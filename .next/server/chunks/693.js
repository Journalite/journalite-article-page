exports.id=693,exports.ids=[693],exports.modules={10129:e=>{e.exports={activeReadersContainer:"ActiveReaders_activeReadersContainer__kzDyK",avatarStack:"ActiveReaders_avatarStack__C0oAd",avatar:"ActiveReaders_avatar__dmRJ6",readingIndicator:"ActiveReaders_readingIndicator__aAJCN",pulse:"ActiveReaders_pulse__xIR81",tooltip:"ActiveReaders_tooltip__hAqNr",avatarAppear:"ActiveReaders_avatarAppear__UbwiK",slideIn:"ActiveReaders_slideIn__40eQ_"}},28914:(e,t,a)=>{"use strict";a.d(t,{A:()=>p});var s=a(60687),r=a(43210),l=a(43649),n=a(75535),i=a(49048);class o{constructor(){this.presenceRefs=new Map,this.heartbeatIntervals=new Map,this.cleanupInterval=null,this.cleanupInterval=setInterval(()=>{this.cleanupStalePresence()},3e4)}async startPresence(e){let t=l.j2.currentUser;if(t)try{let a=await (0,i.VM)(t.uid);if(!a)return;let s=(0,n.doc)(l.db,"articlePresence",`${e}_${t.uid}`);await (0,n.setDoc)(s,{uid:t.uid,username:a.username,firstName:a.firstName,lastName:a.lastName,lastSeen:(0,n.serverTimestamp)(),articleId:e});let r=setInterval(async()=>{if(l.j2.currentUser&&!document.hidden)try{await (0,n.setDoc)(s,{uid:t.uid,username:a.username,firstName:a.firstName,lastName:a.lastName,lastSeen:(0,n.serverTimestamp)(),articleId:e})}catch(t){clearInterval(r),this.heartbeatIntervals.delete(e)}},15e3);this.heartbeatIntervals.set(e,r);let o=()=>{this.stopPresence(e)};window.addEventListener("beforeunload",o),window.addEventListener("pagehide",o),document.addEventListener("visibilitychange",()=>{document.hidden&&setTimeout(()=>{document.hidden&&this.stopPresence(e)},3e4)});let c=l.j2.onAuthStateChanged(t=>{t||this.stopPresence(e)});this.presenceRefs.set(e,()=>{o(),c()})}catch(e){}}async stopPresence(e){let t=l.j2.currentUser;if(t)try{let a=this.heartbeatIntervals.get(e);a&&(clearInterval(a),this.heartbeatIntervals.delete(e));let s=(0,n.doc)(l.db,"articlePresence",`${e}_${t.uid}`);await (0,n.deleteDoc)(s);let r=this.presenceRefs.get(e);r&&(window.removeEventListener("beforeunload",r),this.presenceRefs.delete(e))}catch(e){}}subscribeToActiveUsers(e,t){let a=new Date(Date.now()-45e3),s=(0,n.query)((0,n.collection)(l.db,"articlePresence"),(0,n.where)("articleId","==",e),(0,n.where)("lastSeen",">",n.Timestamp.fromDate(a)),(0,n.orderBy)("lastSeen","desc"),(0,n.limit)(10));return(0,n.onSnapshot)(s,async e=>{try{let a=[];for(let t of e.docs){let e=t.data();if(!l.j2.currentUser||e.uid!==l.j2.currentUser.uid)try{let t=await (0,i.VM)(e.uid);a.push({...e,profile:t||void 0})}catch(t){a.push({...e,profile:void 0})}}t(a)}catch(e){t([])}},e=>{t([])})}async cleanupStalePresence(){try{let e=new Date(Date.now()-6e4),t=(0,n.query)((0,n.collection)(l.db,"articlePresence"),(0,n.where)("lastSeen","<",n.Timestamp.fromDate(e))),a=(await (0,n.getDocs)(t)).docs.map(e=>(0,n.deleteDoc)(e.ref));a.length>0&&await Promise.all(a)}catch(e){}}cleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null),this.heartbeatIntervals.forEach(e=>{clearInterval(e)}),this.heartbeatIntervals.clear(),this.presenceRefs.forEach(e=>{e()}),this.presenceRefs.clear()}}let c=new o;var d=a(10129),m=a.n(d);let v=e=>e.profile?.firstName&&e.profile?.lastName?`${e.profile.firstName[0]}${e.profile.lastName[0]}`.toUpperCase():e.firstName&&e.lastName?`${e.firstName[0]}${e.lastName[0]}`.toUpperCase():e.username?e.username.slice(0,2).toUpperCase():"?",h=e=>e.profile?.firstName&&e.profile?.lastName?`${e.profile.firstName} ${e.profile.lastName}`:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.username||"Anonymous",u=e=>{let t=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#A8E6CF","#FFD93D"];return t[e%t.length]},p=({articleId:e})=>{let[t,a]=(0,r.useState)([]),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=l.j2.onAuthStateChanged(e=>{d(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{if(!e||!o)return;c.startPresence(e);let t=c.subscribeToActiveUsers(e,e=>{let t=e.slice(0,5);a(t),i(t.length>0)});return()=>{t(),c.stopPresence(e)}},[e,o]),o&&n&&0!==t.length)?(0,s.jsxs)("div",{className:m().activeReadersContainer,children:[(0,s.jsxs)("div",{className:m().avatarStack,children:[t.map((e,t)=>(0,s.jsx)("div",{className:m().avatar,style:{backgroundColor:u(t),zIndex:5-t,left:`${20*t}px`},title:h(e),children:v(e)},e.uid)),t.length>0&&(0,s.jsx)("div",{className:m().readingIndicator,style:{left:`${(t.length-1)*20+24}px`},children:(0,s.jsx)("div",{className:m().pulse})})]}),(0,s.jsx)("div",{className:m().tooltip,children:1===t.length?(0,s.jsxs)("span",{children:[h(t[0])," is reading this"]}):(0,s.jsxs)("span",{children:[t.length," people are reading this"]})})]}):null}},45e3:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(60687);a(43210);var r=a(85814),l=a.n(r),n=a(16189),i=a(5062),o=a.n(i);let c=({isAuthenticated:e})=>{let t=(0,n.usePathname)();return(0,s.jsx)("nav",{className:o()["bottom-navigation"],children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l(),{href:"/",className:`${o()["bottom-nav-item"]} ${"/"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 0 0 1 1h3m10-11 2 2m-2-2v10a1 1 0 0 1-1 1h-3m-6 0a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1m-6 0h6'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Home"})]}),(0,s.jsxs)(l(),{href:"/create-article",className:`${o()["bottom-nav-item"]} ${"/create-article"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/create-article"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Write"})]}),(0,s.jsxs)(l(),{href:"/my-thoughts",className:`${o()["bottom-nav-item"]} ${"/my-thoughts"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/my-thoughts"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"My Posts"})]}),(0,s.jsxs)(l(),{href:"/explore",className:`${o()["bottom-nav-item"]} ${"/explore"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/explore"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Explore"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(l(),{href:"/",className:`${o()["bottom-nav-item"]} ${"/"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 0 0 1 1h3m10-11 2 2m-2-2v10a1 1 0 0 1-1 1h-3m-6 0a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1m-6 0h6'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Home"})]}),(0,s.jsxs)(l(),{href:"/explore",className:`${o()["bottom-nav-item"]} ${"/explore"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/explore"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Explore"})]}),(0,s.jsxs)(l(),{href:"/register",className:`${o()["bottom-nav-item"]} ${"/register"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/register"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Sign Up"})]}),(0,s.jsxs)(l(),{href:"/login",className:`${o()["bottom-nav-item"]} ${"/login"===t?o().active:""}`,children:[(0,s.jsx)("div",{className:o()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/login"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:o()["bottom-nav-text"],children:"Login"})]})]})})}},85625:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var s=a(60687),r=a(43210),l=a.n(r),n=a(43649);let i=l().memo(({articleId:e,initialLikes:t=[],className:l="",styles:i={}})=>{let[o,c]=(0,r.useState)(t),[d,m]=(0,r.useState)(!1),[v,h]=(0,r.useState)(null),[u,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=n.j2.onAuthStateChanged(e=>{h(e),e?m(o.includes(e.uid)):m(!1)});return()=>e()},[o]),(0,r.useEffect)(()=>{c(t),v&&m(t.includes(v.uid))},[t,v]);let g=async t=>{if(t.preventDefault(),t.stopPropagation(),console.log("\uD83D\uDC4D LikeButton clicked - should NOT trigger parent re-render"),!v)return void alert("Please login to like articles");p(!0),setTimeout(()=>p(!1),300);try{if(d){let t=o.filter(e=>e!==v.uid);c(t),m(!1),console.log("\uD83D\uDC4D Unlike completed - likes:",t.length);let{doc:s,updateDoc:r,arrayRemove:l}=await Promise.resolve().then(a.bind(a,75535)),{db:n}=await Promise.resolve().then(a.bind(a,43649)),i=s(n,"articles",e);await r(i,{likes:l(v.uid)})}else{let t=[...o,v.uid];c(t),m(!0),console.log("\uD83D\uDC4D Like completed - likes:",t.length);let{doc:s,updateDoc:r,arrayUnion:l}=await Promise.resolve().then(a.bind(a,75535)),{db:n}=await Promise.resolve().then(a.bind(a,43649)),i=s(n,"articles",e);await r(i,{likes:l(v.uid)})}}catch(e){console.error("Error updating like status:",e),d?(c([...o,v.uid]),m(!0)):(c(o.filter(e=>e!==v.uid)),m(!1))}};return(0,s.jsxs)("button",{className:`${l} ${d?i.liked:""}`,onClick:g,"aria-label":d?"Unlike article":"Like article",style:{transition:"all 0.3s ease",transform:u?"scale(1.2)":"scale(1)"},children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:d?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:i.likeIcon,style:{transition:"all 0.3s ease",filter:u?"drop-shadow(0 0 8px currentColor)":"none"},children:(0,s.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,s.jsx)("span",{children:o.length>0?o.length:""})]})})}};