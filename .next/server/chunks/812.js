exports.id=812,exports.ids=[812],exports.modules={6248:e=>{e.exports={commentSection:"comment_commentSection__SP_jS",commentSectionTitle:"comment_commentSectionTitle__F_Jxe",commentError:"comment_commentError__A2v6U",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",loginPromptContainer:"comment_loginPromptContainer__X4aZr",commentAvatar:"comment_commentAvatar__uav6Q",replyAvatar:"comment_replyAvatar__dIlrw",commentInput:"comment_commentInput__4DHa1",replyInput:"comment_replyInput__8t_ho",commentSubmit:"comment_commentSubmit__UfvUF",replySubmit:"comment_replySubmit__2eCP7",loginButton:"comment_loginButton__4encR",loginModalOverlay:"comment_loginModalOverlay__Pk_AM",loginModal:"comment_loginModal__n984X",loginModalClose:"comment_loginModalClose__v02Rx",loginModalTitle:"comment_loginModalTitle__nZpZB",loginModalText:"comment_loginModalText__XwRn6",loginModalButtons:"comment_loginModalButtons__XdVNl",loginModalButton:"comment_loginModalButton__d8Bnr",primary:"comment_primary__1UIRJ",secondary:"comment_secondary__zc89j",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6",commentsList:"comment_commentsList__ZRMbc",commentItem:"comment_commentItem__Vx48l",commentHeader:"comment_commentHeader__3oOD6",commentUser:"comment_commentUser__QP5pY",commentDate:"comment_commentDate__5zfpn",commentContent:"comment_commentContent__DiE8h",commentActions:"comment_commentActions___Wpzi",commentLikeBtn:"comment_commentLikeBtn__wAYZO",replyToggle:"comment_replyToggle__bCRZg",commentDeleteBtn:"comment_commentDeleteBtn__BnLQc",liked:"comment_liked__2yWZ9",repliesToggle:"comment_repliesToggle__yepDc",repliesToggleIcon:"comment_repliesToggleIcon__EZRkK",open:"comment_open__cpLDc",replySection:"comment_replySection__mAqn4",replyItem:"comment_replyItem__ndhqf",replyHeader:"comment_replyHeader__Y2bUK",replyUser:"comment_replyUser__rw4V8",replyDate:"comment_replyDate__4Jafb",replyContent:"comment_replyContent__uV2jp",replyForm:"comment_replyForm__aYyum",inThread:"comment_inThread__lUoKT",replyButtons:"comment_replyButtons__KRGyv",replyCancel:"comment_replyCancel__od7Vq"}},8775:(e,t,r)=>{"use strict";r.d(t,{A:()=>d});var n=r(60687),o=r(76180),i=r.n(o),a=r(43210),l=r(41120),s=r(51215);let d=({isOpen:e,onClose:t,highlightText:r,articleTitle:o,shareUrl:d})=>{let[c,g]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(c){let e=setTimeout(()=>g(!1),3e3);return()=>clearTimeout(e)}},[c]),(0,a.useEffect)(()=>{let r=e=>{"Escape"===e.key&&t()};return e&&(document.addEventListener("keydown",r),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",r),document.body.style.overflow="unset"}},[e,t]);let p=async()=>{try{await navigator.clipboard.writeText(d),g(!0)}catch(e){console.error("Failed to copy link:",e)}};return e?(0,s.createPortal)((0,n.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem"},onClick:t,className:"jsx-8795408d21c696e",children:[(0,n.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"2rem",maxWidth:"500px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",position:"relative",animation:"modalSlideIn 0.3s ease-out"},onClick:e=>e.stopPropagation(),className:"jsx-8795408d21c696e",children:[(0,n.jsx)("button",{onClick:t,style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#6B7280",padding:"0.25rem",borderRadius:"0.375rem",transition:"color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.color="#374151",onMouseOut:e=>e.currentTarget.style.color="#6B7280",className:"jsx-8795408d21c696e",children:"\xd7"}),(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,n.jsxs)("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600",color:"#1F2937"},className:"jsx-8795408d21c696e",children:[(0,n.jsx)(l.uQ,{size:20,color:"#3b82f6"}),"Share Highlight"]}),(0,n.jsxs)("p",{style:{margin:0,color:"#6B7280",fontSize:"0.875rem"},className:"jsx-8795408d21c696e",children:['Share this highlight from "',o,'"']})]}),(0,n.jsxs)("div",{style:{backgroundColor:"#F9FAFB",border:"2px solid #E5E7EB",borderRadius:"0.75rem",padding:"1.25rem",marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,n.jsxs)("div",{style:{fontSize:"1rem",lineHeight:"1.6",color:"#374151",fontStyle:"italic",marginBottom:"0.75rem"},className:"jsx-8795408d21c696e",children:['"',r,'"']}),(0,n.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6B7280",fontWeight:"500"},className:"jsx-8795408d21c696e",children:['— from "',o,'"']})]}),(0,n.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,n.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},className:"jsx-8795408d21c696e",children:"Share Link"}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},className:"jsx-8795408d21c696e",children:[(0,n.jsx)("input",{type:"text",value:d,readOnly:!0,style:{flex:1,padding:"0.75rem",border:"1px solid #D1D5DB",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"#F9FAFB",fontFamily:"monospace"},className:"jsx-8795408d21c696e"}),(0,n.jsx)("button",{onClick:p,style:{padding:"0.75rem 1rem",backgroundColor:c?"#10B981":"#3B82F6",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},className:"jsx-8795408d21c696e",children:c?"✓ Copied!":"\uD83D\uDCCB Copy"})]})]}),(0,n.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},className:"jsx-8795408d21c696e",children:[!1,(0,n.jsx)("button",{onClick:t,style:{padding:"0.75rem 1.5rem",backgroundColor:"#F3F4F6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#E5E7EB",onMouseOut:e=>e.currentTarget.style.backgroundColor="#F3F4F6",className:"jsx-8795408d21c696e",children:"Close"})]})]}),(0,n.jsx)(i(),{id:"8795408d21c696e",children:"@-webkit-keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-moz-keyframes modalSlideIn{from{opacity:0;-moz-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-moz-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-o-keyframes modalSlideIn{from{opacity:0;-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);-moz-transform:translatey(-20px)scale(.95);-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);-moz-transform:translatey(0)scale(1);-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}"})]}),document.body):null}},18314:(e,t,r)=>{"use strict";r.d(t,{Qx:()=>n});let n={joyful:{gradientStart:"#FFD700",gradientEnd:"#FF6B6B",accent:"#FF4757"},angry:{gradientStart:"#FF416C",gradientEnd:"#FF4B2B",accent:"#B71C1C"},energetic:{gradientStart:"#00F260",gradientEnd:"#0575E6",accent:"#1565C0"},peaceful:{gradientStart:"#A8E6CF",gradientEnd:"#88D8C0",accent:"#4CAF50"},reflective:{gradientStart:"#667eea",gradientEnd:"#764ba2",accent:"#5E35B1"},sad:{gradientStart:"#4facfe",gradientEnd:"#00f2fe",accent:"#0288D1"}}},22415:(e,t,r)=>{"use strict";r.d(t,{A:()=>N});var n=r(60687),o=r(43210),i=r.n(o),a=r(43649),l=r(75535);let s=async(e,t,r,n,o,i="insight")=>{try{let s={articleId:e,userId:t,text:r,prefix:n,suffix:o,tag:i,createdAt:(0,l.serverTimestamp)(),comments:[],reactions:{},userReactions:{}};return(await (0,l.addDoc)((0,l.collection)(a.db,"highlights"),s)).id}catch(e){throw console.error("Error saving highlight:",e),e}},d=async(e,t)=>{try{let r=(0,l.query)((0,l.collection)(a.db,"highlights"),(0,l.where)("articleId","==",e));return t&&(r=(0,l.query)((0,l.collection)(a.db,"highlights"),(0,l.where)("articleId","==",e),(0,l.where)("userId","==",t))),(await (0,l.getDocs)(r)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting highlights:",e),[]}},c=async e=>{try{await (0,l.deleteDoc)((0,l.doc)(a.db,"highlights",e))}catch(e){throw console.error("Error deleting highlight:",e),e}},g=(e,t,r="")=>`${r}/articles?slug=${e}#highlight=${t}`,p=(0,o.createContext)(void 0),h=({children:e,articleId:t})=>{let[r,i]=(0,o.useState)([]),[l,g]=(0,o.useState)(!0),[h,u]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{u(e)});return()=>e()},[]),(0,o.useEffect)(()=>{(async()=>{if(t&&h){g(!0);try{let e=await d(t,h.uid);i(e)}catch(e){console.error("Error loading highlights:",e)}finally{g(!1)}}else i([]),g(!1)})()},[t,h]);let m=async(e,t,r,n,o)=>{if(!h)return alert("You must be logged in to highlight text"),null;try{let a=await s(n,h.uid,e,t,r,o),l={id:a,articleId:n,userId:h.uid,text:e,prefix:t,suffix:r,tag:o,createdAt:new Date,reactions:{},userReactions:{}};return i(e=>[...e,l]),a}catch(e){return console.error("Error saving highlight:",e),null}},x=async e=>{try{await c(e),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error removing highlight:",e)}};return(0,n.jsx)(p.Provider,{value:{highlights:r,loading:l,saveHighlight:m,removeHighlight:x,highlightElement:(e,t)=>{try{if(!e.toString())return;let r=document.createElement("mark");r.className=`article-highlight highlight-${t}`;try{e.surroundContents(r)}catch(t){try{let t=e.extractContents();r.appendChild(t),e.insertNode(r)}catch(n){let t=e.cloneContents();r.appendChild(t),e.deleteContents(),e.insertNode(r)}}window.getSelection()?.removeAllRanges()}catch(t){console.error("Error highlighting range:",t),window.getSelection()?.removeAllRanges(),window.getSelection()?.addRange(e)}}},children:e})},u=()=>{let e=(0,o.useContext)(p);if(void 0===e)throw Error("useHighlights must be used within a HighlightProvider");return e};var m=r(41120);r(51215),m.TG,m.Ko,m.Tw,m.Gg;let x=({selection:e,onHighlight:t,onResponse:r,onShare:n,onAiAssist:i})=>{let[a,l]=(0,o.useState)({top:0,left:0}),[s,d]=(0,o.useState)(!1),[c,g]=(0,o.useState)(!1),p=(0,o.useRef)(null);return(0,o.useEffect)(()=>{if(!e||e.isCollapsed){d(!1),g(!1);return}let t=e.getRangeAt(0).getBoundingClientRect(),r=window.innerWidth,n=window.innerHeight,o=p.current?.offsetWidth||280,i=p.current?.offsetHeight||40,a=t.left+t.width/2;a-o/2<16?a=o/2+16:a+o/2>r-16&&(a=r-o/2-16);let s=t.top-i-10+window.scrollY;if(t.top-i-10<0&&(s=t.bottom+10+window.scrollY),r<=768){let e=window.scrollY,t=window.scrollY+n;s<e+16&&(s=e+16),s+i>t-16&&(s=t-i-16)}l({top:s,left:a}),d(!0)},[e]),null};var f=r(8775);let b=e=>{let t={prefix:"",suffix:""};if(!e||0===e.rangeCount)return t;let r=e.getRangeAt(0),n=r.toString(),o=r.commonAncestorContainer,i=o.nodeType===Node.TEXT_NODE?o.parentElement:o;if(!i)return t;let a=i.textContent||"",l=a.indexOf(n);if(-1===l){let e=n.replace(/\s+/g," ").trim(),t=a.replace(/\s+/g," ").indexOf(e);-1!==t&&(l=t)}if(-1!==l){let e=Math.max(0,l-50),r=Math.min(a.length,l+n.length+50),o=a.substring(e,l),i=a.substring(l+n.length,r);o=o.replace(/^\S*\s/,""),i=i.replace(/\s\S*$/,""),t.prefix=o,t.suffix=i}return t},y=(e,t)=>{if(!e||!t)return;let r=t.querySelectorAll(".article-highlight"),n=Array.from(r).map(e=>e.getAttribute("data-highlight-id")).filter(Boolean),o=e.map(e=>e.id);if(n.length===o.length&&n.every(e=>o.includes(e)))return;r.forEach(e=>{let t=e.parentNode;if(t){let r=document.createTextNode(e.textContent||"");t.replaceChild(r,e),t.normalize()}});let i=[];if(e.forEach(e=>{let r=((e,r,n)=>{let o,i,a,l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);for(;o=l.nextNode();){let t=(o.textContent||"").indexOf(e);if(-1!==t){let r=document.createRange();return r.setStart(o,t),r.setEnd(o,t+e.length),r}}let s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),d=e=>RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\s+/g,"\\s+"),"i");for(;i=s.nextNode();){let t=i.textContent||"",r=d(e),n=t.match(r);if(n&&void 0!==n.index){let e=document.createRange();return e.setStart(i,n.index),e.setEnd(i,n.index+n[0].length),e}}if(r||n){let o,i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),a=d(r+e+n);for(;o=i.nextNode();){let t=(o.textContent||"").match(a);if(t&&void 0!==t.index){let n=t[0],i=d(r),a=n.match(i),l=a?a[0].length:0,s=document.createRange(),c=t.index+l,g=d(e),p=n.substring(l).match(g);if(p)return s.setStart(o,c),s.setEnd(o,c+p[0].length),s}}}let c=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),g=(r+e+n).replace(/\s+/g," ").trim();for(;a=c.nextNode();){let t=(a.textContent||"").replace(/\s+/g," ").indexOf(g);if(-1!==t){let n=document.createRange(),o=r.replace(/\s+/g," ").trim().length,i=t+(o>0?o+1:0);return n.setStart(a,i),n.setEnd(a,i+e.replace(/\s+/g," ").trim().length),n}}return null})(e.text,e.prefix||"",e.suffix||"");if(r)try{let t=document.createElement("mark");t.className=`article-highlight highlight-${e.tag||"insight"}`,t.dataset.highlightId=e.id;try{r.surroundContents(t)}catch(n){let e=r.extractContents();t.appendChild(e),r.insertNode(t)}console.log(`✅ Applied highlight "${e.text.substring(0,30)}..." with ID: ${e.id}`)}catch(t){console.error("Error applying highlight:",t,{text:e.text,id:e.id,tag:e.tag}),i.push(e.id)}else console.warn(`❌ Could not find text for highlight: "${e.text.substring(0,30)}..." with ID: ${e.id}`),i.push(e.id)}),i.length>0){console.log(`🧹 Found ${i.length} highlights that couldn't be applied. These might be from old text formatting.`);let e=`failed-highlights-${location.pathname}`,t=JSON.parse(sessionStorage.getItem(e)||"{}");i.forEach(e=>{t[e]=(t[e]||0)+1}),sessionStorage.setItem(e,JSON.stringify(t));let r=Object.entries(t).filter(([e,t])=>t>=3).map(([e])=>e);r.length>0&&(console.log(`🗑️  Suggesting cleanup of ${r.length} persistently failed highlights`),sessionStorage.getItem(`cleanup-notification-${location.pathname}`)||(console.log("\uD83D\uDD04 Auto-cleaning broken highlights from text format change..."),setTimeout(()=>{r.forEach(async e=>{try{let t=new CustomEvent("cleanup-broken-highlight",{detail:{highlightId:e}});window.dispatchEvent(t)}catch(t){console.error("Failed to cleanup highlight:",e,t)}})},1e3),sessionStorage.setItem(`cleanup-notification-${location.pathname}`,"shown")))}},S=({articleId:e,children:t,articleTitle:r="Article",articleSlug:i=""})=>{let[a,l]=(0,o.useState)(null),{highlights:s,saveHighlight:d,removeHighlight:c,highlightElement:p}=u(),[h,m]=(0,o.useState)(null),[S,w]=(0,o.useState)(!1),[_,v]=(0,o.useState)(""),[j,k]=(0,o.useState)(!1),[C,$]=(0,o.useState)(""),[A,F]=(0,o.useState)(null),[E,N]=(0,o.useState)(!1),[T,I]=(0,o.useState)(!1),[M,B]=(0,o.useState)({top:0,left:0}),[z,R]=(0,o.useState)(!1),[W,L]=(0,o.useState)(""),D=(0,o.useCallback)(()=>{I(!0),setTimeout(()=>{N(!1),I(!1)},150)},[]),P=(0,o.useCallback)(()=>{E||setTimeout(()=>{let e=window.getSelection();if(e&&!e.isCollapsed){let t=e.toString(),r=t.trim();if(r&&r.length>0&&t.length<1e3){let t=e.getRangeAt(0).commonAncestorContainer;(t.nodeType===Node.TEXT_NODE?t.parentElement?.closest(".article-highlight-container"):t?.closest(".article-highlight-container"))?l(e):l(null)}else l(null)}else l(null)},100)},[E]),Q=(0,o.useCallback)((t,r,n)=>{if(t&&r){let o=b(window.getSelection());d(t,o.prefix,o.suffix,e,n),p(r,n)}},[e,d,p]),O=(0,o.useCallback)(e=>{let t=e.target;if(t.classList.contains("article-highlight")){e.preventDefault(),e.stopPropagation();let r=t.dataset.highlightId,n=t.textContent||"";if(r){I(!1),F({id:r,text:n});let e=t.getBoundingClientRect();B({top:e.top-40+window.scrollY,left:e.left+e.width/2}),N(!0),l(null)}}else E&&(D(),F(null))},[E,D]),H=(0,o.useCallback)(()=>{if(A&&A.id){D();let e=A.id;if(F(null),c(e),h){let t=h.querySelector(`[data-highlight-id="${e}"]`);if(t&&t.parentNode){let e=document.createTextNode(t.textContent||"");t.parentNode.replaceChild(e,t),t.parentNode.normalize()}}}},[A,c,h,D]),U=(0,o.useCallback)(e=>{v(e),w(!0)},[]),q=(0,o.useCallback)(e=>{L(e),R(!0)},[]),Y=(0,o.useCallback)(e=>{$(e),k(!0)},[]);(0,o.useEffect)(()=>{document.addEventListener("selectionchange",P);let e=()=>{setTimeout(P,150)};return"ontouchstart"in window&&document.addEventListener("touchend",e),()=>{document.removeEventListener("selectionchange",P),"ontouchstart"in window&&document.removeEventListener("touchend",e)}},[P]),(0,o.useEffect)(()=>{if(h)return h.addEventListener("click",O),()=>{h.removeEventListener("click",O)}},[h,O]),(0,o.useEffect)(()=>{let e=e=>{if(E){let t=e.target;t.closest(".highlight-toolbar")||t.classList.contains("article-highlight")||(D(),F(null))}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[E,D]),(0,o.useEffect)(()=>{if(h){let e=setTimeout(()=>{console.log(`🎨 Applying ${s.length} highlights to content`),y(s,h)},100);return()=>clearTimeout(e)}},[s,h]),(0,o.useEffect)(()=>{let e=e=>{let t=e.detail?.highlightId;t&&(console.log(`🗑️ Cleaning up broken highlight: ${t}`),c(t))};return window.addEventListener("cleanup-broken-highlight",e),()=>{window.removeEventListener("cleanup-broken-highlight",e)}},[c]);let J=(0,o.useCallback)(e=>{e&&e!==h&&m(e)},[h]);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x,{selection:a,onHighlight:Q,onResponse:U,onShare:q,onAiAssist:Y}),E&&A&&(0,n.jsxs)("div",{className:`highlight-toolbar unhighlight-toolbar ${T?"hiding":""}`,style:{position:"absolute",top:`${M.top}px`,left:`${M.left}px`,transform:T?"translateY(-10px) translateX(-50%)":"translateX(-50%)",zIndex:1e3},children:[(0,n.jsxs)("button",{onClick:H,className:"highlight-btn highlight-btn-danger",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),(0,n.jsx)("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),(0,n.jsx)("line",{x1:"12",y1:"9",x2:"18",y2:"15"})]}),(0,n.jsx)("span",{children:"Unhighlight"})]}),(0,n.jsxs)("button",{onClick:()=>{q(A.text),D()},className:"highlight-btn",children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,n.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,n.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,n.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,n.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,n.jsx)("span",{children:"Share"})]}),(0,n.jsxs)("button",{onClick:()=>{U(A.text),D()},className:"highlight-btn",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,n.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,n.jsx)("span",{children:"Response"})]})]}),(0,n.jsx)("div",{ref:J,className:"article-highlight-container",children:t}),S&&(0,n.jsx)("div",{className:"highlight-response-modal",children:(0,n.jsxs)("div",{className:"highlight-modal-content",children:[(0,n.jsx)("button",{className:"highlight-modal-close",onClick:()=>w(!1),children:"\xd7"}),(0,n.jsx)("h3",{children:"Respond to highlighted text"}),(0,n.jsxs)("div",{className:"highlight-selected-text",children:['"',_,'"']}),(0,n.jsx)("textarea",{className:"highlight-response-input",placeholder:"Write your response..."}),(0,n.jsx)("button",{className:"highlight-response-submit",children:"Submit"})]})}),j&&(0,n.jsx)("div",{className:"highlight-ai-modal",children:(0,n.jsxs)("div",{className:"highlight-modal-content",children:[(0,n.jsx)("button",{className:"highlight-modal-close",onClick:()=>k(!1),children:"\xd7"}),(0,n.jsx)("h3",{children:"Journa AI"}),(0,n.jsxs)("div",{className:"highlight-selected-text",children:['"',C,'"']}),(0,n.jsxs)("div",{className:"highlight-ai-options",children:[(0,n.jsx)("button",{children:"Explain this"}),(0,n.jsx)("button",{children:"Fact check"}),(0,n.jsx)("button",{children:"Provide context"}),(0,n.jsx)("button",{children:"Summarize"})]}),(0,n.jsx)("div",{className:"highlight-ai-response",children:(0,n.jsx)("div",{className:"highlight-ai-loading",children:"Journa AI is thinking..."})})]})}),z&&(0,n.jsx)(f.A,{isOpen:z,onClose:()=>R(!1),highlightText:W,articleTitle:r,shareUrl:g(i,e)})]})},w=({currentMood:e,isVisible:t,moodFeatureEnabled:r})=>{let[i,a]=(0,o.useState)(!1),[l,s]=(0,o.useState)(null),[d,c]=(0,o.useState)({colorStops:[{id:"1",color:"#007AFF",x:30,y:40,isSelected:!0}],opacity:80,grain:30,mode:"auto"}),g=(0,o.useRef)(null),p=(0,o.useRef)(null),h=(0,o.useRef)(null),u=e=>{let{colorStops:t,opacity:r,grain:n}=e,o=r/100,i=n/100,a="";if(i>.1){let e=.08*i,t=Math.max(15,25-8*i);a=`
        radial-gradient(ellipse at 12% 18%, rgba(255,255,255,${e}) 3px, transparent ${t}px),
        radial-gradient(ellipse at 87% 23%, rgba(0,0,0,${.7*e}) 2px, transparent ${1.2*t}px),
        radial-gradient(ellipse at 43% 82%, rgba(255,255,255,${.5*e}) 4px, transparent ${.9*t}px),
        radial-gradient(ellipse at 71% 64%, rgba(0,0,0,${.6*e}) 2.5px, transparent ${1.1*t}px),
        radial-gradient(ellipse at 29% 57%, rgba(255,255,255,${.4*e}) 3.5px, transparent ${1.3*t}px),
        radial-gradient(ellipse at 93% 11%, rgba(0,0,0,${.3*e}) 2px, transparent ${.8*t}px),
        radial-gradient(ellipse at 6% 89%, rgba(255,255,255,${.6*e}) 3px, transparent ${1.4*t}px),
        radial-gradient(ellipse at 78% 91%, rgba(0,0,0,${.4*e}) 2.5px, transparent ${1.1*t}px),
      `}let l="";if(1===t.length){let e=t[0];l=`radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(255*o).toString(16)}, transparent 70%)`}else if(2===t.length){let[e,r]=t;l=`
        radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(.7*o*255).toString(16)}, transparent 50%),
        radial-gradient(circle at ${r.x}% ${r.y}%, ${r.color}${Math.round(.7*o*255).toString(16)}, transparent 50%)
      `}else if(3===t.length){let[e,r,n]=t;l=`
        radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(.5*o*255).toString(16)}, transparent 40%),
        radial-gradient(circle at ${r.x}% ${r.y}%, ${r.color}${Math.round(.5*o*255).toString(16)}, transparent 40%),
        radial-gradient(circle at ${n.x}% ${n.y}%, ${n.color}${Math.round(.5*o*255).toString(16)}, transparent 40%)
      `}return a?`${a}${l}`:l||"transparent"},x=e=>{let{colorStops:t,opacity:r,grain:n}=e,o=Math.max(.7,r/100),i=n/100,a="";if(i>.3){let e=.04*i;a=`
        radial-gradient(ellipse at 25% 25%, rgba(255,255,255,${e}) 4px, transparent 20px),
        radial-gradient(ellipse at 75% 75%, rgba(0,0,0,${.5*e}) 3px, transparent 25px),
        radial-gradient(ellipse at 50% 15%, rgba(255,255,255,${.7*e}) 3.5px, transparent 22px),
      `}let l="";if(1===t.length){let e=t[0];l=`linear-gradient(135deg, ${e.color}${Math.round(255*o).toString(16)}, ${e.color}${Math.round(.8*o*255).toString(16)})`}else if(2===t.length){let[e,r]=t;l=`linear-gradient(135deg, ${e.color}${Math.round(255*o).toString(16)}, ${r.color}${Math.round(255*o).toString(16)})`}else if(3===t.length){let[e,r,n]=t;l=`linear-gradient(135deg, ${e.color}${Math.round(255*o).toString(16)}, ${r.color}${Math.round(.9*o*255).toString(16)}, ${n.color}${Math.round(255*o).toString(16)})`}return a?`${a}${l}`:l||"transparent"},f=e=>{if(!r)return;let t=u(e),n=x(e);document.querySelectorAll("[data-mood-element]").forEach(e=>{e.style.backgroundImage=t,e.style.transition="background-image 0.2s ease"}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.backgroundImage=t,e.style.transition="background-image 0.2s ease"}),console.log("\uD83C\uDFA8 Looking for toggle bar to update...");let o=document.querySelector('[data-toggle-bar="true"]');o?(console.log("\uD83C\uDFA8 Found toggle bar with data attribute:",o),o.style.backgroundImage=n,o.style.transition="background-image 0.2s ease",o.style.backgroundSize="cover",o.style.backgroundPosition="center"):(console.log("\uD83C\uDFA8 Toggle bar with data attribute not found, trying fallback..."),document.querySelectorAll("div").forEach(e=>{let t=e.textContent||"";t.includes("Atmosphere")&&t.includes("Enhanced features")&&t.includes("Mood Background")&&t.includes("Interactive Reflections")&&(console.log("\uD83C\uDFA8 Found toggle bar via text content:",e),e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease",e.style.backgroundSize="cover",e.style.backgroundPosition="center")})),document.querySelectorAll("[data-reflection-bar], [data-mood-bar]").forEach(e=>{e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease",e.style.backgroundSize="cover",e.style.backgroundPosition="center"}),document.querySelectorAll(".progress-bar, .status-bar, .mood-indicator").forEach(e=>{e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease"}),localStorage.setItem("journaColorThemeConfig",JSON.stringify(e))},b=(e,t)=>{e.preventDefault(),s(t),c({...d,colorStops:d.colorStops.map(e=>({...e,isSelected:e.id===t}))})},y=e=>{if(!l||!g.current)return;let t=g.current.getBoundingClientRect(),r=Math.max(5,Math.min(95,(e.clientX-t.left)/t.width*100)),n=Math.max(5,Math.min(95,(e.clientY-t.top)/t.height*100)),o={...d,colorStops:d.colorStops.map(e=>e.id===l?{...e,x:r,y:n}:e)};c(o),f(o)},S=()=>{s(null)},w=e=>{if(!p.current)return;let t=p.current.getBoundingClientRect(),r=Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100)),n={...d,opacity:r};c(n),f(n)},_=e=>{if(!h.current)return;let t=h.current.getBoundingClientRect(),r=t.left+t.width/2,n=t.top+t.height/2,o=e.clientX-r,i=180/Math.PI*Math.atan2(e.clientY-n,o);(i=(i+270)%360)<0&&(i+=360);let a=Math.round(Math.max(0,Math.min(100,4.166666666666667*Math.round(i/360*100/4.166666666666667))));if(Math.abs(a-d.grain)>.5){navigator.vibrate&&navigator.vibrate(10);let e={...d,grain:a};c(e),f(e)}},v=e=>{if(!d.colorStops.find(e=>e.isSelected))return;let t={...d,colorStops:d.colorStops.map(t=>t.isSelected?{...t,color:e}:t)};c(t),f(t)};if((0,o.useEffect)(()=>{if(l){let e=e=>{"opacity"===l?w(e):"grain"===l?_(e):y(e)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",S),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",S)}}},[l,d]),(0,o.useEffect)(()=>{let e=localStorage.getItem("journaColorThemeConfig");if(e)try{let t=JSON.parse(e);c(t),f(t)}catch(e){console.error("Failed to load theme config:",e)}},[]),!t||!r)return null;let j=u(d),k=d.colorStops.find(e=>e.isSelected)||d.colorStops[0];return(0,n.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"20px":"40px",left:window.innerWidth<=768?"20px":"40px",zIndex:1e3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,n.jsx)("button",{onClick:()=>a(!i),style:{width:window.innerWidth<=768?"48px":"56px",height:window.innerWidth<=768?"48px":"56px",borderRadius:"50%",border:"none",background:j||"#007AFF",color:"white",fontSize:"20px",cursor:"pointer",boxShadow:i?"0 8px 25px rgba(0, 122, 255, 0.4), 0 0 0 2px rgba(0, 122, 255, 0.2)":"0 6px 20px rgba(0, 122, 255, 0.3)",transform:i?"scale(1.05) rotate(45deg)":"scale(1) rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},title:"Journa Color Editor",children:(0,n.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("defs",{children:(0,n.jsxs)("linearGradient",{id:"iconGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,n.jsx)("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),(0,n.jsx)("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0.7"})]})}),(0,n.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"url(#iconGradient)"}),(0,n.jsx)("circle",{cx:"16",cy:"12",r:"2.5",fill:"url(#iconGradient)"}),(0,n.jsx)("circle",{cx:"12",cy:"18",r:"2",fill:"url(#iconGradient)"}),(0,n.jsx)("path",{d:"M8 8L16 12M16 12L12 18",stroke:"url(#iconGradient)",strokeWidth:"1.5",strokeLinecap:"round"})]})}),i&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("style",{children:`
              @keyframes gentleSlideUp {
                from {
                  opacity: 0;
                  transform: translateY(20px) scale(0.98);
                }
                to {
                  opacity: 1;
                  transform: translateY(0) scale(1);
                }
              }
            `}),(0,n.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"80px":"110px",left:window.innerWidth<=768?"20px":"40px",width:window.innerWidth<=768?"340px":"380px",maxHeight:window.innerWidth<=768?"400px":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:window.innerWidth<=768?"16px":"24px",padding:window.innerWidth<=768?"16px":"24px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",zIndex:999,animation:"gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden"},children:[(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem"},children:[{mode:"auto",icon:m.R9,title:"Auto"},{mode:"light",icon:"☀️",title:"Light"},{mode:"dark",icon:"\uD83C\uDF19",title:"Dark"}].map(({mode:e,icon:t,title:r})=>(0,n.jsx)("button",{onClick:()=>{let t={...d,mode:e};c(t),f(t)},style:{width:"48px",height:"48px",borderRadius:"12px",border:d.mode===e?"2px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:d.mode===e?"rgba(0, 122, 255, 0.1)":"rgba(0,0,0,0.05)",fontSize:"20px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:r,children:"auto"===e?(0,n.jsx)(m.R9,{size:20,color:d.mode===e?"#007AFF":"#666"}):t},e))}),(0,n.jsx)("div",{ref:g,style:{width:"100%",height:"180px",borderRadius:"16px",background:`
                radial-gradient(circle at 50% 50%, rgba(100, 100, 100, 0.1) 0%, transparent 70%),
                repeating-linear-gradient(0deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),
                repeating-linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),
                linear-gradient(135deg, #f0f0f0, #e8e8e8)
              `,position:"relative",cursor:"grab",marginBottom:"1.5rem",border:"1px solid rgba(0,0,0,0.1)",overflow:"hidden"},children:d.colorStops.map(e=>(0,n.jsx)("div",{onMouseDown:t=>b(t,e.id),style:{position:"absolute",top:`${e.y}%`,left:`${e.x}%`,transform:"translate(-50%, -50%)",width:e.isSelected?"24px":"20px",height:e.isSelected?"24px":"20px",borderRadius:"50%",background:e.color,border:e.isSelected?"3px solid white":"2px solid white",boxShadow:e.isSelected?"0 4px 12px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.3)",cursor:l===e.id?"grabbing":"grab",transition:l===e.id?"none":"all 0.2s ease",zIndex:e.isSelected?10:5}},e.id))}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,n.jsx)("button",{onClick:()=>{if(d.colorStops.length<=1)return;let e={...d,colorStops:d.colorStops.slice(0,-1)};c(e),f(e)},disabled:d.colorStops.length<=1,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length<=1?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length<=1?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length<=1?.5:1},children:"−"}),(0,n.jsxs)("span",{style:{fontSize:"14px",color:"#666",minWidth:"80px",textAlign:"center"},children:[d.colorStops.length,"/3 colors"]}),(0,n.jsx)("button",{onClick:()=>{if(d.colorStops.length>=3)return;let e={id:Date.now().toString(),color:"#FF6B6B",x:50+15*d.colorStops.length,y:50+10*d.colorStops.length,isSelected:!1},t={...d,colorStops:[...d.colorStops,e]};c(t),f(t)},disabled:d.colorStops.length>=3,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length>=3?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length>=3?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length>=3?.5:1},children:"+"})]}),(0,n.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:["#FFFFFF","#FFB3D9","#B19CD9","#FF6B6B","#FF8E53","#FFD93D","#6BCF7F","#4ECDC4","#45B7D1"].map((e,t)=>(0,n.jsx)("button",{onClick:()=>v(e),style:{width:"32px",height:"32px",borderRadius:"50%",border:k.color===e?"3px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:e,cursor:"pointer",transform:k.color===e?"scale(1.15)":"scale(1)",transition:"all 0.2s ease"}},t))}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[(0,n.jsxs)("div",{ref:p,onMouseDown:e=>{e.preventDefault(),s("opacity"),w(e)},style:{flex:1,height:"40px",background:"rgba(0,0,0,0.05)",borderRadius:"20px",position:"relative",cursor:"pointer",display:"flex",alignItems:"center",paddingLeft:"12px",paddingRight:"12px"},children:[(0,n.jsx)("div",{style:{position:"absolute",left:"12px",right:"12px",height:"4px",background:"repeating-linear-gradient(to right, #ccc 0px, #ccc 3px, transparent 3px, transparent 6px)",borderRadius:"2px"}}),(0,n.jsx)("div",{style:{position:"absolute",left:`${12+d.opacity/100*76}%`,width:"16px",height:"16px",background:"white",borderRadius:"50%",border:"2px solid #007AFF",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transform:"translateX(-50%)"}})]}),(0,n.jsxs)("div",{ref:h,onMouseDown:e=>{e.preventDefault(),s("grain"),_(e)},style:{width:"60px",height:"60px",borderRadius:"50%",background:"linear-gradient(145deg, #f0f0f0, #d9d9d9)",position:"relative",cursor:"grain"===l?"grabbing":"grab",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"grain"===l?"inset 0 2px 4px rgba(0,0,0,0.2)":"0 2px 4px rgba(0,0,0,0.1)",transition:"grain"===l?"none":"all 0.2s ease"},children:[[0,45,90,135,180,225,270,315].map((e,t)=>(0,n.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"2px",height:"6px",background:"rgba(0,0,0,0.3)",borderRadius:"1px",transform:`translate(-50%, -50%) rotate(${e}deg) translateY(-22px)`,transformOrigin:"center"}},t)),(0,n.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(145deg, #ffffff, #e8e8e8)",transform:"translate(-50%, -50%)",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"grain"===l?"inset 0 1px 3px rgba(0,0,0,0.2)":"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,n.jsx)("div",{style:{position:"absolute",top:"6px",left:"50%",width:"3px",height:"12px",background:"#007AFF",borderRadius:"1.5px",transform:`translateX(-50%) rotate(${d.grain/100*360}deg)`,transformOrigin:"50% 14px",transition:"grain"===l?"none":"transform 0.2s ease"}}),(0,n.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"4px",height:"4px",background:"#007AFF",borderRadius:"50%",transform:"translate(-50%, -50%)"}})]}),(0,n.jsxs)("div",{style:{position:"absolute",bottom:"-20px",left:"50%",transform:"translateX(-50%)",fontSize:"10px",color:"#666",fontWeight:"500"},children:[Math.round(d.grain),"%"]})]})]})]})]})]})},_=i().memo(({initialEnabled:e=!0,className:t="",style:r={},currentMood:i="joyful"})=>{let[l,s]=(0,o.useState)(e),[d,c]=(0,o.useState)(null),[g,p]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(c(e),e){let e=localStorage.getItem("moodFeatureEnabled");if(null!==e){let t=JSON.parse(e);s(t);let r=(e=1)=>{console.log(`🎨 Applying initial mood state (attempt ${e}):`,t);let n=document.querySelectorAll("[data-mood-element]");if(console.log("\uD83C\uDFA8 Found mood elements on init:",n.length),0===n.length&&e<5)return void setTimeout(()=>r(e+1),200);n.forEach(e=>{e.style.transition="opacity 0.3s ease, transform 0.3s ease",t?(e.setAttribute("data-mood-active","true"),e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.transform="scale(1)",console.log("\uD83C\uDFA8 Initial show:",e.getAttribute("data-mood-element"))):(e.setAttribute("data-mood-active","false"),e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Initial hide:",e.getAttribute("data-mood-element")))}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",t||(e.style.background="rgba(255, 255, 255, 0.95)",e.style.border="1px solid rgba(0, 0, 0, 0.1)",e.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)")})};setTimeout(()=>r(),100)}else s(!0)}else s(!1)});return()=>e()},[]),d)?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{onClick:()=>{if(console.log("\uD83C\uDFA8 MoodToggle clicked - should NOT trigger parent re-render"),!d)return;p(!0),setTimeout(()=>p(!1),300);let e=!l;s(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e)),console.log("\uD83C\uDFA8 Mood feature toggled to:",e),console.log("\uD83C\uDFA8 Toggle clicked - searching for mood elements...");let t=(r=1)=>{let n=document.querySelectorAll("[data-mood-element]");if(console.log(`🎨 Found mood elements (attempt ${r}):`,n.length),0===n.length&&r<3)return void setTimeout(()=>t(r+1),100);n.forEach(t=>{t.style.transition="opacity 0.3s ease, transform 0.3s ease",e?(t.setAttribute("data-mood-active","true"),t.style.display="block",t.style.visibility="visible",t.style.opacity="1",t.style.transform="scale(1)",console.log("\uD83C\uDFA8 Showing mood element:",t.getAttribute("data-mood-element"))):(t.setAttribute("data-mood-active","false"),t.style.opacity="0",t.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Hiding mood element:",t.getAttribute("data-mood-element")),setTimeout(()=>{"false"===t.getAttribute("data-mood-active")&&(t.style.display="none",t.style.visibility="hidden")},300))})};t(),document.querySelectorAll("[data-mood-header]").forEach(t=>{if(t.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",e){t.style.background="",t.style.border="",t.style.boxShadow="";let e=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=e,console.log("\uD83C\uDFA8 Header mood styling restored - cleared overrides")}else t.setAttribute("data-mood-style",t.style.background),t.style.background="rgba(255, 255, 255, 0.95)",t.style.border="1px solid rgba(0, 0, 0, 0.1)",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)",console.log("\uD83C\uDFA8 Header mood styling removed")}),console.log("\uD83C\uDFA8 Mood backgrounds updated immediately. Enabled:",e)},className:t,style:{...r,transition:"all 0.3s ease",transform:g?"scale(1.1)":"scale(1)"},title:l?"Turn off mood feature":"Turn on mood feature",children:l?"ON":"OFF"}),(0,n.jsx)(w,{currentMood:i,isVisible:!!d,moodFeatureEnabled:l})]}):null}),v=i().memo(({articleId:e,className:t="",style:i={}})=>{let[l,s]=(0,o.useState)(!1),[d,c]=(0,o.useState)(null),[g,p]=(0,o.useState)(!1),[h,u]=(0,o.useState)(0),[x,f]=(0,o.useState)(""),[b,y]=(0,o.useState)(""),[S,w]=(0,o.useState)(!1),[_,v]=(0,o.useState)(!1),j=["How does this make you feel?","What questions does this raise for you?","How does this connect to your own experiences?","What would you have done differently?","What surprises you most about this?","How might this change your perspective?","What emotions are you experiencing right now?","What does this remind you of?","If you could ask the author one question, what would it be?","How does this challenge your existing beliefs?"],k=()=>j[h%j.length];(0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{c(e)});return()=>e()},[]),(0,o.useEffect)(()=>{l&&!b&&y(k())},[l,h]);let C=()=>{w(!1)},$=async()=>{if(x.trim()&&d){v(!0);try{console.log("Starting reflection submission:",{articleId:e,currentPrompt:b,currentReflection:x,reflectionCount:h});let{saveReflectionResponse:t}=await Promise.resolve().then(r.bind(r,45306));await t(e,`prompt_${Date.now()}`,b,x,h,!0),console.log("Reflection saved successfully"),u(e=>e+1),f(""),s(!1)}catch(e){console.error("Error saving reflection:",e)}finally{v(!1)}}};return d?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("button",{"data-reflection-element":"floating-button",onClick:()=>{console.log("ReflectionToggle clicked - should NOT trigger parent re-render"),p(!0),setTimeout(()=>p(!1),300),s(!l),l||y(k())},className:t,style:{position:"fixed",bottom:window.innerWidth<=768?"20px":"40px",right:window.innerWidth<=768?"20px":"40px",width:window.innerWidth<=768?"48px":"56px",height:window.innerWidth<=768?"48px":"56px",borderRadius:"50%",background:l?"linear-gradient(135deg, #1d4ed8, #7c3aed)":"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",boxShadow:l?"0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)":"0 6px 20px rgba(59, 130, 246, 0.3)",cursor:"pointer",zIndex:1e3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0",padding:"0",margin:"0",lineHeight:"0",textAlign:"center",verticalAlign:"middle",overflow:"hidden",boxSizing:"border-box",transform:g?"scale(1.1)":l?"scale(1.05)":"scale(1)",backdropFilter:"blur(10px)",...i},title:l?"Close reflection":"Open reflection",children:(0,n.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:l?(0,n.jsx)(m.US,{size:14,color:"#ffffff"}):(0,n.jsx)(m.zf,{size:14,color:"#ffffff"})})}),l&&(0,n.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"80px":"110px",right:window.innerWidth<=768?"20px":"40px",left:window.innerWidth<=768?"20px":"auto",width:window.innerWidth<=768?"auto":"380px",maxWidth:window.innerWidth<=768?"none":"380px",maxHeight:window.innerWidth<=768?"400px":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:window.innerWidth<=768?"16px":"24px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",zIndex:999,animation:"gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)",padding:window.innerWidth<=768?"16px":"24px",overflow:"hidden"},children:[(0,n.jsx)("style",{children:`
              @keyframes gentleSlideUp {
                from {
                  opacity: 0;
                  transform: translateY(20px) scale(0.98);
                }
                to {
                  opacity: 1;
                  transform: translateY(0) scale(1);
                }
              }
            `}),(0,n.jsxs)("div",{style:{marginBottom:"20px",textAlign:"center"},children:[(0,n.jsxs)("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,n.jsx)(m.uQ,{size:16,color:"#3b82f6"}),"Time to Reflect"]}),(0,n.jsx)("div",{style:{position:"relative"},children:S?(0,n.jsx)("input",{type:"text",value:b,onChange:e=>y(e.target.value),onBlur:C,onKeyDown:e=>{"Enter"===e.key&&C(),"Escape"===e.key&&(y(k()),w(!1))},autoFocus:!0,style:{width:"100%",padding:"8px 12px",border:"2px solid #3b82f6",borderRadius:"12px",background:"white",fontSize:"14px",textAlign:"center",outline:"none"}}):(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",flexWrap:"wrap"},children:[(0,n.jsx)("p",{onClick:()=>{w(!0)},style:{margin:0,fontSize:"14px",color:"#64748b",fontWeight:"500",cursor:"pointer",padding:"4px 8px",borderRadius:"8px",transition:"all 0.2s ease"},title:"Click to edit question",children:b}),(0,n.jsx)("button",{onClick:()=>{let e=Math.floor(Math.random()*j.length);y(j[e])},style:{background:"rgba(59, 130, 246, 0.1)",border:"none",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#3b82f6",cursor:"pointer",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center"},title:"Get different question",children:(0,n.jsx)(m.jG,{size:12,color:"#3b82f6"})})]})})]}),(0,n.jsx)("textarea",{value:x,onChange:e=>f(e.target.value),placeholder:"Share your thoughts...",style:{width:"100%",height:"120px",padding:"12px",border:"2px solid #e2e8f0",borderRadius:"12px",background:"white",fontSize:"14px",fontFamily:"inherit",resize:"vertical",outline:"none",transition:"border-color 0.2s ease",marginBottom:"16px"},onFocus:e=>{e.target.style.borderColor="#3b82f6"},onBlur:e=>{e.target.style.borderColor="#e2e8f0"}}),(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[(0,n.jsx)("button",{onClick:()=>s(!1),style:{background:"transparent",border:"2px solid #e2e8f0",borderRadius:"12px",padding:"8px 16px",fontSize:"14px",color:"#64748b",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},children:"Cancel"}),(0,n.jsx)("button",{onClick:$,disabled:!x.trim()||_,style:{background:x.trim()?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"#e2e8f0",border:"none",borderRadius:"12px",padding:"8px 20px",fontSize:"14px",color:x.trim()?"white":"#94a3b8",cursor:x.trim()?"pointer":"not-allowed",fontWeight:"600",transition:"all 0.2s ease",opacity:_?.7:1},children:_?"Saving...":"Save Reflection"})]})]})]}):null});var j=r(18314);let k=i().memo(({className:e="",style:t={}})=>{let[r,i]=(0,o.useState)(!0),[l,s]=(0,o.useState)(null),[d,c]=(0,o.useState)(!1),[g]=(0,o.useState)("reflective");return((0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(s(e),e){let e=localStorage.getItem("reflectionsEnabled");if(null!==e){let t=JSON.parse(e);i(t),setTimeout(()=>{document.querySelectorAll("[data-reflection-element]").forEach(e=>{e.style.display=t?"":"none"})},100)}else i(!0)}else i(!1)});return()=>e()},[]),l)?(0,n.jsx)("button",{onClick:()=>{if(console.log("ReflectionModeToggle clicked - should NOT trigger parent re-render"),!l)return;c(!0),setTimeout(()=>c(!1),300);let e=!r;i(e),localStorage.setItem("reflectionsEnabled",JSON.stringify(e)),console.log("Reflection mode toggled to:",e),document.querySelectorAll("[data-reflection-element]").forEach(t=>{e?t.style.display="":t.style.display="none"}),window.dispatchEvent(new CustomEvent("reflectionModeToggle",{detail:{enabled:e}}))},className:e,style:{...t,transition:"all 0.3s ease",transform:d?"scale(1.1)":"scale(1)",background:r?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.2)",color:r?j.Qx[g].accent:"#F7FAFC"},title:r?"Turn off reflections":"Turn on reflections",children:r?"ON":"OFF"}):(0,n.jsx)("button",{style:{...t,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"Sign in to use reflections",children:"OFF"})});var C=r(34738),$=r.n(C);async function A(e){let t=`http://127.0.0.1:5001/api/prototype/v1/article/${e}`,r=await fetch(t);if(!r.ok)throw Error(`Failed to fetch article: ${r.status} ${r.statusText}`);return r.json()}function F(){return null}r(46997),r(57894),r(8990),r(68960),r(36014),r(71454),r(25865),r(92623),r(25119),r(29173),r(65848),r(88224),r(35630),r(14321),r(48541),r(83075),r(29731),r(34425),r(61707),r(11566),r(86908);var E=r(62475);let N=({articleId:e,initialHtml:t,isAuthenticated:r=!1,articleTitle:i="Article",articleSlug:a=""})=>{let[l,s]=(0,o.useState)(null),[d,c]=(0,o.useState)(!t),[g,p]=(0,o.useState)(""),[u,x]=(0,o.useState)("reflective"),f=(0,o.useRef)(null);(0,o.useEffect)(()=>{f.current&&(t||l)&&setTimeout(()=>{var e;f.current&&f.current},100)},[t,l]),(0,o.useEffect)(()=>{let e=b();if(e){let t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();t&&x((0,E.H)(t))}},[t,l]),(0,o.useEffect)(()=>{t||l||(async()=>{try{c(!0);let t=await A(e);if(!t)return void p("Article not found");let r="",n=("string"==typeof t.content?t.content:t.content.map(e=>`<p>${e.text}</p>`).join("\n")).replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");s({title:t.title,body:n})}catch(e){console.error("Error loading article:",e),p("Failed to load article")}finally{c(!1)}})()},[e,l,t]);let b=()=>t?t.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):l?.body||"";return d?(0,n.jsxs)("div",{className:$().loadingContainer,children:[(0,n.jsx)("div",{className:$().loadingIndicator}),(0,n.jsx)("p",{children:"Loading article..."})]}):g?(0,n.jsx)("div",{className:$().errorContainer,children:(0,n.jsx)("p",{className:$().errorMessage,children:g})}):(0,n.jsxs)(h,{articleId:e,children:[(0,n.jsx)(F,{}),(0,n.jsxs)("article",{className:$().articleContainer,children:[(0,n.jsxs)("div",{"data-toggle-bar":"true",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",margin:"1rem 0",padding:"1rem",backgroundImage:r?`linear-gradient(270deg, ${j.Qx[u].gradientStart}, ${j.Qx[u].gradientEnd})`:"linear-gradient(270deg, #9CA3AF, #6B7280)",backgroundSize:"200% 200%",animation:"slideGradient 8s ease infinite alternate",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",fontSize:"0.875rem"},children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,n.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.875rem",opacity:.9},children:r?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.cL,{size:16,color:"#F7FAFC"}),"Atmosphere adapted"]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(m.JD,{size:16,color:"#F7FAFC"}),"Sign in for enhanced features"]})}),r&&(0,n.jsxs)("span",{style:{color:"#F7FAFC",fontWeight:"600",fontSize:"0.875rem"},children:[(0,n.jsx)(m.gI,{size:16,color:"#F7FAFC"}),"Enhanced features active"]})]}),(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,n.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Mood Background"}),(0,n.jsx)(_,{style:{padding:"0.4rem 0.8rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),(0,n.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Interactive Reflections"}),(0,n.jsx)(k,{style:{padding:"0.4rem 0.8rem",border:"none",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})]}),(0,n.jsxs)(S,{articleId:e,articleTitle:i,articleSlug:a,onShare:t=>{if(navigator.share)navigator.share({title:l?.title||"Shared highlight",text:`"${t}" - from article ${e}`,url:window.location.href}).catch(e=>console.error("Error sharing:",e));else{let r=`"${t}" - from article ${e} ${window.location.href}`;navigator.clipboard.writeText(r).then(()=>alert("Highlight copied to clipboard!")).catch(e=>console.error("Error copying to clipboard:",e))}},children:[(0,n.jsx)("div",{className:$().articleContent,children:(0,n.jsx)("div",{ref:f,dangerouslySetInnerHTML:{__html:b()}})}),(0,n.jsx)(v,{articleId:e})]})]})]})}},32031:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a,metadata:()=>o,viewport:()=>i});var n=r(37413);let o={title:"Articles | Journalite",description:"Explore the latest articles from Journalite"},i={width:"device-width",initialScale:1,maximumScale:1};function a({children:e}){return(0,n.jsx)(n.Fragment,{children:e})}},34738:e=>{e.exports={articleContainer:"ArticleWithHighlights_articleContainer__r1hgP",articleContent:"ArticleWithHighlights_articleContent__qrFhS",loadingContainer:"ArticleWithHighlights_loadingContainer__6cqbO",loadingIndicator:"ArticleWithHighlights_loadingIndicator__ymNyj",spin:"ArticleWithHighlights_spin__Olepl",errorContainer:"ArticleWithHighlights_errorContainer__njqpS",errorMessage:"ArticleWithHighlights_errorMessage__D4C7O"}},36012:e=>{e.exports={articlePageContainer:"ArticlePage_articlePageContainer__S9vO3",pageHeader:"ArticlePage_pageHeader__LpJc9",headerContainer:"ArticlePage_headerContainer__2_FTv",logoLink:"ArticlePage_logoLink__fMNNv",headerLogo:"ArticlePage_headerLogo__QZCOB",headerActions:"ArticlePage_headerActions__gK7Eo",profileMenu:"ArticlePage_profileMenu__LJeQ0",profileCircle:"ArticlePage_profileCircle__mpTwC",profileDropdown:"ArticlePage_profileDropdown__PnV9R",dropdownItem:"ArticlePage_dropdownItem__Lac2v",authButtons:"ArticlePage_authButtons__R_ANg",loginButton:"ArticlePage_loginButton__kpUQh",signupButton:"ArticlePage_signupButton__EvVWG",pageContainer:"ArticlePage_pageContainer__7QNUg",relatedTagsSection:"ArticlePage_relatedTagsSection__SvZ8y",relatedTagsHeading:"ArticlePage_relatedTagsHeading__Ys9Op",relatedTagsList:"ArticlePage_relatedTagsList__Xn3ds",relatedTag:"ArticlePage_relatedTag__DEwLe",writeButton:"ArticlePage_writeButton__yZp3x",articleHeader:"ArticlePage_articleHeader__LJolV",articleTitle:"ArticlePage_articleTitle__euOmw",articleMeta:"ArticlePage_articleMeta__LXXWl",authorInfo:"ArticlePage_authorInfo__nnMSs",authorAvatar:"ArticlePage_authorAvatar__1S1bM",authorDetails:"ArticlePage_authorDetails__65w4B",authorNameLink:"ArticlePage_authorNameLink__c6fCN",authorName:"ArticlePage_authorName__o2DdL",articleDetails:"ArticlePage_articleDetails__mK6k_",articleActions:"ArticlePage_articleActions__IZLcw",editButton:"ArticlePage_editButton__Yl62q",tagContainer:"ArticlePage_tagContainer__kI5Py",tag:"ArticlePage_tag__F5Z0e",likeButton:"ArticlePage_likeButton__V0q84",liked:"ArticlePage_liked__Mzzkj",likeIcon:"ArticlePage_likeIcon__zOA_O",commentsContainer:"ArticlePage_commentsContainer__rpCTJ",loadingContainer:"ArticlePage_loadingContainer__v7RVf",loadingIndicator:"ArticlePage_loadingIndicator__E2bt3",spin:"ArticlePage_spin__yRZnI",errorContainer:"ArticlePage_errorContainer__pxRgD",errorMessage:"ArticlePage_errorMessage__quACi",editingHeader:"ArticlePage_editingHeader__nzcMi",cancelButton:"ArticlePage_cancelButton__V2ihM"}},62475:(e,t,r)=>{"use strict";r.d(t,{H:()=>i});var n=r(85311),o=r.n(n);function i(e){let t=new(o())().analyze(e),r=e.toLowerCase(),n=["angry","furious","rage","mad","hate","disgusted","outraged","pissed","frustrated","livid","infuriated","enraged","trump","politician","corrupt","stupid","idiot","terrible","awful","worst","disgusting","pathetic"].filter(e=>r.includes(e)).length,i=["happy","joy","excited","amazing","wonderful","fantastic","great","awesome","brilliant","excellent","perfect","beautiful","love","celebrate","triumph","success","victory","delighted","cheerful","blissful"].filter(e=>r.includes(e)).length,a=["calm","peaceful","serene","tranquil","gentle","soothing","quiet","meditation","zen","harmony","balance","nature","garden","sunset","ocean","mindful","breathe","stillness"].filter(e=>r.includes(e)).length,l=["energy","power","strong","dynamic","intense","passionate","vibrant","bold","fierce","electric","explosive","powerful","charged","pumped","motivated","driven"].filter(e=>r.includes(e)).length,s=["sad","depressed","melancholy","grief","sorrow","tragic","heartbreak","crying","tears","lonely","despair","hopeless","miserable","devastated","broken"].filter(e=>r.includes(e)).length;return n>=2||n>=1&&t.score<-2?"angry":i>=2||i>=1&&t.score>3?"joyful":a>=2||a>=1&&t.score>0?"peaceful":l>=2||l>=1&&Math.abs(t.score)>2?"energetic":s>=2||s>=1&&t.score<-1?"sad":t.score>2?"joyful":t.score<-3?"angry":t.score<-1?"sad":"reflective"}},78335:()=>{},80726:(e,t,r)=>{var n={"./en/index":57415};function o(e){return r(i(e))}function i(e){if(!r.o(n,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=80726},89404:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var n=r(60687),o=r(43210),i=r(85814),a=r.n(i),l=r(43649),s=r(84245),d=r(79440),c=r(18314),g=r(41120),p=r(6248),h=r.n(p);let u=({slug:e,articleId:t,isComplex:r,mood:i="reflective",moodFeatureEnabled:p=!1})=>{let[u,m]=(0,o.useState)([]),[x,f]=(0,o.useState)(!0),[b,y]=(0,o.useState)(""),[S,w]=(0,o.useState)(""),[_,v]=(0,o.useState)(!1),[j,k]=(0,o.useState)(!1),[C,$]=(0,o.useState)(null),[A,F]=(0,o.useState)(""),[E,N]=(0,o.useState)(!1),[T,I]=(0,o.useState)({}),[M,B]=(0,o.useState)(!1),[z,R]=(0,o.useState)(!1),[W,L]=(0,o.useState)(t||null),[D,P]=(0,o.useState)({id:"",name:"Reader"});(0,o.useEffect)(()=>{let e=(0,s.onAuthStateChanged)(l.j2,e=>{let t=!!e;B(t),t&&e?P({id:e.uid,name:e.displayName||e.email?.split("@")[0]||"User"}):P({id:"",name:"Reader"})});return()=>e()},[]),(0,o.useEffect)(()=>{if(t)return void L(t);e&&(async()=>{try{let t=await (0,d.l6)(e);t&&t.id&&L(t.id)}catch(e){console.error("Error fetching article:",e),y("Unable to load article details.")}})()},[e,t]),(0,o.useEffect)(()=>{W&&(f(!0),(async()=>{try{let e=await (0,d.fz)(W);setTimeout(()=>{m(e),f(!1)},800)}catch(e){console.error("Error fetching comments:",e),y("Unable to load discussions. Please refresh the page to try again."),f(!1)}})())},[W]);let Q=async e=>{if(e.preventDefault(),S.trim()&&!_&&W){if(!M)return void R(!0);try{v(!0);let e=await (0,d.BC)(W,S);m(t=>[e,...t]),w(""),v(!1),k(!1)}catch(e){console.error("Error adding comment:",e),y("Your response could not be posted. Please try again."),v(!1)}}},O=async e=>{if(A.trim()&&!E&&W){if(!M)return void R(!0);try{N(!0);let t=await (0,d.Oe)(W,e,A);m(r=>r.map(r=>r.commentId===e||r.id===e?{...r,replies:[...r.replies||[],t]}:r)),F(""),$(null),N(!1),I(t=>({...t,[e]:!0}))}catch(e){console.error("Error adding reply:",e),N(!1)}}},H=async e=>{if(!M||!W)return void R(!0);try{let t=await (0,d.tT)(W,e);m(r=>r.map(r=>r.commentId===e||r.id===e?{...r,likes:t.likes}:r))}catch(e){console.error("Error liking comment:",e)}},U=async e=>{if(M&&W)try{await (0,d.Tu)(W,e),m(t=>t.filter(t=>t.commentId!==e&&t.id!==e))}catch(e){console.error("Error deleting comment:",e)}},q=e=>{I(t=>({...t,[e]:!t[e]}))},Y=e=>{if(!e)return"Unknown date";let t=e.toDate?e.toDate():new Date(e),r=Math.floor((new Date().getTime()-t.getTime())/1e3);if(r<60)return"Just now";if(r<3600){let e=Math.floor(r/60);return`${e} ${1===e?"minute":"minutes"} ago`}if(r<86400){let e=Math.floor(r/3600);return`${e} ${1===e?"hour":"hours"} ago`}if(r<604800){let e=Math.floor(r/86400);return`${e} ${1===e?"day":"days"} ago`}try{return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}catch(e){return console.error("Error formatting date:",e),"Unknown date"}},J=(e,t,r=!1)=>{let o=e?.charAt(0).toUpperCase()||"A",i=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444"],a=t?Math.abs(t.charCodeAt(0)%i.length):0,l=i[a];return(0,n.jsx)("div",{className:r?h().replyAvatar:h().commentAvatar,style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:r?"0.9rem":"1.2rem"},children:o})};return(0,n.jsxs)("section",{className:h().commentSection,style:{background:p?`linear-gradient(160deg, 
              rgba(255, 255, 255, 0.1) 0%, 
              ${c.Qx[i].gradientStart}08 30%, 
              ${c.Qx[i].gradientEnd}06 70%, 
              rgba(255, 255, 255, 0.05) 100%)`:"rgba(255, 255, 255, 0.08)",borderRadius:"32px",border:p?`1px solid ${c.Qx[i].gradientStart}12`:"1.5px solid rgba(255, 255, 255, 0.15)",boxShadow:p?`0 8px 32px -8px ${c.Qx[i].gradientStart}08,
             inset 0 1px 0 rgba(255, 255, 255, 0.1)`:`0 8px 32px rgba(0, 0, 0, 0.1),
             inset 0 1px 0 rgba(255, 255, 255, 0.2)`,backdropFilter:"blur(16px) saturate(180%)",WebkitBackdropFilter:"blur(16px) saturate(180%)",transition:"all 0.8s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",padding:"2rem",marginTop:"2rem"},children:[(0,n.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,height:"50%",background:p?`linear-gradient(180deg, 
                rgba(255, 255, 255, 0.2) 0%, 
                ${c.Qx[i].gradientStart}15 50%,
                rgba(255, 255, 255, 0.05) 100%)`:"linear-gradient(180deg, rgba(255, 255, 255, 0.3) 0%, rgba(255, 255, 255, 0.1) 100%)",borderRadius:"32px 32px 0 0",pointerEvents:"none",opacity:.6,zIndex:1}}),p&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",right:"-50%",bottom:"-50%",background:`
                radial-gradient(circle at 30% 20%, ${c.Qx[i].gradientStart}04, transparent 40%), 
                radial-gradient(circle at 70% 80%, ${c.Qx[i].gradientEnd}03, transparent 40%),
                radial-gradient(circle at 20% 70%, ${c.Qx[i].gradientStart}02, transparent 30%)
              `,animation:"moodFloat 20s ease-in-out infinite",pointerEvents:"none",zIndex:0}})}),(0,n.jsxs)("div",{style:{position:"relative",zIndex:2},children:[(0,n.jsxs)("h2",{className:h().commentSectionTitle,style:p?{color:c.Qx[i].accent,fontWeight:"600",marginBottom:"1.5rem",textShadow:`0 0 20px ${c.Qx[i].gradientStart}30, 0 0 40px ${c.Qx[i].gradientStart}15`,transition:"all 0.3s ease"}:{fontWeight:"600",marginBottom:"1.5rem",color:"#333"},children:[(0,n.jsx)(g.Tw,{size:20,color:p?c.Qx[i].accent:"#333"}),"Join the Discussion"]}),b&&(0,n.jsxs)("div",{className:h().commentError,children:[(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,n.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,n.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,n.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),b]}),(0,n.jsx)("form",{className:h().commentForm,onSubmit:Q,children:(0,n.jsx)("div",{className:h().commentInputContainer,style:{background:p?`linear-gradient(135deg, 
                  rgba(255, 255, 255, ${j?"0.15":"0.08"}), 
                  ${c.Qx[i].gradientStart}${j?"12":"06"}, 
                  ${c.Qx[i].gradientEnd}${j?"08":"04"})`:`rgba(255, 255, 255, ${j?"0.12":"0.06"})`,border:p?`1px solid ${c.Qx[i].gradientStart}${j?"25":"15"}`:`1.5px solid rgba(255, 255, 255, ${j?"0.25":"0.15"})`,borderRadius:"24px",boxShadow:p?j?`0 8px 32px -4px ${c.Qx[i].gradientStart}20, 
                     inset 0 1px 0 rgba(255, 255, 255, 0.2)`:`0 4px 16px -4px ${c.Qx[i].gradientStart}10`:j?`0 8px 32px rgba(0, 0, 0, 0.12),
                     inset 0 1px 0 rgba(255, 255, 255, 0.25)`:`0 4px 16px rgba(0, 0, 0, 0.08),
                     inset 0 1px 0 rgba(255, 255, 255, 0.15)`,backdropFilter:"blur(16px) saturate(180%)",WebkitBackdropFilter:"blur(16px) saturate(180%)",transform:j?"translateY(-2px)":"translateY(0)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",padding:"1.5rem"},children:M?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:h().commentAvatar,children:J(D.name,D.id)}),(0,n.jsx)("textarea",{className:h().commentInput,placeholder:"Share your thoughts...",value:S,onChange:e=>w(e.target.value),onFocus:()=>k(!0),onBlur:()=>{S.trim()||k(!1)},style:p?{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"20px",color:"#2d3748",fontSize:"1rem",padding:"1rem",resize:"vertical",minHeight:"120px",backdropFilter:"blur(8px)",transition:"all 0.3s ease"}:{}}),(0,n.jsx)("button",{className:h().commentSubmit,type:"submit",disabled:!S.trim()||_,style:p?{background:`linear-gradient(135deg, 
                    ${c.Qx[i].accent}, 
                    ${c.Qx[i].gradientEnd})`,border:"none",color:"white",borderRadius:"20px",fontWeight:"600",padding:"0.75rem 1.5rem",boxShadow:`0 4px 16px -4px ${c.Qx[i].accent}40`,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)",cursor:"pointer"}:{},onMouseEnter:p?e=>{e.currentTarget.disabled||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow=`0 8px 24px -4px ${c.Qx[i].accent}60`)}:void 0,onMouseLeave:p?e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=`0 4px 16px -4px ${c.Qx[i].accent}40`}:void 0,children:_?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.uQ,{size:16,color:"white"}),"Posting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.qx,{size:16,color:"white"}),"Post"]})})]}):(0,n.jsxs)("div",{className:h().loginPromptContainer,onClick:()=>R(!0),children:[(0,n.jsx)("textarea",{className:h().commentInput,placeholder:"Login to join the discussion...",disabled:!0}),(0,n.jsx)("button",{className:`${h().commentSubmit} ${h().loginButton}`,type:"button",onClick:()=>R(!0),children:"Login to comment"})]})})}),z&&(0,n.jsx)("div",{className:h().loginModalOverlay,onClick:()=>R(!1),children:(0,n.jsxs)("div",{className:h().loginModal,onClick:e=>e.stopPropagation(),children:[(0,n.jsx)("button",{className:h().loginModalClose,onClick:()=>R(!1),children:"\xd7"}),(0,n.jsx)("h3",{className:h().loginModalTitle,children:"Join the conversation"}),(0,n.jsx)("p",{className:h().loginModalText,children:"Sign in to Journalite to share your thoughts and join the discussion."}),(0,n.jsxs)("div",{className:h().loginModalButtons,children:[(0,n.jsx)(a(),{href:"/login",className:`${h().loginModalButton} ${h().primary}`,children:"Log In"}),(0,n.jsx)(a(),{href:"/register",className:`${h().loginModalButton} ${h().secondary}`,children:"Create Account"})]})]})}),x?(0,n.jsxs)("div",{className:h().commentLoading,style:{background:p?`linear-gradient(135deg, 
                  rgba(255, 255, 255, 0.1), 
                  ${c.Qx[i].gradientStart}06)`:"rgba(255, 255, 255, 0.06)",borderRadius:"24px",padding:"2rem",backdropFilter:"blur(12px) saturate(150%)",WebkitBackdropFilter:"blur(12px) saturate(150%)",border:p?`1px solid ${c.Qx[i].gradientStart}10`:"1px solid rgba(255, 255, 255, 0.1)",boxShadow:p?`0 4px 16px rgba(0, 0, 0, 0.06),
                 inset 0 1px 0 rgba(255, 255, 255, 0.1)`:`0 4px 16px rgba(0, 0, 0, 0.08),
                 inset 0 1px 0 rgba(255, 255, 255, 0.15)`,textAlign:"center"},children:[(0,n.jsxs)("p",{style:p?{color:c.Qx[i].accent,fontWeight:"500",marginBottom:"1rem"}:{},children:[(0,n.jsx)(g.uQ,{size:16,color:p?c.Qx[i].accent:"#6b7280"}),"Loading comments..."]}),(0,n.jsxs)("div",{className:h().loadingDots,children:[(0,n.jsx)("div",{className:h().loadingDot,style:p?{background:c.Qx[i].gradientStart}:{}}),(0,n.jsx)("div",{className:h().loadingDot,style:p?{background:c.Qx[i].accent}:{}}),(0,n.jsx)("div",{className:h().loadingDot,style:p?{background:c.Qx[i].gradientEnd}:{}})]})]}):0===u.length?(0,n.jsx)("div",{className:h().noComments,style:{background:p?`linear-gradient(135deg, 
                  rgba(255, 255, 255, 0.15) 0%, 
                  ${c.Qx[i].gradientStart}08 50%, 
                  ${c.Qx[i].gradientEnd}06 100%)`:"rgba(255, 255, 255, 0.08)",border:p?`1px solid ${c.Qx[i].gradientStart}12`:"1px solid rgba(255, 255, 255, 0.12)",borderRadius:"24px",boxShadow:p?`0 6px 24px -8px ${c.Qx[i].gradientStart}10,
                 inset 0 1px 0 rgba(255, 255, 255, 0.12)`:`0 6px 24px rgba(0, 0, 0, 0.06),
                 inset 0 1px 0 rgba(255, 255, 255, 0.18)`,backdropFilter:"blur(12px) saturate(150%)",WebkitBackdropFilter:"blur(12px) saturate(150%)",color:p?c.Qx[i].accent:"#6b7280",fontWeight:"500",padding:"2rem",textAlign:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:"Be the first to share your thoughts on this article."}):(0,n.jsx)("div",{className:h().commentsList,children:u.map(e=>{let t=e.commentId||e.id||"";return(0,n.jsxs)("div",{className:h().commentItem,style:{background:p?`linear-gradient(135deg, 
                        rgba(255, 255, 255, 0.12) 0%, 
                        ${c.Qx[i].gradientStart}06 50%, 
                        ${c.Qx[i].gradientEnd}04 100%)`:"rgba(255, 255, 255, 0.06)",border:p?`1px solid ${c.Qx[i].gradientStart}10`:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"24px",boxShadow:p?`0 4px 20px -6px ${c.Qx[i].gradientStart}08,
                       inset 0 1px 0 rgba(255, 255, 255, 0.1)`:`0 6px 24px rgba(0, 0, 0, 0.08),
                       inset 0 1px 0 rgba(255, 255, 255, 0.15)`,backdropFilter:"blur(12px) saturate(150%)",WebkitBackdropFilter:"blur(12px) saturate(150%)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",marginBottom:"1.5rem"},onMouseEnter:p?e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow=`
                    0 8px 28px -6px ${c.Qx[i].gradientStart}12,
                    inset 0 1px 0 rgba(255, 255, 255, 0.15)
                  `}:void 0,onMouseLeave:p?e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow=`
                    0 4px 20px -6px ${c.Qx[i].gradientStart}08,
                    inset 0 1px 0 rgba(255, 255, 255, 0.1)
                  `}:void 0,children:[(0,n.jsxs)("div",{className:h().commentHeader,children:[J(e.userName,e.userId),(0,n.jsx)("span",{className:h().commentUser,children:e.userName}),(0,n.jsx)("span",{className:h().commentDate,children:Y(e.createdAt)})]}),(0,n.jsx)("div",{className:h().commentContent,children:e.content}),(0,n.jsxs)("div",{className:h().commentActions,children:[(0,n.jsxs)("button",{className:`${h().commentLikeBtn} ${e.likes.includes(D.id)?h().liked:""}`,onClick:()=>H(t),"aria-pressed":e.likes.includes(D.id),"aria-label":e.likes.includes(D.id)?"Unlike comment":"Like comment",children:[e.likes.includes(D.id)?(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),(0,n.jsx)("span",{children:e.likes.length>0?e.likes.length:""})]}),(0,n.jsxs)("button",{className:h().replyToggle,onClick:()=>{M?$(C===t?null:t):R(!0)},"aria-label":"Reply to comment",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})}),(0,n.jsx)("span",{children:"Reply"})]}),e.userId===D.id&&(0,n.jsxs)("button",{className:h().commentDeleteBtn,onClick:()=>U(t),"aria-label":"Delete comment",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,n.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),(0,n.jsx)("span",{children:"Delete"})]})]}),e.replies&&e.replies.length>0&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("button",{className:h().repliesToggle,onClick:()=>q(t),children:[(0,n.jsx)("span",{className:`${h().repliesToggleIcon} ${T[t]?h().open:""}`,children:"▷"}),`${e.replies.length} ${1===e.replies.length?"reply":"replies"}`]}),T[t]&&(0,n.jsx)("div",{className:h().replySection,children:e.replies.map(e=>(0,n.jsxs)("div",{className:h().replyItem,style:p?{background:`linear-gradient(135deg, 
                                rgba(255, 255, 255, 0.08) 0%, 
                                ${c.Qx[i].gradientStart}04 50%, 
                                ${c.Qx[i].gradientEnd}03 100%)`,border:`1px solid ${c.Qx[i].gradientStart}08`,borderRadius:"20px",boxShadow:`
                                0 2px 12px -4px ${c.Qx[i].gradientStart}06,
                                inset 0 1px 0 rgba(255, 255, 255, 0.08)
                              `,backdropFilter:"blur(8px)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",margin:"0.75rem 0",padding:"1rem"}:{},onMouseEnter:p?e=>{e.currentTarget.style.transform="translateX(4px)",e.currentTarget.style.boxShadow=`
                                0 4px 16px -4px ${c.Qx[i].gradientStart}10,
                                inset 0 1px 0 rgba(255, 255, 255, 0.12)
                              `}:void 0,onMouseLeave:p?e=>{e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow=`
                                0 2px 12px -4px ${c.Qx[i].gradientStart}06,
                                inset 0 1px 0 rgba(255, 255, 255, 0.08)
                              `}:void 0,children:[(0,n.jsxs)("div",{className:h().replyHeader,children:[J(e.userName,e.userId,!0),(0,n.jsx)("span",{className:h().replyUser,children:e.userName}),(0,n.jsx)("span",{className:h().replyDate,children:Y(e.createdAt)})]}),(0,n.jsx)("div",{className:h().replyContent,children:e.content})]},e.replyId))})]}),C===t&&(0,n.jsxs)("div",{className:`${h().replyForm} ${e.replies&&e.replies.length>0?h().inThread:""}`,style:p?{background:`linear-gradient(135deg, 
                        rgba(255, 255, 255, 0.1) 0%, 
                        ${c.Qx[i].gradientStart}06 50%, 
                        ${c.Qx[i].gradientEnd}04 100%)`,border:`1px solid ${c.Qx[i].gradientStart}12`,borderRadius:"20px",boxShadow:`0 3px 16px -4px ${c.Qx[i].gradientStart}08`,backdropFilter:"blur(10px)",padding:"1.5rem",margin:"1rem 0"}:{},children:[(0,n.jsx)("textarea",{className:h().replyInput,placeholder:"Write a reply...",value:A,onChange:e=>F(e.target.value),style:p?{background:"rgba(255, 255, 255, 0.08)",border:`1px solid ${c.Qx[i].gradientStart}10`,borderRadius:"16px",backdropFilter:"blur(6px)",color:"#2d3748",padding:"1rem",fontSize:"0.95rem"}:{}}),(0,n.jsxs)("div",{className:h().replyButtons,children:[(0,n.jsx)("button",{className:h().replyCancel,onClick:()=>{$(null),F("")},style:p?{background:"rgba(255, 255, 255, 0.1)",border:`1px solid ${c.Qx[i].gradientStart}15`,borderRadius:"12px",color:c.Qx[i].accent,padding:"0.5rem 1rem",transition:"all 0.3s ease"}:{},children:"Cancel"}),(0,n.jsx)("button",{className:h().replySubmit,disabled:!A.trim()||E,onClick:()=>O(t),style:p?{background:`linear-gradient(135deg, 
                            ${c.Qx[i].accent}, 
                            ${c.Qx[i].gradientEnd})`,border:"none",borderRadius:"12px",color:"white",fontWeight:"600",padding:"0.5rem 1rem",boxShadow:`0 2px 8px -2px ${c.Qx[i].accent}40`,transition:"all 0.3s ease"}:{},children:E?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.uQ,{size:14,color:"white"}),"Posting..."]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(g.qx,{size:14,color:"white"}),"Post Reply"]})})]})]})]},t)})})]})]})}},96487:()=>{}};