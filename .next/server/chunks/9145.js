exports.id=9145,exports.ids=[9145],exports.modules={10129:e=>{e.exports={activeReadersContainer:"ActiveReaders_activeReadersContainer__kzDyK",avatarStack:"ActiveReaders_avatarStack__C0oAd",avatar:"ActiveReaders_avatar__dmRJ6",readingIndicator:"ActiveReaders_readingIndicator__aAJCN",pulse:"ActiveReaders_pulse__xIR81",tooltip:"ActiveReaders_tooltip__hAqNr",avatarAppear:"ActiveReaders_avatarAppear__UbwiK",slideIn:"ActiveReaders_slideIn__40eQ_"}},20365:(e,t,a)=>{"use strict";a.d(t,{$i:()=>u,FA:()=>d,KB:()=>v,SR:()=>h,_z:()=>m,iS:()=>f,zS:()=>p});var s=a(75535),r=a(43649),i=a(49048);let n=new Map,o=new Map;async function l(e){let t=n.get(e),a=Date.now();if(t&&a-t.timestamp<3e5)return t.profile;let s=await (0,i.VM)(e);return s&&n.set(e,{profile:s,timestamp:a}),s}async function c(e,t){let a=`${e}-${t}`,s=o.get(a),r=Date.now();if(s&&r-s.timestamp<3e4)return s.count;let i=await g(e,t);return o.set(a,{count:i,timestamp:r}),i}async function d(e,t){if(!e||!t)throw Error("Both user IDs are required");if(e===t)throw Error("Cannot create conversation with yourself");try{let a=(0,s.collection)(r.db,"conversations"),i=(0,s.query)(a,(0,s.where)("participants","array-contains",e));for(let e of(await (0,s.getDocs)(i)).docs)if(e.data().participants.includes(t))return e.id;let n={participants:[e,t].sort(),lastMessage:{content:"",senderId:"",timestamp:(0,s.serverTimestamp)(),read:!1},createdAt:(0,s.serverTimestamp)(),updatedAt:(0,s.serverTimestamp)()};return(await (0,s.addDoc)(a,n)).id}catch(e){throw console.error("Error getting or creating conversation:",e),e}}async function m(e,t,a,i="text"){let n=r.j2.currentUser;if(!n)throw Error("User must be authenticated to send messages");if(!a.trim())throw Error("Message content cannot be empty");try{let l=(0,s.collection)(r.db,"messages"),c={conversationId:e,senderId:n.uid,receiverId:t,content:a.trim(),type:i,timestamp:(0,s.serverTimestamp)(),read:!1},d=await (0,s.addDoc)(l,c),m=(0,s.doc)(r.db,"conversations",e);await (0,s.updateDoc)(m,{lastMessage:{content:a.trim(),senderId:n.uid,timestamp:(0,s.serverTimestamp)(),read:!1},updatedAt:(0,s.serverTimestamp)()});let u=`${e}-${t}`;return o.delete(u),d.id}catch(e){throw console.error("Error sending message:",e),e}}async function u(e,t,a){let i=r.j2.currentUser;if(!i)throw Error("User must be authenticated to send messages");if(!a.uid||!a.username)throw Error("Profile data must include uid and username");try{let n=(0,s.collection)(r.db,"messages"),l={conversationId:e,senderId:i.uid,receiverId:t,content:`Shared ${a.firstName} ${a.lastName}'s profile`,type:"profile",timestamp:(0,s.serverTimestamp)(),read:!1,profileAttachment:a},c=await (0,s.addDoc)(n,l),d=(0,s.doc)(r.db,"conversations",e);await (0,s.updateDoc)(d,{lastMessage:{content:`Shared ${a.firstName} ${a.lastName}'s profile`,senderId:i.uid,timestamp:(0,s.serverTimestamp)(),read:!1},updatedAt:(0,s.serverTimestamp)()});let m=`${e}-${t}`;return o.delete(m),c.id}catch(e){throw console.error("Error sending profile message:",e),e}}function h(e,t,a=50){try{let i=(0,s.collection)(r.db,"messages"),n=(0,s.query)(i,(0,s.where)("conversationId","==",e),(0,s.orderBy)("timestamp","desc"),(0,s.limit)(a));return(0,s.onSnapshot)(n,e=>{let a=[];e.forEach(e=>{a.push({id:e.id,...e.data()})}),t(a.reverse())})}catch(e){throw console.error("Error subscribing to messages:",e),e}}function v(e,t){try{let a=(0,s.collection)(r.db,"conversations"),i=(0,s.query)(a,(0,s.where)("participants","array-contains",e),(0,s.orderBy)("updatedAt","desc"));return(0,s.onSnapshot)(i,async a=>{let s=[],r=new Map;for(let t of a.docs){let a=({id:t.id,...t.data()}).participants.find(t=>t!==e);a&&!r.has(a)&&r.set(a,l(a))}let i=new Map;for(let[e,t]of r)try{let a=await t;a&&i.set(e,a)}catch(t){console.error(`Error fetching profile for user ${e}:`,t)}for(let t of a.docs){let a={id:t.id,...t.data()},r=a.participants.find(t=>t!==e);if(!r)continue;let n=i.get(r);if(!n)continue;let o=await c(a.id,e);s.push({conversation:a,otherUser:{uid:n.uid,username:n.username,firstName:n.firstName,lastName:n.lastName},unreadCount:o})}t(s)})}catch(e){throw console.error("Error subscribing to conversations:",e),e}}async function f(e,t){try{let a=(0,s.collection)(r.db,"messages"),i=(0,s.query)(a,(0,s.where)("conversationId","==",e),(0,s.where)("receiverId","==",t),(0,s.where)("read","==",!1)),n=(await (0,s.getDocs)(i)).docs.map(e=>(0,s.updateDoc)(e.ref,{read:!0}));await Promise.all(n);let l=`${e}-${t}`;o.delete(l)}catch(e){throw console.error("Error marking messages as read:",e),e}}async function g(e,t){try{let a=(0,s.collection)(r.db,"messages"),i=(0,s.query)(a,(0,s.where)("conversationId","==",e),(0,s.where)("receiverId","==",t),(0,s.where)("read","==",!1));return(await (0,s.getDocs)(i)).size}catch(e){return console.error("Error getting unread message count:",e),0}}async function p(e){try{let t=(0,s.collection)(r.db,"messages"),a=(0,s.query)(t,(0,s.where)("receiverId","==",e),(0,s.where)("read","==",!1));return(await (0,s.getDocs)(a)).size}catch(e){return console.error("Error getting total unread count:",e),0}}},28250:e=>{e.exports={container:"MinimalNotificationBell_container__NGUf_",button:"MinimalNotificationBell_button__MAJkt",icon:"MinimalNotificationBell_icon__c6pW9",badge:"MinimalNotificationBell_badge___Di_K",dropdown:"MinimalNotificationBell_dropdown__PJtYq",header:"MinimalNotificationBell_header__zCiQJ",viewAll:"MinimalNotificationBell_viewAll__ZLWoU",list:"MinimalNotificationBell_list__MmsKd",item:"MinimalNotificationBell_item__flonv",unread:"MinimalNotificationBell_unread__278b3",content:"MinimalNotificationBell_content__31WKK",message:"MinimalNotificationBell_message__fnAua",time:"MinimalNotificationBell_time___76Fq",dot:"MinimalNotificationBell_dot__R2YqN",empty:"MinimalNotificationBell_empty__kDVAL",footer:"MinimalNotificationBell_footer__Pslwe",seeMore:"MinimalNotificationBell_seeMore__ggGUA"}},28914:(e,t,a)=>{"use strict";a.d(t,{A:()=>f});var s=a(60687),r=a(43210),i=a(43649),n=a(75535),o=a(49048);class l{constructor(){this.presenceRefs=new Map,this.heartbeatIntervals=new Map,this.cleanupInterval=null,this.isDestroyed=!1,this.cleanupInterval=setInterval(()=>{this.isDestroyed||this.cleanupStalePresence()},6e4)}async startPresence(e){if(this.isDestroyed)return;let t=i.j2.currentUser;if(t)try{let a=await (0,o.VM)(t.uid);if(!a)return;let s=(0,n.doc)(i.db,"articlePresence",`${e}_${t.uid}`);await (0,n.setDoc)(s,{uid:t.uid,username:a.username,firstName:a.firstName,lastName:a.lastName,lastSeen:(0,n.serverTimestamp)(),articleId:e});let r=setInterval(async()=>{if(i.j2.currentUser&&!document.hidden&&!this.isDestroyed)try{await (0,n.setDoc)(s,{uid:t.uid,username:a.username,firstName:a.firstName,lastName:a.lastName,lastSeen:(0,n.serverTimestamp)(),articleId:e})}catch(t){clearInterval(r),this.heartbeatIntervals.delete(e)}},3e4);this.heartbeatIntervals.set(e,r);let l=()=>{this.stopPresence(e)},c=()=>{document.hidden&&setTimeout(()=>{document.hidden&&!this.isDestroyed&&this.stopPresence(e)},6e4)};window.addEventListener("beforeunload",l),window.addEventListener("pagehide",l),document.addEventListener("visibilitychange",c);let d=i.j2.onAuthStateChanged(t=>{t||this.isDestroyed||this.stopPresence(e)});this.presenceRefs.set(e,()=>{window.removeEventListener("beforeunload",l),window.removeEventListener("pagehide",l),document.removeEventListener("visibilitychange",c),d()})}catch(e){}}async stopPresence(e){let t=i.j2.currentUser;if(t)try{let a=this.heartbeatIntervals.get(e);a&&(clearInterval(a),this.heartbeatIntervals.delete(e));let s=(0,n.doc)(i.db,"articlePresence",`${e}_${t.uid}`);await (0,n.deleteDoc)(s);let r=this.presenceRefs.get(e);r&&(window.removeEventListener("beforeunload",r),this.presenceRefs.delete(e))}catch(e){}}subscribeToActiveUsers(e,t){let a=new Date(Date.now()-45e3),s=(0,n.query)((0,n.collection)(i.db,"articlePresence"),(0,n.where)("articleId","==",e),(0,n.where)("lastSeen",">",n.Timestamp.fromDate(a)),(0,n.orderBy)("lastSeen","desc"),(0,n.limit)(10));return(0,n.onSnapshot)(s,async e=>{try{let a=[];for(let t of e.docs){let e=t.data();if(!i.j2.currentUser||e.uid!==i.j2.currentUser.uid)try{let t=await (0,o.VM)(e.uid);a.push({...e,profile:t||void 0})}catch(t){a.push({...e,profile:void 0})}}t(a)}catch(e){t([])}},e=>{t([])})}async cleanupStalePresence(){try{let e=new Date(Date.now()-6e4),t=(0,n.query)((0,n.collection)(i.db,"articlePresence"),(0,n.where)("lastSeen","<",n.Timestamp.fromDate(e))),a=(await (0,n.getDocs)(t)).docs.map(e=>(0,n.deleteDoc)(e.ref));a.length>0&&await Promise.all(a)}catch(e){}}cleanup(){this.cleanupInterval&&(clearInterval(this.cleanupInterval),this.cleanupInterval=null),this.heartbeatIntervals.forEach(e=>{clearInterval(e)}),this.heartbeatIntervals.clear(),this.presenceRefs.forEach(e=>{e()}),this.presenceRefs.clear(),this.isDestroyed=!0}}let c=new l;var d=a(10129),m=a.n(d);let u=e=>e.profile?.firstName&&e.profile?.lastName?`${e.profile.firstName[0]}${e.profile.lastName[0]}`.toUpperCase():e.firstName&&e.lastName?`${e.firstName[0]}${e.lastName[0]}`.toUpperCase():e.username?e.username.slice(0,2).toUpperCase():"?",h=e=>e.profile?.firstName&&e.profile?.lastName?`${e.profile.firstName} ${e.profile.lastName}`:e.firstName&&e.lastName?`${e.firstName} ${e.lastName}`:e.username||"Anonymous",v=e=>{let t=["#FF6B6B","#4ECDC4","#45B7D1","#96CEB4","#FECA57","#FF9FF3","#A8E6CF","#FFD93D"];return t[e%t.length]},f=({articleId:e})=>{let[t,a]=(0,r.useState)([]),[n,o]=(0,r.useState)(!1),[l,d]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{d(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{if(!e||!l)return;c.startPresence(e);let t=c.subscribeToActiveUsers(e,e=>{let t=e.slice(0,5);a(t),o(t.length>0)});return()=>{t(),c.stopPresence(e)}},[e,l]),l&&n&&0!==t.length)?(0,s.jsxs)("div",{className:m().activeReadersContainer,children:[(0,s.jsxs)("div",{className:m().avatarStack,children:[t.map((e,t)=>(0,s.jsx)("div",{className:m().avatar,style:{backgroundColor:v(t),zIndex:5-t,left:`${20*t}px`},title:h(e),children:u(e)},e.uid)),t.length>0&&(0,s.jsx)("div",{className:m().readingIndicator,style:{left:`${(t.length-1)*20+24}px`},children:(0,s.jsx)("div",{className:m().pulse})})]}),(0,s.jsx)("div",{className:m().tooltip,children:1===t.length?(0,s.jsxs)("span",{children:[h(t[0])," is reading this"]}):(0,s.jsxs)("span",{children:[t.length," people are reading this"]})})]}):null}},45e3:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var s=a(60687);a(43210);var r=a(85814),i=a.n(r),n=a(16189),o=a(5062),l=a.n(o);let c=({isAuthenticated:e})=>{let t=(0,n.usePathname)();return(0,s.jsx)("nav",{className:l()["bottom-navigation"],children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{href:"/",className:`${l()["bottom-nav-item"]} ${"/"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 0 0 1 1h3m10-11 2 2m-2-2v10a1 1 0 0 1-1 1h-3m-6 0a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1m-6 0h6'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Home"})]}),(0,s.jsxs)(i(),{href:"/create-article",className:`${l()["bottom-nav-item"]} ${"/create-article"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/create-article"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Write"})]}),(0,s.jsxs)(i(),{href:"/messages",className:`${l()["bottom-nav-item"]} ${"/messages"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/messages"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Messages"})]}),(0,s.jsxs)(i(),{href:"/explore",className:`${l()["bottom-nav-item"]} ${"/explore"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/explore"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Explore"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{href:"/",className:`${l()["bottom-nav-item"]} ${"/"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m3 12 2-2m0 0 7-7 7 7M5 10v10a1 1 0 0 0 1 1h3m10-11 2 2m-2-2v10a1 1 0 0 1-1 1h-3m-6 0a1 1 0 0 0 1-1v-4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v4a1 1 0 0 0 1 1m-6 0h6'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Home"})]}),(0,s.jsxs)(i(),{href:"/explore",className:`${l()["bottom-nav-item"]} ${"/explore"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/explore"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Explore"})]}),(0,s.jsxs)(i(),{href:"/register",className:`${l()["bottom-nav-item"]} ${"/register"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/register"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M18 7.5v3m0 0v3m0-3h3m-3 0h-3m-2.25-4.125a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0ZM3 19.235v-.11a6.375 6.375 0 0 1 12.75 0v.109A12.318 12.318 0 0 1 9.374 21c-2.331 0-4.512-.645-6.374-1.766Z'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Sign Up"})]}),(0,s.jsxs)(i(),{href:"/login",className:`${l()["bottom-nav-item"]} ${"/login"===t?l().active:""}`,children:[(0,s.jsx)("div",{className:l()["bottom-nav-icon"],style:{backgroundImage:`url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 24 24' stroke='${"/login"===t?"%232563EB":"%236B7280"}'%3E%3Cpath stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15M12 9l-3 3m0 0 3 3m-3-3h12.75'/%3E%3C/svg%3E")`}}),(0,s.jsx)("span",{className:l()["bottom-nav-text"],children:"Login"})]})]})})}},51437:(e,t,a)=>{"use strict";a.d(t,{A:()=>u});var s=a(60687),r=a(43210),i=a(85814),n=a.n(i),o=a(17193),l=a(43649),c=a(20365),d=a(75934),m=a.n(d);let u=()=>{let[e]=(0,o.hD)(l.j2),[t,a]=(0,r.useState)(0),[i,d]=(0,r.useState)(!1),u=(0,r.useRef)(null);return((0,r.useEffect)(()=>{if(!e)return;let t=async()=>{try{let t=await (0,c.zS)(e.uid);a(t)}catch(e){console.error("Error getting message unread count:",e)}};t();let s=(0,c.KB)(e.uid,e=>{a(e.reduce((e,t)=>e+t.unreadCount,0))}),r=setInterval(t,12e4);return()=>{s(),clearInterval(r)}},[e]),(0,r.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),e)?(0,s.jsxs)("div",{className:m().container,ref:u,children:[(0,s.jsx)(n(),{href:"/messages",children:(0,s.jsxs)("button",{className:m().button,onClick:()=>{d(!i)},"aria-label":"Messages",children:[(0,s.jsx)("svg",{className:m().icon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),t>0&&(0,s.jsx)("span",{className:m().badge,children:t})]})}),i&&(0,s.jsxs)("div",{className:m().dropdown,children:[(0,s.jsxs)("div",{className:m().header,children:[(0,s.jsx)("h3",{children:"Messages"}),(0,s.jsx)(n(),{href:"/messages",className:m().viewAll,children:"View All"})]}),(0,s.jsx)("div",{className:m().content,children:0===t?(0,s.jsx)("div",{className:m().empty,children:"No new messages"}):(0,s.jsxs)("div",{className:m().messageInfo,children:[(0,s.jsxs)("p",{className:m().message,children:["You have ",t," unread message",1!==t?"s":""]}),(0,s.jsx)(n(),{href:"/messages",className:m().viewLink,children:"Go to Messages"})]})})]})]}):null}},57129:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var s=a(60687),r=a(98673),i=a(85814),n=a.n(i),o=a(28163),l=a(28250),c=a.n(l);let d=()=>{let[e,t]=(0,r.useState)(0),[a,i]=(0,r.useState)([]),[l,d]=(0,r.useState)(!1),m=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=async()=>{t(await (0,o.Hs)())};e();let a=setInterval(e,6e4);return()=>clearInterval(a)},[]),(0,r.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.useEffect)(()=>{l&&u()},[l]);let u=async()=>{try{let e=await (0,o.Ss)(!1);i(e)}catch(e){console.error("Error fetching notifications:",e)}},h=async e=>{try{!e.read&&e.id&&(await (0,o.bA)(e.id),t(e=>Math.max(e-1,0)),i(t=>t.map(t=>t.id===e.id?{...t,read:!0}:t)))}catch(e){console.error("Error marking notification as read:",e)}},v=e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/6e4);if(a<1)return"Just now";if(a<60)return`${a}m ago`;let s=Math.floor(a/60);if(s<24)return`${s}h ago`;let r=Math.floor(s/24);return r<7?`${r}d ago`:t.toLocaleDateString()},f=e=>"follow"===e.type?e.fromUser?.username?`/user/${e.fromUser.username}`:"/notifications":e.articleSlug?`/articles?slug=${e.articleSlug}`:"/notifications";return(0,s.jsxs)("div",{className:c().container,ref:m,children:[(0,s.jsxs)("button",{className:c().button,onClick:()=>{d(!l)},"aria-label":"Notifications",children:[(0,s.jsxs)("svg",{className:c().icon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,s.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,s.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),e>0&&(0,s.jsx)("span",{className:c().badge,children:e})]}),l&&(0,s.jsxs)("div",{className:c().dropdown,children:[(0,s.jsxs)("div",{className:c().header,children:[(0,s.jsx)("h3",{children:"Notifications"}),a.length>0&&(0,s.jsx)(n(),{href:"/notifications",className:c().viewAll,children:"View All"})]}),(0,s.jsx)("div",{className:c().list,children:0===a.length?(0,s.jsx)("div",{className:c().empty,children:"No notifications yet"}):a.slice(0,5).map(e=>(0,s.jsxs)(n(),{href:f(e),className:`${c().item} ${!e.read?c().unread:""}`,onClick:()=>h(e),children:[(0,s.jsxs)("div",{className:c().content,children:[(0,s.jsx)("p",{className:c().message,children:e.message}),(0,s.jsx)("span",{className:c().time,children:v(e.createdAt)})]}),!e.read&&(0,s.jsx)("div",{className:c().dot})]},e.id))}),a.length>5&&(0,s.jsx)("div",{className:c().footer,children:(0,s.jsx)(n(),{href:"/notifications",className:c().seeMore,children:"See more notifications"})})]})]})}},75934:e=>{e.exports={container:"MessageNotificationBell_container__5aDLA",button:"MessageNotificationBell_button__csZH1",icon:"MessageNotificationBell_icon__jDLI1",badge:"MessageNotificationBell_badge__XBtr6",dropdown:"MessageNotificationBell_dropdown__FrQoZ",header:"MessageNotificationBell_header__dUyx_",viewAll:"MessageNotificationBell_viewAll__rou73",content:"MessageNotificationBell_content__9BE73",empty:"MessageNotificationBell_empty__5dFf7",messageInfo:"MessageNotificationBell_messageInfo__dDLRK",message:"MessageNotificationBell_message__1p3sE",viewLink:"MessageNotificationBell_viewLink__w6OtV"}},85625:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(60687),r=a(43210),i=a.n(r),n=a(43649);let o=i().memo(({articleId:e,initialLikes:t=[],className:i="",styles:o={}})=>{let[l,c]=(0,r.useState)(t),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(null),[v,f]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=n.j2.onAuthStateChanged(e=>{h(e),e?m(l.includes(e.uid)):m(!1)});return()=>e()},[l]),(0,r.useEffect)(()=>{c(t),u&&m(t.includes(u.uid))},[t,u]);let g=async t=>{if(t.preventDefault(),t.stopPropagation(),console.log("\uD83D\uDC4D LikeButton clicked - should NOT trigger parent re-render"),!u)return void alert("Please login to like articles");f(!0),setTimeout(()=>f(!1),300);try{if(d){let t=l.filter(e=>e!==u.uid);c(t),m(!1),console.log("\uD83D\uDC4D Unlike completed - likes:",t.length);let{doc:s,updateDoc:r,arrayRemove:i}=await Promise.resolve().then(a.bind(a,75535)),{db:n}=await Promise.resolve().then(a.bind(a,43649)),o=s(n,"articles",e);await r(o,{likes:i(u.uid)})}else{let t=[...l,u.uid];c(t),m(!0),console.log("\uD83D\uDC4D Like completed - likes:",t.length);let{doc:s,updateDoc:r,arrayUnion:i}=await Promise.resolve().then(a.bind(a,75535)),{db:n}=await Promise.resolve().then(a.bind(a,43649)),o=s(n,"articles",e);await r(o,{likes:i(u.uid)})}}catch(e){console.error("Error updating like status:",e),d?(c([...l,u.uid]),m(!0)):(c(l.filter(e=>e!==u.uid)),m(!1))}};return(0,s.jsxs)("button",{className:`${i} ${d?o.liked:""}`,onClick:g,"aria-label":d?"Unlike article":"Like article",style:{transition:"all 0.3s ease",transform:v?"scale(1.2)":"scale(1)"},children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:d?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:o.likeIcon,style:{transition:"all 0.3s ease",filter:v?"drop-shadow(0 0 8px currentColor)":"none"},children:(0,s.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,s.jsx)("span",{children:l.length>0?l.length:""})]})})},98673:(e,t,a)=>{"use strict";var s=a(43210);a.o(s,"useEffect")&&a.d(t,{useEffect:function(){return s.useEffect}}),a.o(s,"useRef")&&a.d(t,{useRef:function(){return s.useRef}}),a.o(s,"useState")&&a.d(t,{useState:function(){return s.useState}})}};