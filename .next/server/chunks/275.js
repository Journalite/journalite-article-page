"use strict";exports.id=275,exports.ids=[275],exports.modules={49048:(e,s,a)=>{a.d(s,{Ay:()=>d,Ci:()=>w,E$:()=>x,OQ:()=>i,Qt:()=>f,SR:()=>v,VM:()=>c,Vz:()=>o,e_:()=>u,mH:()=>N,pV:()=>m,x5:()=>h});var r=a(75535),n=a(84245),t=a(43649),l=a(28163);async function i(e){try{let s=(0,r.P)((0,r.rJ)(t.db,"users"),(0,r._M)("username","==",e.toLowerCase()));return!(await (0,r.GG)(s)).empty}catch(e){throw console.error("Error checking username:",e),e}}async function o(e,s){try{let a=await c(e);if(a){console.log("User profile already exists, updating instead of creating");let l=(0,r.H9)(t.db,"users",e);await (0,r.mZ)(l,{firstName:s.firstName,lastName:s.lastName,username:s.username.toLowerCase(),email:s.email.toLowerCase(),bio:s.bio||a.bio||""}),t.j2.currentUser&&await (0,n.r7)(t.j2.currentUser,{displayName:s.username});return}let l=(0,r.P)((0,r.rJ)(t.db,"users"),(0,r._M)("email","==",s.email.toLowerCase()));if(!(await (0,r.GG)(l)).empty)throw Error("Email is already associated with another account");if(await i(s.username))throw Error("Username is already taken");let o=(0,r.H9)(t.db,"users",e);await (0,r.BN)(o,{uid:e,firstName:s.firstName,lastName:s.lastName,username:s.username.toLowerCase(),email:s.email.toLowerCase(),bio:s.bio||"",createdAt:(0,r.O5)()}),t.j2.currentUser&&await (0,n.r7)(t.j2.currentUser,{displayName:s.username})}catch(e){throw console.error("Error creating user profile:",e),e}}async function c(e){try{let s=(0,r.H9)(t.db,"users",e),a=await (0,r.x7)(s);if(a.exists())return a.data();return null}catch(e){throw console.error("Error fetching user profile:",e),e}}async function u(e){if(!e)return null;try{let s=(0,r.P)((0,r.rJ)(t.db,"users"),(0,r._M)("email","==",e.toLowerCase()),(0,r.AB)(1)),a=await (0,r.GG)(s);if(!a.empty)return a.docs[0].data();return null}catch(e){throw console.error("Error fetching user profile by email:",e),e}}async function d(e,s){try{let a=(0,r.H9)(t.db,"users",e);await (0,r.mZ)(a,{interests:s}),console.log(`Interests updated for user ${e}:`,s)}catch(e){throw console.error("Error updating user interests:",e),e}}async function h(e){try{if(!e||e.trim().length<2)return[];let s=e.toLowerCase().trim(),a=(0,r.rJ)(t.db,"users");return(await (0,r.GG)(a)).docs.map(e=>e.data()).filter(e=>{let a=e.username.toLowerCase(),r=e.firstName.toLowerCase(),n=e.lastName.toLowerCase(),t=`${r} ${n}`;return a.includes(s)||r.includes(s)||n.includes(s)||t.includes(s)})}catch(e){return console.error("Error searching users:",e),[]}}async function m(e,s){try{if(e===s)throw Error("You cannot follow yourself");let a=(0,r.H9)(t.db,"users",e);await (0,r.mZ)(a,{following:(0,r.hq)(s),followingCount:(0,r.GV)(1)});let n=(0,r.H9)(t.db,"users",s);await (0,r.mZ)(n,{followers:(0,r.hq)(e),followersCount:(0,r.GV)(1)});let i=await (0,r.x7)(a);if(i.exists()){let a=i.data();await (0,l.N9)(s,`${a.firstName} ${a.lastName}`,e,a.username)}}catch(e){throw console.error("Error following user:",e),e}}async function f(e,s){try{let a=(0,r.H9)(t.db,"users",e);await (0,r.mZ)(a,{following:(0,r.C3)(s),followingCount:(0,r.GV)(-1)});let n=(0,r.H9)(t.db,"users",s);await (0,r.mZ)(n,{followers:(0,r.C3)(e),followersCount:(0,r.GV)(-1)})}catch(e){throw console.error("Error unfollowing user:",e),e}}async function x(e,s){try{let a=(0,r.H9)(t.db,"users",e),n=await (0,r.x7)(a);if(!n.exists())return!1;let l=n.data();return l.following?.includes(s)||!1}catch(e){throw console.error("Error checking follow status:",e),e}}async function N(e,s=50){try{let a=(0,r.H9)(t.db,"users",e),n=await (0,r.x7)(a);if(!n.exists())return[];let l=n.data().following||[];if(0===l.length)return[];let i=[],o=Math.min(l.length,s);for(let e=0;e<o;e++){let s=l[e],a=(0,r.H9)(t.db,"users",s),n=await (0,r.x7)(a);n.exists()&&i.push(n.data())}return i}catch(e){throw console.error("Error getting following list:",e),e}}async function v(e,s=50){try{let a=(0,r.H9)(t.db,"users",e),n=await (0,r.x7)(a);if(!n.exists())return[];let l=n.data().followers||[];if(0===l.length)return[];let i=[],o=Math.min(l.length,s);for(let e=0;e<o;e++){let s=l[e],a=(0,r.H9)(t.db,"users",s),n=await (0,r.x7)(a);n.exists()&&i.push(n.data())}return i}catch(e){throw console.error("Error getting followers list:",e),e}}async function w(e){try{let s=(0,r.H9)(t.db,"users",e);await (0,r.kd)(s),console.log(`User profile for UID ${e} deleted from Firestore.`);let a=t.j2.currentUser;if(a&&a.uid===e)await (0,n.hG)(a),console.log(`User account for UID ${e} deleted from Firebase Authentication.`);else if(a)throw console.error("Current authenticated user does not match UID to be deleted."),Error("Mismatch between authenticated user and account to be deleted.");else throw console.error("No current user authenticated. Cannot delete Firebase Auth user."),Error("Authentication required to delete account.")}catch(e){if(console.error("Error deleting user account:",e),"auth/requires-recent-login"===e.code)throw Error("This operation is sensitive and requires recent authentication. Please sign out and sign back in, then try again.");throw Error("Failed to delete user account. "+e.message)}}},89275:(e,s,a)=>{a.d(s,{A:()=>h});var r=a(60687),n=a(43210),t=a(85814),l=a.n(t),i=a(5062),o=a.n(i),c=a(49048);let u=()=>{let[e,s]=(0,n.useState)(""),[a,t]=(0,n.useState)([]),[i,u]=(0,n.useState)(!1),[d,h]=(0,n.useState)(!1),m=(0,n.useRef)(null),f=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&m.current&&!m.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,n.useEffect)(()=>{let s=setTimeout(async()=>{if(e.trim().length>=2){u(!0);try{let s=await (0,c.x5)(e);t(s),h(!0)}catch(e){console.error("Error searching users:",e)}finally{u(!1)}}else t([]),h(!1)},300);return()=>clearTimeout(s)},[e]),(0,r.jsxs)("div",{className:o().searchContainer,children:[(0,r.jsxs)("div",{className:o().searchInputWrapper,children:[(0,r.jsx)("input",{type:"text",ref:m,className:o().searchInput,placeholder:"Search users by name or username...",value:e,onChange:e=>{s(e.target.value)},onFocus:()=>{e.trim().length>=2&&a.length>0&&h(!0)}}),i&&(0,r.jsx)("div",{className:o().searchLoading,children:"Searching..."})]}),d&&a.length>0&&(0,r.jsx)("div",{ref:f,className:o().searchResults,children:a.map(e=>(0,r.jsxs)(l(),{href:`/user/${encodeURIComponent(e.username.toLowerCase())}`,className:o().searchResultItem,onClick:()=>h(!1),children:[(0,r.jsxs)("div",{className:o().userAvatar,children:[e.firstName.charAt(0),e.lastName.charAt(0)]}),(0,r.jsxs)("div",{className:o().userInfo,children:[(0,r.jsxs)("div",{className:o().userName,children:[e.firstName," ",e.lastName]}),(0,r.jsxs)("div",{className:o().userUsername,children:["@",e.username]})]})]},e.uid))}),d&&e.trim().length>=2&&0===a.length&&(0,r.jsx)("div",{className:o().searchResults,children:(0,r.jsxs)("div",{className:o().noResults,children:['No users found matching "',e,'"']})})]})},d=()=>(0,r.jsx)("div",{className:o().searchBarContainer,children:(0,r.jsx)(u,{})}),h=({isAuthenticated:e,handleLogout:s,toggleSidebar:a,isSidebarCollapsed:n})=>(0,r.jsxs)("aside",{className:`${o()["left-sidebar"]} ${n?o().collapsed:""}`,children:[(0,r.jsxs)("div",{className:o()["sidebar-header"],children:[(0,r.jsx)("div",{className:o().logo,children:"Journalite"}),(0,r.jsx)("button",{className:o()["toggle-button"],onClick:a,"aria-label":n?"Expand sidebar":"Collapse sidebar",children:n?"→":"←"})]}),(0,r.jsx)("div",{className:o().sidebarSearch,children:(0,r.jsx)(d,{})}),(0,r.jsx)("nav",{className:o()["vertical-nav"],children:e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{href:"/",className:`${o()["nav-link"]} ${o()["nav-home"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Home"})]}),(0,r.jsxs)(l(),{href:"/my-thoughts",className:`${o()["nav-link"]} ${o()["nav-thoughts"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"My Thoughts"})]}),(0,r.jsxs)(l(),{href:"/create-article",className:`${o()["nav-link"]} ${o()["nav-create"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Create Article"})]}),(0,r.jsxs)(l(),{href:"/explore",className:`${o()["nav-link"]} ${o()["nav-explore"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Explore"})]}),(0,r.jsxs)(l(),{href:"/my-profile",className:`${o()["nav-link"]} ${o()["nav-profile"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"My Profile"})]}),(0,r.jsxs)(l(),{href:"/settings",className:`${o()["nav-link"]} ${o()["nav-settings"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Settings"})]}),(0,r.jsxs)(l(),{href:"/notifications",className:`${o()["nav-link"]} ${o()["nav-notifications"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Notifications"})]}),(0,r.jsxs)(l(),{href:"https://journalite.app/",className:`${o()["nav-link"]} ${o()["nav-learn-more"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Learn More"})]}),(0,r.jsxs)("button",{onClick:s,className:`${o()["nav-link"]} ${o()["nav-logout"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Log out"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(l(),{href:"/",className:`${o()["nav-link"]} ${o()["nav-home"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Home"})]}),(0,r.jsxs)(l(),{href:"/login",className:`${o()["nav-link"]} ${o()["nav-login"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Login"})]}),(0,r.jsxs)(l(),{href:"https://journalite.app/",className:`${o()["nav-link"]} ${o()["nav-learn-more"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Learn More"})]}),(0,r.jsxs)(l(),{href:"/plans",className:`${o()["nav-link"]} ${o()["nav-plans"]}`,children:[(0,r.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,r.jsx)("span",{className:o()["nav-text"],children:"Plans"})]})]})})]})}};