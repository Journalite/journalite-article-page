exports.id=255,exports.ids=[255],exports.modules={26734:(t,e,r)=>{"use strict";r.d(e,{A:()=>d});var i=r(60687),o=r(43210),a=r(85814),n=r.n(a),s=r(28163),c=r(55801),l=r.n(c);let d=()=>{let[t,e]=(0,o.useState)(0),[r,a]=(0,o.useState)([]),[c,d]=(0,o.useState)(!1),u=(0,o.useRef)(null);(0,o.useEffect)(()=>{let t=async()=>{e(await (0,s.Hs)())};t();let r=setInterval(t,6e4);return()=>clearInterval(r)},[]),(0,o.useEffect)(()=>{let t=t=>{u.current&&!u.current.contains(t.target)&&d(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),(0,o.useEffect)(()=>{c&&f()},[c]);let f=async()=>{try{let t=await (0,s.Ss)(!1);a(t)}catch(t){console.error("Error fetching notifications:",t)}},m=async t=>{try{!t.read&&t.id&&(await (0,s.bA)(t.id),e(t=>Math.max(t-1,0)),a(e=>e.map(e=>e.id===t.id?{...e,read:!0}:e)))}catch(t){console.error("Error marking notification as read:",t)}},h=t=>{if(!t)return"";let e=t.toDate?t.toDate():new Date(t),r=Math.floor((new Date().getTime()-e.getTime())/6e4);if(r<1)return"Just now";if(r<60)return`${r}m ago`;let i=Math.floor(r/60);if(i<24)return`${i}h ago`;let o=Math.floor(i/24);return o<7?`${o}d ago`:e.toLocaleDateString()};return(0,i.jsxs)("div",{className:l().notificationContainer,ref:u,children:[(0,i.jsxs)("button",{className:l().bellButton,onClick:()=>{d(!c)},children:[(0,i.jsx)("span",{className:l().bellIcon,children:"\uD83D\uDD14"}),t>0&&(0,i.jsx)("span",{className:l().unreadBadge,children:t})]}),c&&(0,i.jsxs)("div",{className:l().notificationDropdown,children:[(0,i.jsxs)("div",{className:l().notificationHeader,children:[(0,i.jsx)("h3",{children:"Notifications"}),r.length>0&&(0,i.jsx)(n(),{href:"/notifications",className:l().viewAllLink,children:"View All"})]}),(0,i.jsx)("div",{className:l().notificationList,children:0===r.length?(0,i.jsx)("div",{className:l().emptyState,children:"No notifications yet"}):r.slice(0,5).map(t=>(0,i.jsxs)(n(),{href:`/articles?slug=${t.articleSlug}`,className:`${l().notificationItem} ${!t.read?l().unread:""}`,onClick:()=>m(t),children:[(0,i.jsxs)("div",{className:l().notificationContent,children:[(0,i.jsx)("p",{className:l().notificationMessage,children:t.message}),(0,i.jsx)("span",{className:l().notificationTime,children:h(t.createdAt)})]}),!t.read&&(0,i.jsx)("div",{className:l().unreadDot})]},t.id))}),r.length>5&&(0,i.jsx)("div",{className:l().notificationFooter,children:(0,i.jsx)(n(),{href:"/notifications",className:l().seeMoreLink,children:"See more notifications"})})]})]})}},28163:(t,e,r)=>{"use strict";r.d(e,{Hs:()=>d,Ss:()=>n,bA:()=>s,fP:()=>l,fZ:()=>a,he:()=>c});var i=r(75535),o=r(43649);async function a(t,e,r,a,n,s){try{let e=o.j2.currentUser;if(!e||e.uid===t)return null;let c={userId:t,type:"comment",read:!1,sourceId:n,sourceType:"comment",message:`${e.displayName||"Someone"} commented on your article: "${s.substring(0,50)}${s.length>50?"...":""}"`,fromUser:{id:e.uid,name:e.displayName||"Anonymous"},createdAt:i.Dc.now(),articleSlug:r,articleTitle:a};return{id:(await (0,i.gS)((0,i.rJ)(o.db,"notifications"),c)).id,...c}}catch(t){return console.error("Error creating notification:",t),null}}async function n(t=!1){try{let e,r=o.j2.currentUser;if(!r)throw Error("User not authenticated");let a=(0,i.rJ)(o.db,"notifications");e=t?(0,i.P)(a,(0,i._M)("userId","==",r.uid),(0,i._M)("read","==",!1),(0,i.My)("createdAt","desc"),(0,i.AB)(100)):(0,i.P)(a,(0,i._M)("userId","==",r.uid),(0,i.My)("createdAt","desc"),(0,i.AB)(100));let n=await (0,i.GG)(e),s=[];return n.forEach(t=>{s.push({id:t.id,...t.data()})}),s}catch(t){throw console.error("Error fetching notifications:",t),t}}async function s(t){try{let e=o.j2.currentUser;if(!e)throw Error("User not authenticated");let r=(0,i.H9)(o.db,"notifications",t),a=await (0,i.x7)(r);if(!a.exists())throw Error("Notification not found");if(a.data().userId!==e.uid)throw Error("Unauthorized access to notification");return await (0,i.mZ)(r,{read:!0}),{success:!0}}catch(t){throw console.error("Error marking notification as read:",t),t}}async function c(){try{let t=o.j2.currentUser;if(!t)throw Error("User not authenticated");let e=(0,i.rJ)(o.db,"notifications"),r=(0,i.P)(e,(0,i._M)("userId","==",t.uid),(0,i._M)("read","==",!1)),a=await (0,i.GG)(r),n=a.docs.map(t=>(0,i.mZ)(t.ref,{read:!0}));return await Promise.all(n),{success:!0,count:a.size}}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async function l(t){try{let e=o.j2.currentUser;if(!e)throw Error("User not authenticated");let r=(0,i.H9)(o.db,"notifications",t),a=await (0,i.x7)(r);if(!a.exists())throw Error("Notification not found");if(a.data().userId!==e.uid)throw Error("Unauthorized access to notification");return await (0,i.kd)(r),{success:!0}}catch(t){throw console.error("Error deleting notification:",t),t}}async function d(){try{let t=o.j2.currentUser;if(!t)return 0;let e=(0,i.rJ)(o.db,"notifications"),r=(0,i.P)(e,(0,i._M)("userId","==",t.uid),(0,i._M)("read","==",!1));return(await (0,i.GG)(r)).size}catch(t){return console.error("Error counting unread notifications:",t),0}}},55801:t=>{t.exports={notificationContainer:"NotificationBell_notificationContainer__TFGqP",bellButton:"NotificationBell_bellButton__PKB6r",bellIcon:"NotificationBell_bellIcon__ALAAB",unreadBadge:"NotificationBell_unreadBadge__cOn_b",notificationDropdown:"NotificationBell_notificationDropdown__p8Mv4",notificationHeader:"NotificationBell_notificationHeader__cPSyI",viewAllLink:"NotificationBell_viewAllLink__une1x",notificationList:"NotificationBell_notificationList__SBbvK",notificationItem:"NotificationBell_notificationItem__MW9MC",unread:"NotificationBell_unread__9c4op",notificationContent:"NotificationBell_notificationContent__2upmA",notificationMessage:"NotificationBell_notificationMessage__aqMDB",notificationTime:"NotificationBell_notificationTime__JQ2O9",unreadDot:"NotificationBell_unreadDot__qaEb7",notificationFooter:"NotificationBell_notificationFooter__l28sD",seeMoreLink:"NotificationBell_seeMoreLink__eh2qR",emptyState:"NotificationBell_emptyState___y1V2"}},79440:(t,e,r)=>{"use strict";r.d(e,{BC:()=>f,GE:()=>n,N6:()=>l,Oe:()=>m,Tu:()=>w,a:()=>g,fz:()=>u,iZ:()=>d,l6:()=>c,tT:()=>h,zE:()=>s});var i=r(75535),o=r(43649),a=r(28163);async function n(t=!1){try{let e,r=(0,i.rJ)(o.db,"articles");e=(0,i.P)(r,(0,i.My)("createdAt","desc"));let a=await (0,i.GG)(e),n=[];return a.forEach(e=>{let r=e.data();(t||"drafts"!==r.status)&&(t||void 0===r.status||"published"===r.status)&&n.push({id:e.id,...r})}),n}catch(t){throw console.error("Error getting articles:",t),t}}async function s(t){try{let e=(0,i.H9)(o.db,"articles",t),r=await (0,i.x7)(e);if(r.exists())return{id:r.id,...r.data()};throw Error("Article not found")}catch(t){throw console.error("Error getting article:",t),t}}async function c(t){try{let e=(0,i.rJ)(o.db,"articles"),r=(0,i.P)(e,(0,i._M)("slug","==",t)),a=await (0,i.GG)(r);if(a.empty)throw Error("Article not found");let n=a.docs[0];return{id:n.id,...n.data()}}catch(t){throw console.error("Error getting article by slug:",t),t}}async function l(t){try{let e=o.j2.currentUser;if(!e)throw Error("You must be logged in to create an article");let r={title:t.title,body:t.body,slug:t.slug||t.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"),createdAt:i.Dc.now(),authorId:e.uid,authorName:e.displayName||"Anonymous",tags:t.tags||[],status:t.status||"published"};return t.coverImage&&(r.coverImage=t.coverImage),{id:(await (0,i.gS)((0,i.rJ)(o.db,"articles"),r)).id,...r}}catch(t){throw console.error("Error creating article:",t),t}}async function d(t,e){try{let r=o.j2.currentUser;if(!r)throw Error("You must be logged in to edit an article");let a=(0,i.H9)(o.db,"articles",t),n=await (0,i.x7)(a);if(!n.exists())throw Error("Article not found");if(n.data().authorId!==r.uid)throw Error("You can only edit your own articles");let s={};void 0!==e.title&&(s.title=e.title,void 0===e.slug&&(s.slug=e.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"))),void 0!==e.body&&(s.body=e.body),void 0!==e.tags&&(s.tags=e.tags),void 0!==e.status&&(s.status=e.status),void 0!==e.coverImage&&(s.coverImage=e.coverImage),void 0!==e.slug&&(s.slug=e.slug),await (0,i.mZ)(a,s);let c=await (0,i.x7)(a);return{id:c.id,...c.data()}}catch(t){throw console.error("Error updating article:",t),t}}async function u(t){try{let e=(0,i.rJ)(o.db,"articles",t,"comments"),r=(0,i.P)(e,(0,i.My)("createdAt","desc")),a=await (0,i.GG)(r),n=[];return a.forEach(t=>{let e=t.data();n.push({id:t.id,commentId:t.id,...e,replies:e.replies||[]})}),n}catch(t){throw console.error("Error getting comments:",t),t}}async function f(t,e){try{let r=o.j2.currentUser;if(!r)throw Error("You must be logged in to comment");let n={userId:r.uid,userName:r.displayName||r.email?.split("@")[0]||"Anonymous",content:e,createdAt:i.Dc.now(),likes:[],replies:[]},s=await (0,i.gS)((0,i.rJ)(o.db,"articles",t,"comments"),n),c=(0,i.H9)(o.db,"articles",t),l=await (0,i.x7)(c);if(l.exists()){let r=l.data();await (0,a.fZ)(r.authorId,t,r.slug||"",r.title||"Article",s.id,e)}return{id:s.id,commentId:s.id,...n}}catch(t){throw console.error("Error adding comment:",t),t}}async function m(t,e,r){try{let a=o.j2.currentUser;if(!a)throw Error("You must be logged in to reply");let n=(0,i.H9)(o.db,"articles",t,"comments",e);if(!(await (0,i.x7)(n)).exists())throw Error("Comment not found");let s={replyId:Math.random().toString(36).substring(2,15),userId:a.uid,userName:a.displayName||a.email?.split("@")[0]||"Anonymous",content:r,createdAt:i.Dc.now(),likes:[]};return await (0,i.mZ)(n,{replies:(0,i.hq)(s)}),s}catch(t){throw console.error("Error adding reply:",t),t}}async function h(t,e){try{let r=o.j2.currentUser;if(!r)throw Error("You must be logged in to like a comment");let a=(0,i.H9)(o.db,"articles",t,"comments",e),n=await (0,i.x7)(a);if(!n.exists())throw Error("Comment not found");let s=n.data(),c=r.uid;if((s.likes||[]).includes(c)){await (0,i.mZ)(a,{likes:(0,i.C3)(c)});let t=(await (0,i.x7)(a)).data();return{success:!0,action:"unliked",likes:t.likes,count:t.likes.length}}{await (0,i.mZ)(a,{likes:(0,i.hq)(c)});let t=(await (0,i.x7)(a)).data();return{success:!0,action:"liked",likes:t.likes,count:t.likes.length}}}catch(t){throw console.error("Error liking comment:",t),t}}async function w(t,e){try{let r=o.j2.currentUser;if(!r)throw Error("You must be logged in to delete a comment");let a=(0,i.H9)(o.db,"articles",t,"comments",e),n=await (0,i.x7)(a);if(!n.exists())throw Error("Comment not found");if(n.data().userId!==r.uid)throw Error("You can only delete your own comments");return await (0,i.kd)(a),{success:!0,message:"Comment deleted successfully"}}catch(t){throw console.error("Error deleting comment:",t),t}}async function g(t){try{let e=o.j2.currentUser;if(!e)throw Error("You must be logged in to delete an article");let r=await (0,i.x7)((0,i.H9)(o.db,"articles",t));if(!r.exists())throw Error("Article not found");if(r.data().authorId!==e.uid)throw Error("You can only delete your own articles");return await (0,i.kd)((0,i.H9)(o.db,"articles",t)),{success:!0,message:"Article deleted successfully"}}catch(t){throw console.error("Error deleting article:",t),t}}}};