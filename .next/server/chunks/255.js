exports.id=255,exports.ids=[255],exports.modules={26734:(t,e,i)=>{"use strict";i.d(e,{A:()=>d});var r=i(60687),o=i(43210),a=i(85814),n=i.n(a),s=i(28163),c=i(55801),l=i.n(c);let d=()=>{let[t,e]=(0,o.useState)(0),[i,a]=(0,o.useState)([]),[c,d]=(0,o.useState)(!1),u=(0,o.useRef)(null);(0,o.useEffect)(()=>{let t=async()=>{e(await (0,s.Hs)())};t();let i=setInterval(t,6e4);return()=>clearInterval(i)},[]),(0,o.useEffect)(()=>{let t=t=>{u.current&&!u.current.contains(t.target)&&d(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),(0,o.useEffect)(()=>{c&&f()},[c]);let f=async()=>{try{let t=await (0,s.Ss)(!1);a(t)}catch(t){console.error("Error fetching notifications:",t)}},m=async t=>{try{!t.read&&t.id&&(await (0,s.bA)(t.id),e(t=>Math.max(t-1,0)),a(e=>e.map(e=>e.id===t.id?{...e,read:!0}:e)))}catch(t){console.error("Error marking notification as read:",t)}},h=t=>{if(!t)return"";let e=t.toDate?t.toDate():new Date(t),i=Math.floor((new Date().getTime()-e.getTime())/6e4);if(i<1)return"Just now";if(i<60)return`${i}m ago`;let r=Math.floor(i/60);if(r<24)return`${r}h ago`;let o=Math.floor(r/24);return o<7?`${o}d ago`:e.toLocaleDateString()};return(0,r.jsxs)("div",{className:l().notificationContainer,ref:u,children:[(0,r.jsxs)("button",{className:l().bellButton,onClick:()=>{d(!c)},children:[(0,r.jsx)("span",{className:l().bellIcon,children:"\uD83D\uDD14"}),t>0&&(0,r.jsx)("span",{className:l().unreadBadge,children:t})]}),c&&(0,r.jsxs)("div",{className:l().notificationDropdown,children:[(0,r.jsxs)("div",{className:l().notificationHeader,children:[(0,r.jsx)("h3",{children:"Notifications"}),i.length>0&&(0,r.jsx)(n(),{href:"/notifications",className:l().viewAllLink,children:"View All"})]}),(0,r.jsx)("div",{className:l().notificationList,children:0===i.length?(0,r.jsx)("div",{className:l().emptyState,children:"No notifications yet"}):i.slice(0,5).map(t=>(0,r.jsxs)(n(),{href:`/articles?slug=${t.articleSlug}`,className:`${l().notificationItem} ${!t.read?l().unread:""}`,onClick:()=>m(t),children:[(0,r.jsxs)("div",{className:l().notificationContent,children:[(0,r.jsx)("p",{className:l().notificationMessage,children:t.message}),(0,r.jsx)("span",{className:l().notificationTime,children:h(t.createdAt)})]}),!t.read&&(0,r.jsx)("div",{className:l().unreadDot})]},t.id))}),i.length>5&&(0,r.jsx)("div",{className:l().notificationFooter,children:(0,r.jsx)(n(),{href:"/notifications",className:l().seeMoreLink,children:"See more notifications"})})]})]})}},55801:t=>{t.exports={notificationContainer:"NotificationBell_notificationContainer__TFGqP",bellButton:"NotificationBell_bellButton__PKB6r",bellIcon:"NotificationBell_bellIcon__ALAAB",unreadBadge:"NotificationBell_unreadBadge__cOn_b",notificationDropdown:"NotificationBell_notificationDropdown__p8Mv4",notificationHeader:"NotificationBell_notificationHeader__cPSyI",viewAllLink:"NotificationBell_viewAllLink__une1x",notificationList:"NotificationBell_notificationList__SBbvK",notificationItem:"NotificationBell_notificationItem__MW9MC",unread:"NotificationBell_unread__9c4op",notificationContent:"NotificationBell_notificationContent__2upmA",notificationMessage:"NotificationBell_notificationMessage__aqMDB",notificationTime:"NotificationBell_notificationTime__JQ2O9",unreadDot:"NotificationBell_unreadDot__qaEb7",notificationFooter:"NotificationBell_notificationFooter__l28sD",seeMoreLink:"NotificationBell_seeMoreLink__eh2qR",emptyState:"NotificationBell_emptyState___y1V2"}},79440:(t,e,i)=>{"use strict";i.d(e,{BC:()=>f,GE:()=>n,N6:()=>l,Oe:()=>m,Tu:()=>g,a:()=>w,fz:()=>u,iZ:()=>d,l6:()=>c,tT:()=>h,zE:()=>s});var r=i(75535),o=i(43649),a=i(28163);async function n(t=!1){try{let e,i=(0,r.rJ)(o.db,"articles");e=(0,r.P)(i,(0,r.My)("createdAt","desc"));let a=await (0,r.GG)(e),n=[];return a.forEach(e=>{let i=e.data();(t||"drafts"!==i.status)&&(t||void 0===i.status||"published"===i.status)&&n.push({id:e.id,...i})}),n}catch(t){throw console.error("Error getting articles:",t),t}}async function s(t){try{let e=(0,r.H9)(o.db,"articles",t),i=await (0,r.x7)(e);if(i.exists())return{id:i.id,...i.data()};throw Error("Article not found")}catch(t){throw console.error("Error getting article:",t),t}}async function c(t){try{let e=(0,r.rJ)(o.db,"articles"),i=(0,r.P)(e,(0,r._M)("slug","==",t)),a=await (0,r.GG)(i);if(a.empty)throw Error("Article not found");let n=a.docs[0];return{id:n.id,...n.data()}}catch(t){throw console.error("Error getting article by slug:",t),t}}async function l(t){try{let e=o.j2.currentUser;if(!e)throw Error("You must be logged in to create an article");let i={title:t.title,body:t.body,slug:t.slug||t.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"),createdAt:r.Dc.now(),authorId:e.uid,authorName:e.displayName||"Anonymous",tags:t.tags||[],status:t.status||"published"};return t.coverImage&&(i.coverImage=t.coverImage),{id:(await (0,r.gS)((0,r.rJ)(o.db,"articles"),i)).id,...i}}catch(t){throw console.error("Error creating article:",t),t}}async function d(t,e){try{let i=o.j2.currentUser;if(!i)throw Error("You must be logged in to edit an article");let a=(0,r.H9)(o.db,"articles",t),n=await (0,r.x7)(a);if(!n.exists())throw Error("Article not found");if(n.data().authorId!==i.uid)throw Error("You can only edit your own articles");let s={};void 0!==e.title&&(s.title=e.title,void 0===e.slug&&(s.slug=e.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"))),void 0!==e.body&&(s.body=e.body),void 0!==e.tags&&(s.tags=e.tags),void 0!==e.status&&(s.status=e.status),void 0!==e.coverImage&&(s.coverImage=e.coverImage),void 0!==e.slug&&(s.slug=e.slug),await (0,r.mZ)(a,s);let c=await (0,r.x7)(a);return{id:c.id,...c.data()}}catch(t){throw console.error("Error updating article:",t),t}}async function u(t){try{let e=(0,r.rJ)(o.db,"articles",t,"comments"),i=(0,r.P)(e,(0,r.My)("createdAt","desc")),a=await (0,r.GG)(i),n=[];return a.forEach(t=>{let e=t.data();n.push({id:t.id,commentId:t.id,...e,replies:e.replies||[]})}),n}catch(t){throw console.error("Error getting comments:",t),t}}async function f(t,e){try{let i=o.j2.currentUser;if(!i)throw Error("You must be logged in to comment");let n={userId:i.uid,userName:i.displayName||i.email?.split("@")[0]||"Anonymous",content:e,createdAt:r.Dc.now(),likes:[],replies:[]},s=await (0,r.gS)((0,r.rJ)(o.db,"articles",t,"comments"),n),c=(0,r.H9)(o.db,"articles",t),l=await (0,r.x7)(c);if(l.exists()){let i=l.data();await (0,a.fZ)(i.authorId,t,i.slug||"",i.title||"Article",s.id,e)}return{id:s.id,commentId:s.id,...n}}catch(t){throw console.error("Error adding comment:",t),t}}async function m(t,e,i){try{let a=o.j2.currentUser;if(!a)throw Error("You must be logged in to reply");let n=(0,r.H9)(o.db,"articles",t,"comments",e);if(!(await (0,r.x7)(n)).exists())throw Error("Comment not found");let s={replyId:Math.random().toString(36).substring(2,15),userId:a.uid,userName:a.displayName||a.email?.split("@")[0]||"Anonymous",content:i,createdAt:r.Dc.now(),likes:[]};return await (0,r.mZ)(n,{replies:(0,r.hq)(s)}),s}catch(t){throw console.error("Error adding reply:",t),t}}async function h(t,e){try{let i=o.j2.currentUser;if(!i)throw Error("You must be logged in to like a comment");let a=(0,r.H9)(o.db,"articles",t,"comments",e),n=await (0,r.x7)(a);if(!n.exists())throw Error("Comment not found");let s=n.data(),c=i.uid;if((s.likes||[]).includes(c)){await (0,r.mZ)(a,{likes:(0,r.C3)(c)});let t=(await (0,r.x7)(a)).data();return{success:!0,action:"unliked",likes:t.likes,count:t.likes.length}}{await (0,r.mZ)(a,{likes:(0,r.hq)(c)});let t=(await (0,r.x7)(a)).data();return{success:!0,action:"liked",likes:t.likes,count:t.likes.length}}}catch(t){throw console.error("Error liking comment:",t),t}}async function g(t,e){try{let i=o.j2.currentUser;if(!i)throw Error("You must be logged in to delete a comment");let a=(0,r.H9)(o.db,"articles",t,"comments",e),n=await (0,r.x7)(a);if(!n.exists())throw Error("Comment not found");if(n.data().userId!==i.uid)throw Error("You can only delete your own comments");return await (0,r.kd)(a),{success:!0,message:"Comment deleted successfully"}}catch(t){throw console.error("Error deleting comment:",t),t}}async function w(t){try{let e=o.j2.currentUser;if(!e)throw Error("You must be logged in to delete an article");let i=await (0,r.x7)((0,r.H9)(o.db,"articles",t));if(!i.exists())throw Error("Article not found");if(i.data().authorId!==e.uid)throw Error("You can only delete your own articles");return await (0,r.kd)((0,r.H9)(o.db,"articles",t)),{success:!0,message:"Article deleted successfully"}}catch(t){throw console.error("Error deleting article:",t),t}}}};