{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticlePage.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleActions\": \"ArticlePage-module__RPh7Qa__articleActions\",\n  \"articleDetails\": \"ArticlePage-module__RPh7Qa__articleDetails\",\n  \"articleHeader\": \"ArticlePage-module__RPh7Qa__articleHeader\",\n  \"articleMeta\": \"ArticlePage-module__RPh7Qa__articleMeta\",\n  \"articlePageContainer\": \"ArticlePage-module__RPh7Qa__articlePageContainer\",\n  \"articleTitle\": \"ArticlePage-module__RPh7Qa__articleTitle\",\n  \"authButtons\": \"ArticlePage-module__RPh7Qa__authButtons\",\n  \"authorAvatar\": \"ArticlePage-module__RPh7Qa__authorAvatar\",\n  \"authorDetails\": \"ArticlePage-module__RPh7Qa__authorDetails\",\n  \"authorInfo\": \"ArticlePage-module__RPh7Qa__authorInfo\",\n  \"authorName\": \"ArticlePage-module__RPh7Qa__authorName\",\n  \"authorNameLink\": \"ArticlePage-module__RPh7Qa__authorNameLink\",\n  \"cancelButton\": \"ArticlePage-module__RPh7Qa__cancelButton\",\n  \"commentsContainer\": \"ArticlePage-module__RPh7Qa__commentsContainer\",\n  \"dropdownItem\": \"ArticlePage-module__RPh7Qa__dropdownItem\",\n  \"editButton\": \"ArticlePage-module__RPh7Qa__editButton\",\n  \"editingHeader\": \"ArticlePage-module__RPh7Qa__editingHeader\",\n  \"errorContainer\": \"ArticlePage-module__RPh7Qa__errorContainer\",\n  \"errorMessage\": \"ArticlePage-module__RPh7Qa__errorMessage\",\n  \"headerActions\": \"ArticlePage-module__RPh7Qa__headerActions\",\n  \"headerContainer\": \"ArticlePage-module__RPh7Qa__headerContainer\",\n  \"headerLogo\": \"ArticlePage-module__RPh7Qa__headerLogo\",\n  \"likeButton\": \"ArticlePage-module__RPh7Qa__likeButton\",\n  \"likeIcon\": \"ArticlePage-module__RPh7Qa__likeIcon\",\n  \"liked\": \"ArticlePage-module__RPh7Qa__liked\",\n  \"loadingContainer\": \"ArticlePage-module__RPh7Qa__loadingContainer\",\n  \"loadingIndicator\": \"ArticlePage-module__RPh7Qa__loadingIndicator\",\n  \"loginButton\": \"ArticlePage-module__RPh7Qa__loginButton\",\n  \"logoLink\": \"ArticlePage-module__RPh7Qa__logoLink\",\n  \"pageContainer\": \"ArticlePage-module__RPh7Qa__pageContainer\",\n  \"pageHeader\": \"ArticlePage-module__RPh7Qa__pageHeader\",\n  \"profileCircle\": \"ArticlePage-module__RPh7Qa__profileCircle\",\n  \"profileDropdown\": \"ArticlePage-module__RPh7Qa__profileDropdown\",\n  \"profileMenu\": \"ArticlePage-module__RPh7Qa__profileMenu\",\n  \"relatedTag\": \"ArticlePage-module__RPh7Qa__relatedTag\",\n  \"relatedTagsHeading\": \"ArticlePage-module__RPh7Qa__relatedTagsHeading\",\n  \"relatedTagsList\": \"ArticlePage-module__RPh7Qa__relatedTagsList\",\n  \"relatedTagsSection\": \"ArticlePage-module__RPh7Qa__relatedTagsSection\",\n  \"signupButton\": \"ArticlePage-module__RPh7Qa__signupButton\",\n  \"spin\": \"ArticlePage-module__RPh7Qa__spin\",\n  \"tag\": \"ArticlePage-module__RPh7Qa__tag\",\n  \"tagContainer\": \"ArticlePage-module__RPh7Qa__tagContainer\",\n  \"writeButton\": \"ArticlePage-module__RPh7Qa__writeButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/clientApp.ts"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Firebase configuration from environment variables\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n    measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID\n};\n///\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n// Initialize Analytics only in browser environment\nlet analytics;\nif (typeof window !== 'undefined') {\n    try {\n        analytics = getAnalytics(app);\n    } catch (error) {\n        // Analytics initialization skipped in development\n    }\n}\n\n// Initialize Firebase Authentication\nconst auth = getAuth(app);\n\n// Initialize Firestore\nconst db = getFirestore(app);\n\n// Configure custom auth actions URL\nif (typeof window !== 'undefined') {\n    const actionCodeSettings = {\n        url: `${window.location.origin}/reset-password`,\n        handleCodeInApp: true,\n    };\n\n    // We need to update this in the forgot-password component when sending the reset email\n}\n\n// // Connect to Auth Emulator in development\n// if (process.env.NODE_ENV === 'development') {\n//     // connectAuthEmulator(auth, \"http://localhost:9099\", { disableWarnings: true });\n// }\n\n/////\n\nexport { app, analytics, auth, db };"],"names":[],"mappings":"AAAA,uDAAuD;;;;;;;AACvD;AAAA;AACA;AACA;AAAA;AACA;AAAA;;;;;AACA,4DAA4D;AAC5D,iEAAiE;AAEjE,oDAAoD;AACpD,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACjB;AACA,GAAG;AAEH,sBAAsB;AACtB,MAAM,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;AAE1B,mDAAmD;AACnD,IAAI;AACJ,uCAAmC;;AAMnC;AAEA,qCAAqC;AACrC,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AAErB,uBAAuB;AACvB,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE;AAExB,oCAAoC;AACpC,uCAAmC;;AAM/B,uFAAuF;AAC3F","debugId":null}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/notifications.ts"],"sourcesContent":["import {\n    collection,\n    addDoc,\n    getDocs,\n    getDoc,\n    doc,\n    query,\n    orderBy,\n    Timestamp,\n    where,\n    updateDoc,\n    deleteDoc,\n    limit\n} from 'firebase/firestore';\nimport { db, auth } from './clientApp';\n\n// Notification interface matching Firestore structure\nexport interface Notification {\n    id?: string;\n    userId: string;\n    type: 'comment' | 'reply' | 'like' | 'follow';\n    read: boolean;\n    sourceId: string; // ID of the article/comment\n    sourceType: 'article' | 'comment' | 'user';\n    message: string;\n    fromUser: {\n        id: string;\n        name: string;\n        username?: string; // Add username field for profile links\n    };\n    createdAt: Timestamp;\n    articleSlug?: string; // Optional slug to link directly to the article\n    articleTitle?: string; // Optional article title for context\n}\n\n/**\n * Create a new notification when someone comments on a user's post\n */\nexport async function createCommentNotification(\n    ownerId: string,\n    articleId: string,\n    articleSlug: string,\n    articleTitle: string,\n    commentId: string,\n    commentText: string\n) {\n    try {\n        // Skip if the owner is the commenter (don't notify yourself)\n        const currentUser = auth.currentUser;\n        if (!currentUser || currentUser.uid === ownerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: ownerId, // Who will receive the notification\n            type: 'comment',\n            read: false,\n            sourceId: commentId,\n            sourceType: 'comment',\n            message: `${currentUser.displayName || 'Someone'} commented on your article: \"${commentText.substring(0, 50)}${commentText.length > 50 ? '...' : ''}\"`,\n            fromUser: {\n                id: currentUser.uid,\n                name: currentUser.displayName || 'Anonymous'\n            },\n            createdAt: Timestamp.now(),\n            articleSlug,\n            articleTitle\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating notification:', error);\n        return null;\n    }\n}\n\n/**\n * Create a new notification when someone follows a user\n */\nexport async function createFollowNotification(\n    targetUserId: string,\n    followerName: string,\n    followerId: string,\n    followerUsername: string\n) {\n    try {\n        // Skip if user is following themselves (shouldn't happen due to checks in followUser)\n        if (targetUserId === followerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: targetUserId, // Who will receive the notification\n            type: 'follow',\n            read: false,\n            sourceId: followerId,\n            sourceType: 'user',\n            message: `${followerName} (@${followerUsername}) started following you`,\n            fromUser: {\n                id: followerId,\n                name: followerName,\n                username: followerUsername\n            },\n            createdAt: Timestamp.now()\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating follow notification:', error);\n        return null;\n    }\n}\n\n/**\n * Get all notifications for the current user\n */\nexport async function getUserNotifications(unreadOnly = false) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        // Create base query\n        const notificationsRef = collection(db, 'notifications');\n        let q;\n\n        if (unreadOnly) {\n            // Only fetch unread notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                where('read', '==', false),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        } else {\n            // Fetch all notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n\n        const notifications: Notification[] = [];\n        querySnapshot.forEach((doc) => {\n            notifications.push({\n                id: doc.id,\n                ...doc.data() as Omit<Notification, 'id'>\n            });\n        });\n\n        return notifications;\n    } catch (error) {\n        console.error('Error fetching notifications:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark a notification as read\n */\nexport async function markNotificationAsRead(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Update the read status\n        await updateDoc(notificationRef, {\n            read: true\n        });\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error marking notification as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark all notifications as read for the current user\n */\nexport async function markAllNotificationsAsRead() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n\n        // Create an array of promises to update each notification\n        const updatePromises = querySnapshot.docs.map(doc =>\n            updateDoc(doc.ref, { read: true })\n        );\n\n        // Execute all updates in parallel\n        await Promise.all(updatePromises);\n\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error('Error marking all notifications as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Delete the notification\n        await deleteDoc(notificationRef);\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error deleting notification:', error);\n        throw error;\n    }\n}\n\n/**\n * Get the count of unread notifications\n */\nexport async function getUnreadNotificationsCount() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            return 0;\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.size;\n    } catch (error) {\n        console.error('Error counting unread notifications:', error);\n        return 0;\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 439, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/MinimalNotificationBell.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"badge\": \"MinimalNotificationBell-module__DQnHDG__badge\",\n  \"button\": \"MinimalNotificationBell-module__DQnHDG__button\",\n  \"container\": \"MinimalNotificationBell-module__DQnHDG__container\",\n  \"content\": \"MinimalNotificationBell-module__DQnHDG__content\",\n  \"dot\": \"MinimalNotificationBell-module__DQnHDG__dot\",\n  \"dropdown\": \"MinimalNotificationBell-module__DQnHDG__dropdown\",\n  \"empty\": \"MinimalNotificationBell-module__DQnHDG__empty\",\n  \"footer\": \"MinimalNotificationBell-module__DQnHDG__footer\",\n  \"header\": \"MinimalNotificationBell-module__DQnHDG__header\",\n  \"icon\": \"MinimalNotificationBell-module__DQnHDG__icon\",\n  \"item\": \"MinimalNotificationBell-module__DQnHDG__item\",\n  \"list\": \"MinimalNotificationBell-module__DQnHDG__list\",\n  \"message\": \"MinimalNotificationBell-module__DQnHDG__message\",\n  \"seeMore\": \"MinimalNotificationBell-module__DQnHDG__seeMore\",\n  \"time\": \"MinimalNotificationBell-module__DQnHDG__time\",\n  \"unread\": \"MinimalNotificationBell-module__DQnHDG__unread\",\n  \"viewAll\": \"MinimalNotificationBell-module__DQnHDG__viewAll\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 464, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/MinimalNotificationBell.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef } from 'react'\nimport Link from 'next/link'\nimport { getUnreadNotificationsCount, getUserNotifications, markNotificationAsRead, Notification } from '@/firebase/notifications'\nimport styles from './MinimalNotificationBell.module.css'\n\n/**\n * A minimalistic notification bell component designed for the article page header\n */\nconst MinimalNotificationBell = () => {\n  const [unreadCount, setUnreadCount] = useState<number>(0)\n  const [notifications, setNotifications] = useState<Notification[]>([])\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const notificationRef = useRef<HTMLDivElement>(null)\n\n  // Fetch unread count on mount\n  useEffect(() => {\n    const fetchUnreadCount = async () => {\n      const count = await getUnreadNotificationsCount()\n      setUnreadCount(count)\n    }\n\n    fetchUnreadCount()\n    \n    // Refresh every minute\n    const interval = setInterval(fetchUnreadCount, 60000)\n    return () => clearInterval(interval)\n  }, [])\n\n  // Handle clicks outside the dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (notificationRef.current && !notificationRef.current.contains(event.target as Node)) {\n        setIsOpen(false)\n      }\n    }\n\n    document.addEventListener('mousedown', handleClickOutside)\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [])\n\n  // Fetch notifications when dropdown is opened\n  useEffect(() => {\n    if (isOpen) {\n      fetchNotifications()\n    }\n  }, [isOpen])\n\n  const fetchNotifications = async () => {\n    try {\n      const fetchedNotifications = await getUserNotifications(false)\n      setNotifications(fetchedNotifications)\n    } catch (error) {\n      console.error('Error fetching notifications:', error)\n    }\n  }\n\n  const handleToggle = () => {\n    setIsOpen(!isOpen)\n  }\n\n  const handleNotificationClick = async (notification: Notification) => {\n    try {\n      if (!notification.read && notification.id) {\n        await markNotificationAsRead(notification.id)\n        \n        // Update local state\n        setUnreadCount(prev => Math.max(prev - 1, 0))\n        setNotifications(prev => \n          prev.map(n => \n            n.id === notification.id \n              ? { ...n, read: true } \n              : n\n          )\n        )\n      }\n    } catch (error) {\n      console.error('Error marking notification as read:', error)\n    }\n  }\n\n  const formatTime = (timestamp: any) => {\n    if (!timestamp) return ''\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp)\n    const now = new Date()\n    const diffMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60))\n    \n    if (diffMinutes < 1) return 'Just now'\n    if (diffMinutes < 60) return `${diffMinutes}m ago`\n    \n    const diffHours = Math.floor(diffMinutes / 60)\n    if (diffHours < 24) return `${diffHours}h ago`\n    \n    const diffDays = Math.floor(diffHours / 24)\n    if (diffDays < 7) return `${diffDays}d ago`\n    \n    return date.toLocaleDateString()\n  }\n\n  const getNotificationLink = (notification: Notification) => {\n    if (notification.type === 'follow') {\n      if (notification.fromUser?.username) {\n        return `/user/${notification.fromUser.username}`;\n      }\n      return '/notifications';\n    } else if (notification.articleSlug) {\n      return `/articles?slug=${notification.articleSlug}`;\n    } else {\n      return '/notifications';\n    }\n  }\n\n  return (\n    <div className={styles.container} ref={notificationRef}>\n      <button \n        className={styles.button} \n        onClick={handleToggle}\n        aria-label=\"Notifications\"\n      >\n        <svg \n          className={styles.icon} \n          width=\"20\" \n          height=\"20\" \n          viewBox=\"0 0 24 24\" \n          fill=\"none\" \n          stroke=\"currentColor\" \n          strokeWidth=\"2\" \n          strokeLinecap=\"round\" \n          strokeLinejoin=\"round\"\n        >\n          <path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\"></path>\n          <path d=\"M13.73 21a2 2 0 0 1-3.46 0\"></path>\n        </svg>\n        \n        {unreadCount > 0 && (\n          <span className={styles.badge}>{unreadCount}</span>\n        )}\n      </button>\n      \n      {isOpen && (\n        <div className={styles.dropdown}>\n          <div className={styles.header}>\n            <h3>Notifications</h3>\n            {notifications.length > 0 && (\n              <Link href=\"/notifications\" className={styles.viewAll}>\n                View All\n              </Link>\n            )}\n          </div>\n          \n          <div className={styles.list}>\n            {notifications.length === 0 ? (\n              <div className={styles.empty}>\n                No notifications yet\n              </div>\n            ) : (\n              notifications.slice(0, 5).map((notification) => (\n                <Link \n                  href={getNotificationLink(notification)} \n                  key={notification.id}\n                  className={`${styles.item} ${!notification.read ? styles.unread : ''}`}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className={styles.content}>\n                    <p className={styles.message}>\n                      {notification.message}\n                    </p>\n                    <span className={styles.time}>\n                      {formatTime(notification.createdAt)}\n                    </span>\n                  </div>\n                  {!notification.read && (\n                    <div className={styles.dot}></div>\n                  )}\n                </Link>\n              ))\n            )}\n          </div>\n          \n          {notifications.length > 5 && (\n            <div className={styles.footer}>\n              <Link href=\"/notifications\" className={styles.seeMore}>\n                See more notifications\n              </Link>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default MinimalNotificationBell "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 742, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/highlightService.ts"],"sourcesContent":["import { db } from '@/firebase/clientApp';\nimport {\n    collection,\n    doc,\n    addDoc,\n    getDocs,\n    query,\n    where,\n    deleteDoc,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    serverTimestamp\n} from 'firebase/firestore';\n\nexport interface Highlight {\n    id: string;\n    articleId: string;\n    userId: string;\n    text: string;\n    prefix: string;\n    suffix: string;\n    createdAt: any; // Firestore timestamp\n    comments?: Comment[];\n}\n\ninterface Comment {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport const saveHighlight = async (\n    articleId: string,\n    userId: string,\n    text: string,\n    prefix: string,\n    suffix: string\n): Promise<string> => {\n    try {\n        const highlightData = {\n            articleId,\n            userId,\n            text,\n            prefix,\n            suffix,\n            createdAt: serverTimestamp(),\n            comments: []\n        };\n\n        const docRef = await addDoc(collection(db, 'highlights'), highlightData);\n        return docRef.id;\n    } catch (error) {\n        console.error('Error saving highlight:', error);\n        throw error;\n    }\n};\n\nexport const getArticleHighlights = async (articleId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('articleId', '==', articleId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting highlights:', error);\n        return [];\n    }\n};\n\nexport const getUserHighlights = async (userId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('userId', '==', userId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting user highlights:', error);\n        return [];\n    }\n};\n\nexport const deleteHighlight = async (highlightId: string): Promise<void> => {\n    try {\n        await deleteDoc(doc(db, 'highlights', highlightId));\n    } catch (error) {\n        console.error('Error deleting highlight:', error);\n        throw error;\n    }\n};\n\nexport const addCommentToHighlight = async (\n    highlightId: string,\n    userId: string,\n    content: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        const comment = {\n            userId,\n            content,\n            createdAt: new Date().toISOString(),\n        };\n\n        await updateDoc(highlightRef, {\n            comments: arrayUnion(comment)\n        });\n    } catch (error) {\n        console.error('Error adding comment to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeCommentFromHighlight = async (\n    highlightId: string,\n    comment: Comment\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            comments: arrayRemove(comment)\n        });\n    } catch (error) {\n        console.error('Error removing comment from highlight:', error);\n        throw error;\n    }\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 840, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/context/HighlightContext.tsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { \n  Highlight, \n  getArticleHighlights, \n  saveHighlight, \n  deleteHighlight \n} from '@/services/highlightService';\n\ninterface HighlightContextType {\n  highlights: Highlight[];\n  loading: boolean;\n  saveHighlight: (text: string, prefix: string, suffix: string, articleId: string) => Promise<string | null>;\n  removeHighlight: (highlightId: string) => Promise<void>;\n  highlightElement: (range: Range) => void;\n}\n\nconst HighlightContext = createContext<HighlightContextType | undefined>(undefined);\n\ninterface HighlightProviderProps {\n  children: ReactNode;\n  articleId: string;\n}\n\nexport const HighlightProvider: React.FC<HighlightProviderProps> = ({ children, articleId }) => {\n  const [highlights, setHighlights] = useState<Highlight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Load highlights for the current article\n  useEffect(() => {\n    const loadHighlights = async () => {\n      if (articleId) {\n        setLoading(true);\n        try {\n          const articleHighlights = await getArticleHighlights(articleId);\n          setHighlights(articleHighlights);\n        } catch (error) {\n          console.error('Error loading highlights:', error);\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    loadHighlights();\n  }, [articleId]);\n\n  // Save a new highlight\n  const handleSaveHighlight = async (\n    text: string, \n    prefix: string, \n    suffix: string, \n    articleId: string\n  ): Promise<string | null> => {\n    if (!currentUser) {\n      alert('You must be logged in to highlight text');\n      return null;\n    }\n\n    try {\n      const highlightId = await saveHighlight(\n        articleId,\n        currentUser.uid,\n        text,\n        prefix,\n        suffix\n      );\n\n      // Add the new highlight to state\n      const newHighlight: Highlight = {\n        id: highlightId,\n        articleId,\n        userId: currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        createdAt: new Date(),\n      };\n\n      setHighlights(prev => [...prev, newHighlight]);\n      return highlightId;\n    } catch (error) {\n      console.error('Error saving highlight:', error);\n      return null;\n    }\n  };\n\n  // Remove a highlight\n  const handleRemoveHighlight = async (highlightId: string): Promise<void> => {\n    try {\n      await deleteHighlight(highlightId);\n      setHighlights(prev => prev.filter(h => h.id !== highlightId));\n    } catch (error) {\n      console.error('Error removing highlight:', error);\n    }\n  };\n\n  // Apply highlight styling to a DOM element\n  const highlightElement = (range: Range): void => {\n    const highlightMark = document.createElement('mark');\n    highlightMark.className = 'article-highlight';\n    \n    try {\n      range.surroundContents(highlightMark);\n    } catch (error) {\n      console.error('Error highlighting range:', error);\n      // Handle complex selection that spans multiple elements\n      const fragment = range.extractContents();\n      highlightMark.appendChild(fragment);\n      range.insertNode(highlightMark);\n    }\n  };\n\n  const contextValue: HighlightContextType = {\n    highlights,\n    loading,\n    saveHighlight: handleSaveHighlight,\n    removeHighlight: handleRemoveHighlight,\n    highlightElement,\n  };\n\n  return (\n    <HighlightContext.Provider value={contextValue}>\n      {children}\n    </HighlightContext.Provider>\n  );\n};\n\nexport const useHighlights = (): HighlightContextType => {\n  const context = useContext(HighlightContext);\n  if (context === undefined) {\n    throw new Error('useHighlights must be used within a HighlightProvider');\n  }\n  return context;\n}; "],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;AAeA,MAAM,iCAAmB,CAAA,GAAA,qMAAA,CAAA,gBAAa,AAAD,EAAoC;AAOlE,MAAM,oBAAsD,CAAC,EAAE,QAAQ,EAAE,SAAS,EAAE;IACzF,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe,EAAE;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;IAE5D,gCAAgC;IAChC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,kBAAkB,CAAC,CAAA;YAC1C,eAAe;QACjB;QACA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,0CAA0C;IAC1C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,iBAAiB;YACrB,IAAI,WAAW;gBACb,WAAW;gBACX,IAAI;oBACF,MAAM,oBAAoB,MAAM,CAAA,GAAA,mIAAA,CAAA,uBAAoB,AAAD,EAAE;oBACrD,cAAc;gBAChB,EAAE,OAAO,OAAO;oBACd,QAAQ,KAAK,CAAC,6BAA6B;gBAC7C,SAAU;oBACR,WAAW;gBACb;YACF;QACF;QAEA;IACF,GAAG;QAAC;KAAU;IAEd,uBAAuB;IACvB,MAAM,sBAAsB,OAC1B,MACA,QACA,QACA;QAEA,IAAI,CAAC,aAAa;YAChB,MAAM;YACN,OAAO;QACT;QAEA,IAAI;YACF,MAAM,cAAc,MAAM,CAAA,GAAA,mIAAA,CAAA,gBAAa,AAAD,EACpC,WACA,YAAY,GAAG,EACf,MACA,QACA;YAGF,iCAAiC;YACjC,MAAM,eAA0B;gBAC9B,IAAI;gBACJ;gBACA,QAAQ,YAAY,GAAG;gBACvB;gBACA;gBACA;gBACA,WAAW,IAAI;YACjB;YAEA,cAAc,CAAA,OAAQ;uBAAI;oBAAM;iBAAa;YAC7C,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO;QACT;IACF;IAEA,qBAAqB;IACrB,MAAM,wBAAwB,OAAO;QACnC,IAAI;YACF,MAAM,CAAA,GAAA,mIAAA,CAAA,kBAAe,AAAD,EAAE;YACtB,cAAc,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAClD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C;IACF;IAEA,2CAA2C;IAC3C,MAAM,mBAAmB,CAAC;QACxB,MAAM,gBAAgB,SAAS,aAAa,CAAC;QAC7C,cAAc,SAAS,GAAG;QAE1B,IAAI;YACF,MAAM,gBAAgB,CAAC;QACzB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,wDAAwD;YACxD,MAAM,WAAW,MAAM,eAAe;YACtC,cAAc,WAAW,CAAC;YAC1B,MAAM,UAAU,CAAC;QACnB;IACF;IAEA,MAAM,eAAqC;QACzC;QACA;QACA,eAAe;QACf,iBAAiB;QACjB;IACF;IAEA,qBACE,8OAAC,iBAAiB,QAAQ;QAAC,OAAO;kBAC/B;;;;;;AAGP;AAEO,MAAM,gBAAgB;IAC3B,MAAM,UAAU,CAAA,GAAA,qMAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 963, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/HighlightToolbar.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\ninterface HighlightToolbarProps {\n  selection: Selection | null;\n  onHighlight: (selectedText: string, range: Range) => void;\n  onResponse?: (selectedText: string) => void;\n  onShare?: (selectedText: string) => void;\n  onAiAssist?: (selectedText: string) => void;\n}\n\nconst HighlightToolbar: React.FC<HighlightToolbarProps> = ({ \n  selection, \n  onHighlight, \n  onResponse, \n  onShare, \n  onAiAssist \n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const [isVisible, setIsVisible] = useState(false);\n  const toolbarRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // Don't show toolbar if no selection or empty selection\n    if (!selection || selection.isCollapsed) {\n      setIsVisible(false);\n      return;\n    }\n\n    // Get the selection's bounding rectangle\n    const range = selection.getRangeAt(0);\n    const rect = range.getBoundingClientRect();\n\n    // Position the toolbar above the selection\n    const windowHeight = window.innerHeight;\n    const toolbarHeight = toolbarRef.current?.offsetHeight || 40;\n    \n    // Calculate position (centered above the selection)\n    const top = rect.top - toolbarHeight - 10 + window.scrollY;\n    const left = rect.left + rect.width / 2;\n\n    setPosition({ \n      top: top < 0 ? rect.bottom + 10 + window.scrollY : top, // Handle if too high\n      left \n    });\n    \n    // Show the toolbar\n    setIsVisible(true);\n  }, [selection]);\n\n  // Handle highlighting action\n  const handleHighlight = () => {\n    if (selection && !selection.isCollapsed) {\n      const range = selection.getRangeAt(0);\n      const selectedText = selection.toString();\n      onHighlight(selectedText, range);\n      // Clear selection after highlighting\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle response action\n  const handleResponse = () => {\n    if (selection && !selection.isCollapsed && onResponse) {\n      const selectedText = selection.toString();\n      onResponse(selectedText);\n      // Clear selection after response\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle share action\n  const handleShare = () => {\n    if (selection && !selection.isCollapsed && onShare) {\n      const selectedText = selection.toString();\n      onShare(selectedText);\n      // Clear selection after share\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle AI assist action\n  const handleAiAssist = () => {\n    if (selection && !selection.isCollapsed && onAiAssist) {\n      const selectedText = selection.toString();\n      onAiAssist(selectedText);\n      // Clear selection after AI assist\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Only render if there's a valid selection and in browser\n  if (!isVisible || typeof window === 'undefined') {\n    return null;\n  }\n\n  // Use portal to render outside of article container\n  return createPortal(\n    <div \n      ref={toolbarRef}\n      className=\"highlight-toolbar\"\n      style={{\n        position: 'absolute',\n        top: `${position.top}px`,\n        left: `${position.left}px`,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n      }}\n    >\n      <button onClick={handleHighlight} className=\"highlight-btn highlight-btn-main\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n          <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\n        </svg>\n        <span>Highlight</span>\n      </button>\n      \n      {onResponse && (\n        <button onClick={handleResponse} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n          </svg>\n          <span>Response</span>\n        </button>\n      )}\n      \n      {onShare && (\n        <button onClick={handleShare} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n            <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n            <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n            <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n            <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n          </svg>\n          <span>Share</span>\n        </button>\n      )}\n      \n      {onAiAssist && (\n        <button onClick={handleAiAssist} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n            <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line>\n          </svg>\n          <span>Journa AI</span>\n        </button>\n      )}\n    </div>,\n    document.body\n  );\n};\n\nexport default HighlightToolbar; "],"names":[],"mappings":";;;;AAAA;AACA;;;;AAUA,MAAM,mBAAoD,CAAC,EACzD,SAAS,EACT,WAAW,EACX,UAAU,EACV,OAAO,EACP,UAAU,EACX;IACC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;QAAE,KAAK;QAAG,MAAM;IAAE;IAC3D,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC3C,MAAM,aAAa,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAE1C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,wDAAwD;QACxD,IAAI,CAAC,aAAa,UAAU,WAAW,EAAE;YACvC,aAAa;YACb;QACF;QAEA,yCAAyC;QACzC,MAAM,QAAQ,UAAU,UAAU,CAAC;QACnC,MAAM,OAAO,MAAM,qBAAqB;QAExC,2CAA2C;QAC3C,MAAM,eAAe,OAAO,WAAW;QACvC,MAAM,gBAAgB,WAAW,OAAO,EAAE,gBAAgB;QAE1D,oDAAoD;QACpD,MAAM,MAAM,KAAK,GAAG,GAAG,gBAAgB,KAAK,OAAO,OAAO;QAC1D,MAAM,OAAO,KAAK,IAAI,GAAG,KAAK,KAAK,GAAG;QAEtC,YAAY;YACV,KAAK,MAAM,IAAI,KAAK,MAAM,GAAG,KAAK,OAAO,OAAO,GAAG;YACnD;QACF;QAEA,mBAAmB;QACnB,aAAa;IACf,GAAG;QAAC;KAAU;IAEd,6BAA6B;IAC7B,MAAM,kBAAkB;QACtB,IAAI,aAAa,CAAC,UAAU,WAAW,EAAE;YACvC,MAAM,QAAQ,UAAU,UAAU,CAAC;YACnC,MAAM,eAAe,UAAU,QAAQ;YACvC,YAAY,cAAc;YAC1B,qCAAqC;YACrC,OAAO,YAAY,IAAI;YACvB,aAAa;QACf;IACF;IAEA,yBAAyB;IACzB,MAAM,iBAAiB;QACrB,IAAI,aAAa,CAAC,UAAU,WAAW,IAAI,YAAY;YACrD,MAAM,eAAe,UAAU,QAAQ;YACvC,WAAW;YACX,iCAAiC;YACjC,OAAO,YAAY,IAAI;YACvB,aAAa;QACf;IACF;IAEA,sBAAsB;IACtB,MAAM,cAAc;QAClB,IAAI,aAAa,CAAC,UAAU,WAAW,IAAI,SAAS;YAClD,MAAM,eAAe,UAAU,QAAQ;YACvC,QAAQ;YACR,8BAA8B;YAC9B,OAAO,YAAY,IAAI;YACvB,aAAa;QACf;IACF;IAEA,0BAA0B;IAC1B,MAAM,iBAAiB;QACrB,IAAI,aAAa,CAAC,UAAU,WAAW,IAAI,YAAY;YACrD,MAAM,eAAe,UAAU,QAAQ;YACvC,WAAW;YACX,kCAAkC;YAClC,OAAO,YAAY,IAAI;YACvB,aAAa;QACf;IACF;IAEA,0DAA0D;IAC1D,wCAAiD;QAC/C,OAAO;IACT;;AA0DF;uCAEe","debugId":null}},
    {"offset": {"line": 1057, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleHighlights.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport HighlightToolbar from './HighlightToolbar';\nimport { useHighlights } from '@/context/HighlightContext';\nimport { Highlight } from '@/services/highlightService';\n\ninterface ArticleHighlightsProps {\n  articleId: string;\n  children: React.ReactNode;\n  onShare?: (text: string) => void; // Optional share handler\n}\n\n// Get context for a selection\nconst getSelectionContext = (selection: Selection): { prefix: string; suffix: string } => {\n  // Default empty result\n  const result = { prefix: '', suffix: '' };\n  \n  if (!selection || selection.rangeCount === 0) return result;\n  \n  const range = selection.getRangeAt(0);\n  const selectedText = range.toString();\n  \n  // Clone the range for getting surrounding content\n  const contextRange = range.cloneRange();\n  \n  // Get parent node of selection\n  const parentNode = range.commonAncestorContainer;\n  const parentContent = parentNode.textContent || '';\n  \n  // Find selection position in parent content\n  const selectionStart = parentContent.indexOf(selectedText);\n  \n  if (selectionStart !== -1) {\n    // Get up to 30 chars of context before and after selection\n    const prefixStart = Math.max(0, selectionStart - 30);\n    const suffixEnd = Math.min(parentContent.length, selectionStart + selectedText.length + 30);\n    \n    result.prefix = parentContent.substring(prefixStart, selectionStart);\n    result.suffix = parentContent.substring(selectionStart + selectedText.length, suffixEnd);\n  }\n  \n  return result;\n};\n\n// Apply highlights to existing content in the DOM\nconst applyHighlightsToContent = (highlights: any[], articleContent: HTMLElement): void => {\n  if (!highlights || !articleContent) return;\n  \n  // First clear existing highlights to prevent duplicates\n  const existingHighlights = articleContent.querySelectorAll('.article-highlight');\n  existingHighlights.forEach(el => {\n    const parent = el.parentNode;\n    if (parent) {\n      // Replace the highlight with its text content\n      const textNode = document.createTextNode(el.textContent || '');\n      parent.replaceChild(textNode, el);\n      // Normalize to merge adjacent text nodes\n      parent.normalize();\n    }\n  });\n  \n  // Then apply all highlights from the database\n  highlights.forEach(highlight => {\n    // Function to find text in the DOM using prefix and suffix as context\n    const findTextInDOM = (text: string, prefix: string, suffix: string): Range | null => {\n      // Create a text finder walker\n      const walker = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      // Pattern to search for (prefix + text + suffix)\n      const pattern = (prefix + text + suffix).trim();\n      \n      let node;\n      while (node = walker.nextNode()) {\n        const content = node.textContent || '';\n        const index = content.indexOf(pattern);\n        \n        if (index !== -1) {\n          // Found the text with context, create a range\n          const range = document.createRange();\n          const prefixLength = prefix.trim().length;\n          range.setStart(node, index + prefixLength);\n          range.setEnd(node, index + prefixLength + text.trim().length);\n          return range;\n        }\n      }\n      \n      return null;\n    };\n    \n    // Try to find and highlight the text\n    const range = findTextInDOM(highlight.text, highlight.prefix, highlight.suffix);\n    if (range) {\n      try {\n        // Create highlight mark\n        const mark = document.createElement('mark');\n        mark.className = 'article-highlight';\n        mark.dataset.highlightId = highlight.id;\n        \n        // Apply highlight\n        range.surroundContents(mark);\n      } catch (error) {\n        console.error('Error applying highlight:', error);\n      }\n    }\n  });\n};\n\nconst ArticleHighlights: React.FC<ArticleHighlightsProps> = ({ articleId, children, onShare }) => {\n  const [selection, setSelection] = useState<Selection | null>(null);\n  const { highlights, saveHighlight, removeHighlight, highlightElement } = useHighlights();\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\n  const [showResponseModal, setShowResponseModal] = useState(false);\n  const [selectedTextForResponse, setSelectedTextForResponse] = useState('');\n  const [showAiModal, setShowAiModal] = useState(false);\n  const [selectedTextForAi, setSelectedTextForAi] = useState('');\n  const [activeHighlight, setActiveHighlight] = useState<{ id: string, text: string } | null>(null);\n  const [showUnhighlightToolbar, setShowUnhighlightToolbar] = useState(false);\n  const [isHidingToolbar, setIsHidingToolbar] = useState(false);\n  const [unhighlightPosition, setUnhighlightPosition] = useState({ top: 0, left: 0 });\n  \n  // Function to hide toolbar with animation\n  const hideToolbarWithAnimation = useCallback(() => {\n    setIsHidingToolbar(true);\n    // After animation completes, actually hide the toolbar\n    setTimeout(() => {\n      setShowUnhighlightToolbar(false);\n      setIsHidingToolbar(false);\n    }, 150); // Match this with CSS transition duration\n  }, []);\n  \n  // Handle text selection\n  const handleSelection = useCallback(() => {\n    // If unhighlight toolbar is active, don't process regular selections\n    if (showUnhighlightToolbar) return;\n    \n    const currentSelection = window.getSelection();\n    if (currentSelection && !currentSelection.isCollapsed && currentSelection.toString().trim() !== '') {\n      setSelection(currentSelection);\n    } else {\n      setSelection(null);\n    }\n  }, [showUnhighlightToolbar]);\n  \n  // Handle highlight button click\n  const handleHighlight = useCallback((selectedText: string, range: Range) => {\n    if (selectedText && range) {\n      // Get context for the selection\n      const context = getSelectionContext(window.getSelection()!);\n      \n      // Save highlight to database\n      saveHighlight(\n        selectedText.trim(),\n        context.prefix,\n        context.suffix,\n        articleId\n      );\n      \n      // Apply highlight visually\n      highlightElement(range);\n    }\n  }, [articleId, saveHighlight, highlightElement]);\n  \n  // Handle highlight click to show unhighlight option\n  const handleHighlightClick = useCallback((e: MouseEvent) => {\n    // Check if click is on a highlight\n    const target = e.target as HTMLElement;\n    if (target.classList.contains('article-highlight')) {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // Get highlight info\n      const highlightId = target.dataset.highlightId;\n      const highlightText = target.textContent || '';\n      \n      if (highlightId) {\n        // Reset hiding state if it was set\n        setIsHidingToolbar(false);\n        \n        // Set active highlight\n        setActiveHighlight({ id: highlightId, text: highlightText });\n        \n        // Position unhighlight toolbar near the highlight\n        const rect = target.getBoundingClientRect();\n        setUnhighlightPosition({\n          top: rect.top - 40 + window.scrollY, // Position above the highlight\n          left: rect.left + rect.width / 2\n        });\n        \n        // Show unhighlight toolbar\n        setShowUnhighlightToolbar(true);\n        \n        // Hide regular selection toolbar if visible\n        setSelection(null);\n      }\n    } else {\n      // If clicking elsewhere, hide unhighlight toolbar with animation\n      if (showUnhighlightToolbar) {\n        hideToolbarWithAnimation();\n        setActiveHighlight(null);\n      }\n    }\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Handle unhighlight action\n  const handleUnhighlight = useCallback(() => {\n    if (activeHighlight && activeHighlight.id) {\n      // Start the hiding animation\n      hideToolbarWithAnimation();\n      \n      // Store the ID before resetting the active highlight\n      const highlightId = activeHighlight.id;\n      \n      // Reset active highlight state\n      setActiveHighlight(null);\n      \n      // Remove highlight from database\n      removeHighlight(highlightId);\n      \n      // Find and remove highlight from DOM\n      if (contentRef) {\n        const highlightEl = contentRef.querySelector(`[data-highlight-id=\"${highlightId}\"]`);\n        if (highlightEl && highlightEl.parentNode) {\n          const textNode = document.createTextNode(highlightEl.textContent || '');\n          highlightEl.parentNode.replaceChild(textNode, highlightEl);\n          highlightEl.parentNode.normalize();\n        }\n      }\n    }\n  }, [activeHighlight, removeHighlight, contentRef, hideToolbarWithAnimation]);\n  \n  // Handle response button click\n  const handleResponse = useCallback((selectedText: string) => {\n    setSelectedTextForResponse(selectedText);\n    setShowResponseModal(true);\n  }, []);\n\n  // Handle share button click\n  const handleShare = useCallback((selectedText: string) => {\n    if (onShare) {\n      onShare(selectedText);\n    } else {\n      // Fallback if no share handler is provided\n      const shareText = `\"${selectedText}\" — via Journalite`;\n      \n      // Try to use native share API if available\n      if (navigator.share) {\n        navigator.share({\n          text: shareText,\n        }).catch(error => {\n          console.error('Error sharing:', error);\n          // Fallback to copying to clipboard\n          navigator.clipboard.writeText(shareText)\n            .then(() => alert('Quote copied to clipboard!'))\n            .catch(err => console.error('Failed to copy:', err));\n        });\n      } else {\n        // Fallback to copying to clipboard\n        navigator.clipboard.writeText(shareText)\n          .then(() => alert('Quote copied to clipboard!'))\n          .catch(err => console.error('Failed to copy:', err));\n      }\n    }\n  }, [onShare]);\n\n  // Handle AI assist button click\n  const handleAiAssist = useCallback((selectedText: string) => {\n    setSelectedTextForAi(selectedText);\n    setShowAiModal(true);\n  }, []);\n  \n  // Set up selection event listener\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelection);\n    return () => {\n      document.removeEventListener('selectionchange', handleSelection);\n    };\n  }, [handleSelection]);\n  \n  // Set up click listener for highlights\n  useEffect(() => {\n    if (contentRef) {\n      contentRef.addEventListener('click', handleHighlightClick as EventListener);\n      \n      return () => {\n        contentRef.removeEventListener('click', handleHighlightClick as EventListener);\n      };\n    }\n  }, [contentRef, handleHighlightClick]);\n  \n  // Add click listener to document to hide unhighlight toolbar when clicking outside\n  useEffect(() => {\n    const handleDocumentClick = (e: MouseEvent) => {\n      if (showUnhighlightToolbar) {\n        const target = e.target as HTMLElement;\n        if (!target.closest('.highlight-toolbar') && \n            !target.classList.contains('article-highlight')) {\n          hideToolbarWithAnimation();\n          setActiveHighlight(null);\n        }\n      }\n    };\n    \n    document.addEventListener('click', handleDocumentClick);\n    \n    return () => {\n      document.removeEventListener('click', handleDocumentClick);\n    };\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Apply highlights from database when they change\n  useEffect(() => {\n    if (contentRef && highlights.length > 0) {\n      applyHighlightsToContent(highlights, contentRef);\n    }\n  }, [highlights, contentRef]);\n  \n  // Get ref to content element\n  const setRef = useCallback((node: HTMLElement | null) => {\n    if (node) {\n      setContentRef(node);\n    }\n  }, []);\n  \n  return (\n    <>\n      {/* Toolbar for highlighting */}\n      <HighlightToolbar \n        selection={selection} \n        onHighlight={handleHighlight} \n        onResponse={handleResponse}\n        onShare={handleShare}\n        onAiAssist={handleAiAssist}\n      />\n      \n      {/* Unhighlight toolbar */}\n      {showUnhighlightToolbar && activeHighlight && (\n        <div \n          className={`highlight-toolbar unhighlight-toolbar ${isHidingToolbar ? 'hiding' : ''}`}\n          style={{\n            position: 'absolute',\n            top: `${unhighlightPosition.top}px`,\n            left: `${unhighlightPosition.left}px`,\n            transform: isHidingToolbar ? 'translateY(-10px) translateX(-50%)' : 'translateX(-50%)',\n            zIndex: 1000,\n          }}\n        >\n          <button onClick={handleUnhighlight} className=\"highlight-btn highlight-btn-danger\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z\"></path>\n              <line x1=\"18\" y1=\"9\" x2=\"12\" y2=\"15\"></line>\n              <line x1=\"12\" y1=\"9\" x2=\"18\" y2=\"15\"></line>\n            </svg>\n            <span>Unhighlight</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleShare(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n              <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n              <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n              <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n              <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n            </svg>\n            <span>Share</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleResponse(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n            </svg>\n            <span>Response</span>\n          </button>\n        </div>\n      )}\n      \n      {/* Content with ref for highlight application */}\n      <div ref={setRef} className=\"article-highlight-container\">\n        {children}\n      </div>\n      \n      {/* Response Modal - placeholder for implementation */}\n      {showResponseModal && (\n        <div className=\"highlight-response-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowResponseModal(false)}\n            >\n              ×\n            </button>\n            <h3>Respond to highlighted text</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForResponse}\"</div>\n            <textarea \n              className=\"highlight-response-input\" \n              placeholder=\"Write your response...\"\n            ></textarea>\n            <button className=\"highlight-response-submit\">Submit</button>\n          </div>\n        </div>\n      )}\n      \n      {/* Journa AI Modal - placeholder for implementation */}\n      {showAiModal && (\n        <div className=\"highlight-ai-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowAiModal(false)}\n            >\n              ×\n            </button>\n            <h3>Journa AI</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForAi}\"</div>\n            <div className=\"highlight-ai-options\">\n              <button>Explain this</button>\n              <button>Fact check</button>\n              <button>Provide context</button>\n              <button>Summarize</button>\n            </div>\n            <div className=\"highlight-ai-response\">\n              {/* AI response would appear here */}\n              <div className=\"highlight-ai-loading\">Journa AI is thinking...</div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default ArticleHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1746, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleWithHighlights.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleContainer\": \"ArticleWithHighlights-module__TI8ibW__articleContainer\",\n  \"articleContent\": \"ArticleWithHighlights-module__TI8ibW__articleContent\",\n  \"errorContainer\": \"ArticleWithHighlights-module__TI8ibW__errorContainer\",\n  \"errorMessage\": \"ArticleWithHighlights-module__TI8ibW__errorMessage\",\n  \"loadingContainer\": \"ArticleWithHighlights-module__TI8ibW__loadingContainer\",\n  \"loadingIndicator\": \"ArticleWithHighlights-module__TI8ibW__loadingIndicator\",\n  \"spin\": \"ArticleWithHighlights-module__TI8ibW__spin\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 1761, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/articles.ts"],"sourcesContent":["import { collection, addDoc, getDocs, getDoc, doc, query, orderBy, Timestamp, where, DocumentData, DocumentSnapshot, deleteDoc, updateDoc, arrayUnion, arrayRemove, limit as firestoreLimit, QueryConstraint } from 'firebase/firestore';\nimport { db, auth } from './clientApp';\nimport { createCommentNotification } from './notifications';\n\n// Article interface matching our Firestore structure\nexport interface Article {\n    id?: string;\n    title: string;\n    body: string;\n    createdAt: Timestamp;\n    updatedAt?: Timestamp;\n    authorId: string;\n    authorName: string;\n    tags?: string[];\n    coverImage?: string | null;\n    slug?: string;\n    status?: 'published' | 'drafts';\n    likes?: string[];\n    excerpt?: string;\n    viewCount?: number;\n    reposts?: string[];\n    comments?: any[];\n}\n\n// Comment interfaces for Firestore\nexport interface ArticleComment {\n    id?: string;\n    commentId?: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n}\n\n// Get articles from Firestore, ordered by createdAt desc, with optional limit and draft inclusion\nexport async function getArticles(options: { limit?: number; includeDrafts?: boolean } = {}) {\n    const { limit, includeDrafts = false } = options;\n    console.log('getArticles called with limit:', limit);\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints = [];\n\n        if (!includeDrafts) {\n            // If status is explicitly 'published' OR if status field does not exist (older data might not have it)\n            // Firestore doesn't easily support \"OR\" across different fields or \"field not exists\" in combination with other `where` on same field.\n            // A common approach is to ensure all articles have a status.\n            // For now, we'll explicitly query for 'published'. If you need to include articles where 'status' is undefined\n            // as 'published', you might need two separate queries or adjust your data model to always include a 'status'.\n            queryConstraints.push(where('status', '==', 'published'));\n        }\n        // Always order by creation date\n        queryConstraints.push(orderBy('createdAt', 'desc'));\n\n        if (limit && limit > 0) {\n            console.log('Adding limit constraint:', limit);\n            queryConstraints.push(firestoreLimit(limit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n        console.log('Query returned document count:', querySnapshot.size);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            const articleData = docSnapshot.data() as Omit<Article, 'id'>;\n\n            // The query now handles filtering for published status if includeDrafts is false.\n            // If includeDrafts is true, no status filter is applied in the query.\n            articles.push({\n                id: docSnapshot.id,\n                ...articleData\n            });\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles:', error);\n        throw error;\n    }\n}\n\n// Get a single article by ID - DIRECT NO-CACHE VERSION\nexport async function getArticleById(id: string): Promise<Article | null> {\n    try {\n        // Super aggressive cache-busting\n        const timestamp = Date.now();\n        console.log(`🔄 DIRECT FETCH: Getting article with ID: ${id} (time: ${timestamp})`);\n\n        // Completely bypass any caching by making a direct Firestore call\n        const docRef = doc(db, 'articles', id);\n\n        // Direct Firestore fetch with no caching\n\n        // Get fresh data directly\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const articleData = {\n                id: docSnap.id,\n                ...docSnap.data()\n            } as Article;\n\n            console.log('✅ Article found:', articleData.title);\n            console.log('📄 Content length:', articleData.body?.length || 0);\n            console.log('🏷️ Tags:', articleData.tags?.join(', ') || 'none');\n\n            // Return fresh data\n            return articleData;\n        } else {\n            console.log('❌ Article not found for ID:', id);\n            return null;\n        }\n    } catch (error) {\n        console.error('🛑 Error getting article:', error);\n        throw error;\n    }\n}\n\n// Get a single article by slug\nexport async function getArticleBySlug(slug: string): Promise<Article | null> {\n    try {\n        console.log(`Getting article by slug: ${slug}, timestamp: ${Date.now()}`);\n\n        // Try multiple attempts to get fresh data\n        let attempts = 0;\n        const maxAttempts = 2;\n\n        while (attempts < maxAttempts) {\n            attempts++;\n            console.log(`Attempt ${attempts} to get article by slug`);\n\n            // Short delay between attempts\n            if (attempts > 1) {\n                await new Promise(resolve => setTimeout(resolve, 500));\n            }\n\n            const articlesRef = collection(db, 'articles');\n            const q = query(articlesRef, where('slug', '==', slug), where('status', '==', 'published'));\n            const querySnapshot = await getDocs(q);\n\n            if (!querySnapshot.empty) {\n                const docSnap = querySnapshot.docs[0];\n                const articleData = {\n                    id: docSnap.id,\n                    ...docSnap.data()\n                } as Article;\n\n                console.log('Article found by slug:', articleData.title, 'Content length:', articleData.body?.length || 0);\n                return articleData;\n            } else if (attempts >= maxAttempts) {\n                console.log('Article not found for slug after multiple attempts:', slug);\n                return null;\n            }\n\n            console.log(`Article not found by slug on attempt ${attempts}, will retry...`);\n        }\n\n        return null;\n    } catch (error) {\n        console.error('Error getting article by slug:', error);\n        throw error;\n    }\n}\n\n// Create a new article\nexport async function createArticle(articleInput: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>> & { title: string; body: string; }) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to create an article');\n        }\n\n        const newArticleData: Omit<Article, 'id'> = {\n            title: articleInput.title,\n            body: articleInput.body,\n            slug: articleInput.slug || articleInput.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, ''),\n            createdAt: Timestamp.now(),\n            authorId: user.uid,\n            authorName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            tags: articleInput.tags || [],\n            status: articleInput.status || 'published',\n            coverImage: articleInput.coverImage || null,\n            likes: [],\n            excerpt: articleInput.excerpt || '',\n            viewCount: 0,\n            reposts: [],\n            comments: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles'), newArticleData);\n        return {\n            id: docRef.id,\n            ...newArticleData\n        } as Article;\n    } catch (error) {\n        console.error('Error creating article:', error);\n        throw error;\n    }\n}\n\n// Update an existing article\nexport async function updateArticle(articleId: string, articleData: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>>) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to edit an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleSnap = await getDoc(articleRef);\n\n        if (!articleSnap.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const existingArticleData = articleSnap.data() as Article;\n        if (existingArticleData.authorId !== user.uid) {\n            throw new Error('You can only edit your own articles');\n        }\n\n        const updateData: Partial<Article> = { ...articleData };\n\n        // Always update slug when title changes to ensure published articles reflect changes\n        if (articleData.title) {\n            updateData.slug = articleData.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, '');\n            console.log('Updated slug to:', updateData.slug);\n        }\n        updateData.updatedAt = Timestamp.now();\n\n        await updateDoc(articleRef, updateData);\n\n        const updatedArticleSnap = await getDoc(articleRef);\n        return {\n            id: updatedArticleSnap.id,\n            ...updatedArticleSnap.data()\n        } as Article;\n    } catch (error) {\n        console.error('Error updating article:', error);\n        throw error;\n    }\n}\n\n// Comments functions\nexport async function getArticleComments(articleId: string) {\n    try {\n        const commentsRef = collection(db, 'articles', articleId, 'comments');\n        const q = query(commentsRef, orderBy('createdAt', 'desc'));\n        const querySnapshot = await getDocs(q);\n\n        const comments: ArticleComment[] = [];\n        querySnapshot.forEach((doc) => {\n            const commentData = doc.data() as Omit<ArticleComment, 'id' | 'commentId'>;\n            comments.push({\n                id: doc.id,\n                commentId: doc.id,\n                ...commentData,\n                replies: commentData.replies || []\n            });\n        });\n\n        return comments;\n    } catch (error) {\n        console.error('Error getting comments:', error);\n        throw error;\n    }\n}\n\nexport async function addComment(articleId: string, content: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to comment');\n        }\n\n        const newComment: Omit<ArticleComment, 'id' | 'commentId'> = {\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: [],\n            replies: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles', articleId, 'comments'), newComment);\n\n        const articleInfoForNotification = await getArticleById(articleId);\n        if (articleInfoForNotification && articleInfoForNotification.authorId !== user.uid) {\n            await createCommentNotification(\n                articleInfoForNotification.authorId,\n                articleId,\n                articleInfoForNotification.slug || '',\n                articleInfoForNotification.title || 'Article',\n                docRef.id,\n                content\n            );\n        }\n\n        return {\n            id: docRef.id,\n            commentId: docRef.id,\n            ...newComment\n        } as ArticleComment;\n    } catch (error) {\n        console.error('Error adding comment:', error);\n        throw error;\n    }\n}\n\nexport async function addReply(articleId: string, commentId: string, content: string): Promise<CommentReply> {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to reply');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const newReply: CommentReply = {\n            replyId: Math.random().toString(36).substring(2, 15),\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: []\n        };\n\n        await updateDoc(commentRef, {\n            replies: arrayUnion(newReply)\n        });\n\n        const commentData = commentSnap.data() as ArticleComment;\n        if (commentData.userId !== user.uid) {\n            const articleInfo = await getArticleById(articleId);\n            console.log(`User ${user.uid} replied to comment ${commentId} by ${commentData.userId} on article ${articleInfo?.title}`);\n        }\n\n        return newReply;\n    } catch (error) {\n        console.error('Error adding reply:', error);\n        throw error;\n    }\n}\n\nexport async function likeComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to like a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n        const userId = user.uid;\n\n        const likes = commentData.likes || [];\n        const hasLiked = likes.includes(userId);\n\n        await updateDoc(commentRef, {\n            likes: hasLiked ? arrayRemove(userId) : arrayUnion(userId)\n        });\n\n        const updatedSnap = await getDoc(commentRef);\n        const updatedData = updatedSnap.data() as ArticleComment;\n\n        return {\n            success: true,\n            action: hasLiked ? 'unliked' : 'liked',\n            likes: updatedData.likes,\n            count: updatedData.likes.length\n        };\n    } catch (error) {\n        console.error('Error liking comment:', error);\n        throw error;\n    }\n}\n\nexport async function deleteComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n\n        if (commentData.userId !== user.uid) {\n            throw new Error('You can only delete your own comments');\n        }\n\n        await deleteDoc(commentRef);\n\n        return {\n            success: true,\n            message: 'Comment deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting comment:', error);\n        throw error;\n    }\n}\n\n// Delete an article\nexport async function deleteArticle(articleId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleDoc = await getDoc(articleRef);\n\n        if (!articleDoc.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const articleData = articleDoc.data() as Article;\n\n        if (articleData.authorId !== user.uid) {\n            throw new Error('You can only delete your own articles');\n        }\n\n        await deleteDoc(articleRef);\n\n        return {\n            success: true,\n            message: 'Article deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting article:', error);\n        throw error;\n    }\n}\n\n// Get articles by tag\nexport async function getArticlesByTag(tag: string, options: { limit?: number } = {}) {\n    const { limit: queryLimit } = options;\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints: QueryConstraint[] = [\n            where('tags', 'array-contains', tag),\n            where('status', '==', 'published'),\n            orderBy('createdAt', 'desc')\n        ];\n\n        if (queryLimit && queryLimit > 0) {\n            queryConstraints.push(firestoreLimit(queryLimit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            articles.push({\n                id: docSnapshot.id,\n                ...docSnapshot.data()\n            } as Article);\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles by tag:', error);\n        throw error;\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2150, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleWithHighlights.tsx"],"sourcesContent":["'use client'\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { HighlightProvider } from '@/context/HighlightContext';\nimport ArticleHighlights from './ArticleHighlights';\nimport styles from '@/styles/ArticleWithHighlights.module.css';\nimport { getArticleById } from '@/firebase/articles';\n\ninterface ArticleWithHighlightsProps {\n  articleId: string;\n  initialHtml?: string;\n}\n\n/**\n * ArticleWithHighlights\n * \n * Displays an article with highlighting functionality.\n * This component renders HTML content with the highlighting feature.\n */\nconst ArticleWithHighlights: React.FC<ArticleWithHighlightsProps> = ({\n  articleId,\n  initialHtml\n}) => {\n  const [article, setArticle] = useState<{ title: string; body: string } | null>(null);\n  const [isLoading, setIsLoading] = useState(!initialHtml);\n  const [error, setError] = useState('');\n  const articleContainerRef = useRef<HTMLDivElement>(null);\n  \n  // Share handler for highlight sharing\n  const handleShare = (text: string) => {\n    if (navigator.share) {\n      navigator.share({\n        title: article?.title || 'Shared highlight',\n        text: `\"${text}\" - from article ${articleId}`,\n        url: window.location.href\n      }).catch(error => console.error('Error sharing:', error));\n    } else {\n      // Fallback for browsers that don't support navigator.share\n      const shareText = `\"${text}\" - from article ${articleId} ${window.location.href}`;\n      navigator.clipboard.writeText(shareText)\n        .then(() => alert('Highlight copied to clipboard!'))\n        .catch(error => console.error('Error copying to clipboard:', error));\n    }\n  };\n  \n  // Load the article if needed\n  useEffect(() => {\n    if (initialHtml || article) return;\n    \n    const fetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        const articleData = await getArticleById(articleId);\n        \n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n        \n        setArticle({\n          title: articleData.title,\n          body: cleanHtml\n        });\n        \n      } catch (error) {\n        console.error('Error loading article:', error);\n        setError('Failed to load article');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    fetchArticle();\n  }, [articleId, article, initialHtml]);\n\n  // Get the content to display\n  const getContentToDisplay = () => {\n    if (initialHtml) {\n      // Clean HTML content\n      return initialHtml\n        .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n        .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n    }\n    return article?.body || '';\n  };\n\n  if (isLoading) {\n    return (\n      <div className={styles.loadingContainer}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <p className={styles.errorMessage}>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <HighlightProvider articleId={articleId}>\n      <article className={styles.articleContainer}>\n        <ArticleHighlights articleId={articleId} onShare={handleShare}>\n          <div \n            className={styles.articleContent} \n            ref={articleContainerRef}\n            dangerouslySetInnerHTML={{ __html: getContentToDisplay() }}\n          />\n        </ArticleHighlights>\n      </article>\n    </HighlightProvider>\n  );\n};\n\nexport default ArticleWithHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2310, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/comment.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"commentActions\": \"comment-module__H_rXLG__commentActions\",\n  \"commentAvatar\": \"comment-module__H_rXLG__commentAvatar\",\n  \"commentContent\": \"comment-module__H_rXLG__commentContent\",\n  \"commentDate\": \"comment-module__H_rXLG__commentDate\",\n  \"commentDeleteBtn\": \"comment-module__H_rXLG__commentDeleteBtn\",\n  \"commentError\": \"comment-module__H_rXLG__commentError\",\n  \"commentForm\": \"comment-module__H_rXLG__commentForm\",\n  \"commentHeader\": \"comment-module__H_rXLG__commentHeader\",\n  \"commentInput\": \"comment-module__H_rXLG__commentInput\",\n  \"commentInputContainer\": \"comment-module__H_rXLG__commentInputContainer\",\n  \"commentItem\": \"comment-module__H_rXLG__commentItem\",\n  \"commentLikeBtn\": \"comment-module__H_rXLG__commentLikeBtn\",\n  \"commentLoading\": \"comment-module__H_rXLG__commentLoading\",\n  \"commentSection\": \"comment-module__H_rXLG__commentSection\",\n  \"commentSectionTitle\": \"comment-module__H_rXLG__commentSectionTitle\",\n  \"commentSubmit\": \"comment-module__H_rXLG__commentSubmit\",\n  \"commentUser\": \"comment-module__H_rXLG__commentUser\",\n  \"commentsList\": \"comment-module__H_rXLG__commentsList\",\n  \"inThread\": \"comment-module__H_rXLG__inThread\",\n  \"liked\": \"comment-module__H_rXLG__liked\",\n  \"loadingDot\": \"comment-module__H_rXLG__loadingDot\",\n  \"loadingDots\": \"comment-module__H_rXLG__loadingDots\",\n  \"loginButton\": \"comment-module__H_rXLG__loginButton\",\n  \"loginModal\": \"comment-module__H_rXLG__loginModal\",\n  \"loginModalButton\": \"comment-module__H_rXLG__loginModalButton\",\n  \"loginModalButtons\": \"comment-module__H_rXLG__loginModalButtons\",\n  \"loginModalClose\": \"comment-module__H_rXLG__loginModalClose\",\n  \"loginModalOverlay\": \"comment-module__H_rXLG__loginModalOverlay\",\n  \"loginModalText\": \"comment-module__H_rXLG__loginModalText\",\n  \"loginModalTitle\": \"comment-module__H_rXLG__loginModalTitle\",\n  \"loginPromptContainer\": \"comment-module__H_rXLG__loginPromptContainer\",\n  \"noComments\": \"comment-module__H_rXLG__noComments\",\n  \"open\": \"comment-module__H_rXLG__open\",\n  \"primary\": \"comment-module__H_rXLG__primary\",\n  \"pulse\": \"comment-module__H_rXLG__pulse\",\n  \"repliesToggle\": \"comment-module__H_rXLG__repliesToggle\",\n  \"repliesToggleIcon\": \"comment-module__H_rXLG__repliesToggleIcon\",\n  \"replyAvatar\": \"comment-module__H_rXLG__replyAvatar\",\n  \"replyButtons\": \"comment-module__H_rXLG__replyButtons\",\n  \"replyCancel\": \"comment-module__H_rXLG__replyCancel\",\n  \"replyContent\": \"comment-module__H_rXLG__replyContent\",\n  \"replyDate\": \"comment-module__H_rXLG__replyDate\",\n  \"replyForm\": \"comment-module__H_rXLG__replyForm\",\n  \"replyHeader\": \"comment-module__H_rXLG__replyHeader\",\n  \"replyInput\": \"comment-module__H_rXLG__replyInput\",\n  \"replyItem\": \"comment-module__H_rXLG__replyItem\",\n  \"replySection\": \"comment-module__H_rXLG__replySection\",\n  \"replySubmit\": \"comment-module__H_rXLG__replySubmit\",\n  \"replyToggle\": \"comment-module__H_rXLG__replyToggle\",\n  \"replyUser\": \"comment-module__H_rXLG__replyUser\",\n  \"secondary\": \"comment-module__H_rXLG__secondary\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2369, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/CommentSection.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { auth } from '@/firebase/clientApp';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { \n  getArticleComments, \n  addComment, \n  addReply,\n  likeComment,\n  deleteComment,\n  getArticleBySlug,\n  ArticleComment as FirestoreComment,\n  CommentReply as FirestoreReply\n} from '@/firebase/articles';\nimport styles from '@/styles/comment.module.css';\n\ninterface CommentSectionProps {\n  articleId: string;\n  slug?: string; // Keep slug as optional for backward compatibility\n  isComplex?: boolean; // New prop for article type\n}\n\nconst CommentSection: React.FC<CommentSectionProps> = ({ slug, articleId: propArticleId, isComplex }) => {\n  const [comments, setComments] = useState<FirestoreComment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [newComment, setNewComment] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [focusState, setFocusState] = useState(false);\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [replyContent, setReplyContent] = useState('');\n  const [submittingReply, setSubmittingReply] = useState(false);\n  const [expandedReplies, setExpandedReplies] = useState<Record<string, boolean>>({});\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n  const [articleId, setArticleId] = useState<string | null>(propArticleId || null);\n  \n  // This user object will be updated when authenticated\n  const [currentUser, setCurrentUser] = useState({ id: '', name: 'Reader' });\n\n  useEffect(() => {\n    // Check authentication status\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      const isAuth = !!user;\n      setIsAuthenticated(isAuth);\n      \n      if (isAuth && user) {\n        setCurrentUser({\n          id: user.uid,\n          name: user.displayName || user.email?.split('@')[0] || 'User'\n        });\n      } else {\n        setCurrentUser({ id: '', name: 'Reader' });\n      }\n    });\n    \n    return () => unsubscribe();\n  }, []);\n\n  // First, get the article ID from the slug if not provided directly\n  useEffect(() => {\n    if (propArticleId) {\n      setArticleId(propArticleId);\n      return;\n    }\n    \n    if (!slug) return;\n\n    const fetchArticleId = async () => {\n      try {\n        const article = await getArticleBySlug(slug);\n        if (article && article.id) {\n          setArticleId(article.id);\n        }\n      } catch (err) {\n        console.error('Error fetching article:', err);\n        setError('Unable to load article details.');\n      }\n    };\n\n    fetchArticleId();\n  }, [slug, propArticleId]);\n\n  // Then, fetch comments when we have the articleId\n  useEffect(() => {\n    if (!articleId) return;\n    \n    setLoading(true);\n    const fetchComments = async () => {\n      try {\n        const commentsData = await getArticleComments(articleId);\n        \n        // Add a small delay to show loading animation\n        setTimeout(() => {\n          setComments(commentsData);\n          setLoading(false);\n        }, 800);\n      } catch (err) {\n        console.error('Error fetching comments:', err);\n        setError('Unable to load discussions. Please refresh the page to try again.');\n        setLoading(false);\n      }\n    };\n\n    fetchComments();\n  }, [articleId]);\n\n  const handleCommentSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim() || submitting || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      const comment = await addComment(articleId, newComment);\n      setComments(prev => [comment, ...prev]);\n      setNewComment('');\n      setSubmitting(false);\n      setFocusState(false); // Reset focus state after submission\n    } catch (err) {\n      console.error('Error adding comment:', err);\n      setError('Your response could not be posted. Please try again.');\n      setSubmitting(false);\n    }\n  };\n\n  const handleReplySubmit = async (commentId: string) => {\n    if (!replyContent.trim() || submittingReply || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmittingReply(true);\n      const reply = await addReply(articleId, commentId, replyContent);\n      \n      // Update the local state with the new reply\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { \n                ...comment, \n                replies: [...(comment.replies || []), reply]\n              }\n            : comment\n        )\n      );\n      \n      // Reset reply state\n      setReplyContent('');\n      setReplyingTo(null);\n      setSubmittingReply(false);\n      \n      // Ensure replies for this comment are expanded\n      setExpandedReplies(prev => ({\n        ...prev,\n        [commentId]: true\n      }));\n    } catch (err) {\n      console.error('Error adding reply:', err);\n      setSubmittingReply(false);\n    }\n  };\n\n  const handleLikeComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      const result = await likeComment(articleId, commentId);\n      \n      // Update local state\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { ...comment, likes: result.likes } \n            : comment\n        )\n      );\n    } catch (err) {\n      console.error('Error liking comment:', err);\n    }\n  };\n\n  const handleDeleteComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      return;\n    }\n    \n    try {\n      await deleteComment(articleId, commentId);\n      \n      // Remove comment from local state\n      setComments(prev => \n        prev.filter(comment => \n          comment.commentId !== commentId && comment.id !== commentId\n        )\n      );\n    } catch (err) {\n      console.error('Error deleting comment:', err);\n    }\n  };\n\n  const toggleReplies = (commentId: string) => {\n    setExpandedReplies(prev => ({\n      ...prev,\n      [commentId]: !prev[commentId]\n    }));\n  };\n\n  // Helper to format dates\n  const formatDate = (timestamp: any) => {\n    if (!timestamp) return 'Unknown date';\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    const now = new Date();\n    const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n    \n    // For recent dates, use relative time (which is less prone to hydration issues)\n    if (diffInSeconds < 60) {\n      return 'Just now';\n    } else if (diffInSeconds < 3600) {\n      const minutes = Math.floor(diffInSeconds / 60);\n      return `${minutes} ${minutes === 1 ? 'minute' : 'minutes'} ago`;\n    } else if (diffInSeconds < 86400) {\n      const hours = Math.floor(diffInSeconds / 3600);\n      return `${hours} ${hours === 1 ? 'hour' : 'hours'} ago`;\n    } else if (diffInSeconds < 604800) {\n      const days = Math.floor(diffInSeconds / 86400);\n      return `${days} ${days === 1 ? 'day' : 'days'} ago`;\n    } else {\n      // Use consistent UTC timezone and locale for older dates\n      try {\n        const options: Intl.DateTimeFormatOptions = { \n          year: 'numeric', \n          month: 'short', \n          day: 'numeric',\n          timeZone: 'UTC'\n        };\n        \n        return date.toLocaleDateString('en-US', options);\n      } catch (error) {\n        console.error('Error formatting date:', error);\n        return 'Unknown date';\n      }\n    }\n  };\n\n  // Generate a user avatar with initial\n  const getUserAvatar = (name: string, userId: string, isReply = false) => {\n    const initial = name?.charAt(0).toUpperCase() || 'A';\n    const colors = ['#4f46e5', '#0ea5e9', '#10b981', '#f59e0b', '#ef4444'];\n    const colorIndex = userId ? Math.abs(userId.charCodeAt(0) % colors.length) : 0;\n    const bgColor = colors[colorIndex];\n    \n    return (\n      <div \n        className={isReply ? styles.replyAvatar : styles.commentAvatar} \n        style={{ \n          backgroundColor: bgColor, \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center',\n          color: 'white',\n          fontWeight: 'bold',\n          fontSize: isReply ? '0.9rem' : '1.2rem'\n        }}\n      >\n        {initial}\n      </div>\n    );\n  };\n\n  return (\n    <section className={styles.commentSection}>\n      <h2 className={styles.commentSectionTitle}>\n        Join the Discussion\n      </h2>\n      \n      {error && (\n        <div className={styles.commentError}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\n            <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\n          </svg>\n          {error}\n        </div>\n      )}\n      \n      <form className={styles.commentForm} onSubmit={handleCommentSubmit}>\n        <div\n          className={styles.commentInputContainer}\n          style={{ opacity: focusState ? 1 : 0.85 }}\n        >\n          {isAuthenticated ? (\n            <>\n              <div className={styles.commentAvatar}>\n                {getUserAvatar(currentUser.name, currentUser.id)}\n              </div>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Share your thoughts...\"\n                value={newComment}\n                onChange={e => setNewComment(e.target.value)}\n                onFocus={() => setFocusState(true)}\n                onBlur={() => {\n                  if (!newComment.trim()) {\n                    setFocusState(false);\n                  }\n                }}\n              />\n              <button \n                className={styles.commentSubmit}\n                type=\"submit\" \n                disabled={!newComment.trim() || submitting}\n              >\n                {submitting ? 'Posting...' : 'Post'}\n              </button>\n            </>\n          ) : (\n            <div className={styles.loginPromptContainer} onClick={() => setShowLoginPrompt(true)}>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Login to join the discussion...\"\n                disabled\n              />\n              <button\n                className={`${styles.commentSubmit} ${styles.loginButton}`}\n                type=\"button\"\n                onClick={() => setShowLoginPrompt(true)}\n              >\n                Login to comment\n              </button>\n            </div>\n          )}\n        </div>\n      </form>\n\n      {/* Login Prompt Modal */}\n      {showLoginPrompt && (\n        <div className={styles.loginModalOverlay} onClick={() => setShowLoginPrompt(false)}>\n          <div className={styles.loginModal} onClick={e => e.stopPropagation()}>\n            <button className={styles.loginModalClose} onClick={() => setShowLoginPrompt(false)}>×</button>\n            <h3 className={styles.loginModalTitle}>Join the conversation</h3>\n            <p className={styles.loginModalText}>\n              Sign in to Journalite to share your thoughts and join the discussion.\n            </p>\n            <div className={styles.loginModalButtons}>\n              <Link href=\"/login\" className={`${styles.loginModalButton} ${styles.primary}`}>\n                Log In\n              </Link>\n              <Link href=\"/register\" className={`${styles.loginModalButton} ${styles.secondary}`}>\n                Create Account\n              </Link>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {loading ? (\n        <div className={styles.commentLoading}>\n          <p>Loading comments...</p>\n          <div className={styles.loadingDots}>\n            <div className={styles.loadingDot}></div>\n            <div className={styles.loadingDot}></div>\n            <div className={styles.loadingDot}></div>\n          </div>\n        </div>\n      ) : comments.length === 0 ? (\n        <div className={styles.noComments}>\n          Be the first to share your thoughts on this article.\n        </div>\n      ) : (\n        <div className={styles.commentsList}>\n          {comments.map(comment => {\n            const commentId = comment.commentId || comment.id || '';\n            return (\n              <div key={commentId} className={styles.commentItem}>\n                <div className={styles.commentHeader}>\n                  {getUserAvatar(comment.userName, comment.userId)}\n                  <span className={styles.commentUser}>{comment.userName}</span>\n                  <span className={styles.commentDate}>{formatDate(comment.createdAt)}</span>\n                </div>\n                <div className={styles.commentContent}>\n                  {comment.content}\n                </div>\n                <div className={styles.commentActions}>\n                  <button \n                    className={`${styles.commentLikeBtn} ${comment.likes.includes(currentUser.id) ? styles.liked : ''}`}\n                    onClick={() => handleLikeComment(commentId)}\n                    aria-pressed={comment.likes.includes(currentUser.id)}\n                    aria-label={comment.likes.includes(currentUser.id) ? \"Unlike comment\" : \"Like comment\"}\n                  >\n                    {comment.likes.includes(currentUser.id) ? (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-4 h-4\">\n                        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n                      </svg>\n                    ) : (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z\" />\n                      </svg>\n                    )}\n                    <span>{comment.likes.length > 0 ? comment.likes.length : ''}</span>\n                  </button>\n                  \n                  <button \n                    className={styles.replyToggle}\n                    onClick={() => {\n                      if (isAuthenticated) {\n                        setReplyingTo(replyingTo === commentId ? null : commentId);\n                      } else {\n                        setShowLoginPrompt(true);\n                      }\n                    }}\n                    aria-label=\"Reply to comment\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n                    </svg>\n                    <span>Reply</span>\n                  </button>\n                  \n                  {/* Only show delete button for the user's own comments */}\n                  {comment.userId === currentUser.id && (\n                    <button \n                      className={styles.commentDeleteBtn}\n                      onClick={() => handleDeleteComment(commentId)}\n                      aria-label=\"Delete comment\"\n                    >\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\" />\n                      </svg>\n                      <span>Delete</span>\n                    </button>\n                  )}\n                </div>\n                \n                {/* Replies */}\n                {comment.replies && comment.replies.length > 0 && (\n                  <>\n                    <button\n                      className={styles.repliesToggle}\n                      onClick={() => toggleReplies(commentId)}\n                    >\n                      <span className={`${styles.repliesToggleIcon} ${expandedReplies[commentId] ? styles.open : ''}`}>\n                        ▷\n                      </span>\n                      {`${comment.replies.length} ${comment.replies.length === 1 ? 'reply' : 'replies'}`}\n                    </button>\n                    \n                    {expandedReplies[commentId] && (\n                      <div className={styles.replySection}>\n                        {comment.replies.map(reply => (\n                          <div key={reply.replyId} className={styles.replyItem}>\n                            <div className={styles.replyHeader}>\n                              {getUserAvatar(reply.userName, reply.userId, true)}\n                              <span className={styles.replyUser}>{reply.userName}</span>\n                              <span className={styles.replyDate}>{formatDate(reply.createdAt)}</span>\n                            </div>\n                            <div className={styles.replyContent}>\n                              {reply.content}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </>\n                )}\n                \n                {/* Reply form */}\n                {replyingTo === commentId && (\n                  <div className={`${styles.replyForm} ${comment.replies && comment.replies.length > 0 ? styles.inThread : ''}`}>\n                    <textarea\n                      className={styles.replyInput}\n                      placeholder=\"Write a reply...\"\n                      value={replyContent}\n                      onChange={e => setReplyContent(e.target.value)}\n                    />\n                    <div className={styles.replyButtons}>\n                      <button \n                        className={styles.replyCancel}\n                        onClick={() => {\n                          setReplyingTo(null);\n                          setReplyContent('');\n                        }}\n                      >\n                        Cancel\n                      </button>\n                      <button \n                        className={styles.replySubmit}\n                        disabled={!replyContent.trim() || submittingReply}\n                        onClick={() => handleReplySubmit(commentId)}\n                      >\n                        {submittingReply ? 'Posting...' : 'Post Reply'}\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </section>\n  );\n};\n\nexport default CommentSection; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3235, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/schema.js"],"sourcesContent":["import { Schema, DOMParser, DOMSerializer } from 'prosemirror-model';\n\n// Define all nodes manually including list nodes\nconst nodes = {\n    // Document node - the root\n    doc: {\n        content: 'block+'\n    },\n\n    // Text node - inline text content\n    text: {\n        group: 'inline'\n    },\n\n    // Paragraph node - basic block containing inline content\n    paragraph: {\n        content: 'inline*',\n        group: 'block',\n        parseDOM: [{ tag: 'p' }],\n        toDOM() { return ['p', 0] }\n    },\n\n    // Heading node with levels 1-6\n    heading: {\n        attrs: { level: { default: 1 } },\n        content: 'inline*',\n        group: 'block',\n        defining: true,\n        parseDOM: [\n            { tag: 'h1', attrs: { level: 1 } },\n            { tag: 'h2', attrs: { level: 2 } },\n            { tag: 'h3', attrs: { level: 3 } },\n            { tag: 'h4', attrs: { level: 4 } },\n            { tag: 'h5', attrs: { level: 5 } },\n            { tag: 'h6', attrs: { level: 6 } }\n        ],\n        toDOM(node) { return [`h${node.attrs.level}`, 0] }\n    },\n\n    // Hard break node\n    hard_break: {\n        inline: true,\n        group: 'inline',\n        selectable: false,\n        parseDOM: [{ tag: 'br' }],\n        toDOM() { return ['br'] }\n    },\n\n    // Image node with enhanced attributes\n    image: {\n        inline: true,\n        attrs: {\n            src: {},\n            alt: { default: null },\n            title: { default: null },\n            width: { default: null },\n            height: { default: null }\n        },\n        group: 'inline',\n        draggable: true,\n        parseDOM: [\n            {\n                tag: 'img[src]',\n                getAttrs(dom) {\n                    return {\n                        src: dom.getAttribute('src'),\n                        title: dom.getAttribute('title'),\n                        alt: dom.getAttribute('alt'),\n                        width: dom.getAttribute('width'),\n                        height: dom.getAttribute('height')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { src, alt, title, width, height } = node.attrs;\n            const attrs = { src };\n            if (alt != null) attrs.alt = alt;\n            if (title != null) attrs.title = title;\n            if (width != null) attrs.width = width;\n            if (height != null) attrs.height = height;\n            return ['img', attrs];\n        }\n    },\n\n    // Blockquote node\n    blockquote: {\n        content: 'block+',\n        group: 'block',\n        defining: true,\n        parseDOM: [{ tag: 'blockquote' }],\n        toDOM() { return ['blockquote', 0] }\n    },\n\n    // Code block node\n    code_block: {\n        content: 'text*',\n        marks: '',\n        group: 'block',\n        code: true,\n        defining: true,\n        parseDOM: [{ tag: 'pre', preserveWhitespace: 'full' }],\n        toDOM() { return ['pre', ['code', 0]] }\n    },\n\n    // Horizontal rule\n    horizontal_rule: {\n        group: 'block',\n        parseDOM: [{ tag: 'hr' }],\n        toDOM() { return ['hr'] }\n    },\n\n    // List nodes - manually defined to avoid addListNodes issue\n    bullet_list: {\n        content: 'list_item+',\n        group: 'block',\n        parseDOM: [{ tag: 'ul' }],\n        toDOM() { return ['ul', 0] }\n    },\n\n    ordered_list: {\n        content: 'list_item+',\n        group: 'block',\n        attrs: { order: { default: 1 } },\n        parseDOM: [{\n            tag: 'ol',\n            getAttrs(dom) {\n                return { order: dom.hasAttribute('start') ? +dom.getAttribute('start') : 1 }\n            }\n        }],\n        toDOM(node) {\n            return node.attrs.order == 1 ? ['ol', 0] : ['ol', { start: node.attrs.order }, 0]\n        }\n    },\n\n    list_item: {\n        content: 'paragraph block*',\n        parseDOM: [{ tag: 'li' }],\n        toDOM() { return ['li', 0] },\n        defining: true\n    }\n};\n\n// Define marks\nconst marks = {\n    // Strong mark (bold)\n    strong: {\n        parseDOM: [\n            { tag: 'strong' },\n            { tag: 'b', getAttrs: node => node.style.fontWeight != 'normal' && null },\n            { style: 'font-weight', getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null }\n        ],\n        toDOM() { return ['strong', 0] }\n    },\n\n    // Emphasis mark (italic)\n    em: {\n        parseDOM: [\n            { tag: 'i' }, { tag: 'em' },\n            { style: 'font-style=italic' }\n        ],\n        toDOM() { return ['em', 0] }\n    },\n\n    // Code mark (inline code)\n    code: {\n        parseDOM: [{ tag: 'code' }],\n        toDOM() { return ['code', 0] }\n    },\n\n    // Link mark with enhanced attributes\n    link: {\n        attrs: {\n            href: {},\n            title: { default: null },\n            target: { default: null }\n        },\n        inclusive: false,\n        parseDOM: [\n            {\n                tag: 'a[href]',\n                getAttrs(dom) {\n                    return {\n                        href: dom.getAttribute('href'),\n                        title: dom.getAttribute('title'),\n                        target: dom.getAttribute('target')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { href, title, target } = node.attrs;\n            const attrs = { href };\n            if (title != null) attrs.title = title;\n            if (target != null) attrs.target = target;\n            return ['a', attrs, 0];\n        }\n    }\n};\n\n// Create and export the schema\nexport const schema = new Schema({\n    nodes,\n    marks\n});\n\n// Helper function to create an empty document\nexport function createEmptyDocument() {\n    return schema.node('doc', null, [\n        schema.node('paragraph')\n    ]);\n}\n\n// Parse HTML content to ProseMirror document\nexport function parseHTML(html) {\n    if (!html || html.trim() === '') {\n        return createEmptyDocument();\n    }\n\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    return DOMParser.fromSchema(schema).parse(div);\n}\n\n// Serialize ProseMirror document to HTML\nexport function serializeToHTML(doc) {\n    const div = document.createElement('div');\n    div.appendChild(DOMSerializer.fromSchema(schema).serializeFragment(doc.content));\n    return div.innerHTML;\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3631, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commandHelpers.js"],"sourcesContent":["import { liftListItem } from 'prosemirror-schema-list';\n\n/**\n * If the selection is inside a list, lift it out first,\n * then run the real command (cmd).\n */\nexport const withListLift = (cmd, listItemNode) => {\n    return (state, dispatch, view) => {\n        let lifted = false;\n\n        if (liftListItem(listItemNode)(state, dispatch, view)) {\n            // state has changed, pull the fresh state from the view\n            state = view.state;\n            lifted = true;\n        }\n        const ok = cmd(state, dispatch, view);\n        return lifted || ok;\n    };\n}; "],"names":[],"mappings":";;;AAAA;;AAMO,MAAM,eAAe,CAAC,KAAK;IAC9B,OAAO,CAAC,OAAO,UAAU;QACrB,IAAI,SAAS;QAEb,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,cAAc,OAAO,UAAU,OAAO;YACnD,wDAAwD;YACxD,QAAQ,KAAK,KAAK;YAClB,SAAS;QACb;QACA,MAAM,KAAK,IAAI,OAAO,UAAU;QAChC,OAAO,UAAU;IACrB;AACJ","debugId":null}},
    {"offset": {"line": 3654, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commands.js"],"sourcesContent":["import { setBlockType, wrapIn, lift } from 'prosemirror-commands';\nimport { liftListItem } from 'prosemirror-schema-list';\nimport { schema } from './schema.js';\nimport { withListLift } from './commandHelpers.js';\n\nconst { heading, paragraph, list_item, blockquote } = schema.nodes;\n\n/**\n * Heading command that works even when text is inside lists\n * Lifts out of lists first, then applies heading level\n */\nexport const headingCmd = (level) =>\n    withListLift(\n        setBlockType(heading, { level }),\n        list_item\n    );\n\n/**\n * Paragraph command that works even when text is inside lists\n * Lifts out of lists first, then applies paragraph format\n */\nexport const paragraphCmd = () =>\n    withListLift(\n        setBlockType(paragraph),\n        list_item\n    );\n\n/**\n * Toggle block-quote on the current selection:\n *   • if already quoted  → lift out\n *   • otherwise          → wrap in <blockquote>\n * Works on multiple paragraphs and inside lists.\n */\nexport const toggleBlockquote = (state, dispatch, view) => {\n    // 1. If we're *inside* a blockquote anywhere in the selection, lift it out\n    const { from, to } = state.selection;\n    let inQuote = false;\n    state.doc.nodesBetween(from, to, node => {\n        if (node.type === blockquote) {\n            inQuote = true;\n            return false;              // early exit\n        }\n        return true;\n    });\n\n    if (inQuote) {\n        // also lift once if we're inside a list → blockquote → paragraph\n        if (liftListItem(list_item)(state, dispatch)) return true;\n        return lift(state, dispatch);\n    }\n\n    // 2. Otherwise wrap the selection in a new blockquote\n    //    (lift out of list first so the quote sits at top level)\n    if (liftListItem(list_item)(state, dispatch)) {\n        // state has changed; fetch the fresh state from the view\n        state = view.state;\n    }\n    return wrapIn(blockquote)(state, dispatch, view);\n}; "],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,uHAAA,CAAA,SAAM,CAAC,KAAK;AAM3D,MAAM,aAAa,CAAC,QACvB,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,SAAS;QAAE;IAAM,IAC9B;AAOD,MAAM,eAAe,IACxB,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,YACb;AASD,MAAM,mBAAmB,CAAC,OAAO,UAAU;IAC9C,2EAA2E;IAC3E,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,MAAM,SAAS;IACpC,IAAI,UAAU;IACd,MAAM,GAAG,CAAC,YAAY,CAAC,MAAM,IAAI,CAAA;QAC7B,IAAI,KAAK,IAAI,KAAK,YAAY;YAC1B,UAAU;YACV,OAAO,OAAoB,aAAa;QAC5C;QACA,OAAO;IACX;IAEA,IAAI,SAAS;QACT,iEAAiE;QACjE,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW,OAAO;QACrD,OAAO,CAAA,GAAA,wJAAA,CAAA,OAAI,AAAD,EAAE,OAAO;IACvB;IAEA,sDAAsD;IACtD,6DAA6D;IAC7D,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW;QAC1C,yDAAyD;QACzD,QAAQ,KAAK,KAAK;IACtB;IACA,OAAO,CAAA,GAAA,wJAAA,CAAA,SAAM,AAAD,EAAE,YAAY,OAAO,UAAU;AAC/C","debugId":null}},
    {"offset": {"line": 3702, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/exitHeadingPlugin.js"],"sourcesContent":["import { Plugin, PluginKey } from 'prosemirror-state';\nimport { setBlockType } from 'prosemirror-commands';\nimport { schema } from './schema.js';\n\nexport const exitHeadingPlugin = new Plugin({\n    key: new PluginKey('exitHeading'),\n    props: {\n        handleKeyDown(view, event) {\n            if (event.key !== 'Enter' || event.shiftKey) return false;\n\n            const { state, dispatch } = view;\n            const { $from, empty } = state.selection;\n            const { heading, paragraph } = schema.nodes;\n\n            // Only trigger if the cursor is at the *end* of a heading\n            if (\n                empty &&\n                $from.parent.type === heading &&\n                $from.parentOffset === $from.parent.content.size\n            ) {\n                event.preventDefault();           // stop default split behaviour\n                return setBlockType(paragraph)(state, dispatch, view);\n            }\n            return false; // let other handlers run\n        },\n    },\n}); "],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEO,MAAM,oBAAoB,IAAI,qJAAA,CAAA,SAAM,CAAC;IACxC,KAAK,IAAI,qJAAA,CAAA,YAAS,CAAC;IACnB,OAAO;QACH,eAAc,IAAI,EAAE,KAAK;YACrB,IAAI,MAAM,GAAG,KAAK,WAAW,MAAM,QAAQ,EAAE,OAAO;YAEpD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;YAC5B,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS;YACxC,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,GAAG,uHAAA,CAAA,SAAM,CAAC,KAAK;YAE3C,0DAA0D;YAC1D,IACI,SACA,MAAM,MAAM,CAAC,IAAI,KAAK,WACtB,MAAM,YAAY,KAAK,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI,EAClD;gBACE,MAAM,cAAc,IAAc,+BAA+B;gBACjE,OAAO,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,UAAU;YACpD;YACA,OAAO,OAAO,yBAAyB;QAC3C;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 3734, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/plugins.js"],"sourcesContent":["import { history, undo, redo } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { baseKeymap, toggleMark, setBlockType } from 'prosemirror-commands';\nimport {\n    wrapInList,\n    splitListItem,\n    liftListItem,\n    sinkListItem\n} from 'prosemirror-schema-list';\nimport {\n    inputRules,\n    wrappingInputRule,\n    textblockTypeInputRule,\n    smartQuotes,\n    emDash,\n    ellipsis\n} from 'prosemirror-inputrules';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { schema } from './schema.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from './commands.js';\nimport { exitHeadingPlugin } from './exitHeadingPlugin.js';\n\n// Create input rules for automatic formatting\nfunction buildInputRulesPlugin() {\n    console.log('Building input rules plugin...');\n    const rules = [];\n\n    // 1) Smart text rules (quotes, em-dash, ellipsis) - but be more conservative\n    // Only add ellipsis to avoid conflicts with typing\n    rules.push(ellipsis);\n    console.log('Added basic smart text rules');\n\n    // 2) Bullet list: typing \"- \" at start of line (more precise pattern to avoid cursor jumping)\n    const bulletRule = wrappingInputRule(\n        /^([-+*])\\s$/,  // Must be at start of line with space\n        schema.nodes.bullet_list,\n        match => null,\n        (match, node) => ({ tight: true })\n    );\n    rules.push(bulletRule);\n    console.log('Added bullet list rule');\n\n    // 3) Ordered list: typing \"1. \" at start of line (more precise)\n    const orderedRule = wrappingInputRule(\n        /^(\\d+)\\.\\s$/,  // Must be at start of line with space\n        schema.nodes.ordered_list,\n        match => ({ order: +match[1] }),\n        (match, node) => ({ tight: true })\n    );\n    rules.push(orderedRule);\n    console.log('Added ordered list rule');\n\n    // 4) Headings: typing \"#\" to \"######\" followed by space (FIXED: more precise to prevent cursor jumping)\n    const headingRule = textblockTypeInputRule(\n        /^(#{1,6})\\s$/,  // Must be at very start of line followed by space\n        schema.nodes.heading,\n        match => ({ level: match[1].length })\n    );\n    rules.push(headingRule);\n    console.log('Added heading rule');\n\n    // 5) Blockquote: typing \"> \" at start of line (more precise)\n    const blockquoteRule = wrappingInputRule(\n        /^>\\s$/,  // Must be at start of line with space\n        schema.nodes.blockquote\n    );\n    rules.push(blockquoteRule);\n    console.log('Added blockquote rule');\n\n    // 6) Code block: typing \"```\" at start of line (no space needed for this one)\n    const codeRule = textblockTypeInputRule(\n        /^```$/,\n        schema.nodes.code_block\n    );\n    rules.push(codeRule);\n    console.log('Added code block rule');\n\n    console.log('Total input rules created:', rules.length);\n    const plugin = inputRules({ rules });\n    console.log('Input rules plugin created successfully');\n    return plugin;\n}\n\n// Build keymap with common shortcuts\nfunction buildKeymap() {\n    const keys = {\n        ...baseKeymap,\n\n        // Text formatting shortcuts\n        'Mod-b': toggleMark(schema.marks.strong),\n        'Mod-i': toggleMark(schema.marks.em),\n\n        // Block type shortcuts - now using selection-aware commands\n        'Mod-0': paragraphCmd(),\n        'Mod-Shift-1': headingCmd(1),\n        'Mod-Shift-2': headingCmd(2),\n        'Mod-Shift-3': headingCmd(3),\n        'Mod-Shift-4': headingCmd(4),\n        'Mod-Shift-5': headingCmd(5),\n        'Mod-Shift-6': headingCmd(6),\n        'Mod->': toggleBlockquote,          // ⌘/Ctrl + Shift + .\n        'Shift-Ctrl->': toggleBlockquote,   // Windows/Linux variant\n\n        // List shortcuts\n        'Shift-Ctrl-8': wrapInList(schema.nodes.bullet_list),\n        'Shift-Ctrl-9': wrapInList(schema.nodes.ordered_list),\n\n        // Enhanced list item navigation\n        'Enter': splitListItem(schema.nodes.list_item),\n        'Mod-[': liftListItem(schema.nodes.list_item),\n        'Mod-]': sinkListItem(schema.nodes.list_item),\n\n        // Simplified backspace handling\n        'Backspace': (state, dispatch, view) => {\n            const { $from, empty } = state.selection;\n            if (empty && $from.parent.type === schema.nodes.list_item &&\n                $from.parentOffset === 0 && $from.parent.content.size === 0) {\n                if (dispatch) {\n                    const lifted = liftListItem(schema.nodes.list_item)(state, dispatch);\n                    if (!lifted) {\n                        const tr = state.tr;\n                        const range = $from.blockRange();\n                        if (range) {\n                            tr.setBlockType(range.start, range.end, schema.nodes.paragraph);\n                            dispatch(tr);\n                        }\n                    }\n                }\n                return true;\n            }\n            return false; // Fall back to default\n        },\n\n        // History\n        'Mod-z': undo,\n        'Mod-y': redo,\n        'Shift-Mod-z': redo,\n        // REMOVED custom 'Space' handler to let input rules and default behavior manage it.\n    };\n\n    return keymap(keys);\n}\n\n// Create and export the complete plugins array\nexport function createPlugins() {\n    console.log('Creating ProseMirror plugins...');\n\n    const inputRulesPlugin = buildInputRulesPlugin();\n    console.log('Input rules plugin ready');\n\n    const historyPlugin = history();\n    console.log('History plugin ready');\n\n    const keymapPlugin = buildKeymap();\n    console.log('Keymap plugin ready');\n\n    const dropCursorPlugin = dropCursor();\n    console.log('Drop cursor plugin ready');\n\n    const gapCursorPlugin = gapCursor();\n    console.log('Gap cursor plugin ready');\n\n    console.log('Exit heading plugin ready');\n\n    const allPlugins = [\n        // Input rules MUST come before keymap for auto-formatting to work\n        inputRulesPlugin,\n        historyPlugin,\n        keymapPlugin,\n        dropCursorPlugin,\n        gapCursorPlugin,\n        exitHeadingPlugin,\n    ];\n\n    console.log('All plugins created. Total count:', allPlugins.length);\n    return allPlugins;\n}\n\n// Export individual plugins for custom configurations\nexport {\n    buildInputRulesPlugin,\n    buildKeymap\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3883, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/Editor.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"ProseMirror\": \"Editor-module__x7ssIG__ProseMirror\",\n  \"active\": \"Editor-module__x7ssIG__active\",\n  \"editor\": \"Editor-module__x7ssIG__editor\",\n  \"editorContent\": \"Editor-module__x7ssIG__editorContent\",\n  \"keyboardHint\": \"Editor-module__x7ssIG__keyboardHint\",\n  \"loading\": \"Editor-module__x7ssIG__loading\",\n  \"prosemirrorEditor\": \"Editor-module__x7ssIG__prosemirrorEditor\",\n  \"slideInFromTop\": \"Editor-module__x7ssIG__slideInFromTop\",\n  \"toolbar\": \"Editor-module__x7ssIG__toolbar\",\n  \"toolbarButton\": \"Editor-module__x7ssIG__toolbarButton\",\n  \"toolbarGroup\": \"Editor-module__x7ssIG__toolbarGroup\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 3902, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/Editor.jsx"],"sourcesContent":["'use client'\n\n// Import ProseMirror base styles FIRST\nimport 'prosemirror-view/style/prosemirror.css';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { EditorState } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { toggleMark, setBlockType, baseKeymap } from 'prosemirror-commands';\nimport { wrapInList } from 'prosemirror-schema-list';\nimport { undo, redo } from 'prosemirror-history';\nimport { schema, createEmptyDocument, parseHTML, serializeToHTML } from '@/editor/schema.js';\nimport { createPlugins } from '@/editor/plugins.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from '@/editor/commands.js';\nimport styles from '@/styles/Editor.module.css';\n\n/**\n * ProseMirror-based Rich Text Editor\n * \n * A modern, extensible editor built with ProseMirror\n * \n * Props:\n * - articleId: string - Unique identifier for the article\n * - initialContent?: string - JSON string or HTML initial content\n * - onChange?: function - Callback when content changes (content: string, json: any) => void\n * - placeholder?: string - Placeholder text for empty editor\n * - className?: string - Additional CSS classes\n */\nconst Editor = ({\n    articleId,\n    initialContent = '',\n    onChange,\n    placeholder = 'Tell your story...',\n    className = ''\n}) => {\n    const editorRef = useRef(null);\n    const viewRef = useRef(null);\n    const [isReady, setIsReady] = useState(false);\n    const [, forceUpdate] = useState(0);\n\n    // Initialize ProseMirror editor\n    useEffect(() => {\n        // Guard against SSR - ProseMirror needs browser environment\n        if (typeof window === 'undefined') {\n            console.log('Editor: Running on server, skipping initialization');\n            return;\n        }\n\n        console.log('Editor: useEffect running on client');\n        console.log('Editor: editorRef.current:', editorRef.current);\n        console.log('Editor: viewRef.current:', viewRef.current);\n\n        if (!editorRef.current) {\n            console.log('Editor: editorRef.current is null, cannot initialize');\n            return;\n        }\n\n        if (viewRef.current) {\n            console.log('Editor: viewRef.current already exists, skipping');\n            return;\n        }\n\n        try {\n            console.log('Editor: Starting initialization...');\n\n            // Parse initial content\n            let initialDoc;\n            try {\n                if (initialContent) {\n                    // Try to parse as JSON first, then as HTML\n                    if (initialContent.startsWith('{')) {\n                        const jsonDoc = JSON.parse(initialContent);\n                        initialDoc = schema.nodeFromJSON(jsonDoc);\n                    } else {\n                        // Clean HTML and parse\n                        const cleanHtml = initialContent\n                            .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n                            .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n                        initialDoc = parseHTML(cleanHtml);\n                    }\n                } else {\n                    initialDoc = createEmptyDocument();\n                }\n                console.log('Editor: Initial document created successfully');\n            } catch (error) {\n                console.error('Error parsing initial content:', error);\n                initialDoc = createEmptyDocument();\n            }\n\n            // Validate that we have a valid document\n            if (!initialDoc) {\n                console.error('Failed to create initial document');\n                initialDoc = createEmptyDocument();\n            }\n\n            console.log('Editor: Creating editor state...');\n            // Create editor state\n            const state = EditorState.create({\n                doc: initialDoc,\n                plugins: createPlugins()\n            });\n\n            console.log('Editor: Creating editor view...');\n            // Create editor view\n            const view = new EditorView(editorRef.current, {\n                state,\n                dispatchTransaction: (transaction) => {\n                    const newState = view.state.apply(transaction);\n                    view.updateState(newState);\n\n                    // 1) fire onChange only when the *document* changed\n                    if (transaction.docChanged && onChange) {\n                        const html = serializeToHTML(newState.doc);\n                        const json = newState.doc.toJSON();\n                        onChange(html, json);\n                    }\n\n                    // 2) but force a React re-render whenever *either*\n                    //    the document OR the selection changed\n                    if (transaction.docChanged || transaction.selectionSet) {\n                        forceUpdate(v => v + 1);        // <- one line does the trick\n                    }\n                },\n                attributes: {\n                    class: `${styles.prosemirrorEditor} prosemirror-content`,\n                    'data-placeholder': placeholder,\n                    'contenteditable': 'true',\n                    'role': 'textbox',\n                    'aria-multiline': 'true'\n                },\n                editable: () => true,\n                handleDOMEvents: {\n                    // Ensure proper focus handling\n                    focus: (view, event) => {\n                        console.log('Editor focused');\n                        return false; // Let ProseMirror handle it\n                    },\n                    blur: (view, event) => {\n                        console.log('Editor blurred');\n                        return false; // Let ProseMirror handle it\n                    }\n                }\n            });\n\n            console.log('Editor: EditorView created successfully');\n            viewRef.current = view;\n            setIsReady(true);\n            console.log('Editor: setIsReady(true) called - editor should now be visible');\n\n        } catch (error) {\n            console.error('Error initializing editor:', error);\n            console.error('Error details:', error.message, error.stack);\n            // Set ready to true anyway to show the editor, even if there was an error\n            setIsReady(true);\n        }\n\n        // Cleanup function\n        return () => {\n            if (viewRef.current) {\n                console.log('Editor: Cleaning up view');\n                viewRef.current.destroy();\n                viewRef.current = null;\n            }\n        };\n    }, []);\n\n    // Toolbar action handlers - simplified\n    const toggleBold = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        toggleMark(schema.marks.strong)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const toggleItalic = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        toggleMark(schema.marks.em)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const setHeading = useCallback((level) => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        headingCmd(level)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const setParagraph = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        paragraphCmd()(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const setBlockquote = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        toggleBlockquote(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, [forceUpdate]);\n\n    const setCodeBlock = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        setBlockType(schema.nodes.code_block)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const toggleBulletList = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        wrapInList(schema.nodes.bullet_list)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const toggleOrderedList = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        wrapInList(schema.nodes.ordered_list)(state, dispatch, viewRef.current);\n        viewRef.current.focus();\n    }, []);\n\n    const insertImage = useCallback(() => {\n        const url = prompt('Enter image URL:');\n        if (url && viewRef.current) {\n            const { state, dispatch } = viewRef.current;\n            const imageNode = schema.nodes.image.create({ src: url, alt: '' });\n            const transaction = state.tr.replaceSelectionWith(imageNode);\n            dispatch(transaction);\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const undoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        undo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    const redoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        redo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    // Check if a mark or node is active (range-aware for multi-block selections)\n    const isMarkActive = useCallback((markType) => {\n        if (!viewRef.current) return false;\n        const { from, $from, to, empty } = viewRef.current.state.selection;\n        if (empty) {\n            return markType.isInSet(viewRef.current.state.storedMarks || $from.marks());\n        }\n        return viewRef.current.state.doc.rangeHasMark(from, to, markType);\n    }, [forceUpdate]);\n\n    const isBlockActive = useCallback((nodeType, attrs = {}) => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let allMatch = true;\n\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.isTextblock && !node.hasMarkup(nodeType, attrs)) {\n                allMatch = false;\n                return false;          // early exit\n            }\n            return true;\n        });\n        return allMatch;\n    }, [forceUpdate]);\n\n    const isInBlockquote = useCallback(() => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let inQuote = false;\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.type === schema.nodes.blockquote) {\n                inQuote = true;\n                return false;              // early exit\n            }\n            return true;\n        });\n        return inQuote;\n    }, [forceUpdate]);\n\n    return (\n        <div className={`${styles.editor} ${className}`}>\n            {/* Conditionally show toolbar only when ready */}\n            {isReady ? (\n                <div className={styles.toolbar}>\n                    {/* Text formatting */}\n                    <div className={styles.toolbarGroup}>\n                        <button\n                            className={`${styles.toolbarButton} ${isMarkActive(schema.marks.strong) ? styles.active : ''}`}\n                            onClick={toggleBold}\n                            title=\"Bold (⌘/Ctrl+B)\"\n                        >\n                            <strong>B</strong>\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isMarkActive(schema.marks.em) ? styles.active : ''}`}\n                            onClick={toggleItalic}\n                            title=\"Italic (⌘/Ctrl+I)\"\n                        >\n                            <em>I</em>\n                        </button>\n                    </div>\n\n                    {/* Block types */}\n                    <div className={styles.toolbarGroup}>\n                        <button\n                            className={`${styles.toolbarButton} ${isBlockActive(schema.nodes.paragraph) ? styles.active : ''}`}\n                            onClick={setParagraph}\n                            title=\"Paragraph (⌘/Ctrl+0)\"\n                        >\n                            P\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isBlockActive(schema.nodes.heading, { level: 1 }) ? styles.active : ''}`}\n                            onClick={() => setHeading(1)}\n                            title=\"Heading 1 (⌘/Ctrl+Shift+1)\"\n                        >\n                            H1\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isBlockActive(schema.nodes.heading, { level: 2 }) ? styles.active : ''}`}\n                            onClick={() => setHeading(2)}\n                            title=\"Heading 2 (⌘/Ctrl+Shift+2)\"\n                        >\n                            H2\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isBlockActive(schema.nodes.heading, { level: 3 }) ? styles.active : ''}`}\n                            onClick={() => setHeading(3)}\n                            title=\"Heading 3 (⌘/Ctrl+Shift+3)\"\n                        >\n                            H3\n                        </button>\n                    </div>\n\n                    {/* Lists and blocks */}\n                    <div className={styles.toolbarGroup}>\n                        <button\n                            className={styles.toolbarButton}\n                            onClick={toggleBulletList}\n                            title=\"Bullet List\"\n                        >\n                            • List\n                        </button>\n                        <button\n                            className={styles.toolbarButton}\n                            onClick={toggleOrderedList}\n                            title=\"Ordered List\"\n                        >\n                            1. List\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isInBlockquote() ? styles.active : ''}`}\n                            onClick={setBlockquote}\n                            title=\"Blockquote (⌘/Ctrl+>)\"\n                        >\n                            \" Quote\n                        </button>\n                        <button\n                            className={`${styles.toolbarButton} ${isBlockActive(schema.nodes.code_block) ? styles.active : ''}`}\n                            onClick={setCodeBlock}\n                            title=\"Code Block\"\n                        >\n                            &lt;/&gt;\n                        </button>\n                    </div>\n\n                    {/* Media and actions */}\n                    <div className={styles.toolbarGroup}>\n                        <button\n                            className={styles.toolbarButton}\n                            onClick={insertImage}\n                            title=\"Insert Image\"\n                        >\n                            🖼️ Image\n                        </button>\n                    </div>\n\n                    {/* History */}\n                    <div className={styles.toolbarGroup}>\n                        <button\n                            className={styles.toolbarButton}\n                            onClick={undoCommand}\n                            title=\"Undo (⌘/Ctrl+Z)\"\n                        >\n                            ↶ Undo\n                        </button>\n                        <button\n                            className={styles.toolbarButton}\n                            onClick={redoCommand}\n                            title=\"Redo (⌘/Ctrl+Y)\"\n                        >\n                            ↷ Redo\n                        </button>\n                    </div>\n\n                    {/* Keyboard shortcuts hint */}\n                    <div className={styles.keyboardHint}>\n                        <kbd>⌘B</kbd> Bold &nbsp; <kbd>⌘I</kbd> Italic &nbsp; <kbd>⌘⇧1-3</kbd> Headings\n                    </div>\n                </div>\n            ) : (\n                <div className={styles.loading}>Loading editor...</div>\n            )}\n\n            {/* Always render the editor container so the ref can attach */}\n            <div\n                ref={editorRef}\n                className={`ProseMirror ${styles.editorContent}`}\n                aria-label=\"Rich text editor\"\n                style={{\n                    minHeight: '300px',\n                    opacity: isReady ? 1 : 0.5\n                }}\n            />\n        </div>\n    );\n};\n\nexport default Editor; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4338, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleComposer.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actionButton\": \"ArticleComposer-module__UcJHvq__actionButton\",\n  \"actionButtons\": \"ArticleComposer-module__UcJHvq__actionButtons\",\n  \"articleComposer\": \"ArticleComposer-module__UcJHvq__articleComposer\",\n  \"composerContent\": \"ArticleComposer-module__UcJHvq__composerContent\",\n  \"composerHeader\": \"ArticleComposer-module__UcJHvq__composerHeader\",\n  \"composerLoading\": \"ArticleComposer-module__UcJHvq__composerLoading\",\n  \"coverImageInput\": \"ArticleComposer-module__UcJHvq__coverImageInput\",\n  \"coverImagePreview\": \"ArticleComposer-module__UcJHvq__coverImagePreview\",\n  \"editorContainer\": \"ArticleComposer-module__UcJHvq__editorContainer\",\n  \"errorMessage\": \"ArticleComposer-module__UcJHvq__errorMessage\",\n  \"fadeIn\": \"ArticleComposer-module__UcJHvq__fadeIn\",\n  \"imageUrlInput\": \"ArticleComposer-module__UcJHvq__imageUrlInput\",\n  \"loadingIndicator\": \"ArticleComposer-module__UcJHvq__loadingIndicator\",\n  \"logo\": \"ArticleComposer-module__UcJHvq__logo\",\n  \"logoContainer\": \"ArticleComposer-module__UcJHvq__logoContainer\",\n  \"publishButton\": \"ArticleComposer-module__UcJHvq__publishButton\",\n  \"removeTagButton\": \"ArticleComposer-module__UcJHvq__removeTagButton\",\n  \"savedIndicator\": \"ArticleComposer-module__UcJHvq__savedIndicator\",\n  \"spin\": \"ArticleComposer-module__UcJHvq__spin\",\n  \"tag\": \"ArticleComposer-module__UcJHvq__tag\",\n  \"tagContainer\": \"ArticleComposer-module__UcJHvq__tagContainer\",\n  \"tagInput\": \"ArticleComposer-module__UcJHvq__tagInput\",\n  \"titleInput\": \"ArticleComposer-module__UcJHvq__titleInput\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 4369, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleComposer.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { v4 as uuidv4 } from 'uuid';\nimport { createArticle, updateArticle, getArticleById, Article } from '@/firebase/articles';\nimport { auth } from '@/firebase/clientApp';\nimport Editor from './Editor';\nimport styles from '@/styles/ArticleComposer.module.css';\nimport { User } from 'firebase/auth';\n\ninterface ArticleComposerProps {\n  articleId?: string; // Optional - if provided, edit mode, otherwise create mode\n  onUpdateComplete?: (updatedArticle?: Article | null) => void; // Callback when update is complete\n}\n\nconst ArticleComposer: React.FC<ArticleComposerProps> = ({ articleId, onUpdateComplete }) => {\n  const router = useRouter();\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [tags, setTags] = useState<string[]>([]);\n  const [coverImage, setCoverImage] = useState('');\n  const [isPublishing, setIsPublishing] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isSaved, setIsSaved] = useState(false);\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(!!articleId);\n  const [user, setUser] = useState<User | null>(null);\n  const [currentTag, setCurrentTag] = useState('');\n  \n  const titleRef = useRef<HTMLTextAreaElement>(null);\n  const tagInputRef = useRef<HTMLInputElement>(null);\n  \n  // Auto-resize title textarea as content grows\n  const autoResizeTitle = useCallback(() => {\n    if (titleRef.current) {\n      titleRef.current.style.height = 'auto';\n      titleRef.current.style.height = `${titleRef.current.scrollHeight}px`;\n      // Set focus to title if it's empty when component loads\n      if (!title && titleRef.current) {\n        titleRef.current.focus();\n      }\n    }\n  }, [title]);\n  \n  // Set up authentication listener\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setUser(user);\n      if (!user) {\n        // Redirect to login if not authenticated\n        router.push('/login?redirect=compose');\n      }\n    });\n    \n    return () => unsubscribe();\n  }, [router]);\n  \n  // Load article data if in edit mode\n  useEffect(() => {\n    if (articleId && user) {\n      const fetchArticle = async () => {\n        try {\n          setIsLoading(true);\n          const article = await getArticleById(articleId);\n          \n          if (!article) {\n            setError('Article not found');\n            router.push('/');\n            return;\n          }\n          \n          // Verify article ownership\n          if (article.authorId !== user.uid) {\n            setError('You can only edit your own articles');\n            router.push('/');\n            return;\n          }\n          \n          // Set form data\n          setTitle(article.title);\n          \n          // Process HTML to extract and clean the content\n          const cleanContent = article.body.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n          setContent(cleanContent);\n          \n          setTags(article.tags || []);\n          setCoverImage(article.coverImage || '');\n        } catch (error) {\n          console.error('Error loading article:', error);\n          setError('Failed to load article');\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      \n      fetchArticle();\n    } else if (!articleId) {\n      // Editor will start with empty content - no need for document model\n      setIsLoading(false);\n    }\n  }, [articleId, user, router]);\n  \n  // Auto-resize title when it changes\n  useEffect(() => {\n    autoResizeTitle();\n  }, [title, autoResizeTitle]);\n  \n  // Auto-save draft periodically (every 30 seconds)\n  useEffect(() => {\n    let timer: NodeJS.Timeout;\n    \n    if (user && title.trim() && content.trim() && !isSaving && !isPublishing) {\n      timer = setTimeout(() => {\n        saveArticle('drafts');\n      }, 30000);\n    }\n    \n    return () => {\n      if (timer) clearTimeout(timer);\n    };\n  }, [user, title, content, isSaving, isPublishing]);\n  \n  // Handle title changes\n  const handleTitleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setTitle(e.target.value);\n  };\n  \n  // Handle editor content changes with debouncing for better performance\n  const handleEditorChange = useCallback((html: string, json: any) => {\n    // Only update if content has actually changed\n    if (html !== content) {\n      setContent(html);\n      \n      // Reset saved status when content changes\n      if (isSaved) {\n        setIsSaved(false);\n      }\n    }\n  }, [content, isSaved]);\n  \n  // Handle tag input\n  const handleTagInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCurrentTag(e.target.value);\n  };\n  \n  // Handle tag input keydown\n  const handleTagInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter' || e.key === ',') {\n      e.preventDefault();\n      addTag();\n    }\n  };\n  \n  // Add a tag\n  const addTag = () => {\n    const tag = currentTag.trim().toLowerCase();\n    if (tag && !tags.includes(tag) && tags.length < 5) {\n      setTags([...tags, tag]);\n      setCurrentTag('');\n    }\n  };\n  \n  // Remove a tag\n  const removeTag = (tagToRemove: string) => {\n    setTags(tags.filter(tag => tag !== tagToRemove));\n  };\n  \n  // Handle cover image input\n  const handleCoverImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCoverImage(e.target.value);\n  };\n  \n  // Handle focus moving from title to editor\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    // When user presses Enter in the title field, move focus to the editor\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      // Note: The new Editor component will handle its own focus\n      // when the user starts typing in the editor area\n    }\n  };\n  \n  // Save article (draft or published)\n  const saveArticle = async (status: 'drafts' | 'published' = 'drafts') => {\n    if (!user) {\n      setError('You must be logged in to save an article');\n      return;\n    }\n    \n    if (!title.trim()) {\n      setError('Title is required');\n      return;\n    }\n    \n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    try {\n      setIsSaving(true);\n      setError('');\n      \n      // Clean HTML content to avoid any strange formatting\n      const cleanContent = content.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n      \n      const articleData = {\n        title: title.trim(),\n        body: cleanContent,\n        tags,\n        coverImage: coverImage.trim(),\n        status\n      };\n      \n      console.log('Saving article data:', articleData);\n      \n      if (articleId) {\n        try {\n          // Update existing article\n          const updatedArticle = await updateArticle(articleId, articleData);\n          console.log('Article updated successfully:', updatedArticle?.title);\n          \n          // Show saved indicator\n          setIsSaved(true);\n          \n          // Wait a moment for Firebase to fully process the update\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n          // Get the updated article with fresh data\n          const updatedArticleData = await getArticleById(articleId);\n          console.log('Fetched updated article data:', updatedArticleData?.title);\n          \n          // Call the callback if provided, pass the updated article data\n          if (onUpdateComplete) {\n            onUpdateComplete(updatedArticleData);\n          }\n          \n          // THIS IS CRITICAL: Go directly to the article page by ID (not slug) to avoid issues\n          // when title/slug changes\n          setTimeout(() => {\n            console.log('Applying changes immediately and redirecting to article ID page');\n            // Direct navigation to our ID-based view route\n            window.location.href = `/articles/${articleId}/view?updated=true&time=${Date.now()}`;\n            \n            // Add a fallback in case something goes wrong - but use ID-based routing\n            setTimeout(() => {\n              if (window.location.pathname.includes('/edit')) {\n                console.log('Fallback navigation to ID-based article page');\n                window.location.href = `/articles/${articleId}?updated=true&time=${Date.now()}`;\n              }\n            }, 2000);\n          }, 1000);\n        } catch (error) {\n          console.error('Error updating article:', error);\n          setError('Failed to update article. Please try again.');\n          setIsSaved(false);\n        }\n      } else {\n        // Create new article\n        const newArticle = await createArticle(articleData);\n        if (status === 'published') {\n          // Redirect to the new article page\n          router.push(`/articles/${newArticle.id}`);\n        } else {\n          // Redirect to dashboard\n          router.push(`/dashboard`);\n        }\n      }\n      \n    } catch (error) {\n      console.error('Error saving article:', error);\n      setError('Failed to save article. Please try again.');\n    } finally {\n      setIsSaving(false);\n      setIsPublishing(false);\n    }\n  };\n  \n  // Handle publish button click\n  const handlePublish = async () => {\n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    setIsPublishing(true);\n    await saveArticle('published');\n  };\n  \n  // Handle save draft button click\n  const handleSaveDraft = async () => {\n    await saveArticle('drafts');\n  };\n  \n  if (isLoading) {\n    return (\n      <div className={styles.composerLoading}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n  \n  return (\n    <div className={styles.articleComposer}>\n      {/* Header with actions */}\n      <header className={styles.composerHeader}>\n        <div className={styles.logoContainer}>\n          <div className={styles.logo}>Journalite</div>\n        </div>\n        \n        <div className={styles.actionButtons}>\n          {isSaved && (\n            <span className={styles.savedIndicator}>\n              <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"currentColor\">\n                <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\" />\n              </svg>\n              Saved\n            </span>\n          )}\n          \n          <button\n            className={styles.actionButton}\n            onClick={handleSaveDraft}\n            disabled={isSaving || isPublishing}\n          >\n            Save draft\n          </button>\n          \n          <button\n            className={styles.publishButton}\n            onClick={handlePublish}\n            disabled={isSaving || isPublishing || !title.trim() || !content.trim()}\n          >\n            {articleId ? 'Update' : 'Publish'}\n          </button>\n        </div>\n      </header>\n      \n      {/* Main content area */}\n      <main className={styles.composerContent}>\n        {/* Title input */}\n        <textarea\n          ref={titleRef}\n          className={styles.titleInput}\n          value={title}\n          onChange={handleTitleChange}\n          onKeyDown={handleTitleKeyDown}\n          placeholder=\"Title\"\n          rows={1}\n        />\n        \n        {/* Cover image input */}\n        <div className={styles.coverImageInput}>\n          <input\n            type=\"text\"\n            value={coverImage}\n            onChange={handleCoverImageChange}\n            placeholder=\"Add a cover image (enter image URL)\"\n            className={styles.imageUrlInput}\n          />\n          {coverImage && (\n            <div className={styles.coverImagePreview}>\n              <img src={coverImage} alt=\"Cover preview\" />\n            </div>\n          )}\n        </div>\n        \n        {/* Tag input */}\n        <div className={styles.tagContainer}>\n          {tags.map(tag => (\n            <div key={tag} className={styles.tag}>\n              {tag}\n              <button \n                className={styles.removeTagButton} \n                onClick={() => removeTag(tag)}\n                aria-label={`Remove ${tag} tag`}\n              >\n                &times;\n              </button>\n            </div>\n          ))}\n          \n          {tags.length < 5 && (\n            <input\n              ref={tagInputRef}\n              type=\"text\"\n              value={currentTag}\n              onChange={handleTagInputChange}\n              onKeyDown={handleTagInputKeyDown}\n              onBlur={addTag}\n              placeholder={tags.length === 0 ? \"Add up to 5 tags...\" : \"Add another tag...\"}\n              className={styles.tagInput}\n            />\n          )}\n        </div>\n        \n        {/* Error message */}\n        {error && <div className={styles.errorMessage}>{error}</div>}\n        \n        {/* Article editor */}\n        <div className={styles.editorContainer}>\n          <Editor\n            articleId={articleId || uuidv4()}\n            initialContent={content}\n            onChange={handleEditorChange}\n            placeholder=\"Tell your story...\"\n          />\n        </div>\n      </main>\n    </div>\n  );\n};\n\nexport default ArticleComposer; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4895, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/app/articles/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { useSearchParams, useRouter } from 'next/navigation'\nimport { Suspense } from 'react'\nimport styles from '@/styles/home.module.css'\nimport articleStyles from '@/styles/ArticlePage.module.css'\nimport { auth } from '@/firebase/clientApp'\nimport { onAuthStateChanged, signOut } from 'firebase/auth'\nimport MinimalNotificationBell from '@/components/MinimalNotificationBell'\nimport LeftSidebar from '@/components/LeftSidebar'\nimport ArticleWithHighlights from '@/components/ArticleWithHighlights'\nimport CommentSection from '@/components/CommentSection'\nimport ArticleComposer from '@/components/ArticleComposer'\n\n// Import Firestore article service\nimport { getArticleBySlug } from '@/firebase/articles'\n\n// Author mapping from homepage for consistency\nconst authorMapping: { [key: string]: string } = {\n  '84b2f82c-1e93-498a-983e-3b30a8379e63': 'Samuel Green',\n  user_002: 'Alex Martinez',\n  'kristen-lee-id': 'Kristen Lee',\n  'alex-wen-id': 'Alex Wen',\n  'hannah-cole-id': 'Hannah Cole'\n}\n\n// Convert Firestore article to UI format for RenderArticle\n// This adapter should ensure the object passed to RenderArticle has the fields RenderArticle expects.\nconst adaptFirestoreArticle = (firestoreArticle: any): any => { // Using 'any' for return type temporarily due to unknown FirestoreArticle structure\n  const slug = firestoreArticle.slug || (firestoreArticle.title || 'untitled').toLowerCase().replace(/[\\s\\W-]+/g, '-').replace(/^-+|-+$/g, '');\n  const now = new Date().toISOString();\n\n  // Base fields required by RenderArticle's BaseArticleInfo\n  const adapted = {\n    id: firestoreArticle.id || '', // CRITICAL: Ensure 'id' is present\n    _id: firestoreArticle.id || '', // Keep for compatibility if RenderArticle or other parts use it\n    title: firestoreArticle.title || 'Untitled Article',\n    slug: slug,\n    authorId: firestoreArticle.authorId, // Assuming authorId is on FirestoreArticle\n    authorName: firestoreArticle.authorName || 'Unknown Author',\n    coverImageUrl: firestoreArticle.coverImage || null,\n    tags: firestoreArticle.tags || [],\n    likes: firestoreArticle.likes || [],\n    createdAt: firestoreArticle.createdAt ? firestoreArticle.createdAt.toDate().toISOString() : now,\n    updatedAt: firestoreArticle.updatedAt ? firestoreArticle.updatedAt.toDate().toISOString() : now,\n    excerpt: firestoreArticle.excerpt || '',\n\n    // Fields for SimpleArticle vs ComplexArticle differentiation by RenderArticle\n    // RenderArticle will use its type guards (isSimple, isComplex)\n    // We pass both `body` and a potential `content` array if Firestore structure supports it.\n    body: firestoreArticle.body || '', // For SimpleArticle path in RenderArticle\n    content: firestoreArticle.content || undefined, // For ComplexArticle path if 'content' is an array in Firestore\n                                                       // If firestoreArticle.content is not an array, RenderArticle's isComplex will be false.\n    \n    // Other optional fields RenderArticle might use from ComplexArticle type\n    reposts: firestoreArticle.reposts || [],\n    viewCount: firestoreArticle.viewCount || 0,\n  };\n\n  // If firestoreArticle.content is indeed an array of paragraphs, map it.\n  // This specific mapping logic might be too complex for the adapter if FirestoreArticle's content isn't already structured as Paragraph[].\n  // For now, we pass it as is, and RenderArticle's isComplex will determine how to use it or 'body'.\n  // If `firestoreArticle.content` is an array and matches Paragraph structure, it will be used.\n  // Otherwise, RenderArticle's `isSimple` path will likely take over using `adapted.body`.\n\n  return adapted;\n};\n\nfunction Article() {\n  const params = useSearchParams()\n  const router = useRouter()\n  const slug = params?.get('slug')\n  \n  const [article, setArticle] = useState<any>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [tags, setTags] = useState<string[]>([])\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(true)\n  const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false)\n  const [windowWidth, setWindowWidth] = useState(0)\n  const [articleHtml, setArticleHtml] = useState<string | null>(null)\n  const [likes, setLikes] = useState<string[]>([])\n  const [isLiked, setIsLiked] = useState(false)\n  const [currentUser, setCurrentUser] = useState<any>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  \n  // Initialize window width on client side\n  useEffect(() => {\n    setWindowWidth(window.innerWidth)\n    \n    const handleResize = () => {\n      setWindowWidth(window.innerWidth)\n    }\n    \n    window.addEventListener('resize', handleResize)\n    return () => window.removeEventListener('resize', handleResize)\n  }, [])\n  \n  // Check if user is authenticated\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setIsAuthenticated(!!user)\n      setCurrentUser(user)\n      \n      // Check if article is liked by current user\n      if (user && article?.likes) {\n        setIsLiked(article.likes.includes(user.uid))\n      }\n    })\n    \n    return () => unsubscribe()\n  }, [article])\n  \n  // Handle clicks outside the profile menu to close it\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      const profileMenu = document.getElementById('profile-menu');\n      const profileButton = document.getElementById('profile-button');\n      \n      if (profileMenu && !profileMenu.contains(target) && \n          profileButton && !profileButton.contains(target)) {\n        setIsProfileMenuOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n  \n  // Fetch article data\n  useEffect(() => {\n    const fetchArticle = async () => {\n      if (!slug) {\n        setError('No article slug provided')\n        setIsLoading(false)\n        return\n      }\n      \n      try {\n        const articleData = await getArticleBySlug(slug)\n        \n        if (!articleData) {\n          setError('Article not found')\n          setIsLoading(false)\n          return\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '')\n          \n        setArticleHtml(cleanHtml)\n        setLikes(articleData.likes || [])\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length\n        const readTimeMinutes = Math.ceil(wordCount / 200)\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date'\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug\n        })\n        \n        setTags(articleData.tags || [])\n        setIsLoading(false)\n      } catch (error) {\n        console.error('Error fetching article:', error)\n        setError('Failed to load article')\n        setIsLoading(false)\n      }\n    }\n    \n    fetchArticle()\n  }, [slug])\n  \n  const handleSignOut = async () => {\n    try {\n      await signOut(auth)\n      setIsProfileMenuOpen(false)\n    } catch (error) {\n      console.error('Error signing out:', error)\n    }\n  }\n  \n  const toggleSidebar = () => {\n    setIsSidebarCollapsed(!isSidebarCollapsed)\n  }\n\n  const toggleProfileMenu = () => {\n    setIsProfileMenuOpen(!isProfileMenuOpen)\n  }\n  \n  const handleLikeArticle = async () => {\n    if (!currentUser) {\n      alert('Please login to like articles')\n      return\n    }\n    \n    try {\n      if (isLiked) {\n        setLikes(likes.filter(uid => uid !== currentUser.uid))\n        setIsLiked(false)\n      } else {\n        setLikes([...likes, currentUser.uid])\n        setIsLiked(true)\n      }\n      \n      // This is a placeholder - you would call your API here\n      // to update the likes in your database\n    } catch (error) {\n      console.error('Error updating like status:', error)\n    }\n  }\n  \n  if (isLoading) {\n    return (\n      <div className={articleStyles.loadingContainer}>\n        <div className={articleStyles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    )\n  }\n  \n  if (error) {\n    return (\n      <div className={articleStyles.errorContainer}>\n        <p className={articleStyles.errorMessage}>{error}</p>\n      </div>\n    )\n  }\n  \n  // Handle when editing is complete\n  const handleUpdateComplete = () => {\n    console.log('Article update complete');\n    // Set loading state\n    setIsLoading(true);\n    setIsEditing(false);\n    \n    // Use ID-based routing instead of slug to prevent issues when title changes\n    if (article?.id) {\n      window.location.href = `/articles/${article.id}/view?updated=true&t=${Date.now()}`;\n    } else {\n      // Fallback to current page refresh if no ID available\n      window.location.reload();\n    }\n    \n    // Fallback: Refetch the article to show updated content\n    const refetchArticle = async () => {\n      try {\n        const articleData = await getArticleBySlug(slug || '');\n        \n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '')\n          \n        setArticleHtml(cleanHtml);\n        setLikes(articleData.likes || []);\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length;\n        const readTimeMinutes = Math.ceil(wordCount / 200);\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date';\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug || ''\n        });\n        \n        setTags(articleData.tags || []);\n      } catch (error) {\n        console.error('Error refetching article:', error);\n      }\n    };\n    \n    refetchArticle();\n  };\n\n  if (isEditing && article) {\n    return (\n      <div>\n        <div className={articleStyles.editingHeader}>\n          <button onClick={() => setIsEditing(false)} className={articleStyles.cancelButton}>\n            ← Back to Article\n          </button>\n          <h2>Editing: {article.title}</h2>\n        </div>\n        <ArticleComposer articleId={article.id} onUpdateComplete={handleUpdateComplete} />\n      </div>\n    );\n  }\n  \n  return (\n    <div className={articleStyles.articlePageContainer}>\n      {article && (\n        <>\n          <header className={articleStyles.pageHeader}>\n            <div className={articleStyles.headerContainer}>\n              <Link href=\"/\" className={articleStyles.logoLink}>\n                <div className={articleStyles.headerLogo}>Journalite</div>\n              </Link>\n              \n              <div className={articleStyles.headerActions}>\n                {isAuthenticated && <MinimalNotificationBell />}\n                \n                <div className={articleStyles.profileMenu} id=\"profile-menu\">\n                  {isAuthenticated ? (\n                    <>\n                      <div \n                        className={articleStyles.profileCircle} \n                        onClick={toggleProfileMenu}\n                        id=\"profile-button\"\n                      >\n                        {currentUser?.displayName?.charAt(0) || currentUser?.email?.charAt(0) || 'U'}\n                      </div>\n                      \n                      {isProfileMenuOpen && (\n                        <div className={articleStyles.profileDropdown}>\n                          <Link href=\"/\" className={articleStyles.dropdownItem}>Home</Link>\n                          <Link href=\"/my-thoughts\" className={articleStyles.dropdownItem}>My Thoughts</Link>\n                          <Link href=\"/dashboard\" className={articleStyles.dropdownItem}>Dashboard</Link>\n                          <Link href=\"/write\" className={articleStyles.dropdownItem}>Write a story</Link>\n                          <Link href=\"/create-article\" className={articleStyles.dropdownItem}>Create Article</Link>\n                          <Link href=\"/explore\" className={articleStyles.dropdownItem}>Explore</Link>\n                          <Link href=\"/profile\" className={articleStyles.dropdownItem}>Profile</Link>\n                          <Link href=\"/settings\" className={articleStyles.dropdownItem}>Settings</Link>\n                          <button onClick={handleSignOut} className={articleStyles.dropdownItem}>Sign out</button>\n                        </div>\n                      )}\n                    </>\n                  ) : (\n                    <div className={articleStyles.authButtons}>\n                      <Link href=\"/login\" className={articleStyles.loginButton}>\n                        Sign in\n                      </Link>\n                      <Link href=\"/signup\" className={articleStyles.signupButton}>\n                        Get started\n                      </Link>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </header>\n          \n          <div className={articleStyles.pageContainer}>\n            {/* Article header */}\n            <header className={articleStyles.articleHeader}>\n              <h1 className={articleStyles.articleTitle}>{article.title}</h1>\n              \n              <div className={articleStyles.articleMeta}>\n                <div className={articleStyles.authorInfo}>\n                  <div className={articleStyles.authorAvatar}>{article.authorName.charAt(0)}</div>\n                  <div className={articleStyles.authorDetails}>\n                    <Link \n                      href={`/user/${article.authorName.toLowerCase().replace(/\\s+/g, '')}`} \n                      className={articleStyles.authorNameLink}\n                    >\n                      <div className={articleStyles.authorName}>{article.authorName}</div>\n                    </Link>\n                    <div className={articleStyles.articleDetails}>\n                      {article.createdAt} · {article.readTime} min read\n                    </div>\n                  </div>\n                </div>\n                \n                <div className={articleStyles.articleActions}>\n                  <button \n                    className={`${articleStyles.likeButton} ${isLiked ? articleStyles.liked : ''}`}\n                    onClick={handleLikeArticle}\n                    aria-label={isLiked ? 'Unlike article' : 'Like article'}\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill={isLiked ? \"currentColor\" : \"none\"} stroke=\"currentColor\" strokeWidth=\"2\" className={articleStyles.likeIcon}>\n                      <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n                    </svg>\n                    <span>{likes.length > 0 ? likes.length : ''}</span>\n                  </button>\n                  \n                  {isAuthenticated && article.authorId === currentUser?.uid && (\n                    <button \n                      className={articleStyles.editButton}\n                      onClick={() => setIsEditing(true)}\n                    >\n                      Edit\n                    </button>\n                  )}\n                </div>\n              </div>\n              \n              {article.tags && article.tags.length > 0 && (\n                <div className={articleStyles.tagContainer}>\n                  {article.tags.map((tag: string, index: number) => (\n                    <span key={index} className={articleStyles.tag}>{tag}</span>\n                  ))}\n                </div>\n              )}\n            </header>\n            \n            {/* Article content with highlights */}\n            <ArticleWithHighlights \n              articleId={article.id} \n              initialHtml={articleHtml || undefined}\n            />\n            \n            {/* Comments section */}\n            <div className={articleStyles.commentsContainer}>\n              <CommentSection articleId={article.id} />\n            </div>\n            \n            {/* Related tags section */}\n            <aside className={articleStyles.relatedTagsSection}>\n              <h2 className={articleStyles.relatedTagsHeading}>Related Tags</h2>\n              <div className={articleStyles.relatedTagsList}>\n                {tags.map((tag: string) => (\n                  <Link\n                    key={tag}\n                    href={`/tag/${tag.toLowerCase()}`}\n                    className={articleStyles.relatedTag}\n                  >\n                    # {tag}\n                  </Link>\n                ))}\n              </div>\n              \n              <Link href='/write' className={articleStyles.writeButton}>\n                Write\n              </Link>\n            </aside>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default function ArticlePage () {\n  return (\n    <Suspense fallback={<div>Loading article...</div>}>\n      <Article />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}