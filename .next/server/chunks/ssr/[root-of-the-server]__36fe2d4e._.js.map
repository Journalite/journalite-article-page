{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticlePage.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleActions\": \"ArticlePage-module__RPh7Qa__articleActions\",\n  \"articleDetails\": \"ArticlePage-module__RPh7Qa__articleDetails\",\n  \"articleHeader\": \"ArticlePage-module__RPh7Qa__articleHeader\",\n  \"articleMeta\": \"ArticlePage-module__RPh7Qa__articleMeta\",\n  \"articlePageContainer\": \"ArticlePage-module__RPh7Qa__articlePageContainer\",\n  \"articleTitle\": \"ArticlePage-module__RPh7Qa__articleTitle\",\n  \"authButtons\": \"ArticlePage-module__RPh7Qa__authButtons\",\n  \"authorAvatar\": \"ArticlePage-module__RPh7Qa__authorAvatar\",\n  \"authorDetails\": \"ArticlePage-module__RPh7Qa__authorDetails\",\n  \"authorInfo\": \"ArticlePage-module__RPh7Qa__authorInfo\",\n  \"authorName\": \"ArticlePage-module__RPh7Qa__authorName\",\n  \"authorNameLink\": \"ArticlePage-module__RPh7Qa__authorNameLink\",\n  \"cancelButton\": \"ArticlePage-module__RPh7Qa__cancelButton\",\n  \"commentsContainer\": \"ArticlePage-module__RPh7Qa__commentsContainer\",\n  \"dropdownItem\": \"ArticlePage-module__RPh7Qa__dropdownItem\",\n  \"editButton\": \"ArticlePage-module__RPh7Qa__editButton\",\n  \"editingHeader\": \"ArticlePage-module__RPh7Qa__editingHeader\",\n  \"errorContainer\": \"ArticlePage-module__RPh7Qa__errorContainer\",\n  \"errorMessage\": \"ArticlePage-module__RPh7Qa__errorMessage\",\n  \"headerActions\": \"ArticlePage-module__RPh7Qa__headerActions\",\n  \"headerContainer\": \"ArticlePage-module__RPh7Qa__headerContainer\",\n  \"headerLogo\": \"ArticlePage-module__RPh7Qa__headerLogo\",\n  \"likeButton\": \"ArticlePage-module__RPh7Qa__likeButton\",\n  \"likeIcon\": \"ArticlePage-module__RPh7Qa__likeIcon\",\n  \"liked\": \"ArticlePage-module__RPh7Qa__liked\",\n  \"loadingContainer\": \"ArticlePage-module__RPh7Qa__loadingContainer\",\n  \"loadingIndicator\": \"ArticlePage-module__RPh7Qa__loadingIndicator\",\n  \"loginButton\": \"ArticlePage-module__RPh7Qa__loginButton\",\n  \"logoLink\": \"ArticlePage-module__RPh7Qa__logoLink\",\n  \"pageContainer\": \"ArticlePage-module__RPh7Qa__pageContainer\",\n  \"pageHeader\": \"ArticlePage-module__RPh7Qa__pageHeader\",\n  \"profileCircle\": \"ArticlePage-module__RPh7Qa__profileCircle\",\n  \"profileDropdown\": \"ArticlePage-module__RPh7Qa__profileDropdown\",\n  \"profileMenu\": \"ArticlePage-module__RPh7Qa__profileMenu\",\n  \"relatedTag\": \"ArticlePage-module__RPh7Qa__relatedTag\",\n  \"relatedTagsHeading\": \"ArticlePage-module__RPh7Qa__relatedTagsHeading\",\n  \"relatedTagsList\": \"ArticlePage-module__RPh7Qa__relatedTagsList\",\n  \"relatedTagsSection\": \"ArticlePage-module__RPh7Qa__relatedTagsSection\",\n  \"signupButton\": \"ArticlePage-module__RPh7Qa__signupButton\",\n  \"spin\": \"ArticlePage-module__RPh7Qa__spin\",\n  \"tag\": \"ArticlePage-module__RPh7Qa__tag\",\n  \"tagContainer\": \"ArticlePage-module__RPh7Qa__tagContainer\",\n  \"writeButton\": \"ArticlePage-module__RPh7Qa__writeButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/clientApp.ts"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Firebase configuration from environment variables\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n    measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID\n};\n///\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n// Initialize Analytics only in browser environment\nlet analytics;\nif (typeof window !== 'undefined') {\n    try {\n        analytics = getAnalytics(app);\n    } catch (error) {\n        // Analytics initialization skipped in development\n    }\n}\n\n// Initialize Firebase Authentication\nconst auth = getAuth(app);\n\n// Initialize Firestore\nconst db = getFirestore(app);\n\n// Configure custom auth actions URL\nif (typeof window !== 'undefined') {\n    const actionCodeSettings = {\n        url: `${window.location.origin}/reset-password`,\n        handleCodeInApp: true,\n    };\n\n    // We need to update this in the forgot-password component when sending the reset email\n}\n\n// // Connect to Auth Emulator in development\n// if (process.env.NODE_ENV === 'development') {\n//     // connectAuthEmulator(auth, \"http://localhost:9099\", { disableWarnings: true });\n// }\n\n/////\n\nexport { app, analytics, auth, db };"],"names":[],"mappings":"AAAA,uDAAuD;;;;;;;AACvD;AAAA;AACA;AACA;AAAA;AACA;AAAA;;;;;AACA,4DAA4D;AAC5D,iEAAiE;AAEjE,oDAAoD;AACpD,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACjB;AACA,GAAG;AAEH,sBAAsB;AACtB,MAAM,MAAM,CAAA,GAAA,oLAAA,CAAA,gBAAa,AAAD,EAAE;AAE1B,mDAAmD;AACnD,IAAI;AACJ,uCAAmC;;AAMnC;AAEA,qCAAqC;AACrC,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AAErB,uBAAuB;AACvB,MAAM,KAAK,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE;AAExB,oCAAoC;AACpC,uCAAmC;;AAM/B,uFAAuF;AAC3F","debugId":null}},
    {"offset": {"line": 231, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/notifications.ts"],"sourcesContent":["import {\n    collection,\n    addDoc,\n    getDocs,\n    getDoc,\n    doc,\n    query,\n    orderBy,\n    Timestamp,\n    where,\n    updateDoc,\n    deleteDoc,\n    limit\n} from 'firebase/firestore';\nimport { db, auth } from './clientApp';\n\n// Notification interface matching Firestore structure\nexport interface Notification {\n    id?: string;\n    userId: string;\n    type: 'comment' | 'reply' | 'like' | 'follow';\n    read: boolean;\n    sourceId: string; // ID of the article/comment\n    sourceType: 'article' | 'comment' | 'user';\n    message: string;\n    fromUser: {\n        id: string;\n        name: string;\n        username?: string; // Add username field for profile links\n    };\n    createdAt: Timestamp;\n    articleSlug?: string; // Optional slug to link directly to the article\n    articleTitle?: string; // Optional article title for context\n}\n\n/**\n * Create a new notification when someone comments on a user's post\n */\nexport async function createCommentNotification(\n    ownerId: string,\n    articleId: string,\n    articleSlug: string,\n    articleTitle: string,\n    commentId: string,\n    commentText: string\n) {\n    try {\n        // Skip if the owner is the commenter (don't notify yourself)\n        const currentUser = auth.currentUser;\n        if (!currentUser || currentUser.uid === ownerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: ownerId, // Who will receive the notification\n            type: 'comment',\n            read: false,\n            sourceId: commentId,\n            sourceType: 'comment',\n            message: `${currentUser.displayName || 'Someone'} commented on your article: \"${commentText.substring(0, 50)}${commentText.length > 50 ? '...' : ''}\"`,\n            fromUser: {\n                id: currentUser.uid,\n                name: currentUser.displayName || 'Anonymous'\n            },\n            createdAt: Timestamp.now(),\n            articleSlug,\n            articleTitle\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating notification:', error);\n        return null;\n    }\n}\n\n/**\n * Create a new notification when someone follows a user\n */\nexport async function createFollowNotification(\n    targetUserId: string,\n    followerName: string,\n    followerId: string,\n    followerUsername: string\n) {\n    try {\n        // Skip if user is following themselves (shouldn't happen due to checks in followUser)\n        if (targetUserId === followerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: targetUserId, // Who will receive the notification\n            type: 'follow',\n            read: false,\n            sourceId: followerId,\n            sourceType: 'user',\n            message: `${followerName} (@${followerUsername}) started following you`,\n            fromUser: {\n                id: followerId,\n                name: followerName,\n                username: followerUsername\n            },\n            createdAt: Timestamp.now()\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating follow notification:', error);\n        return null;\n    }\n}\n\n/**\n * Get all notifications for the current user\n */\nexport async function getUserNotifications(unreadOnly = false) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        // Create base query\n        const notificationsRef = collection(db, 'notifications');\n        let q;\n\n        if (unreadOnly) {\n            // Only fetch unread notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                where('read', '==', false),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        } else {\n            // Fetch all notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n\n        const notifications: Notification[] = [];\n        querySnapshot.forEach((doc) => {\n            notifications.push({\n                id: doc.id,\n                ...doc.data() as Omit<Notification, 'id'>\n            });\n        });\n\n        return notifications;\n    } catch (error) {\n        console.error('Error fetching notifications:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark a notification as read\n */\nexport async function markNotificationAsRead(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Update the read status\n        await updateDoc(notificationRef, {\n            read: true\n        });\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error marking notification as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark all notifications as read for the current user\n */\nexport async function markAllNotificationsAsRead() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n\n        // Create an array of promises to update each notification\n        const updatePromises = querySnapshot.docs.map(doc =>\n            updateDoc(doc.ref, { read: true })\n        );\n\n        // Execute all updates in parallel\n        await Promise.all(updatePromises);\n\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error('Error marking all notifications as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Delete the notification\n        await deleteDoc(notificationRef);\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error deleting notification:', error);\n        throw error;\n    }\n}\n\n/**\n * Get the count of unread notifications\n */\nexport async function getUnreadNotificationsCount() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            return 0;\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.size;\n    } catch (error) {\n        console.error('Error counting unread notifications:', error);\n        return 0;\n    }\n} "],"names":[],"mappings":";;;;;;;;;AAAA;AAAA;AAcA;;;AAwBO,eAAe,0BAClB,OAAe,EACf,SAAiB,EACjB,WAAmB,EACnB,YAAoB,EACpB,SAAiB,EACjB,WAAmB;IAEnB,IAAI;QACA,6DAA6D;QAC7D,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,eAAe,YAAY,GAAG,KAAK,SAAS;YAC7C,OAAO;QACX;QAEA,6BAA6B;QAC7B,MAAM,eAAyC;YAC3C,QAAQ;YACR,MAAM;YACN,MAAM;YACN,UAAU;YACV,YAAY;YACZ,SAAS,GAAG,YAAY,WAAW,IAAI,UAAU,6BAA6B,EAAE,YAAY,SAAS,CAAC,GAAG,MAAM,YAAY,MAAM,GAAG,KAAK,QAAQ,GAAG,CAAC,CAAC;YACtJ,UAAU;gBACN,IAAI,YAAY,GAAG;gBACnB,MAAM,YAAY,WAAW,IAAI;YACrC;YACA,WAAW,iKAAA,CAAA,YAAS,CAAC,GAAG;YACxB;YACA;QACJ;QAEA,mBAAmB;QACnB,MAAM,SAAS,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE,kBAAkB;QAE7D,OAAO;YACH,IAAI,OAAO,EAAE;YACb,GAAG,YAAY;QACnB;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACX;AACJ;AAKO,eAAe,yBAClB,YAAoB,EACpB,YAAoB,EACpB,UAAkB,EAClB,gBAAwB;IAExB,IAAI;QACA,sFAAsF;QACtF,IAAI,iBAAiB,YAAY;YAC7B,OAAO;QACX;QAEA,6BAA6B;QAC7B,MAAM,eAAyC;YAC3C,QAAQ;YACR,MAAM;YACN,MAAM;YACN,UAAU;YACV,YAAY;YACZ,SAAS,GAAG,aAAa,GAAG,EAAE,iBAAiB,uBAAuB,CAAC;YACvE,UAAU;gBACN,IAAI;gBACJ,MAAM;gBACN,UAAU;YACd;YACA,WAAW,iKAAA,CAAA,YAAS,CAAC,GAAG;QAC5B;QAEA,mBAAmB;QACnB,MAAM,SAAS,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE,kBAAkB;QAE7D,OAAO;YACH,IAAI,OAAO,EAAE;YACb,GAAG,YAAY;QACnB;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO;IACX;AACJ;AAKO,eAAe,qBAAqB,aAAa,KAAK;IACzD,IAAI;QACA,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,oBAAoB;QACpB,MAAM,mBAAmB,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE;QACxC,IAAI;QAEJ,IAAI,YAAY;YACZ,kCAAkC;YAClC,IAAI,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EACJ,kBACA,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM,QACpB,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE,aAAa,SACrB,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE;QAEd,OAAO;YACH,0BAA0B;YAC1B,IAAI,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EACJ,kBACA,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE,aAAa,SACrB,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE;QAEd;QAEA,MAAM,gBAAgB,MAAM,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE;QAEpC,MAAM,gBAAgC,EAAE;QACxC,cAAc,OAAO,CAAC,CAAC;YACnB,cAAc,IAAI,CAAC;gBACf,IAAI,IAAI,EAAE;gBACV,GAAG,IAAI,IAAI,EAAE;YACjB;QACJ;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,MAAM;IACV;AACJ;AAKO,eAAe,uBAAuB,cAAsB;IAC/D,IAAI;QACA,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,kBAAkB,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE,iBAAiB;QACjD,MAAM,mBAAmB,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE;QAEtC,IAAI,CAAC,iBAAiB,MAAM,IAAI;YAC5B,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,iBAAiB,IAAI;QAE9C,wDAAwD;QACxD,IAAI,iBAAiB,MAAM,KAAK,YAAY,GAAG,EAAE;YAC7C,MAAM,IAAI,MAAM;QACpB;QAEA,yBAAyB;QACzB,MAAM,CAAA,GAAA,iKAAA,CAAA,YAAS,AAAD,EAAE,iBAAiB;YAC7B,MAAM;QACV;QAEA,OAAO;YACH,SAAS;QACb;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uCAAuC;QACrD,MAAM;IACV;AACJ;AAKO,eAAe;IAClB,IAAI;QACA,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE;QACxC,MAAM,IAAI,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EACV,kBACA,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM;QAGxB,MAAM,gBAAgB,MAAM,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE;QAEpC,0DAA0D;QAC1D,MAAM,iBAAiB,cAAc,IAAI,CAAC,GAAG,CAAC,CAAA,MAC1C,CAAA,GAAA,iKAAA,CAAA,YAAS,AAAD,EAAE,IAAI,GAAG,EAAE;gBAAE,MAAM;YAAK;QAGpC,kCAAkC;QAClC,MAAM,QAAQ,GAAG,CAAC;QAElB,OAAO;YACH,SAAS;YACT,OAAO,cAAc,IAAI;QAC7B;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,4CAA4C;QAC1D,MAAM;IACV;AACJ;AAKO,eAAe,mBAAmB,cAAsB;IAC3D,IAAI;QACA,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,kBAAkB,CAAA,GAAA,iKAAA,CAAA,MAAG,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE,iBAAiB;QACjD,MAAM,mBAAmB,MAAM,CAAA,GAAA,iKAAA,CAAA,SAAM,AAAD,EAAE;QAEtC,IAAI,CAAC,iBAAiB,MAAM,IAAI;YAC5B,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,iBAAiB,IAAI;QAE9C,wDAAwD;QACxD,IAAI,iBAAiB,MAAM,KAAK,YAAY,GAAG,EAAE;YAC7C,MAAM,IAAI,MAAM;QACpB;QAEA,0BAA0B;QAC1B,MAAM,CAAA,GAAA,iKAAA,CAAA,YAAS,AAAD,EAAE;QAEhB,OAAO;YACH,SAAS;QACb;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,MAAM;IACV;AACJ;AAKO,eAAe;IAClB,IAAI;QACA,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,OAAO;QACX;QAEA,MAAM,mBAAmB,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,4HAAA,CAAA,KAAE,EAAE;QACxC,MAAM,IAAI,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EACV,kBACA,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,iKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM;QAGxB,MAAM,gBAAgB,MAAM,CAAA,GAAA,iKAAA,CAAA,UAAO,AAAD,EAAE;QACpC,OAAO,cAAc,IAAI;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO;IACX;AACJ","debugId":null}},
    {"offset": {"line": 439, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/MinimalNotificationBell.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"badge\": \"MinimalNotificationBell-module__DQnHDG__badge\",\n  \"button\": \"MinimalNotificationBell-module__DQnHDG__button\",\n  \"container\": \"MinimalNotificationBell-module__DQnHDG__container\",\n  \"content\": \"MinimalNotificationBell-module__DQnHDG__content\",\n  \"dot\": \"MinimalNotificationBell-module__DQnHDG__dot\",\n  \"dropdown\": \"MinimalNotificationBell-module__DQnHDG__dropdown\",\n  \"empty\": \"MinimalNotificationBell-module__DQnHDG__empty\",\n  \"footer\": \"MinimalNotificationBell-module__DQnHDG__footer\",\n  \"header\": \"MinimalNotificationBell-module__DQnHDG__header\",\n  \"icon\": \"MinimalNotificationBell-module__DQnHDG__icon\",\n  \"item\": \"MinimalNotificationBell-module__DQnHDG__item\",\n  \"list\": \"MinimalNotificationBell-module__DQnHDG__list\",\n  \"message\": \"MinimalNotificationBell-module__DQnHDG__message\",\n  \"seeMore\": \"MinimalNotificationBell-module__DQnHDG__seeMore\",\n  \"time\": \"MinimalNotificationBell-module__DQnHDG__time\",\n  \"unread\": \"MinimalNotificationBell-module__DQnHDG__unread\",\n  \"viewAll\": \"MinimalNotificationBell-module__DQnHDG__viewAll\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 464, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/MinimalNotificationBell.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef } from 'react'\nimport Link from 'next/link'\nimport { getUnreadNotificationsCount, getUserNotifications, markNotificationAsRead, Notification } from '@/firebase/notifications'\nimport styles from './MinimalNotificationBell.module.css'\n\n/**\n * A minimalistic notification bell component designed for the article page header\n */\nconst MinimalNotificationBell = () => {\n  const [unreadCount, setUnreadCount] = useState<number>(0)\n  const [notifications, setNotifications] = useState<Notification[]>([])\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const notificationRef = useRef<HTMLDivElement>(null)\n\n  // Fetch unread count on mount\n  useEffect(() => {\n    const fetchUnreadCount = async () => {\n      const count = await getUnreadNotificationsCount()\n      setUnreadCount(count)\n    }\n\n    fetchUnreadCount()\n    \n    // Refresh every minute\n    const interval = setInterval(fetchUnreadCount, 60000)\n    return () => clearInterval(interval)\n  }, [])\n\n  // Handle clicks outside the dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (notificationRef.current && !notificationRef.current.contains(event.target as Node)) {\n        setIsOpen(false)\n      }\n    }\n\n    document.addEventListener('mousedown', handleClickOutside)\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [])\n\n  // Fetch notifications when dropdown is opened\n  useEffect(() => {\n    if (isOpen) {\n      fetchNotifications()\n    }\n  }, [isOpen])\n\n  const fetchNotifications = async () => {\n    try {\n      const fetchedNotifications = await getUserNotifications(false)\n      setNotifications(fetchedNotifications)\n    } catch (error) {\n      console.error('Error fetching notifications:', error)\n    }\n  }\n\n  const handleToggle = () => {\n    setIsOpen(!isOpen)\n  }\n\n  const handleNotificationClick = async (notification: Notification) => {\n    try {\n      if (!notification.read && notification.id) {\n        await markNotificationAsRead(notification.id)\n        \n        // Update local state\n        setUnreadCount(prev => Math.max(prev - 1, 0))\n        setNotifications(prev => \n          prev.map(n => \n            n.id === notification.id \n              ? { ...n, read: true } \n              : n\n          )\n        )\n      }\n    } catch (error) {\n      console.error('Error marking notification as read:', error)\n    }\n  }\n\n  const formatTime = (timestamp: any) => {\n    if (!timestamp) return ''\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp)\n    const now = new Date()\n    const diffMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60))\n    \n    if (diffMinutes < 1) return 'Just now'\n    if (diffMinutes < 60) return `${diffMinutes}m ago`\n    \n    const diffHours = Math.floor(diffMinutes / 60)\n    if (diffHours < 24) return `${diffHours}h ago`\n    \n    const diffDays = Math.floor(diffHours / 24)\n    if (diffDays < 7) return `${diffDays}d ago`\n    \n    return date.toLocaleDateString()\n  }\n\n  const getNotificationLink = (notification: Notification) => {\n    if (notification.type === 'follow') {\n      if (notification.fromUser?.username) {\n        return `/user/${notification.fromUser.username}`;\n      }\n      return '/notifications';\n    } else if (notification.articleSlug) {\n      return `/articles?slug=${notification.articleSlug}`;\n    } else {\n      return '/notifications';\n    }\n  }\n\n  return (\n    <div className={styles.container} ref={notificationRef}>\n      <button \n        className={styles.button} \n        onClick={handleToggle}\n        aria-label=\"Notifications\"\n      >\n        <svg \n          className={styles.icon} \n          width=\"20\" \n          height=\"20\" \n          viewBox=\"0 0 24 24\" \n          fill=\"none\" \n          stroke=\"currentColor\" \n          strokeWidth=\"2\" \n          strokeLinecap=\"round\" \n          strokeLinejoin=\"round\"\n        >\n          <path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\"></path>\n          <path d=\"M13.73 21a2 2 0 0 1-3.46 0\"></path>\n        </svg>\n        \n        {unreadCount > 0 && (\n          <span className={styles.badge}>{unreadCount}</span>\n        )}\n      </button>\n      \n      {isOpen && (\n        <div className={styles.dropdown}>\n          <div className={styles.header}>\n            <h3>Notifications</h3>\n            {notifications.length > 0 && (\n              <Link href=\"/notifications\" className={styles.viewAll}>\n                View All\n              </Link>\n            )}\n          </div>\n          \n          <div className={styles.list}>\n            {notifications.length === 0 ? (\n              <div className={styles.empty}>\n                No notifications yet\n              </div>\n            ) : (\n              notifications.slice(0, 5).map((notification) => (\n                <Link \n                  href={getNotificationLink(notification)} \n                  key={notification.id}\n                  className={`${styles.item} ${!notification.read ? styles.unread : ''}`}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className={styles.content}>\n                    <p className={styles.message}>\n                      {notification.message}\n                    </p>\n                    <span className={styles.time}>\n                      {formatTime(notification.createdAt)}\n                    </span>\n                  </div>\n                  {!notification.read && (\n                    <div className={styles.dot}></div>\n                  )}\n                </Link>\n              ))\n            )}\n          </div>\n          \n          {notifications.length > 5 && (\n            <div className={styles.footer}>\n              <Link href=\"/notifications\" className={styles.seeMore}>\n                See more notifications\n              </Link>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default MinimalNotificationBell "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 742, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/highlightService.ts"],"sourcesContent":["import { db } from '@/firebase/clientApp';\nimport {\n    collection,\n    doc,\n    addDoc,\n    getDocs,\n    query,\n    where,\n    deleteDoc,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    serverTimestamp\n} from 'firebase/firestore';\n\nexport type HighlightTag = 'insight' | 'question' | 'quote' | 'important';\n\nexport interface Highlight {\n    id: string;\n    articleId: string;\n    userId: string;\n    text: string;\n    prefix: string;\n    suffix: string;\n    tag: HighlightTag;\n    createdAt: any; // Firestore timestamp\n    comments?: Comment[];\n    reactions?: { [emoji: string]: number };\n    userReactions?: { [userId: string]: string }; // Track which user reacted with what emoji\n}\n\ninterface Comment {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport const saveHighlight = async (\n    articleId: string,\n    userId: string,\n    text: string,\n    prefix: string,\n    suffix: string,\n    tag: HighlightTag = 'insight'\n): Promise<string> => {\n    try {\n        const highlightData = {\n            articleId,\n            userId,\n            text,\n            prefix,\n            suffix,\n            tag,\n            createdAt: serverTimestamp(),\n            comments: [],\n            reactions: {},\n            userReactions: {}\n        };\n\n        const docRef = await addDoc(collection(db, 'highlights'), highlightData);\n        return docRef.id;\n    } catch (error) {\n        console.error('Error saving highlight:', error);\n        throw error;\n    }\n};\n\nexport const getArticleHighlights = async (articleId: string, userId?: string): Promise<Highlight[]> => {\n    try {\n        let q = query(\n            collection(db, 'highlights'),\n            where('articleId', '==', articleId)\n        );\n\n        // If userId is provided, filter by user to make highlights private\n        if (userId) {\n            q = query(\n                collection(db, 'highlights'),\n                where('articleId', '==', articleId),\n                where('userId', '==', userId)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting highlights:', error);\n        return [];\n    }\n};\n\nexport const getUserHighlights = async (userId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('userId', '==', userId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting user highlights:', error);\n        return [];\n    }\n};\n\nexport const deleteHighlight = async (highlightId: string): Promise<void> => {\n    try {\n        await deleteDoc(doc(db, 'highlights', highlightId));\n    } catch (error) {\n        console.error('Error deleting highlight:', error);\n        throw error;\n    }\n};\n\nexport const addCommentToHighlight = async (\n    highlightId: string,\n    userId: string,\n    content: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        const comment = {\n            userId,\n            content,\n            createdAt: new Date().toISOString(),\n        };\n\n        await updateDoc(highlightRef, {\n            comments: arrayUnion(comment)\n        });\n    } catch (error) {\n        console.error('Error adding comment to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeCommentFromHighlight = async (\n    highlightId: string,\n    comment: Comment\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            comments: arrayRemove(comment)\n        });\n    } catch (error) {\n        console.error('Error removing comment from highlight:', error);\n        throw error;\n    }\n};\n\nexport const addReactionToHighlight = async (\n    highlightId: string,\n    userId: string,\n    emoji: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        // Note: This is a simplified approach. In production, you'd want to use a transaction\n        // to ensure consistency when multiple users react simultaneously\n        await updateDoc(highlightRef, {\n            [`reactions.${emoji}`]: (await import('firebase/firestore')).increment(1),\n            [`userReactions.${userId}`]: emoji\n        });\n    } catch (error) {\n        console.error('Error adding reaction to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeReactionFromHighlight = async (\n    highlightId: string,\n    userId: string,\n    emoji: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            [`reactions.${emoji}`]: (await import('firebase/firestore')).increment(-1),\n            [`userReactions.${userId}`]: null\n        });\n    } catch (error) {\n        console.error('Error removing reaction from highlight:', error);\n        throw error;\n    }\n};\n\nexport const generateHighlightShareUrl = (\n    articleSlug: string,\n    highlightId: string,\n    baseUrl: string = typeof window !== 'undefined' ? window.location.origin : ''\n): string => {\n    return `${baseUrl}/articles?slug=${articleSlug}#highlight=${highlightId}`;\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 879, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/context/HighlightContext.tsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { \n  Highlight, \n  HighlightTag,\n  getArticleHighlights, \n  saveHighlight, \n  deleteHighlight \n} from '@/services/highlightService';\n\ninterface HighlightContextType {\n  highlights: Highlight[];\n  loading: boolean;\n  saveHighlight: (text: string, prefix: string, suffix: string, articleId: string, tag: HighlightTag) => Promise<string | null>;\n  removeHighlight: (highlightId: string) => Promise<void>;\n  highlightElement: (range: Range, tag: HighlightTag) => void;\n}\n\nconst HighlightContext = createContext<HighlightContextType | undefined>(undefined);\n\ninterface HighlightProviderProps {\n  children: ReactNode;\n  articleId: string;\n}\n\nexport const HighlightProvider: React.FC<HighlightProviderProps> = ({ children, articleId }) => {\n  const [highlights, setHighlights] = useState<Highlight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Load highlights for the current article (user-specific)\n  useEffect(() => {\n    const loadHighlights = async () => {\n      if (articleId && currentUser) {\n        setLoading(true);\n        try {\n          // Pass user ID to get only current user's highlights\n          const userHighlights = await getArticleHighlights(articleId, currentUser.uid);\n          setHighlights(userHighlights);\n        } catch (error) {\n          console.error('Error loading highlights:', error);\n        } finally {\n          setLoading(false);\n        }\n      } else {\n        // If no user is logged in, clear highlights\n        setHighlights([]);\n        setLoading(false);\n      }\n    };\n\n    loadHighlights();\n  }, [articleId, currentUser]);\n\n  // Save a new highlight\n  const handleSaveHighlight = async (\n    text: string, \n    prefix: string, \n    suffix: string, \n    articleId: string,\n    tag: HighlightTag\n  ): Promise<string | null> => {\n    if (!currentUser) {\n      alert('You must be logged in to highlight text');\n      return null;\n    }\n\n    try {\n      const highlightId = await saveHighlight(\n        articleId,\n        currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        tag\n      );\n\n      // Add the new highlight to state\n      const newHighlight: Highlight = {\n        id: highlightId,\n        articleId,\n        userId: currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        tag,\n        createdAt: new Date(),\n        reactions: {},\n        userReactions: {}\n      };\n\n      setHighlights(prev => [...prev, newHighlight]);\n      return highlightId;\n    } catch (error) {\n      console.error('Error saving highlight:', error);\n      return null;\n    }\n  };\n\n  // Remove a highlight\n  const handleRemoveHighlight = async (highlightId: string): Promise<void> => {\n    try {\n      await deleteHighlight(highlightId);\n      setHighlights(prev => prev.filter(h => h.id !== highlightId));\n    } catch (error) {\n      console.error('Error removing highlight:', error);\n    }\n  };\n\n  // Apply highlight styling to a DOM element with improved range handling\n  const highlightElement = (range: Range, tag: HighlightTag): void => {\n    try {\n      // Get the exact selected text without trimming to preserve formatting\n      const selectedText = range.toString();\n      if (!selectedText) return;\n      \n      // Use the original range without modification to preserve exact selection\n      const highlightMark = document.createElement('mark');\n      highlightMark.className = `article-highlight highlight-${tag}`;\n    \n      // Use a safer approach that preserves text structure\n    try {\n        // Try surrounding contents first\n      range.surroundContents(highlightMark);\n      } catch (error) {\n        // If that fails, try extracting and inserting\n        try {\n          const contents = range.extractContents();\n          highlightMark.appendChild(contents);\n          range.insertNode(highlightMark);\n        } catch (innerError) {\n          // Last resort: clone contents to avoid moving elements\n          const contents = range.cloneContents();\n          highlightMark.appendChild(contents);\n          range.deleteContents();\n          range.insertNode(highlightMark);\n        }\n      }\n      \n      // Clear the selection to prevent UI confusion\n      window.getSelection()?.removeAllRanges();\n      \n    } catch (error) {\n      console.error('Error highlighting range:', error);\n      // Restore selection if highlight fails\n      window.getSelection()?.removeAllRanges();\n      window.getSelection()?.addRange(range);\n    }\n  };\n\n  const contextValue: HighlightContextType = {\n    highlights,\n    loading,\n    saveHighlight: handleSaveHighlight,\n    removeHighlight: handleRemoveHighlight,\n    highlightElement,\n  };\n\n  return (\n    <HighlightContext.Provider value={contextValue}>\n      {children}\n    </HighlightContext.Provider>\n  );\n};\n\nexport const useHighlights = (): HighlightContextType => {\n  const context = useContext(HighlightContext);\n  if (context === undefined) {\n    throw new Error('useHighlights must be used within a HighlightProvider');\n  }\n  return context;\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1033, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/HighlightToolbar.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { HighlightTag } from '@/services/highlightService';\n\ninterface HighlightToolbarProps {\n  selection: Selection | null;\n  onHighlight: (selectedText: string, range: Range, tag: HighlightTag) => void;\n  onResponse?: (selectedText: string) => void;\n  onShare?: (selectedText: string) => void;\n  onAiAssist?: (selectedText: string) => void;\n}\n\nconst highlightTags: { tag: HighlightTag; label: string; color: string; icon: string }[] = [\n  { tag: 'insight', label: 'Insight', color: '#3B82F6', icon: '' },\n  { tag: 'question', label: 'Question', color: '#F59E0B', icon: '' },\n  { tag: 'quote', label: 'Quote', color: '#10B981', icon: '' },\n  { tag: 'important', label: 'Important', color: '#EF4444', icon: '' }\n];\n\nconst HighlightToolbar: React.FC<HighlightToolbarProps> = ({ \n  selection, \n  onHighlight, \n  onResponse, \n  onShare, \n  onAiAssist \n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const [isVisible, setIsVisible] = useState(false);\n  const [showColorOptions, setShowColorOptions] = useState(false);\n  const toolbarRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // Don't show toolbar if no selection or empty selection\n    if (!selection || selection.isCollapsed) {\n      setIsVisible(false);\n      setShowColorOptions(false);\n      return;\n    }\n\n    // Get the selection's bounding rectangle\n    const range = selection.getRangeAt(0);\n    const rect = range.getBoundingClientRect();\n\n    // Get viewport and toolbar dimensions\n    const windowWidth = window.innerWidth;\n    const windowHeight = window.innerHeight;\n    const toolbarWidth = toolbarRef.current?.offsetWidth || 280;\n    const toolbarHeight = toolbarRef.current?.offsetHeight || 40;\n    \n    // Calculate horizontal position (keep within viewport)\n    let left = rect.left + rect.width / 2;\n    const margin = 16; // Margin from screen edges\n    \n    // Ensure toolbar doesn't go off screen horizontally\n    if (left - toolbarWidth / 2 < margin) {\n      left = toolbarWidth / 2 + margin;\n    } else if (left + toolbarWidth / 2 > windowWidth - margin) {\n      left = windowWidth - toolbarWidth / 2 - margin;\n    }\n    \n    // Calculate vertical position\n    let top = rect.top - toolbarHeight - 10 + window.scrollY;\n    \n    // If toolbar would be above viewport, place it below selection\n    if (rect.top - toolbarHeight - 10 < 0) {\n      top = rect.bottom + 10 + window.scrollY;\n    }\n    \n    // Additional mobile-specific adjustments\n    const isMobile = windowWidth <= 768;\n    if (isMobile) {\n      // On mobile, ensure toolbar is always visible\n      const viewportTop = window.scrollY;\n      const viewportBottom = window.scrollY + windowHeight;\n      \n      // If toolbar would be above viewport\n      if (top < viewportTop + margin) {\n        top = viewportTop + margin;\n      }\n      \n      // If toolbar would be below viewport\n      if (top + toolbarHeight > viewportBottom - margin) {\n        top = viewportBottom - toolbarHeight - margin;\n      }\n    }\n\n    setPosition({ top, left });\n    \n    // Show the toolbar\n    setIsVisible(true);\n  }, [selection]);\n\n  // Handle highlighting action with tag\n  const handleHighlight = (tag: HighlightTag) => {\n    if (selection && !selection.isCollapsed) {\n      const range = selection.getRangeAt(0);\n      const selectedText = selection.toString();\n      onHighlight(selectedText, range, tag);\n      // Clear selection after highlighting\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n      setShowColorOptions(false);\n    }\n  };\n\n  // Toggle color options\n  const toggleColorOptions = () => {\n    setShowColorOptions(!showColorOptions);\n  };\n\n  // Handle response action\n  const handleResponse = () => {\n    if (selection && !selection.isCollapsed && onResponse) {\n      const selectedText = selection.toString();\n      onResponse(selectedText);\n      // Clear selection after response\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle share action\n  const handleShare = () => {\n    if (selection && !selection.isCollapsed && onShare) {\n      const selectedText = selection.toString();\n      onShare(selectedText);\n      // Clear selection after share\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle AI assist action\n  const handleAiAssist = () => {\n    if (selection && !selection.isCollapsed && onAiAssist) {\n      const selectedText = selection.toString();\n      onAiAssist(selectedText);\n      // Clear selection after AI assist\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Only render if there's a valid selection and in browser\n  if (!isVisible || typeof window === 'undefined') {\n    return null;\n  }\n\n  // Use portal to render outside of article container\n  return createPortal(\n    <div \n      ref={toolbarRef}\n      className=\"highlight-toolbar\"\n      style={{\n        position: 'absolute',\n        top: `${position.top}px`,\n        left: `${position.left}px`,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n      }}\n    >\n      {!showColorOptions ? (\n        <>\n          <button onClick={toggleColorOptions} className=\"highlight-btn highlight-btn-main\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n              <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\n            </svg>\n            <span>Highlight</span>\n          </button>\n          \n          {onResponse && (\n            <button onClick={handleResponse} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n              </svg>\n              <span>Response</span>\n            </button>\n          )}\n          \n          {onShare && (\n            <button onClick={handleShare} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n                <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n                <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n                <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n                <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n              </svg>\n              <span>Share</span>\n            </button>\n          )}\n          \n          {onAiAssist && (\n            <button onClick={handleAiAssist} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n                <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line>\n                <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line>\n              </svg>\n              <span>Journa AI</span>\n            </button>\n          )}\n        </>\n      ) : (\n        <div className=\"highlight-color-options\">\n          <span className=\"highlight-color-label\">Choose highlight type:</span>\n          {highlightTags.map((tagInfo) => (\n            <button\n              key={tagInfo.tag}\n              onClick={() => handleHighlight(tagInfo.tag)}\n              className=\"highlight-color-btn\"\n              style={{ backgroundColor: tagInfo.color }}\n              title={tagInfo.label}\n            >\n              <span className=\"highlight-icon\">{tagInfo.icon}</span>\n              <span className=\"highlight-label\">{tagInfo.label}</span>\n            </button>\n          ))}\n          <button onClick={toggleColorOptions} className=\"highlight-btn highlight-btn-cancel\">\n            Cancel\n          </button>\n        </div>\n      )}\n    </div>,\n    document.body\n  );\n};\n\nexport default HighlightToolbar; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1189, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ShareModal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport styles from './ShareModal.module.css'; // We will create this CSS module next\nimport { createPortal } from 'react-dom';\n\ninterface ShareModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  highlightText: string;\n  articleTitle: string;\n  shareUrl: string;\n}\n\nconst ShareModal: React.FC<ShareModalProps> = ({\n  isOpen,\n  onClose,\n  highlightText,\n  articleTitle,\n  shareUrl\n}) => {\n  const [copied, setCopied] = useState(false);\n\n  useEffect(() => {\n    if (copied) {\n      const timer = setTimeout(() => setCopied(false), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [copied]);\n\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') onClose();\n    };\n    \n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n      document.body.style.overflow = 'hidden';\n    }\n    \n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n      document.body.style.overflow = 'unset';\n    };\n  }, [isOpen, onClose]);\n\n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n    } catch (error) {\n      console.error('Failed to copy link:', error);\n    }\n  };\n\n  const handleNativeShare = async () => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: `Highlight from \"${articleTitle}\"`,\n          text: `\"${highlightText}\" - from \"${articleTitle}\"`,\n          url: shareUrl,\n        });\n        onClose();\n             } catch (error: any) {\n         if (error.name !== 'AbortError') {\n           console.error('Error sharing:', error);\n         }\n       }\n    }\n  };\n\n  const shareText = `\"${highlightText}\" - from \"${articleTitle}\"`;\n\n  if (!isOpen) return null;\n\n  return createPortal(\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 10000,\n        padding: '1rem'\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          backgroundColor: 'white',\n          borderRadius: '1rem',\n          padding: '2rem',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\n          position: 'relative',\n          animation: 'modalSlideIn 0.3s ease-out'\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Close button */}\n        <button\n          onClick={onClose}\n          style={{\n            position: 'absolute',\n            top: '1rem',\n            right: '1rem',\n            background: 'none',\n            border: 'none',\n            fontSize: '1.5rem',\n            cursor: 'pointer',\n            color: '#6B7280',\n            padding: '0.25rem',\n            borderRadius: '0.375rem',\n            transition: 'color 0.2s ease'\n          }}\n          onMouseOver={(e) => e.currentTarget.style.color = '#374151'}\n          onMouseOut={(e) => e.currentTarget.style.color = '#6B7280'}\n        >\n          \n        </button>\n\n        {/* Header */}\n        <div style={{ marginBottom: '1.5rem' }}>\n          <h3 style={{\n            margin: '0 0 0.5rem 0',\n            fontSize: '1.25rem',\n            fontWeight: '600',\n            color: '#1F2937'\n          }}>\n             Share Highlight\n          </h3>\n          <p style={{\n            margin: 0,\n            color: '#6B7280',\n            fontSize: '0.875rem'\n          }}>\n            Share this highlight from \"{articleTitle}\"\n          </p>\n        </div>\n\n        {/* Preview */}\n        <div style={{\n          backgroundColor: '#F9FAFB',\n          border: '2px solid #E5E7EB',\n          borderRadius: '0.75rem',\n          padding: '1.25rem',\n          marginBottom: '1.5rem'\n        }}>\n          <div style={{\n            fontSize: '1rem',\n            lineHeight: '1.6',\n            color: '#374151',\n            fontStyle: 'italic',\n            marginBottom: '0.75rem'\n          }}>\n            \"{highlightText}\"\n          </div>\n          <div style={{\n            fontSize: '0.875rem',\n            color: '#6B7280',\n            fontWeight: '500'\n          }}>\n             from \"{articleTitle}\"\n          </div>\n        </div>\n\n        {/* Share URL */}\n        <div style={{ marginBottom: '1.5rem' }}>\n          <label style={{\n            display: 'block',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            color: '#374151',\n            marginBottom: '0.5rem'\n          }}>\n            Share Link\n          </label>\n          <div style={{\n            display: 'flex',\n            gap: '0.5rem'\n          }}>\n            <input\n              type=\"text\"\n              value={shareUrl}\n              readOnly\n              style={{\n                flex: 1,\n                padding: '0.75rem',\n                border: '1px solid #D1D5DB',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#F9FAFB',\n                fontFamily: 'monospace'\n              }}\n            />\n            <button\n              onClick={handleCopyLink}\n              style={{\n                padding: '0.75rem 1rem',\n                backgroundColor: copied ? '#10B981' : '#3B82F6',\n                color: 'white',\n                border: 'none',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                fontWeight: '500',\n                cursor: 'pointer',\n                transition: 'all 0.2s ease',\n                whiteSpace: 'nowrap'\n              }}\n            >\n              {copied ? ' Copied!' : ' Copy'}\n            </button>\n          </div>\n        </div>\n\n        {/* Action buttons */}\n        <div style={{\n          display: 'flex',\n          gap: '0.75rem',\n          justifyContent: 'flex-end'\n        }}>\n                     {typeof window !== 'undefined' && typeof navigator !== 'undefined' && 'share' in navigator && (\n            <button\n              onClick={handleNativeShare}\n              style={{\n                padding: '0.75rem 1.5rem',\n                backgroundColor: '#6366F1',\n                color: 'white',\n                border: 'none',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                fontWeight: '500',\n                cursor: 'pointer',\n                transition: 'background-color 0.2s ease',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem'\n              }}\n              onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#5B21B6'}\n              onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#6366F1'}\n            >\n               Share\n            </button>\n          )}\n          \n          <button\n            onClick={onClose}\n            style={{\n              padding: '0.75rem 1.5rem',\n              backgroundColor: '#F3F4F6',\n              color: '#374151',\n              border: 'none',\n              borderRadius: '0.5rem',\n              fontSize: '0.875rem',\n              fontWeight: '500',\n              cursor: 'pointer',\n              transition: 'background-color 0.2s ease'\n            }}\n            onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#E5E7EB'}\n            onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#F3F4F6'}\n          >\n            Close\n          </button>\n        </div>\n      </div>\n\n      <style jsx>{`\n        @keyframes modalSlideIn {\n          from {\n            opacity: 0;\n            transform: translateY(-20px) scale(0.95);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0) scale(1);\n          }\n        }\n      `}</style>\n    </div>,\n    document.body\n  );\n};\n\nexport default ShareModal; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1569, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleHighlights.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport HighlightToolbar from './HighlightToolbar';\nimport { useHighlights } from '@/context/HighlightContext';\nimport { Highlight, HighlightTag, generateHighlightShareUrl } from '@/services/highlightService';\nimport ShareModal from './ShareModal';\n\ninterface ArticleHighlightsProps {\n  articleId: string;\n  children: React.ReactNode;\n  articleTitle?: string;\n  articleSlug?: string;\n  onShare?: (text: string) => void; // Optional share handler\n}\n\n// Get context for a selection with improved handling that preserves formatting\nconst getSelectionContext = (selection: Selection): { prefix: string; suffix: string } => {\n  const result = { prefix: '', suffix: '' };\n  \n  if (!selection || selection.rangeCount === 0) return result;\n  \n  const range = selection.getRangeAt(0);\n  const selectedText = range.toString();\n  \n  // Get the full text content of the container\n  const container = range.commonAncestorContainer;\n  const containerElement = container.nodeType === Node.TEXT_NODE ? container.parentElement : container;\n  \n  if (!containerElement) return result;\n  \n  // Get all text content from the container preserving original formatting\n  const fullText = containerElement.textContent || '';\n  \n  // Find the position of our selected text in the full text (exact match first)\n  let startIndex = fullText.indexOf(selectedText);\n  \n  // If exact match fails, try with normalized spaces as fallback\n  if (startIndex === -1) {\n    const normalizedSelectedText = selectedText.replace(/\\s+/g, ' ').trim();\n    const normalizedFullText = fullText.replace(/\\s+/g, ' ');\n    const normalizedStartIndex = normalizedFullText.indexOf(normalizedSelectedText);\n    \n    if (normalizedStartIndex !== -1) {\n      // Map back to original text position - this is approximate\n      startIndex = normalizedStartIndex;\n    }\n  }\n  \n  if (startIndex !== -1) {\n    // Get context with word boundaries to avoid partial word issues\n    const contextLength = 50;\n    const prefixStart = Math.max(0, startIndex - contextLength);\n    const suffixEnd = Math.min(fullText.length, startIndex + selectedText.length + contextLength);\n    \n    // Extract prefix and suffix preserving original formatting\n    let prefix = fullText.substring(prefixStart, startIndex);\n    let suffix = fullText.substring(startIndex + selectedText.length, suffixEnd);\n    \n    // Only trim word boundaries, not all whitespace\n    prefix = prefix.replace(/^\\S*\\s/, ''); // Remove partial word at start\n    suffix = suffix.replace(/\\s\\S*$/, ''); // Remove partial word at end\n    \n    result.prefix = prefix;\n    result.suffix = suffix;\n  }\n  \n  return result;\n};\n\n// Apply highlights to existing content in the DOM\nconst applyHighlightsToContent = (highlights: any[], articleContent: HTMLElement): void => {\n  if (!highlights || !articleContent) return;\n  \n  // Check if highlights are already applied correctly\n  const existingHighlights = articleContent.querySelectorAll('.article-highlight');\n  const existingHighlightIds = Array.from(existingHighlights).map(el => el.getAttribute('data-highlight-id')).filter(Boolean);\n  const newHighlightIds = highlights.map(h => h.id);\n  \n  // If the same highlights are already applied, don't re-apply\n  if (existingHighlightIds.length === newHighlightIds.length && \n      existingHighlightIds.every(id => newHighlightIds.includes(id))) {\n    return;\n  }\n  \n  // First clear existing highlights to prevent duplicates\n  existingHighlights.forEach(el => {\n    const parent = el.parentNode;\n    if (parent) {\n      // Replace the highlight with its text content\n      const textNode = document.createTextNode(el.textContent || '');\n      parent.replaceChild(textNode, el);\n      // Normalize to merge adjacent text nodes\n      parent.normalize();\n    }\n  });\n  \n  // Track highlights that couldn't be applied for cleanup\n  const failedHighlights: string[] = [];\n  \n  // Then apply all highlights from the database\n  highlights.forEach(highlight => {\n    // Enhanced function to find text in the DOM with better formatting preservation\n    const findTextInDOM = (text: string, prefix: string, suffix: string): Range | null => {\n      \n      // Strategy 1: Try exact text match first (preserves all formatting)\n      const walker = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      let node;\n      while (node = walker.nextNode()) {\n        const content = node.textContent || '';\n        const index = content.indexOf(text);\n        \n        if (index !== -1) {\n          const range = document.createRange();\n          range.setStart(node, index);\n          range.setEnd(node, index + text.length);\n          return range;\n        }\n      }\n      \n      // Strategy 2: Try with relaxed whitespace matching for poetry/formatted text\n      const walker2 = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      // Create a more flexible pattern that accounts for different whitespace\n      const createFlexiblePattern = (str: string): RegExp => {\n        // Escape special regex characters but keep spaces flexible\n        const escaped = str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        // Replace any sequence of whitespace with flexible whitespace matcher\n        const flexible = escaped.replace(/\\s+/g, '\\\\s+');\n        return new RegExp(flexible, 'i');\n      };\n      \n      let node2;\n      while (node2 = walker2.nextNode()) {\n        const content = node2.textContent || '';\n        const flexiblePattern = createFlexiblePattern(text);\n        const match = content.match(flexiblePattern);\n        \n        if (match && match.index !== undefined) {\n          const range = document.createRange();\n          range.setStart(node2, match.index);\n          range.setEnd(node2, match.index + match[0].length);\n          return range;\n        }\n      }\n      \n      // Strategy 3: Try with context if above strategies fail\n      if (prefix || suffix) {\n        const walker3 = document.createTreeWalker(\n          articleContent,\n          NodeFilter.SHOW_TEXT,\n          null\n        );\n        \n        // Create context pattern with flexible whitespace\n        const contextText = prefix + text + suffix;\n        const contextPattern = createFlexiblePattern(contextText);\n        \n        let node3;\n        while (node3 = walker3.nextNode()) {\n          const content = node3.textContent || '';\n          const match = content.match(contextPattern);\n          \n          if (match && match.index !== undefined) {\n            // Find the actual text within the context match\n            const fullMatch = match[0];\n            const prefixPattern = createFlexiblePattern(prefix);\n            const prefixMatch = fullMatch.match(prefixPattern);\n            const prefixLength = prefixMatch ? prefixMatch[0].length : 0;\n            \n            const range = document.createRange();\n            const textStart = match.index + prefixLength;\n            const textPattern = createFlexiblePattern(text);\n            const textInContext = fullMatch.substring(prefixLength);\n            const textMatch = textInContext.match(textPattern);\n            \n            if (textMatch) {\n              range.setStart(node3, textStart);\n              range.setEnd(node3, textStart + textMatch[0].length);\n              return range;\n            }\n          }\n        }\n      }\n      \n      // Strategy 4: Last resort - normalized search (original behavior as fallback)\n      const walker4 = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      const contextPattern = (prefix + text + suffix).replace(/\\s+/g, ' ').trim();\n      \n      let node4;\n      while (node4 = walker4.nextNode()) {\n        const content = node4.textContent || '';\n        const normalizedContent = content.replace(/\\s+/g, ' ');\n        const index = normalizedContent.indexOf(contextPattern);\n        \n        if (index !== -1) {\n          const range = document.createRange();\n          const prefixLength = prefix.replace(/\\s+/g, ' ').trim().length;\n          const startIndex = index + (prefixLength > 0 ? prefixLength + 1 : 0);\n          range.setStart(node4, startIndex);\n          range.setEnd(node4, startIndex + text.replace(/\\s+/g, ' ').trim().length);\n          return range;\n        }\n      }\n      \n      return null;\n    };\n    \n    // Try to find and highlight the text\n    const range = findTextInDOM(highlight.text, highlight.prefix || '', highlight.suffix || '');\n    if (range) {\n      try {\n        // Create highlight mark\n        const mark = document.createElement('mark');\n        mark.className = `article-highlight highlight-${highlight.tag || 'insight'}`;\n        mark.dataset.highlightId = highlight.id;\n        \n        // Apply highlight with better error handling\n        try {\n        range.surroundContents(mark);\n        } catch (surroundError) {\n          // Fallback approach\n          const contents = range.extractContents();\n          mark.appendChild(contents);\n          range.insertNode(mark);\n        }\n        \n        console.log(` Applied highlight \"${highlight.text.substring(0, 30)}...\" with ID: ${highlight.id}`);\n      } catch (error) {\n        console.error('Error applying highlight:', error, {\n          text: highlight.text,\n          id: highlight.id,\n          tag: highlight.tag\n        });\n        failedHighlights.push(highlight.id);\n      }\n    } else {\n      console.warn(` Could not find text for highlight: \"${highlight.text.substring(0, 30)}...\" with ID: ${highlight.id}`);\n      failedHighlights.push(highlight.id);\n    }\n  });\n  \n  // Clean up failed highlights after a few attempts\n  if (failedHighlights.length > 0) {\n    console.log(` Found ${failedHighlights.length} highlights that couldn't be applied. These might be from old text formatting.`);\n    \n    // Store failed highlights in sessionStorage to track across re-renders\n    const storageKey = `failed-highlights-${location.pathname}`;\n    const existingFailed = JSON.parse(sessionStorage.getItem(storageKey) || '{}');\n    \n    failedHighlights.forEach(id => {\n      existingFailed[id] = (existingFailed[id] || 0) + 1;\n    });\n    \n    sessionStorage.setItem(storageKey, JSON.stringify(existingFailed));\n    \n    // If a highlight has failed 3+ times, suggest cleanup\n    const persistentlyFailed = Object.entries(existingFailed)\n      .filter(([_, count]) => (count as number) >= 3)\n      .map(([id]) => id);\n    \n    if (persistentlyFailed.length > 0) {\n      console.log(`  Suggesting cleanup of ${persistentlyFailed.length} persistently failed highlights`);\n      \n      // Show a one-time cleanup notification\n      const notificationShown = sessionStorage.getItem(`cleanup-notification-${location.pathname}`);\n      if (!notificationShown) {\n        // Automatically clean up broken highlights from text format change\n        console.log(' Auto-cleaning broken highlights from text format change...');\n        setTimeout(() => {\n          persistentlyFailed.forEach(async (id) => {\n            try {\n              // We need access to removeHighlight function, so let's emit a custom event\n              const cleanupEvent = new CustomEvent('cleanup-broken-highlight', { \n                detail: { highlightId: id } \n              });\n              window.dispatchEvent(cleanupEvent);\n            } catch (error) {\n              console.error('Failed to cleanup highlight:', id, error);\n            }\n          });\n        }, 1000);\n        \n        sessionStorage.setItem(`cleanup-notification-${location.pathname}`, 'shown');\n      }\n    }\n  }\n};\n\nconst ArticleHighlights: React.FC<ArticleHighlightsProps> = ({ articleId, children, articleTitle = 'Article', articleSlug = '', onShare }) => {\n  const [selection, setSelection] = useState<Selection | null>(null);\n  const { highlights, saveHighlight, removeHighlight, highlightElement } = useHighlights();\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\n  const [showResponseModal, setShowResponseModal] = useState(false);\n  const [selectedTextForResponse, setSelectedTextForResponse] = useState('');\n  const [showAiModal, setShowAiModal] = useState(false);\n  const [selectedTextForAi, setSelectedTextForAi] = useState('');\n  const [activeHighlight, setActiveHighlight] = useState<{ id: string, text: string } | null>(null);\n  const [showUnhighlightToolbar, setShowUnhighlightToolbar] = useState(false);\n  const [isHidingToolbar, setIsHidingToolbar] = useState(false);\n  const [unhighlightPosition, setUnhighlightPosition] = useState({ top: 0, left: 0 });\n  const [showShareModal, setShowShareModal] = useState(false);\n  const [shareHighlightText, setShareHighlightText] = useState('');\n  \n  // Function to hide toolbar with animation\n  const hideToolbarWithAnimation = useCallback(() => {\n    setIsHidingToolbar(true);\n    // After animation completes, actually hide the toolbar\n    setTimeout(() => {\n      setShowUnhighlightToolbar(false);\n      setIsHidingToolbar(false);\n    }, 150); // Match this with CSS transition duration\n  }, []);\n  \n  // Handle text selection with mobile-specific improvements\n  const handleSelection = useCallback(() => {\n    // If unhighlight toolbar is active, don't process regular selections\n    if (showUnhighlightToolbar) return;\n    \n    // Add a small delay to ensure selection is stable on mobile\n    setTimeout(() => {\n    const currentSelection = window.getSelection();\n      if (currentSelection && !currentSelection.isCollapsed) {\n        const selectedText = currentSelection.toString();\n        const trimmedText = selectedText.trim();\n        \n        // Filter out selections that are too long (likely accidental)\n        if (trimmedText && trimmedText.length > 0 && selectedText.length < 1000) {\n          // Check if selection is within our article content\n          const range = currentSelection.getRangeAt(0);\n          const container = range.commonAncestorContainer;\n          const articleContainer = container.nodeType === Node.TEXT_NODE \n            ? container.parentElement?.closest('.article-highlight-container')\n            : (container as Element)?.closest('.article-highlight-container');\n          \n          if (articleContainer) {\n      setSelection(currentSelection);\n    } else {\n      setSelection(null);\n    }\n        } else {\n          setSelection(null);\n        }\n      } else {\n        setSelection(null);\n      }\n    }, 100); // Short delay for mobile stability\n  }, [showUnhighlightToolbar]);\n  \n  // Handle highlight button click\n  const handleHighlight = useCallback((selectedText: string, range: Range, tag: HighlightTag) => {\n    if (selectedText && range) {\n      // Get context for the selection\n      const context = getSelectionContext(window.getSelection()!);\n      \n      // Save highlight to database with tag (preserve original formatting)\n      saveHighlight(\n        selectedText, // Don't trim - preserve exact formatting including line breaks\n        context.prefix,\n        context.suffix,\n        articleId,\n        tag\n      );\n      \n      // Apply highlight visually with tag-based styling\n      highlightElement(range, tag);\n    }\n  }, [articleId, saveHighlight, highlightElement]);\n  \n  // Handle highlight click to show unhighlight option\n  const handleHighlightClick = useCallback((e: MouseEvent) => {\n    // Check if click is on a highlight\n    const target = e.target as HTMLElement;\n    if (target.classList.contains('article-highlight')) {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // Get highlight info\n      const highlightId = target.dataset.highlightId;\n      const highlightText = target.textContent || '';\n      \n      if (highlightId) {\n        // Reset hiding state if it was set\n        setIsHidingToolbar(false);\n        \n        // Set active highlight\n        setActiveHighlight({ id: highlightId, text: highlightText });\n        \n        // Position unhighlight toolbar near the highlight\n        const rect = target.getBoundingClientRect();\n        setUnhighlightPosition({\n          top: rect.top - 40 + window.scrollY, // Position above the highlight\n          left: rect.left + rect.width / 2\n        });\n        \n        // Show unhighlight toolbar\n        setShowUnhighlightToolbar(true);\n        \n        // Hide regular selection toolbar if visible\n        setSelection(null);\n      }\n    } else {\n      // If clicking elsewhere, hide unhighlight toolbar with animation\n      if (showUnhighlightToolbar) {\n        hideToolbarWithAnimation();\n        setActiveHighlight(null);\n      }\n    }\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Handle unhighlight action\n  const handleUnhighlight = useCallback(() => {\n    if (activeHighlight && activeHighlight.id) {\n      // Start the hiding animation\n      hideToolbarWithAnimation();\n      \n      // Store the ID before resetting the active highlight\n      const highlightId = activeHighlight.id;\n      \n      // Reset active highlight state\n      setActiveHighlight(null);\n      \n      // Remove highlight from database\n      removeHighlight(highlightId);\n      \n      // Find and remove highlight from DOM\n      if (contentRef) {\n        const highlightEl = contentRef.querySelector(`[data-highlight-id=\"${highlightId}\"]`);\n        if (highlightEl && highlightEl.parentNode) {\n          const textNode = document.createTextNode(highlightEl.textContent || '');\n          highlightEl.parentNode.replaceChild(textNode, highlightEl);\n          highlightEl.parentNode.normalize();\n        }\n      }\n    }\n  }, [activeHighlight, removeHighlight, contentRef, hideToolbarWithAnimation]);\n  \n  // Handle response button click\n  const handleResponse = useCallback((selectedText: string) => {\n    setSelectedTextForResponse(selectedText);\n    setShowResponseModal(true);\n  }, []);\n\n  // Handle share button click\n  const handleShare = useCallback((selectedText: string) => {\n    setShareHighlightText(selectedText);\n    setShowShareModal(true);\n  }, []);\n\n  // Handle AI assist button click\n  const handleAiAssist = useCallback((selectedText: string) => {\n    setSelectedTextForAi(selectedText);\n    setShowAiModal(true);\n  }, []);\n  \n  // Set up selection event listener with mobile improvements\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelection);\n    \n    // Additional mobile touch handling\n    const handleTouchEnd = () => {\n      // Small delay to ensure selection is finalized\n      setTimeout(handleSelection, 150);\n    };\n    \n    // Only add touch handlers on mobile devices\n    if ('ontouchstart' in window) {\n      document.addEventListener('touchend', handleTouchEnd);\n    }\n    \n    return () => {\n      document.removeEventListener('selectionchange', handleSelection);\n      if ('ontouchstart' in window) {\n        document.removeEventListener('touchend', handleTouchEnd);\n      }\n    };\n  }, [handleSelection]);\n  \n  // Set up click listener for highlights\n  useEffect(() => {\n    if (contentRef) {\n      contentRef.addEventListener('click', handleHighlightClick as EventListener);\n      \n      return () => {\n        contentRef.removeEventListener('click', handleHighlightClick as EventListener);\n      };\n    }\n  }, [contentRef, handleHighlightClick]);\n  \n  // Add click listener to document to hide unhighlight toolbar when clicking outside\n  useEffect(() => {\n    const handleDocumentClick = (e: MouseEvent) => {\n      if (showUnhighlightToolbar) {\n        const target = e.target as HTMLElement;\n        if (!target.closest('.highlight-toolbar') && \n            !target.classList.contains('article-highlight')) {\n          hideToolbarWithAnimation();\n          setActiveHighlight(null);\n        }\n      }\n    };\n    \n    document.addEventListener('click', handleDocumentClick);\n    \n    return () => {\n      document.removeEventListener('click', handleDocumentClick);\n    };\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Apply highlights from database when they change\n  useEffect(() => {\n    if (contentRef) {\n      // Always try to apply highlights, even if array is empty (for cleanup)\n      const timeoutId = setTimeout(() => {\n        console.log(` Applying ${highlights.length} highlights to content`);\n      applyHighlightsToContent(highlights, contentRef);\n      }, 100); // Increased delay for better stability\n      \n      return () => clearTimeout(timeoutId);\n    }\n  }, [highlights, contentRef]);\n  \n  // Listen for cleanup events\n  useEffect(() => {\n    const handleCleanupEvent = (event: CustomEvent) => {\n      const highlightId = event.detail?.highlightId;\n      if (highlightId) {\n        console.log(` Cleaning up broken highlight: ${highlightId}`);\n        removeHighlight(highlightId);\n      }\n    };\n    \n    window.addEventListener('cleanup-broken-highlight', handleCleanupEvent as EventListener);\n    \n    return () => {\n      window.removeEventListener('cleanup-broken-highlight', handleCleanupEvent as EventListener);\n    };\n  }, [removeHighlight]);\n  \n  // Get ref to content element\n  const setRef = useCallback((node: HTMLElement | null) => {\n    if (node && node !== contentRef) {\n      setContentRef(node);\n    }\n  }, [contentRef]);\n  \n  return (\n    <>\n      {/* Toolbar for highlighting */}\n      <HighlightToolbar \n        selection={selection} \n        onHighlight={handleHighlight} \n        onResponse={handleResponse}\n        onShare={handleShare}\n        onAiAssist={handleAiAssist}\n      />\n      \n      {/* Unhighlight toolbar */}\n      {showUnhighlightToolbar && activeHighlight && (\n        <div \n          className={`highlight-toolbar unhighlight-toolbar ${isHidingToolbar ? 'hiding' : ''}`}\n          style={{\n            position: 'absolute',\n            top: `${unhighlightPosition.top}px`,\n            left: `${unhighlightPosition.left}px`,\n            transform: isHidingToolbar ? 'translateY(-10px) translateX(-50%)' : 'translateX(-50%)',\n            zIndex: 1000,\n          }}\n        >\n          <button onClick={handleUnhighlight} className=\"highlight-btn highlight-btn-danger\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z\"></path>\n              <line x1=\"18\" y1=\"9\" x2=\"12\" y2=\"15\"></line>\n              <line x1=\"12\" y1=\"9\" x2=\"18\" y2=\"15\"></line>\n            </svg>\n            <span>Unhighlight</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleShare(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n              <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n              <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n              <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n              <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n            </svg>\n            <span>Share</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleResponse(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n            </svg>\n            <span>Response</span>\n          </button>\n        </div>\n      )}\n      \n      {/* Content with ref for highlight application */}\n      <div ref={setRef} className=\"article-highlight-container\">\n        {children}\n      </div>\n      \n      {/* Response Modal - placeholder for implementation */}\n      {showResponseModal && (\n        <div className=\"highlight-response-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowResponseModal(false)}\n            >\n              \n            </button>\n            <h3>Respond to highlighted text</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForResponse}\"</div>\n            <textarea \n              className=\"highlight-response-input\" \n              placeholder=\"Write your response...\"\n            ></textarea>\n            <button className=\"highlight-response-submit\">Submit</button>\n          </div>\n        </div>\n      )}\n      \n      {/* Journa AI Modal - placeholder for implementation */}\n      {showAiModal && (\n        <div className=\"highlight-ai-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowAiModal(false)}\n            >\n              \n            </button>\n            <h3>Journa AI</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForAi}\"</div>\n            <div className=\"highlight-ai-options\">\n              <button>Explain this</button>\n              <button>Fact check</button>\n              <button>Provide context</button>\n              <button>Summarize</button>\n            </div>\n            <div className=\"highlight-ai-response\">\n              {/* AI response would appear here */}\n              <div className=\"highlight-ai-loading\">Journa AI is thinking...</div>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Share Modal */}\n      {showShareModal && (\n        <ShareModal\n          isOpen={showShareModal}\n          onClose={() => setShowShareModal(false)}\n          highlightText={shareHighlightText}\n          articleTitle={articleTitle}\n          shareUrl={generateHighlightShareUrl(articleSlug, articleId)}\n        />\n      )}\n    </>\n  );\n};\n\nexport default ArticleHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2454, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/GradientPanel.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useRef } from 'react';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface GradientPanelProps {\n  currentMood: keyof typeof moodThemes;\n  isVisible: boolean;\n  moodFeatureEnabled: boolean;\n}\n\ninterface ColorStop {\n  id: string;\n  color: string;\n  x: number; // 0-100\n  y: number; // 0-100\n  isSelected: boolean;\n}\n\ninterface ThemeConfig {\n  colorStops: ColorStop[];\n  opacity: number; // 0-100\n  grain: number; // 0-100\n  mode: 'auto' | 'light' | 'dark';\n}\n\nconst GradientPanel: React.FC<GradientPanelProps> = ({\n  currentMood,\n  isVisible,\n  moodFeatureEnabled\n}) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isDragging, setIsDragging] = useState<string | null>(null);\n  const [themeConfig, setThemeConfig] = useState<ThemeConfig>({\n    colorStops: [\n      { id: '1', color: '#007AFF', x: 30, y: 40, isSelected: true }\n    ],\n    opacity: 80,\n    grain: 30,\n    mode: 'auto'\n  });\n\n  const canvasRef = useRef<HTMLDivElement>(null);\n  const opacitySliderRef = useRef<HTMLDivElement>(null);\n  const grainSliderRef = useRef<HTMLDivElement>(null);\n\n  // Generate Journa Color-style gradient from color stops with grain effect\n  const generateJournaColorGradient = (config: ThemeConfig) => {\n    const { colorStops, opacity, grain } = config;\n    const alpha = opacity / 100;\n    \n    // Generate uniform film grain overlay like Arc browser\n    const grainIntensity = grain / 100;\n    let grainPattern = '';\n    \n    if (grainIntensity > 0.1) {\n      // Create uniform grain effect with fine noise simulation (static pattern)\n      const grainOpacity = grainIntensity * 0.08; // Visible but subtle grain like Arc\n      \n      // Pre-defined static pattern that resembles Arc's uniform grain\n      grainPattern = `\n        radial-gradient(circle at 7% 12%, rgba(255,255,255,${grainOpacity}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 23% 8%, rgba(0,0,0,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 41% 15%, rgba(255,255,255,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 59% 7%, rgba(0,0,0,${grainOpacity * 0.9}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 73% 14%, rgba(255,255,255,${grainOpacity * 0.7}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 91% 9%, rgba(0,0,0,${grainOpacity * 0.5}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 13% 31%, rgba(255,255,255,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 29% 28%, rgba(0,0,0,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 47% 33%, rgba(255,255,255,${grainOpacity}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 61% 29%, rgba(0,0,0,${grainOpacity * 0.7}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 79% 32%, rgba(255,255,255,${grainOpacity * 0.5}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 97% 27%, rgba(0,0,0,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 5% 53%, rgba(255,255,255,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 21% 47%, rgba(0,0,0,${grainOpacity}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 37% 52%, rgba(255,255,255,${grainOpacity * 0.7}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 55% 48%, rgba(0,0,0,${grainOpacity * 0.5}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 71% 51%, rgba(255,255,255,${grainOpacity * 0.9}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 87% 49%, rgba(0,0,0,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 11% 71%, rgba(255,255,255,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 25% 68%, rgba(0,0,0,${grainOpacity * 0.7}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 43% 73%, rgba(255,255,255,${grainOpacity}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 57% 67%, rgba(0,0,0,${grainOpacity * 0.5}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 75% 72%, rgba(255,255,255,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 93% 69%, rgba(0,0,0,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 9% 89%, rgba(255,255,255,${grainOpacity * 0.7}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 27% 87%, rgba(0,0,0,${grainOpacity * 0.9}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 45% 92%, rgba(255,255,255,${grainOpacity * 0.5}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 63% 88%, rgba(0,0,0,${grainOpacity * 0.6}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 81% 91%, rgba(255,255,255,${grainOpacity * 0.8}) 0.3px, transparent 0.8px),\n        radial-gradient(circle at 99% 89%, rgba(0,0,0,${grainOpacity}) 0.3px, transparent 0.8px)\n      `;\n    }\n    \n    let baseGradient = '';\n    \n    if (colorStops.length === 1) {\n      const stop = colorStops[0];\n      baseGradient = `radial-gradient(circle at ${stop.x}% ${stop.y}%, ${stop.color}${Math.round(alpha * 255).toString(16)}, transparent 70%)`;\n    } else if (colorStops.length === 2) {\n      const [stop1, stop2] = colorStops;\n      baseGradient = `\n        radial-gradient(circle at ${stop1.x}% ${stop1.y}%, ${stop1.color}${Math.round(alpha * 0.7 * 255).toString(16)}, transparent 50%),\n        radial-gradient(circle at ${stop2.x}% ${stop2.y}%, ${stop2.color}${Math.round(alpha * 0.7 * 255).toString(16)}, transparent 50%)\n      `;\n    } else if (colorStops.length === 3) {\n      const [stop1, stop2, stop3] = colorStops;\n      baseGradient = `\n        radial-gradient(circle at ${stop1.x}% ${stop1.y}%, ${stop1.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%),\n        radial-gradient(circle at ${stop2.x}% ${stop2.y}%, ${stop2.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%),\n        radial-gradient(circle at ${stop3.x}% ${stop3.y}%, ${stop3.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%)\n      `;\n    }\n    \n    return grainPattern ? `${grainPattern}${baseGradient}` : baseGradient || 'transparent';\n  };\n\n  // Generate clearer gradient for bars and UI elements (more visible)\n  const generateClearerGradient = (config: ThemeConfig) => {\n    const { colorStops, opacity, grain } = config;\n    const alpha = Math.max(0.7, opacity / 100); // Higher minimum opacity for bars\n    \n    // Light grain for UI elements (matches background but lighter)\n    const grainIntensity = grain / 100;\n    let lightGrainPattern = '';\n    \n    if (grainIntensity > 0.3) {\n      const grainOpacity = grainIntensity * 0.03; // Light grain for UI readability\n      lightGrainPattern = `\n        radial-gradient(circle at 15% 25%, rgba(255,255,255,${grainOpacity}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 35% 15%, rgba(0,0,0,${grainOpacity * 0.7}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 55% 35%, rgba(255,255,255,${grainOpacity * 0.5}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 75% 25%, rgba(0,0,0,${grainOpacity * 0.8}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 25% 65%, rgba(255,255,255,${grainOpacity * 0.6}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 45% 55%, rgba(0,0,0,${grainOpacity * 0.4}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 65% 75%, rgba(255,255,255,${grainOpacity * 0.7}) 0.2px, transparent 0.6px),\n        radial-gradient(circle at 85% 65%, rgba(0,0,0,${grainOpacity * 0.5}) 0.2px, transparent 0.6px),\n      `;\n    }\n    \n    let clearBaseGradient = '';\n    \n    if (colorStops.length === 1) {\n      const stop = colorStops[0];\n      clearBaseGradient = `linear-gradient(135deg, ${stop.color}${Math.round(alpha * 255).toString(16)}, ${stop.color}${Math.round(alpha * 0.8 * 255).toString(16)})`;\n    } else if (colorStops.length === 2) {\n      const [stop1, stop2] = colorStops;\n      clearBaseGradient = `linear-gradient(135deg, ${stop1.color}${Math.round(alpha * 255).toString(16)}, ${stop2.color}${Math.round(alpha * 255).toString(16)})`;\n    } else if (colorStops.length === 3) {\n      const [stop1, stop2, stop3] = colorStops;\n      clearBaseGradient = `linear-gradient(135deg, ${stop1.color}${Math.round(alpha * 255).toString(16)}, ${stop2.color}${Math.round(alpha * 0.9 * 255).toString(16)}, ${stop3.color}${Math.round(alpha * 255).toString(16)})`;\n    }\n    \n    return lightGrainPattern ? `${lightGrainPattern}${clearBaseGradient}` : clearBaseGradient || 'transparent';\n  };\n\n  // Real-time update function (fixed)\n  const updateThemeRealTime = (config: ThemeConfig) => {\n    if (!moodFeatureEnabled) return;\n    \n    const gradientCSS = generateJournaColorGradient(config);\n    \n    // Create a more visible/clearer version for bars and UI elements\n    const clearerGradientCSS = generateClearerGradient(config);\n    \n    // Update all mood elements immediately\n    const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n    moodElements.forEach(element => {\n      element.style.backgroundImage = gradientCSS;\n      element.style.transition = 'background-image 0.2s ease';\n    });\n\n    // Update mood headers\n    const moodHeaders = document.querySelectorAll('[data-mood-header]') as NodeListOf<HTMLElement>;\n    moodHeaders.forEach(element => {\n      element.style.backgroundImage = gradientCSS;\n      element.style.transition = 'background-image 0.2s ease';\n    });\n\n    // Update the specific toggle/feature bar using data attribute\n    console.log(' Looking for toggle bar to update...');\n    \n    const toggleBar = document.querySelector('[data-toggle-bar=\"true\"]') as HTMLElement;\n    if (toggleBar) {\n      console.log(' Found toggle bar with data attribute:', toggleBar);\n      toggleBar.style.backgroundImage = clearerGradientCSS;\n      toggleBar.style.transition = 'background-image 0.2s ease';\n      toggleBar.style.backgroundSize = 'cover';\n      toggleBar.style.backgroundPosition = 'center';\n    } else {\n      console.log(' Toggle bar with data attribute not found, trying fallback...');\n      \n      // Fallback: Look for elements with specific content\n      const allElements = document.querySelectorAll('div') as NodeListOf<HTMLElement>;\n      allElements.forEach(element => {\n        const text = element.textContent || '';\n        if (text.includes('Atmosphere') && text.includes('Enhanced features') && \n            text.includes('Mood Background') && text.includes('Interactive Reflections')) {\n          console.log(' Found toggle bar via text content:', element);\n          element.style.backgroundImage = clearerGradientCSS;\n          element.style.transition = 'background-image 0.2s ease';\n          element.style.backgroundSize = 'cover';\n          element.style.backgroundPosition = 'center';\n        }\n      });\n    }\n\n    // Update reflection/mood bars with clearer gradient\n    const reflectionBars = document.querySelectorAll('[data-reflection-bar], [data-mood-bar]') as NodeListOf<HTMLElement>;\n    reflectionBars.forEach(element => {\n      element.style.backgroundImage = clearerGradientCSS;\n      element.style.transition = 'background-image 0.2s ease';\n      element.style.backgroundSize = 'cover';\n      element.style.backgroundPosition = 'center';\n    });\n\n    // Update any progress bars or status indicators\n    const progressBars = document.querySelectorAll('.progress-bar, .status-bar, .mood-indicator') as NodeListOf<HTMLElement>;\n    progressBars.forEach(element => {\n      element.style.backgroundImage = clearerGradientCSS;\n      element.style.transition = 'background-image 0.2s ease';\n    });\n\n    // Save configuration\n    localStorage.setItem('journaColorThemeConfig', JSON.stringify(config));\n  };\n\n  // Handle color stop dragging\n  const handleColorStopMouseDown = (e: React.MouseEvent, stopId: string) => {\n    e.preventDefault();\n    setIsDragging(stopId);\n    \n    // Select this color stop\n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop => ({\n        ...stop,\n        isSelected: stop.id === stopId\n      }))\n    };\n    setThemeConfig(newConfig);\n  };\n\n  const handleMouseMove = (e: MouseEvent) => {\n    if (!isDragging || !canvasRef.current) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    const x = Math.max(5, Math.min(95, ((e.clientX - rect.left) / rect.width) * 100));\n    const y = Math.max(5, Math.min(95, ((e.clientY - rect.top) / rect.height) * 100));\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop => \n        stop.id === isDragging ? { ...stop, x, y } : stop\n      )\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  const handleMouseUp = () => {\n    setIsDragging(null);\n  };\n\n  // Handle opacity slider (squiggly line)\n  const handleOpacityMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    setIsDragging('opacity');\n    handleOpacityMouseMove(e);\n  };\n\n  const handleOpacityMouseMove = (e: React.MouseEvent | MouseEvent) => {\n    if (!opacitySliderRef.current) return;\n    \n    const rect = opacitySliderRef.current.getBoundingClientRect();\n    const x = Math.max(0, Math.min(100, ((e.clientX - rect.left) / rect.width) * 100));\n    \n    const newConfig = { ...themeConfig, opacity: x };\n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Handle grain rotary knob with tactile detents (like real knob)\n  const handleGrainMouseDown = (e: React.MouseEvent) => {\n    e.preventDefault();\n    setIsDragging('grain');\n    handleGrainMouseMove(e);\n  };\n\n  const handleGrainMouseMove = (e: React.MouseEvent | MouseEvent) => {\n    if (!grainSliderRef.current) return;\n    \n    const rect = grainSliderRef.current.getBoundingClientRect();\n    const centerX = rect.left + rect.width / 2;\n    const centerY = rect.top + rect.height / 2;\n    \n    // Calculate angle from center\n    const deltaX = e.clientX - centerX;\n    const deltaY = e.clientY - centerY;\n    let angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);\n    \n    // Normalize to 0-360 degrees, starting from top (270 degrees offset)\n    angle = (angle + 270) % 360;\n    if (angle < 0) angle += 360;\n    \n    // Create detents every 15 degrees (24 steps total) for tactile feel\n    const detentSize = 15; // degrees per detent\n    const rawGrain = (angle / 360) * 100;\n    const detentIndex = Math.round(rawGrain / (100 / (360 / detentSize)));\n    const snappedGrain = Math.max(0, Math.min(100, (detentIndex * (100 / (360 / detentSize)))));\n    \n    // Add haptic feedback simulation by slightly varying the snapped value\n    const finalGrain = Math.round(snappedGrain);\n    \n    if (Math.abs(finalGrain - themeConfig.grain) > 0.5) {\n      // Simulate tactile feedback with a tiny vibration-like effect\n      if (navigator.vibrate) {\n        navigator.vibrate(10); // Very short vibration on mobile\n      }\n      \n      const newConfig = { ...themeConfig, grain: finalGrain };\n      setThemeConfig(newConfig);\n      updateThemeRealTime(newConfig);\n    }\n  };\n\n  // Add color stop\n  const addColorStop = () => {\n    if (themeConfig.colorStops.length >= 3) return;\n    \n    const newStop: ColorStop = {\n      id: Date.now().toString(),\n      color: '#FF6B6B',\n      x: 50 + (themeConfig.colorStops.length * 15),\n      y: 50 + (themeConfig.colorStops.length * 10),\n      isSelected: false\n    };\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: [...themeConfig.colorStops, newStop]\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Remove color stop\n  const removeColorStop = () => {\n    if (themeConfig.colorStops.length <= 1) return;\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.slice(0, -1)\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Change selected color\n  const changeSelectedColor = (color: string) => {\n    const selectedStop = themeConfig.colorStops.find(stop => stop.isSelected);\n    if (!selectedStop) return;\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop => \n        stop.isSelected ? { ...stop, color } : stop\n      )\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Mouse event listeners\n  useEffect(() => {\n    if (isDragging) {\n      const handleMove = (e: MouseEvent) => {\n        if (isDragging === 'opacity') {\n          handleOpacityMouseMove(e);\n        } else if (isDragging === 'grain') {\n          handleGrainMouseMove(e);\n        } else {\n          handleMouseMove(e);\n        }\n      };\n      \n      document.addEventListener('mousemove', handleMove);\n      document.addEventListener('mouseup', handleMouseUp);\n      \n      return () => {\n        document.removeEventListener('mousemove', handleMove);\n        document.removeEventListener('mouseup', handleMouseUp);\n      };\n    }\n  }, [isDragging, themeConfig]);\n\n  // Load saved configuration\n  useEffect(() => {\n    const saved = localStorage.getItem('journaColorThemeConfig');\n    if (saved) {\n      try {\n        const config = JSON.parse(saved);\n        setThemeConfig(config);\n        updateThemeRealTime(config);\n      } catch (e) {\n        console.error('Failed to load theme config:', e);\n      }\n    }\n  }, []);\n\n  if (!isVisible || !moodFeatureEnabled) return null;\n\n  const currentGradient = generateJournaColorGradient(themeConfig);\n  const selectedStop = themeConfig.colorStops.find(stop => stop.isSelected) || themeConfig.colorStops[0];\n  \n  const presetColors = [\n    '#FFFFFF', '#FFB3D9', '#B19CD9', '#FF6B6B', \n    '#FF8E53', '#FFD93D', '#6BCF7F', '#4ECDC4', '#45B7D1'\n  ];\n\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: '20px',\n      left: '20px',\n      zIndex: 9999,\n      transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)'\n    }}>\n      {/* Floating toggle button */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        style={{\n          width: '56px',\n          height: '56px',\n          borderRadius: '50%',\n          border: 'none',\n          background: currentGradient || '#007AFF',\n          color: 'white',\n          fontSize: '20px',\n          cursor: 'pointer',\n          boxShadow: '0 8px 32px rgba(0,0,0,0.2)',\n          transform: isExpanded ? 'rotate(45deg)' : 'rotate(0deg)',\n          transition: 'all 0.3s ease',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center'\n        }}\n        title=\"Journa Color Editor\"\n      >\n        <svg \n          width=\"24\" \n          height=\"24\" \n          viewBox=\"0 0 24 24\" \n          fill=\"none\" \n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <defs>\n            <linearGradient id=\"iconGradient\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\">\n              <stop offset=\"0%\" stopColor=\"#ffffff\" stopOpacity=\"0.9\"/>\n              <stop offset=\"100%\" stopColor=\"#ffffff\" stopOpacity=\"0.7\"/>\n            </linearGradient>\n          </defs>\n          <circle cx=\"8\" cy=\"8\" r=\"3\" fill=\"url(#iconGradient)\"/>\n          <circle cx=\"16\" cy=\"12\" r=\"2.5\" fill=\"url(#iconGradient)\"/>\n          <circle cx=\"12\" cy=\"18\" r=\"2\" fill=\"url(#iconGradient)\"/>\n          <path \n            d=\"M8 8L16 12M16 12L12 18\" \n            stroke=\"url(#iconGradient)\" \n            strokeWidth=\"1.5\" \n            strokeLinecap=\"round\"\n          />\n        </svg>\n      </button>\n\n      {/* Expanded Journa Color-style panel */}\n      {isExpanded && (\n        <div style={{\n          position: 'absolute',\n          bottom: '70px',\n          left: '0',\n          background: 'rgba(255, 255, 255, 0.98)',\n          backdropFilter: 'blur(20px)',\n          borderRadius: '24px',\n          padding: '1.5rem',\n          border: '1px solid rgba(0, 0, 0, 0.08)',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.15)',\n          width: '380px',\n          transform: 'translateY(0)',\n          opacity: '1',\n          transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)'\n        }}>\n          {/* Theme mode toggles */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '1rem',\n            marginBottom: '1.5rem'\n          }}>\n            {[\n              { mode: 'auto' as const, icon: '', title: 'Auto' },\n              { mode: 'light' as const, icon: '', title: 'Light' },\n              { mode: 'dark' as const, icon: '', title: 'Dark' }\n            ].map(({ mode, icon, title }) => (\n              <button\n                key={mode}\n                onClick={() => {\n                  const newConfig = { ...themeConfig, mode };\n                  setThemeConfig(newConfig);\n                  updateThemeRealTime(newConfig);\n                }}\n                style={{\n                  width: '48px',\n                  height: '48px',\n                  borderRadius: '12px',\n                  border: themeConfig.mode === mode ? '2px solid #007AFF' : '2px solid rgba(0,0,0,0.1)',\n                  background: themeConfig.mode === mode ? 'rgba(0, 122, 255, 0.1)' : 'rgba(0,0,0,0.05)',\n                  fontSize: '20px',\n                  cursor: 'pointer',\n                  transition: 'all 0.2s ease'\n                }}\n                title={title}\n              >\n                {icon}\n              </button>\n            ))}\n          </div>\n\n          {/* Large interactive color area - Journa Color's main canvas */}\n          <div \n            ref={canvasRef}\n            style={{\n              width: '100%',\n              height: '180px',\n              borderRadius: '16px',\n              background: `\n                radial-gradient(circle at 50% 50%, rgba(100, 100, 100, 0.1) 0%, transparent 70%),\n                repeating-linear-gradient(0deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),\n                repeating-linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),\n                linear-gradient(135deg, #f0f0f0, #e8e8e8)\n              `,\n              position: 'relative',\n              cursor: 'grab',\n              marginBottom: '1.5rem',\n              border: '1px solid rgba(0,0,0,0.1)',\n              overflow: 'hidden'\n            }}\n          >\n            {/* Draggable color stops */}\n            {themeConfig.colorStops.map((stop) => (\n              <div\n                key={stop.id}\n                onMouseDown={(e) => handleColorStopMouseDown(e, stop.id)}\n                style={{\n                  position: 'absolute',\n                  top: `${stop.y}%`,\n                  left: `${stop.x}%`,\n                  transform: 'translate(-50%, -50%)',\n                  width: stop.isSelected ? '24px' : '20px',\n                  height: stop.isSelected ? '24px' : '20px',\n                  borderRadius: '50%',\n                  background: stop.color,\n                  border: stop.isSelected ? '3px solid white' : '2px solid white',\n                  boxShadow: stop.isSelected ? '0 4px 12px rgba(0,0,0,0.4)' : '0 2px 8px rgba(0,0,0,0.3)',\n                  cursor: isDragging === stop.id ? 'grabbing' : 'grab',\n                  transition: isDragging === stop.id ? 'none' : 'all 0.2s ease',\n                  zIndex: stop.isSelected ? 10 : 5\n                }}\n              />\n            ))}\n          </div>\n\n          {/* Add/Remove color stops */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            gap: '1rem',\n            marginBottom: '1.5rem'\n          }}>\n            <button\n              onClick={removeColorStop}\n              disabled={themeConfig.colorStops.length <= 1}\n              style={{\n                width: '36px',\n                height: '36px',\n                borderRadius: '8px',\n                border: '1px solid rgba(0,0,0,0.2)',\n                background: themeConfig.colorStops.length <= 1 ? 'rgba(0,0,0,0.05)' : 'white',\n                fontSize: '18px',\n                cursor: themeConfig.colorStops.length <= 1 ? 'not-allowed' : 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                opacity: themeConfig.colorStops.length <= 1 ? 0.5 : 1\n              }}\n            >\n              \n            </button>\n            \n            <span style={{ \n              fontSize: '14px', \n              color: '#666',\n              minWidth: '80px',\n              textAlign: 'center'\n            }}>\n              {themeConfig.colorStops.length}/3 colors\n            </span>\n            \n            <button\n              onClick={addColorStop}\n              disabled={themeConfig.colorStops.length >= 3}\n              style={{\n                width: '36px',\n                height: '36px',\n                borderRadius: '8px',\n                border: '1px solid rgba(0,0,0,0.2)',\n                background: themeConfig.colorStops.length >= 3 ? 'rgba(0,0,0,0.05)' : 'white',\n                fontSize: '18px',\n                cursor: themeConfig.colorStops.length >= 3 ? 'not-allowed' : 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                opacity: themeConfig.colorStops.length >= 3 ? 0.5 : 1\n              }}\n            >\n              +\n            </button>\n          </div>\n\n          {/* Color preset row */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '0.5rem',\n            marginBottom: '1.5rem',\n            flexWrap: 'wrap'\n          }}>\n            {presetColors.map((color, index) => (\n              <button\n                key={index}\n                onClick={() => changeSelectedColor(color)}\n                style={{\n                  width: '32px',\n                  height: '32px',\n                  borderRadius: '50%',\n                  border: selectedStop.color === color ? '3px solid #007AFF' : '2px solid rgba(0,0,0,0.1)',\n                  background: color,\n                  cursor: 'pointer',\n                  transform: selectedStop.color === color ? 'scale(1.15)' : 'scale(1)',\n                  transition: 'all 0.2s ease'\n                }}\n              />\n            ))}\n          </div>\n\n          {/* Bottom controls - Squiggly line (opacity) and Dotted circle (grain) */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            gap: '1rem'\n          }}>\n            {/* Squiggly line - Opacity control */}\n            <div \n              ref={opacitySliderRef}\n              onMouseDown={handleOpacityMouseDown}\n              style={{\n                flex: 1,\n                height: '40px',\n                background: 'rgba(0,0,0,0.05)',\n                borderRadius: '20px',\n                position: 'relative',\n                cursor: 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                paddingLeft: '12px',\n                paddingRight: '12px'\n              }}\n            >\n              {/* Squiggly pattern background */}\n              <div style={{\n                position: 'absolute',\n                left: '12px',\n                right: '12px',\n                height: '4px',\n                background: `repeating-linear-gradient(to right, #ccc 0px, #ccc 3px, transparent 3px, transparent 6px)`,\n                borderRadius: '2px'\n              }} />\n              \n              {/* Opacity slider handle */}\n              <div style={{\n                position: 'absolute',\n                left: `${12 + (themeConfig.opacity / 100) * (100 - 24)}%`,\n                width: '16px',\n                height: '16px',\n                background: 'white',\n                borderRadius: '50%',\n                border: '2px solid #007AFF',\n                boxShadow: '0 2px 8px rgba(0,0,0,0.2)',\n                transform: 'translateX(-50%)'\n              }} />\n            </div>\n\n                         {/* Rotary knob - Grain control */}\n             <div \n               ref={grainSliderRef}\n               onMouseDown={handleGrainMouseDown}\n               style={{\n                 width: '60px',\n                 height: '60px',\n                 borderRadius: '50%',\n                 background: 'linear-gradient(145deg, #f0f0f0, #d9d9d9)',\n                 position: 'relative',\n                 cursor: isDragging === 'grain' ? 'grabbing' : 'grab',\n                 border: '1px solid rgba(0,0,0,0.1)',\n                 boxShadow: isDragging === 'grain' ? 'inset 0 2px 4px rgba(0,0,0,0.2)' : '0 2px 4px rgba(0,0,0,0.1)',\n                 transition: isDragging === 'grain' ? 'none' : 'all 0.2s ease'\n               }}\n             >\n               {/* Knob track marks */}\n               {[0, 45, 90, 135, 180, 225, 270, 315].map((angle, i) => (\n                 <div\n                   key={i}\n                   style={{\n                     position: 'absolute',\n                     top: '50%',\n                     left: '50%',\n                     width: '2px',\n                     height: '6px',\n                     background: 'rgba(0,0,0,0.3)',\n                     borderRadius: '1px',\n                     transform: `translate(-50%, -50%) rotate(${angle}deg) translateY(-22px)`,\n                     transformOrigin: 'center'\n                   }}\n                 />\n               ))}\n               \n               {/* Knob center */}\n               <div style={{\n                 position: 'absolute',\n                 top: '50%',\n                 left: '50%',\n                 width: '40px',\n                 height: '40px',\n                 borderRadius: '50%',\n                 background: 'linear-gradient(145deg, #ffffff, #e8e8e8)',\n                 transform: 'translate(-50%, -50%)',\n                 border: '1px solid rgba(0,0,0,0.1)',\n                 boxShadow: isDragging === 'grain' ? 'inset 0 1px 3px rgba(0,0,0,0.2)' : '0 1px 3px rgba(0,0,0,0.1)'\n               }}>\n                 {/* Knob indicator pointer */}\n                 <div style={{\n                   position: 'absolute',\n                   top: '6px',\n                   left: '50%',\n                   width: '3px',\n                   height: '12px',\n                   background: '#007AFF',\n                   borderRadius: '1.5px',\n                   transform: `translateX(-50%) rotate(${(themeConfig.grain / 100) * 360}deg)`,\n                   transformOrigin: '50% 14px',\n                   transition: isDragging === 'grain' ? 'none' : 'transform 0.2s ease'\n                 }} />\n                 \n                 {/* Center dot */}\n                 <div style={{\n                   position: 'absolute',\n                   top: '50%',\n                   left: '50%',\n                   width: '4px',\n                   height: '4px',\n                   background: '#007AFF',\n                   borderRadius: '50%',\n                   transform: 'translate(-50%, -50%)'\n                 }} />\n               </div>\n               \n               {/* Grain value indicator */}\n               <div style={{\n                 position: 'absolute',\n                 bottom: '-20px',\n                 left: '50%',\n                 transform: 'translateX(-50%)',\n                 fontSize: '10px',\n                 color: '#666',\n                 fontWeight: '500'\n               }}>\n                 {Math.round(themeConfig.grain)}%\n               </div>\n             </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GradientPanel; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3371, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/MoodToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport GradientPanel from './GradientPanel';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface MoodToggleProps {\n  initialEnabled?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n  currentMood?: keyof typeof moodThemes;\n}\n\nconst MoodToggle: React.FC<MoodToggleProps> = ({ \n  initialEnabled = true, \n  className = '',\n  style = {},\n  currentMood = 'joyful'\n}) => {\n  const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(initialEnabled);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      \n              if (user) {\n          // Load user's mood preference from localStorage\n          const savedPreference = localStorage.getItem('moodFeatureEnabled');\n          if (savedPreference !== null) {\n            const enabled = JSON.parse(savedPreference);\n            setMoodFeatureEnabled(enabled);\n            \n            // Apply initial state to DOM with multiple attempts to ensure it works\n            const applyInitialState = (attempt = 1) => {\n              console.log(` Applying initial mood state (attempt ${attempt}):`, enabled);\n              const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n              console.log(' Found mood elements on init:', moodElements.length);\n              \n              if (moodElements.length === 0 && attempt < 5) {\n                // Elements not ready yet, try again\n                setTimeout(() => applyInitialState(attempt + 1), 200);\n                return;\n              }\n              \n                    moodElements.forEach(element => {\n        // Ensure elements have proper transitions\n        element.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n        \n        if (enabled) {\n          // Show elements with data attributes\n          element.setAttribute('data-mood-active', 'true');\n          element.style.display = 'block';\n          element.style.visibility = 'visible';\n          element.style.opacity = '1';\n          element.style.transform = 'scale(1)';\n          console.log(' Initial show:', element.getAttribute('data-mood-element'));\n        } else {\n          // Hide elements with data attributes\n          element.setAttribute('data-mood-active', 'false');\n          element.style.display = 'none';\n          element.style.visibility = 'hidden';\n          element.style.opacity = '0';\n          element.style.transform = 'scale(0.95)';\n          console.log(' Initial hide:', element.getAttribute('data-mood-element'));\n        }\n      });\n              \n              // Also apply to headers\n              const moodHeaders = document.querySelectorAll('[data-mood-header]') as NodeListOf<HTMLElement>;\n              moodHeaders.forEach(element => {\n                element.style.transition = 'background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease';\n                if (!enabled) {\n                  element.style.background = 'rgba(255, 255, 255, 0.95)';\n                  element.style.border = '1px solid rgba(0, 0, 0, 0.1)';\n                  element.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';\n                }\n              });\n            };\n            \n            // Start applying initial state\n            setTimeout(() => applyInitialState(), 100);\n          } else {\n            setMoodFeatureEnabled(true);\n          }\n        } else {\n          setMoodFeatureEnabled(false);\n        }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleToggle = () => {\n    console.log(' MoodToggle clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) return;\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    const newEnabled = !moodFeatureEnabled;\n    setMoodFeatureEnabled(newEnabled);\n    localStorage.setItem('moodFeatureEnabled', JSON.stringify(newEnabled));\n    \n    console.log(' Mood feature toggled to:', newEnabled);\n    \n    //  REMOVED: No more React state updates that cause re-renders and lose highlights!\n    \n    // Force IMMEDIATE visual updates for mood backgrounds - no waiting for events\n    console.log(' Toggle clicked - searching for mood elements...');\n    \n    const findAndUpdateElements = (attempt = 1) => {\n      const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n      console.log(` Found mood elements (attempt ${attempt}):`, moodElements.length);\n      \n      if (moodElements.length === 0 && attempt < 3) {\n        // Try again if elements not found\n        setTimeout(() => findAndUpdateElements(attempt + 1), 100);\n        return;\n      }\n      \n      moodElements.forEach(element => {\n        // Add smooth transitions\n        element.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n        \n        if (newEnabled) {\n          // Show elements - use data attributes and CSS properties\n          element.setAttribute('data-mood-active', 'true');\n          element.style.display = 'block';\n          element.style.visibility = 'visible';\n          element.style.opacity = '1';\n          element.style.transform = 'scale(1)';\n          console.log(' Showing mood element:', element.getAttribute('data-mood-element'));\n        } else {\n          // Hide elements\n          element.setAttribute('data-mood-active', 'false');\n          element.style.opacity = '0';\n          element.style.transform = 'scale(0.95)';\n          console.log(' Hiding mood element:', element.getAttribute('data-mood-element'));\n          \n          // Hide after animation completes\n          setTimeout(() => {\n            if (element.getAttribute('data-mood-active') === 'false') {\n              element.style.display = 'none';\n              element.style.visibility = 'hidden';\n            }\n          }, 300);\n        }\n      });\n    };\n    \n    // Start the search and update process\n    findAndUpdateElements();\n    \n    // Also update any mood-controlled headers/panels with smooth transitions\n    const moodHeaders = document.querySelectorAll('[data-mood-header]') as NodeListOf<HTMLElement>;\n    moodHeaders.forEach(element => {\n      // Add smooth transition for header changes\n      element.style.transition = 'background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease';\n      \n      if (newEnabled) {\n        // When enabling, clear any overrides to restore original mood styling\n        element.style.background = '';\n        element.style.border = '';\n        element.style.boxShadow = '';\n        \n        // Force a complete refresh by temporarily hiding and showing\n        const originalDisplay = element.style.display;\n        element.style.display = 'none';\n        element.offsetHeight; // Force reflow\n        element.style.display = originalDisplay;\n        \n        console.log(' Header mood styling restored - cleared overrides');\n      } else {\n        // Save current mood styling and apply neutral background\n        element.setAttribute('data-mood-style', element.style.background);\n        element.style.background = 'rgba(255, 255, 255, 0.95)';\n        element.style.border = '1px solid rgba(0, 0, 0, 0.1)';\n        element.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';\n        console.log(' Header mood styling removed');\n      }\n    });\n    \n    console.log(' Mood backgrounds updated immediately. Enabled:', newEnabled);\n  };\n\n  if (!currentUser) {\n    return null; // Don't show toggle for unauthenticated users\n  }\n\n  return (\n    <>\n      <button\n        onClick={handleToggle}\n        className={className}\n        style={{\n          ...style,\n          transition: 'all 0.3s ease',\n          transform: isAnimating ? 'scale(1.1)' : 'scale(1)',\n        }}\n        title={moodFeatureEnabled ? \"Turn off mood feature\" : \"Turn on mood feature\"}\n      >\n        {moodFeatureEnabled ? 'ON' : 'OFF'}\n      </button>\n\n      {/* Real-time gradient panel */}\n      <GradientPanel\n        currentMood={currentMood}\n        isVisible={!!currentUser}\n        moodFeatureEnabled={moodFeatureEnabled}\n      />\n    </>\n  );\n};\n\nexport default React.memo(MoodToggle); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3566, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\n\ninterface ReflectionToggleProps {\n  articleId: string;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst ReflectionToggle: React.FC<ReflectionToggleProps> = ({ \n  articleId,\n  className = '',\n  style = {}\n}) => {\n  const [showReflectionPanel, setShowReflectionPanel] = useState(false);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [reflectionCount, setReflectionCount] = useState(0);\n  const [currentReflection, setCurrentReflection] = useState('');\n  const [currentPrompt, setCurrentPrompt] = useState('');\n  const [isEditingPrompt, setIsEditingPrompt] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n\n  // Base reflection prompts\n  const basePrompts = [\n    \"How does this make you feel?\",\n    \"What questions does this raise for you?\",\n    \"How does this connect to your own experiences?\",\n    \"What would you have done differently?\",\n    \"What surprises you most about this?\",\n    \"How might this change your perspective?\",\n    \"What emotions are you experiencing right now?\",\n    \"What does this remind you of?\",\n    \"If you could ask the author one question, what would it be?\",\n    \"How does this challenge your existing beliefs?\"\n  ];\n\n  const getDefaultPrompt = () => {\n    return basePrompts[reflectionCount % basePrompts.length];\n  };\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Initialize prompt when panel opens\n  useEffect(() => {\n    if (showReflectionPanel && !currentPrompt) {\n      setCurrentPrompt(getDefaultPrompt());\n    }\n  }, [showReflectionPanel, reflectionCount]);\n\n  const toggleReflectionPanel = () => {\n    console.log(' ReflectionToggle clicked - should NOT trigger parent re-render');\n    \n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n    \n    setShowReflectionPanel(!showReflectionPanel);\n    if (!showReflectionPanel) {\n      setCurrentPrompt(getDefaultPrompt());\n    }\n  };\n\n  const handlePromptEdit = () => {\n    setIsEditingPrompt(true);\n  };\n\n  const handlePromptSave = () => {\n    setIsEditingPrompt(false);\n  };\n\n  const getRandomPrompt = () => {\n    const randomIndex = Math.floor(Math.random() * basePrompts.length);\n    setCurrentPrompt(basePrompts[randomIndex]);\n  };\n\n  const handleReflectionSubmit = async () => {\n    if (!currentReflection.trim() || !currentUser) return;\n    \n    setIsSubmitting(true);\n    \n    try {\n      console.log('Starting reflection submission:', {\n        articleId,\n        currentPrompt,\n        currentReflection,\n        reflectionCount\n      });\n      \n      // Import the reflection service\n      const { saveReflectionResponse } = await import('@/services/reflectionService');\n      \n      // Save the reflection with proper metadata\n      await saveReflectionResponse(\n        articleId,\n        `prompt_${Date.now()}`,\n        currentPrompt,\n        currentReflection,\n        reflectionCount,\n        true // isPrivate\n      );\n      \n      console.log('Reflection saved successfully');\n      \n      // Update count and close panel\n      setReflectionCount(prev => prev + 1);\n      setCurrentReflection('');\n      setShowReflectionPanel(false);\n      \n    } catch (error) {\n      console.error('Error saving reflection:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  if (!currentUser) {\n    return null; // Don't show for unauthenticated users\n  }\n\n  return (\n    <>\n      {/* Elegant Floating Reflection Button */}\n      <button\n        data-reflection-element=\"floating-button\"\n        onClick={toggleReflectionPanel}\n        className={className}\n        style={{\n          position: 'fixed',\n          bottom: window.innerWidth <= 768 ? '20px' : '40px',\n          right: window.innerWidth <= 768 ? '20px' : '40px',\n          width: window.innerWidth <= 768 ? '48px' : '56px',\n          height: window.innerWidth <= 768 ? '48px' : '56px',\n          borderRadius: '50%',\n          background: showReflectionPanel \n            ? 'linear-gradient(135deg, #1d4ed8, #7c3aed)' \n            : 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n          border: 'none',\n          boxShadow: showReflectionPanel\n            ? '0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)'\n            : '0 6px 20px rgba(59, 130, 246, 0.3)',\n          cursor: 'pointer',\n          zIndex: 1000,\n          transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          fontSize: '18px',\n          transform: isAnimating ? 'scale(1.1)' : showReflectionPanel ? 'scale(1.05)' : 'scale(1)',\n          backdropFilter: 'blur(10px)',\n          ...style,\n        }}\n        title={showReflectionPanel ? \"Close reflection\" : \"Open reflection\"}\n      >\n        {showReflectionPanel ? '' : ''}\n      </button>\n\n      {/* Custom Floating Reflection Panel */}\n      {showReflectionPanel && (\n        <div style={{\n          position: 'fixed',\n          bottom: window.innerWidth <= 768 ? '80px' : '110px',\n          right: window.innerWidth <= 768 ? '20px' : '40px',\n          left: window.innerWidth <= 768 ? '20px' : 'auto',\n          width: window.innerWidth <= 768 ? 'auto' : '380px',\n          maxWidth: window.innerWidth <= 768 ? 'none' : '380px',\n          maxHeight: window.innerWidth <= 768 ? '400px' : '500px',\n          background: 'rgba(255, 255, 255, 0.95)',\n          backdropFilter: 'blur(20px)',\n          borderRadius: window.innerWidth <= 768 ? '16px' : '24px',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)',\n          border: '1px solid rgba(255, 255, 255, 0.3)',\n          zIndex: 999,\n          animation: 'gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)',\n          padding: window.innerWidth <= 768 ? '16px' : '24px',\n          overflow: 'hidden'\n        }}>\n          <style>\n            {`\n              @keyframes gentleSlideUp {\n                from {\n                  opacity: 0;\n                  transform: translateY(20px) scale(0.98);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0) scale(1);\n                }\n              }\n            `}\n          </style>\n          \n          {/* Header */}\n          <div style={{ marginBottom: '20px', textAlign: 'center' }}>\n            <h3 style={{\n              margin: '0 0 12px 0',\n              fontSize: '16px',\n              fontWeight: '600',\n              background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n              WebkitBackgroundClip: 'text',\n              WebkitTextFillColor: 'transparent',\n              backgroundClip: 'text'\n            }}>\n              Time to Reflect \n            </h3>\n            \n            {/* Editable Prompt */}\n            <div style={{ position: 'relative' }}>\n              {isEditingPrompt ? (\n                <input\n                  type=\"text\"\n                  value={currentPrompt}\n                  onChange={(e) => setCurrentPrompt(e.target.value)}\n                  onBlur={handlePromptSave}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') handlePromptSave();\n                    if (e.key === 'Escape') {\n                      setCurrentPrompt(getDefaultPrompt());\n                      setIsEditingPrompt(false);\n                    }\n                  }}\n                  autoFocus\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '2px solid #3b82f6',\n                    borderRadius: '12px',\n                    background: 'white',\n                    fontSize: '14px',\n                    textAlign: 'center',\n                    outline: 'none'\n                  }}\n                />\n              ) : (\n                <div style={{\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: '8px',\n                  flexWrap: 'wrap'\n                }}>\n                  <p \n                    onClick={handlePromptEdit}\n                    style={{\n                      margin: 0,\n                      fontSize: '14px',\n                      color: '#64748b',\n                      fontWeight: '500',\n                      cursor: 'pointer',\n                      padding: '4px 8px',\n                      borderRadius: '8px',\n                      transition: 'all 0.2s ease'\n                    }}\n                    title=\"Click to edit question\"\n                  >\n                    {currentPrompt}\n                  </p>\n                  <button\n                    onClick={getRandomPrompt}\n                    style={{\n                      background: 'rgba(59, 130, 246, 0.1)',\n                      border: 'none',\n                      borderRadius: '6px',\n                      padding: '4px 8px',\n                      fontSize: '12px',\n                      color: '#3b82f6',\n                      cursor: 'pointer',\n                      fontWeight: '500'\n                    }}\n                    title=\"Get different question\"\n                  >\n                    \n                  </button>\n                </div>\n              )}\n            </div>\n          </div>\n\n          {/* Reflection Input */}\n          <textarea\n            value={currentReflection}\n            onChange={(e) => setCurrentReflection(e.target.value)}\n            placeholder=\"Share your thoughts...\"\n            style={{\n              width: '100%',\n              height: '120px',\n              padding: '12px',\n              border: '2px solid #e2e8f0',\n              borderRadius: '12px',\n              background: 'white',\n              fontSize: '14px',\n              fontFamily: 'inherit',\n              resize: 'vertical',\n              outline: 'none',\n              transition: 'border-color 0.2s ease',\n              marginBottom: '16px'\n            }}\n            onFocus={(e) => {\n              e.target.style.borderColor = '#3b82f6';\n            }}\n            onBlur={(e) => {\n              e.target.style.borderColor = '#e2e8f0';\n            }}\n          />\n\n          {/* Action Buttons */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            gap: '12px'\n          }}>\n            <button\n              onClick={() => setShowReflectionPanel(false)}\n              style={{\n                background: 'transparent',\n                border: '2px solid #e2e8f0',\n                borderRadius: '12px',\n                padding: '8px 16px',\n                fontSize: '14px',\n                color: '#64748b',\n                cursor: 'pointer',\n                fontWeight: '500',\n                transition: 'all 0.2s ease'\n              }}\n            >\n              Cancel\n            </button>\n            \n            <button\n              onClick={handleReflectionSubmit}\n              disabled={!currentReflection.trim() || isSubmitting}\n              style={{\n                background: currentReflection.trim() \n                  ? 'linear-gradient(135deg, #3b82f6, #8b5cf6)' \n                  : '#e2e8f0',\n                border: 'none',\n                borderRadius: '12px',\n                padding: '8px 20px',\n                fontSize: '14px',\n                color: currentReflection.trim() ? 'white' : '#94a3b8',\n                cursor: currentReflection.trim() ? 'pointer' : 'not-allowed',\n                fontWeight: '600',\n                transition: 'all 0.2s ease',\n                opacity: isSubmitting ? 0.7 : 1\n              }}\n            >\n              {isSubmitting ? 'Saving...' : 'Save Reflection'}\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default React.memo(ReflectionToggle); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3953, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/moodThemes.ts"],"sourcesContent":["export const moodThemes = {\n    joyful: {\n        gradientStart: '#FFD700',  // Golden yellow\n        gradientEnd: '#FF6B6B',    // Coral pink\n        accent: '#FF4757'          // Bright red\n    },\n    angry: {\n        gradientStart: '#FF416C',  // Hot pink\n        gradientEnd: '#FF4B2B',    // Fiery red\n        accent: '#B71C1C'          // Dark red\n    },\n    energetic: {\n        gradientStart: '#00F260',  // Electric green\n        gradientEnd: '#0575E6',    // Electric blue\n        accent: '#1565C0'          // Deep blue\n    },\n    peaceful: {\n        gradientStart: '#A8E6CF',  // Soft mint\n        gradientEnd: '#88D8C0',    // Sage green\n        accent: '#4CAF50'          // Forest green\n    },\n    reflective: {\n        gradientStart: '#667eea',  // Soft purple\n        gradientEnd: '#764ba2',    // Deep purple\n        accent: '#5E35B1'          // Royal purple\n    },\n    sad: {\n        gradientStart: '#4facfe',  // Sky blue\n        gradientEnd: '#00f2fe',    // Cyan\n        accent: '#0288D1'          // Ocean blue\n    },\n};\n\nexport const gradientTypes = {\n    linear: 'linear',\n    radial: 'radial',\n    conic: 'conic',\n    waves: 'waves',\n    dots: 'dots',\n    mesh: 'mesh'\n} as const;\n\nexport type GradientType = keyof typeof gradientTypes;\n\nexport const generateGradientStyle = (\n    mood: keyof typeof moodThemes,\n    gradientType: GradientType,\n    opacity: number = 0.4\n) => {\n    const theme = moodThemes[mood];\n    const opacityHex = Math.round(opacity * 255).toString(16).padStart(2, '0');\n\n    switch (gradientType) {\n        case 'linear':\n            return `linear-gradient(45deg, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex})`;\n\n        case 'radial':\n            return `radial-gradient(circle at 50% 50%, ${theme.gradientStart}${opacityHex} 0%, ${theme.gradientEnd}${opacityHex} 100%)`;\n\n        case 'conic':\n            return `conic-gradient(from 0deg at 50% 50%, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex}, ${theme.accent}${opacityHex}, ${theme.gradientStart}${opacityHex})`;\n\n        case 'waves':\n            return `\n        radial-gradient(ellipse 200% 100% at 50% 0%, ${theme.gradientStart}${opacityHex}, transparent 50%), \n        radial-gradient(ellipse 200% 100% at 50% 100%, ${theme.gradientEnd}${opacityHex}, transparent 50%)\n      `;\n\n        case 'dots':\n            return `\n        radial-gradient(circle at 20% 20%, ${theme.gradientStart}${opacityHex} 8px, transparent 8px),\n        radial-gradient(circle at 80% 80%, ${theme.gradientEnd}${opacityHex} 8px, transparent 8px),\n        radial-gradient(circle at 40% 60%, ${theme.accent}${Math.round(opacity * 0.6 * 255).toString(16).padStart(2, '0')} 4px, transparent 4px)\n      `;\n\n        case 'mesh':\n            return `\n        radial-gradient(circle at 20% 20%, ${theme.gradientStart}${opacityHex}, transparent 50%), \n        radial-gradient(circle at 80% 60%, ${theme.gradientEnd}${opacityHex}, transparent 50%),\n        radial-gradient(circle at 40% 90%, ${theme.accent}${Math.round(opacity * 0.8 * 255).toString(16).padStart(2, '0')}, transparent 50%),\n        radial-gradient(circle at 70% 30%, ${theme.gradientStart}${Math.round(opacity * 0.6 * 255).toString(16).padStart(2, '0')}, transparent 50%)\n      `;\n\n        default:\n            return `linear-gradient(45deg, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex})`;\n    }\n};\n\n// Real-time gradient updater utility\nexport const updateAllGradients = (mood: keyof typeof moodThemes, gradientType: GradientType) => {\n    const elements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n\n    elements.forEach(element => {\n        const elementType = element.getAttribute('data-mood-element');\n        element.style.backgroundImage = generateGradientStyle(mood, gradientType, 0.4);\n        element.style.transition = 'background-image 0.5s cubic-bezier(0.4, 0, 0.2, 1)';\n    });\n}; "],"names":[],"mappings":";;;;;;AAAO,MAAM,aAAa;IACtB,QAAQ;QACJ,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,aAAa;IAC5C;IACA,OAAO;QACH,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,WAAW;IAC1C;IACA,WAAW;QACP,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,YAAY;IAC3C;IACA,UAAU;QACN,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,eAAe;IAC9C;IACA,YAAY;QACR,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,eAAe;IAC9C;IACA,KAAK;QACD,eAAe;QACf,aAAa;QACb,QAAQ,UAAmB,aAAa;IAC5C;AACJ;AAEO,MAAM,gBAAgB;IACzB,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,OAAO;IACP,MAAM;IACN,MAAM;AACV;AAIO,MAAM,wBAAwB,CACjC,MACA,cACA,UAAkB,GAAG;IAErB,MAAM,QAAQ,UAAU,CAAC,KAAK;IAC9B,MAAM,aAAa,KAAK,KAAK,CAAC,UAAU,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG;IAEtE,OAAQ;QACJ,KAAK;YACD,OAAO,CAAC,uBAAuB,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,CAAC,CAAC;QAE3G,KAAK;YACD,OAAO,CAAC,mCAAmC,EAAE,MAAM,aAAa,GAAG,WAAW,KAAK,EAAE,MAAM,WAAW,GAAG,WAAW,MAAM,CAAC;QAE/H,KAAK;YACD,OAAO,CAAC,qCAAqC,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,EAAE,EAAE,MAAM,MAAM,GAAG,WAAW,EAAE,EAAE,MAAM,aAAa,GAAG,WAAW,CAAC,CAAC;QAE5L,KAAK;YACD,OAAO,CAAC;qDACiC,EAAE,MAAM,aAAa,GAAG,WAAW;uDACjC,EAAE,MAAM,WAAW,GAAG,WAAW;MAClF,CAAC;QAEC,KAAK;YACD,OAAO,CAAC;2CACuB,EAAE,MAAM,aAAa,GAAG,WAAW;2CACnC,EAAE,MAAM,WAAW,GAAG,WAAW;2CACjC,EAAE,MAAM,MAAM,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;MACpH,CAAC;QAEC,KAAK;YACD,OAAO,CAAC;2CACuB,EAAE,MAAM,aAAa,GAAG,WAAW;2CACnC,EAAE,MAAM,WAAW,GAAG,WAAW;2CACjC,EAAE,MAAM,MAAM,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;2CAC/E,EAAE,MAAM,aAAa,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;MAC3H,CAAC;QAEC;YACI,OAAO,CAAC,uBAAuB,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,CAAC,CAAC;IAC/G;AACJ;AAGO,MAAM,qBAAqB,CAAC,MAA+B;IAC9D,MAAM,WAAW,SAAS,gBAAgB,CAAC;IAE3C,SAAS,OAAO,CAAC,CAAA;QACb,MAAM,cAAc,QAAQ,YAAY,CAAC;QACzC,QAAQ,KAAK,CAAC,eAAe,GAAG,sBAAsB,MAAM,cAAc;QAC1E,QAAQ,KAAK,CAAC,UAAU,GAAG;IAC/B;AACJ","debugId":null}},
    {"offset": {"line": 4045, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionModeToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface ReflectionModeToggleProps {\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst ReflectionModeToggle: React.FC<ReflectionModeToggleProps> = ({ \n  className = '',\n  style = {}\n}) => {\n  const [reflectionsEnabled, setReflectionsEnabled] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [mood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective');\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      \n      if (user) {\n        // Load user's reflection preference from localStorage\n        const savedPreference = localStorage.getItem('reflectionsEnabled');\n        if (savedPreference !== null) {\n          const enabled = JSON.parse(savedPreference);\n          setReflectionsEnabled(enabled);\n          // Apply initial state to DOM\n          setTimeout(() => {\n            const reflectionElements = document.querySelectorAll('[data-reflection-element]') as NodeListOf<HTMLElement>;\n            reflectionElements.forEach(element => {\n              element.style.display = enabled ? '' : 'none';\n            });\n          }, 100);\n        } else {\n          setReflectionsEnabled(true);\n        }\n      } else {\n        setReflectionsEnabled(false);\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleToggle = () => {\n    console.log(' ReflectionModeToggle clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) return;\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    const newEnabled = !reflectionsEnabled;\n    setReflectionsEnabled(newEnabled);\n    localStorage.setItem('reflectionsEnabled', JSON.stringify(newEnabled));\n    \n    console.log(' Reflection mode toggled to:', newEnabled);\n    \n    // Force immediate DOM updates for reflection components\n    const reflectionElements = document.querySelectorAll('[data-reflection-element]') as NodeListOf<HTMLElement>;\n    reflectionElements.forEach(element => {\n      if (newEnabled) {\n        element.style.display = '';\n      } else {\n        element.style.display = 'none';\n      }\n    });\n    \n    // Dispatch custom event to notify other components without causing re-renders\n    window.dispatchEvent(new CustomEvent('reflectionModeToggle', { \n      detail: { enabled: newEnabled } \n    }));\n  };\n\n  if (!currentUser) {\n    return (\n      <button\n        style={{\n          ...style,\n          opacity: 0.6,\n          cursor: 'not-allowed'\n        }}\n        disabled\n        title=\"Sign in to use reflections\"\n      >\n        OFF\n      </button>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleToggle}\n      className={className}\n      style={{\n        ...style,\n        transition: 'all 0.3s ease',\n        transform: isAnimating ? 'scale(1.1)' : 'scale(1)',\n        background: reflectionsEnabled \n          ? 'rgba(255, 255, 255, 0.9)' \n          : 'rgba(255, 255, 255, 0.2)',\n        color: reflectionsEnabled ? moodThemes[mood].accent : '#F7FAFC',\n      }}\n      title={reflectionsEnabled ? \"Turn off reflections\" : \"Turn on reflections\"}\n    >\n      {reflectionsEnabled ? 'ON' : 'OFF'}\n    </button>\n  );\n};\n\nexport default React.memo(ReflectionModeToggle); "],"names":[],"mappings":";;;;AAEA;AACA;AAEA;AALA;;;;;AAYA,MAAM,uBAA4D,CAAC,EACjE,YAAY,EAAE,EACd,QAAQ,CAAC,CAAC,EACX;IACC,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC7D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAe;IAC5D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,KAAK,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAwE;IAE9F,gCAAgC;IAChC,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,cAAc,4HAAA,CAAA,OAAI,CAAC,kBAAkB,CAAC,CAAA;YAC1C,eAAe;YAEf,IAAI,MAAM;gBACR,sDAAsD;gBACtD,MAAM,kBAAkB,aAAa,OAAO,CAAC;gBAC7C,IAAI,oBAAoB,MAAM;oBAC5B,MAAM,UAAU,KAAK,KAAK,CAAC;oBAC3B,sBAAsB;oBACtB,6BAA6B;oBAC7B,WAAW;wBACT,MAAM,qBAAqB,SAAS,gBAAgB,CAAC;wBACrD,mBAAmB,OAAO,CAAC,CAAA;4BACzB,QAAQ,KAAK,CAAC,OAAO,GAAG,UAAU,KAAK;wBACzC;oBACF,GAAG;gBACL,OAAO;oBACL,sBAAsB;gBACxB;YACF,OAAO;gBACL,sBAAsB;YACxB;QACF;QACA,OAAO,IAAM;IACf,GAAG,EAAE;IAEL,MAAM,eAAe;QACnB,QAAQ,GAAG,CAAC;QAEZ,IAAI,CAAC,aAAa;QAElB,mCAAmC;QACnC,eAAe;QACf,WAAW,IAAM,eAAe,QAAQ;QAExC,MAAM,aAAa,CAAC;QACpB,sBAAsB;QACtB,aAAa,OAAO,CAAC,sBAAsB,KAAK,SAAS,CAAC;QAE1D,QAAQ,GAAG,CAAC,kCAAkC;QAE9C,wDAAwD;QACxD,MAAM,qBAAqB,SAAS,gBAAgB,CAAC;QACrD,mBAAmB,OAAO,CAAC,CAAA;YACzB,IAAI,YAAY;gBACd,QAAQ,KAAK,CAAC,OAAO,GAAG;YAC1B,OAAO;gBACL,QAAQ,KAAK,CAAC,OAAO,GAAG;YAC1B;QACF;QAEA,8EAA8E;QAC9E,OAAO,aAAa,CAAC,IAAI,YAAY,wBAAwB;YAC3D,QAAQ;gBAAE,SAAS;YAAW;QAChC;IACF;IAEA,IAAI,CAAC,aAAa;QAChB,qBACE,8OAAC;YACC,OAAO;gBACL,GAAG,KAAK;gBACR,SAAS;gBACT,QAAQ;YACV;YACA,QAAQ;YACR,OAAM;sBACP;;;;;;IAIL;IAEA,qBACE,8OAAC;QACC,SAAS;QACT,WAAW;QACX,OAAO;YACL,GAAG,KAAK;YACR,YAAY;YACZ,WAAW,cAAc,eAAe;YACxC,YAAY,qBACR,6BACA;YACJ,OAAO,qBAAqB,0HAAA,CAAA,aAAU,CAAC,KAAK,CAAC,MAAM,GAAG;QACxD;QACA,OAAO,qBAAqB,yBAAyB;kBAEpD,qBAAqB,OAAO;;;;;;AAGnC;qDAEe,qMAAA,CAAA,UAAK,CAAC,IAAI,CAAC","debugId":null}},
    {"offset": {"line": 4154, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleWithHighlights.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleContainer\": \"ArticleWithHighlights-module__TI8ibW__articleContainer\",\n  \"articleContent\": \"ArticleWithHighlights-module__TI8ibW__articleContent\",\n  \"errorContainer\": \"ArticleWithHighlights-module__TI8ibW__errorContainer\",\n  \"errorMessage\": \"ArticleWithHighlights-module__TI8ibW__errorMessage\",\n  \"loadingContainer\": \"ArticleWithHighlights-module__TI8ibW__loadingContainer\",\n  \"loadingIndicator\": \"ArticleWithHighlights-module__TI8ibW__loadingIndicator\",\n  \"spin\": \"ArticleWithHighlights-module__TI8ibW__spin\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 4169, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/articleService.ts"],"sourcesContent":["// src/services/articleService.ts\n// // or wherever your interface lives\n\nexport async function getArticle(slug: string): Promise<Article> {\n    // 1. Read your base URL (make sure .env.local has NEXT_PUBLIC_API_BASE_URL)\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL\n        || 'http://127.0.0.1:5001'\n\n    // 2. Construct the correct Flask endpoint\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}`\n\n    // 3. Fetch it\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch article: ${res.status} ${res.statusText}`)\n    }\n\n    // 4. Parse JSON and return\n    return res.json()\n}\n\n// Get article comments\nexport async function getArticleComments(slug: string): Promise<ArticleComment[]> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comments`\n\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch comments: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a new comment\nexport async function postComment(slug: string, userId: string, content: string): Promise<ArticleComment> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a reply to a comment\nexport async function postReply(slug: string, commentId: string, userId: string, content: string): Promise<CommentReply> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a comment\nexport async function likeComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a reply\nexport async function likeReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a comment\nexport async function deleteComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a reply\nexport async function deleteReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\nexport interface Article {\n    _id: string;\n    id?: string;           // optional for your samples\n    slug: string;\n    title: string;\n    content: string | ParagraphContent[];\n    author?: string;\n    authorId: string;\n    publishedDate?: string;\n    tags: string[];\n    likes: number | string[];\n    viewCount?: number;\n    readTime?: number;\n    comments?: ArticleComment[];\n    coverImageUrl?: string;\n    createdAt?: string;\n    updatedAt?: string;\n    reposts?: string[];\n}\n\ninterface ParagraphContent {\n    paragraphId: string;\n    text: string;\n    likes: string[];\n    comments: CommentContent[];\n}\n\ninterface CommentContent {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport interface ArticleComment {\n    commentId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4301, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/syntaxHighlighter.js"],"sourcesContent":["import Prism from 'prismjs';\n\n// Import language support\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/components/prism-typescript';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-tsx';\nimport 'prismjs/components/prism-css';\nimport 'prismjs/components/prism-scss';\nimport 'prismjs/components/prism-json';\nimport 'prismjs/components/prism-python';\nimport 'prismjs/components/prism-java';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-cpp';\nimport 'prismjs/components/prism-csharp';\nimport 'prismjs/components/prism-php';\nimport 'prismjs/components/prism-ruby';\nimport 'prismjs/components/prism-go';\nimport 'prismjs/components/prism-rust';\nimport 'prismjs/components/prism-sql';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-markdown';\n\n/**\n * Apply syntax highlighting to all code blocks in a container\n * @param {HTMLElement} container - The container element to search for code blocks\n */\nexport function highlightCodeBlocks(container) {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const codeBlocks = container.querySelectorAll('pre code');\n\n    codeBlocks.forEach(codeBlock => {\n        const pre = codeBlock.parentElement;\n\n        // Get language from class name or data attribute\n        let language = 'javascript'; // default\n\n        // Check for language-* class on the code element\n        const classNames = codeBlock.className.split(' ');\n        for (const className of classNames) {\n            if (className.startsWith('language-')) {\n                language = className.replace('language-', '');\n                break;\n            }\n        }\n\n        // Check for data-language on the pre element\n        if (pre.hasAttribute('data-language')) {\n            language = pre.getAttribute('data-language');\n        }\n\n        // Apply syntax highlighting if language is supported\n        if (Prism.languages[language]) {\n            try {\n                const code = codeBlock.textContent || '';\n                const highlightedCode = Prism.highlight(code, Prism.languages[language], language);\n                codeBlock.innerHTML = highlightedCode;\n\n                // Add language indicator\n                pre.setAttribute('data-language', language);\n                pre.style.position = 'relative';\n\n            } catch (error) {\n                console.warn('Syntax highlighting failed for language:', language, error);\n            }\n        }\n    });\n}\n\n/**\n * Auto-detect and highlight code blocks when the DOM is ready\n */\nexport function autoHighlightCodeBlocks() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const highlightOnLoad = () => {\n        const containers = [\n            document.querySelector('.article-content'),\n            document.querySelector('.paragraph-text'),\n            document.querySelector('.paragraph-block'),\n            document.body\n        ].filter(Boolean);\n\n        containers.forEach(container => {\n            if (container) {\n                highlightCodeBlocks(container);\n            }\n        });\n    };\n\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', highlightOnLoad);\n    } else {\n        highlightOnLoad();\n    }\n}\n\n/**\n * Highlight code blocks after dynamic content is loaded\n * Call this after AJAX content updates\n */\nexport function highlightDynamicContent() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    // Wait a bit for DOM to settle\n    setTimeout(() => {\n        autoHighlightCodeBlocks();\n    }, 100);\n} "],"names":[],"mappings":";;;;;AAAA;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AAMO,SAAS,oBAAoB,SAAS;IACzC,wCAAmC,QAAQ,YAAY;;IAEvD,MAAM;AAsCV;AAKO,SAAS;IACZ,wCAAmC,QAAQ,YAAY;;IAEvD,MAAM;AAoBV;AAMO,SAAS;IACZ,wCAAmC,QAAQ,YAAY;;AAM3D","debugId":null}},
    {"offset": {"line": 4369, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ClientSideHighlighter.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react';\n\nconst CLIENT_SIDE_HIGHLIGHTER_SCRIPT = `\n// Simple syntax highlighting without external dependencies\nfunction highlightCode() {\n  const codeBlocks = document.querySelectorAll('pre code');\n  \n  codeBlocks.forEach(codeBlock => {\n    const pre = codeBlock.parentElement;\n    if (!pre) return;\n    \n    // Apply dark theme\n    pre.style.backgroundColor = '#1e1e1e';\n    pre.style.color = '#d4d4d4';\n    pre.style.border = '1px solid #333';\n    pre.style.borderRadius = '8px';\n    pre.style.padding = '16px';\n    pre.style.fontFamily = \"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace\";\n    pre.style.fontSize = '14px';\n    pre.style.lineHeight = '1.6';\n    pre.style.overflowX = 'auto';\n    pre.style.position = 'relative';\n    \n    const code = codeBlock.textContent || '';\n    let highlightedCode = code;\n    \n    // Simplified highlighting to avoid regex issues\n    try {\n      // Keywords\n      const keywords = ['const', 'let', 'var', 'function', 'class', 'interface', 'type', 'enum', 'import', 'export', 'from', 'as', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'default', 'try', 'catch', 'finally', 'async', 'await', 'new', 'this', 'extends', 'implements', 'private', 'public', 'protected', 'static'];\n      keywords.forEach(keyword => {\n        const regex = new RegExp('\\\\\\\\b' + keyword + '\\\\\\\\b', 'g');\n        highlightedCode = highlightedCode.replace(regex, '<span style=\"color: #569cd6; font-weight: 500;\">' + keyword + '</span>');\n      });\n      \n      // Simple string highlighting\n      highlightedCode = highlightedCode.replace(/\"([^\"]*)\"/g, '<span style=\"color: #ce9178;\">\"$1\"</span>');\n      highlightedCode = highlightedCode.replace(/'([^']*)'/g, '<span style=\"color: #ce9178;\">\\'$1\\'</span>');\n      \n      // Numbers\n      highlightedCode = highlightedCode.replace(/\\\\b\\\\d+\\\\.?\\\\d*\\\\b/g, '<span style=\"color: #b5cea8;\">$&</span>');\n      \n      // Comments\n      highlightedCode = highlightedCode.replace(/\\/\\/.*$/gm, '<span style=\"color: #6a9955; font-style: italic;\">$&</span>');\n    } catch (e) {\n      console.warn('Syntax highlighting failed:', e);\n      // Keep original code if highlighting fails\n    }\n    \n    codeBlock.innerHTML = highlightedCode;\n    \n    // Add language indicator if available\n    let language = 'code';\n    const classNames = codeBlock.className.split(' ');\n    for (const className of classNames) {\n      if (className.startsWith('language-')) {\n        language = className.replace('language-', '');\n        break;\n      }\n    }\n    \n    if (pre.hasAttribute('data-language')) {\n      language = pre.getAttribute('data-language');\n    }\n    \n    // Add language badge\n    const badge = document.createElement('div');\n    badge.textContent = language.toUpperCase();\n    badge.style.position = 'absolute';\n    badge.style.top = '8px';\n    badge.style.right = '12px';\n    badge.style.background = 'rgba(255, 255, 255, 0.1)';\n    badge.style.color = '#a0a0a0';\n    badge.style.padding = '2px 8px';\n    badge.style.borderRadius = '4px';\n    badge.style.fontSize = '12px';\n    badge.style.fontWeight = '500';\n    badge.style.letterSpacing = '0.5px';\n    pre.appendChild(badge);\n  });\n}\n\n// Run when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', highlightCode);\n} else {\n  highlightCode();\n}\n\n// Also run on dynamic content changes\nconst observer = new MutationObserver(() => {\n  setTimeout(highlightCode, 100);\n});\n\nobserver.observe(document.body, {\n  childList: true,\n  subtree: true\n});\n`;\n\nexport default function ClientSideHighlighter() {\n  useEffect(() => {\n    // Create and inject the script\n    const script = document.createElement('script');\n    script.textContent = CLIENT_SIDE_HIGHLIGHTER_SCRIPT;\n    document.head.appendChild(script);\n\n    return () => {\n      // Cleanup if needed\n      try {\n        document.head.removeChild(script);\n      } catch (e) {\n        // Script might already be removed\n      }\n    };\n  }, []);\n\n  return null; // This component doesn't render anything\n} "],"names":[],"mappings":";;;AAEA;AAFA;;AAIA,MAAM,iCAAiC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGxC,CAAC;AAEc,SAAS;IACtB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,+BAA+B;QAC/B,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,OAAO,WAAW,GAAG;QACrB,SAAS,IAAI,CAAC,WAAW,CAAC;QAE1B,OAAO;YACL,oBAAoB;YACpB,IAAI;gBACF,SAAS,IAAI,CAAC,WAAW,CAAC;YAC5B,EAAE,OAAO,GAAG;YACV,kCAAkC;YACpC;QACF;IACF,GAAG,EAAE;IAEL,OAAO,MAAM,yCAAyC;AACxD","debugId":null}},
    {"offset": {"line": 4495, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/getMoodFromText.ts"],"sourcesContent":["import Sentiment from 'sentiment';\n\nexport function getMoodFromText(text: string): 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic' {\n    const sentiment = new Sentiment();\n    const result = sentiment.analyze(text);\n    const lowerText = text.toLowerCase();\n\n    // Define emotion keywords\n    const angryWords = ['angry', 'furious', 'rage', 'mad', 'hate', 'disgusted', 'outraged', 'pissed', 'frustrated', 'livid', 'infuriated', 'enraged', 'trump', 'politician', 'corrupt', 'stupid', 'idiot', 'terrible', 'awful', 'worst', 'disgusting', 'pathetic'];\n    const joyfulWords = ['happy', 'joy', 'excited', 'amazing', 'wonderful', 'fantastic', 'great', 'awesome', 'brilliant', 'excellent', 'perfect', 'beautiful', 'love', 'celebrate', 'triumph', 'success', 'victory', 'delighted', 'cheerful', 'blissful'];\n    const peacefulWords = ['calm', 'peaceful', 'serene', 'tranquil', 'gentle', 'soothing', 'quiet', 'meditation', 'zen', 'harmony', 'balance', 'nature', 'garden', 'sunset', 'ocean', 'mindful', 'breathe', 'stillness'];\n    const energeticWords = ['energy', 'power', 'strong', 'dynamic', 'intense', 'passionate', 'vibrant', 'bold', 'fierce', 'electric', 'explosive', 'powerful', 'charged', 'pumped', 'motivated', 'driven'];\n    const sadWords = ['sad', 'depressed', 'melancholy', 'grief', 'sorrow', 'tragic', 'heartbreak', 'crying', 'tears', 'lonely', 'despair', 'hopeless', 'miserable', 'devastated', 'broken'];\n\n    // Count keyword matches\n    const angryCount = angryWords.filter(word => lowerText.includes(word)).length;\n    const joyfulCount = joyfulWords.filter(word => lowerText.includes(word)).length;\n    const peacefulCount = peacefulWords.filter(word => lowerText.includes(word)).length;\n    const energeticCount = energeticWords.filter(word => lowerText.includes(word)).length;\n    const sadCount = sadWords.filter(word => lowerText.includes(word)).length;\n\n    // Determine mood based on keyword frequency and sentiment\n    if (angryCount >= 2 || (angryCount >= 1 && result.score < -2)) return 'angry';\n    if (joyfulCount >= 2 || (joyfulCount >= 1 && result.score > 3)) return 'joyful';\n    if (peacefulCount >= 2 || (peacefulCount >= 1 && result.score > 0)) return 'peaceful';\n    if (energeticCount >= 2 || (energeticCount >= 1 && Math.abs(result.score) > 2)) return 'energetic';\n    if (sadCount >= 2 || (sadCount >= 1 && result.score < -1)) return 'sad';\n\n    // Fallback to sentiment score\n    if (result.score > 2) return 'joyful';\n    if (result.score < -3) return 'angry';\n    if (result.score < -1) return 'sad';\n    return 'reflective';\n} "],"names":[],"mappings":";;;AAAA;;AAEO,SAAS,gBAAgB,IAAY;IACxC,MAAM,YAAY,IAAI,yIAAA,CAAA,UAAS;IAC/B,MAAM,SAAS,UAAU,OAAO,CAAC;IACjC,MAAM,YAAY,KAAK,WAAW;IAElC,0BAA0B;IAC1B,MAAM,aAAa;QAAC;QAAS;QAAW;QAAQ;QAAO;QAAQ;QAAa;QAAY;QAAU;QAAc;QAAS;QAAc;QAAW;QAAS;QAAc;QAAW;QAAU;QAAS;QAAY;QAAS;QAAS;QAAc;KAAW;IAC9P,MAAM,cAAc;QAAC;QAAS;QAAO;QAAW;QAAW;QAAa;QAAa;QAAS;QAAW;QAAa;QAAa;QAAW;QAAa;QAAQ;QAAa;QAAW;QAAW;QAAW;QAAa;QAAY;KAAW;IACrP,MAAM,gBAAgB;QAAC;QAAQ;QAAY;QAAU;QAAY;QAAU;QAAY;QAAS;QAAc;QAAO;QAAW;QAAW;QAAU;QAAU;QAAU;QAAS;QAAW;QAAW;KAAY;IACpN,MAAM,iBAAiB;QAAC;QAAU;QAAS;QAAU;QAAW;QAAW;QAAc;QAAW;QAAQ;QAAU;QAAY;QAAa;QAAY;QAAW;QAAU;QAAa;KAAS;IACtM,MAAM,WAAW;QAAC;QAAO;QAAa;QAAc;QAAS;QAAU;QAAU;QAAc;QAAU;QAAS;QAAU;QAAW;QAAY;QAAa;QAAc;KAAS;IAEvL,wBAAwB;IACxB,MAAM,aAAa,WAAW,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAC7E,MAAM,cAAc,YAAY,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAC/E,MAAM,gBAAgB,cAAc,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IACnF,MAAM,iBAAiB,eAAe,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IACrF,MAAM,WAAW,SAAS,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAEzE,0DAA0D;IAC1D,IAAI,cAAc,KAAM,cAAc,KAAK,OAAO,KAAK,GAAG,CAAC,GAAI,OAAO;IACtE,IAAI,eAAe,KAAM,eAAe,KAAK,OAAO,KAAK,GAAG,GAAI,OAAO;IACvE,IAAI,iBAAiB,KAAM,iBAAiB,KAAK,OAAO,KAAK,GAAG,GAAI,OAAO;IAC3E,IAAI,kBAAkB,KAAM,kBAAkB,KAAK,KAAK,GAAG,CAAC,OAAO,KAAK,IAAI,GAAI,OAAO;IACvF,IAAI,YAAY,KAAM,YAAY,KAAK,OAAO,KAAK,GAAG,CAAC,GAAI,OAAO;IAElE,8BAA8B;IAC9B,IAAI,OAAO,KAAK,GAAG,GAAG,OAAO;IAC7B,IAAI,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;IAC9B,IAAI,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;IAC9B,OAAO;AACX","debugId":null}},
    {"offset": {"line": 4630, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleWithHighlights.tsx"],"sourcesContent":["'use client'\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { HighlightProvider } from '@/context/HighlightContext';\nimport ArticleHighlights from './ArticleHighlights';\nimport MoodToggle from './MoodToggle';\nimport ReflectionToggle from './ReflectionToggle';\nimport ReflectionModeToggle from './ReflectionModeToggle';\nimport styles from '@/styles/ArticleWithHighlights.module.css';\nimport { getArticle } from '@/services/articleService';\nimport { highlightCodeBlocks } from '@/utils/syntaxHighlighter';\nimport ClientSideHighlighter from './ClientSideHighlighter';\nimport { getMoodFromText } from '@/utils/getMoodFromText';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface ArticleWithHighlightsProps {\n  articleId: string;\n  initialHtml?: string;\n  isAuthenticated?: boolean;\n  articleTitle?: string;\n  articleSlug?: string;\n}\n\nconst ArticleWithHighlights: React.FC<ArticleWithHighlightsProps> = ({\n  articleId,\n  initialHtml,\n  isAuthenticated = false,\n  articleTitle = 'Article',\n  articleSlug = ''\n}) => {\n  const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(true);\n  const [article, setArticle] = useState<{ title: string; body: string } | null>(null);\n  const [isLoading, setIsLoading] = useState(!initialHtml);\n  const [error, setError] = useState('');\n  const [mood, setMood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective');\n  const articleContainerRef = useRef<HTMLDivElement>(null);\n\n\n\n  // Apply syntax highlighting when content loads\n  useEffect(() => {\n    if (articleContainerRef.current && (initialHtml || article)) {\n      // Small delay to ensure DOM is updated\n      setTimeout(() => {\n        if (articleContainerRef.current) {\n          highlightCodeBlocks(articleContainerRef.current);\n        }\n      }, 100);\n    }\n  }, [initialHtml, article]);\n\n  // Analyze mood when content is available\n  useEffect(() => {\n    const content = getContentToDisplay();\n    if (content) {\n      // Extract text from HTML for sentiment analysis\n      const textContent = content.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\n      if (textContent) {\n        const detectedMood = getMoodFromText(textContent);\n        setMood(detectedMood);\n      }\n    }\n  }, [initialHtml, article]);\n\n  const handleShare = (text: string) => {\n    if (navigator.share) {\n      navigator.share({\n        title: article?.title || 'Shared highlight',\n        text: `\"${text}\" - from article ${articleId}`,\n        url: window.location.href\n      }).catch(error => console.error('Error sharing:', error));\n    } else {\n      const shareText = `\"${text}\" - from article ${articleId} ${window.location.href}`;\n      navigator.clipboard.writeText(shareText)\n        .then(() => alert('Highlight copied to clipboard!'))\n        .catch(error => console.error('Error copying to clipboard:', error));\n    }\n  };\n\n\n\n  // Load the article if needed\n  useEffect(() => {\n    if (initialHtml || article) return;\n\n    const fetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        const articleData = await getArticle(articleId);\n\n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n\n        let content = '';\n        if (typeof articleData.content === 'string') {\n          content = articleData.content;\n        } else {\n          content = articleData.content.map(p => `<p>${p.text}</p>`).join('\\n');\n        }\n\n        const cleanHtml = content\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n\n        setArticle({\n          title: articleData.title,\n          body: cleanHtml\n        });\n\n      } catch (error) {\n        console.error('Error loading article:', error);\n        setError('Failed to load article');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchArticle();\n  }, [articleId, article, initialHtml]);\n\n  // Get the content to display\n  const getContentToDisplay = () => {\n    if (initialHtml) {\n      return initialHtml\n        .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n        .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n    }\n    return article?.body || '';\n  };\n\n  if (isLoading) {\n    return (\n      <div className={styles.loadingContainer}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <p className={styles.errorMessage}>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <HighlightProvider articleId={articleId}>\n      <ClientSideHighlighter />\n      <article className={styles.articleContainer}>\n        {/* Reflection Settings */}\n        <div \n          data-toggle-bar=\"true\"\n          style={{ \n            display: 'flex', \n            justifyContent: 'space-between', \n            alignItems: 'center', \n            gap: '1rem', \n            margin: '1rem 0',\n            padding: '1rem',\n            backgroundImage: isAuthenticated \n              ? `linear-gradient(270deg, ${moodThemes[mood].gradientStart}, ${moodThemes[mood].gradientEnd})`\n              : 'linear-gradient(270deg, #9CA3AF, #6B7280)',\n            backgroundSize: '200% 200%',\n            animation: 'slideGradient 8s ease infinite alternate',\n            borderRadius: '20px',\n            border: '1px solid rgba(255, 255, 255, 0.5)',\n            boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)',\n            fontSize: '0.875rem'\n          }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n            <span style={{ \n              color: '#F7FAFC',\n              fontWeight: '500',\n              fontSize: '0.875rem',\n              opacity: 0.9\n            }}>\n              {isAuthenticated ? ' Atmosphere adapted' : ' Sign in for enhanced features'}\n            </span>\n            {isAuthenticated && (\n              <span style={{ \n                color: '#F7FAFC',\n                fontWeight: '600',\n                fontSize: '0.875rem'\n              }}>\n                 Enhanced features active\n              </span>\n            )}\n          </div>\n          \n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            {/* Mood Background Toggle */}\n            <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.75rem' }}>\n              Mood Background\n            </span>\n            <MoodToggle\n              style={{\n                padding: '0.4rem 0.8rem',\n                border: 'none',\n                background: 'rgba(255, 255, 255, 0.2)',\n                color: '#F7FAFC',\n                borderRadius: '20px',\n                fontSize: '0.7rem',\n                fontWeight: '600',\n                cursor: 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                backdropFilter: 'blur(10px)',\n              }}\n            />\n            \n            <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.75rem' }}>\n              Interactive Reflections\n            </span>\n            <ReflectionModeToggle\n              style={{\n                padding: '0.4rem 0.8rem',\n                border: 'none',\n                borderRadius: '20px',\n                fontSize: '0.7rem',\n                fontWeight: '600',\n                cursor: 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                backdropFilter: 'blur(10px)',\n              }}\n            />\n          </div>\n        </div>\n\n        <ArticleHighlights \n          articleId={articleId} \n          articleTitle={articleTitle}\n          articleSlug={articleSlug}\n          onShare={handleShare}\n        >\n          <div className={styles.articleContent}>\n            {/* Original article content with preserved formatting */}\n            <div \n              ref={articleContainerRef}\n              dangerouslySetInnerHTML={{ __html: getContentToDisplay() }}\n            />\n          </div>\n          \n          {/* Isolated Reflection Component */}\n          <ReflectionToggle articleId={articleId} />\n\n\n        </ArticleHighlights>\n      </article>\n    </HighlightProvider>\n  );\n};\n\nexport default ArticleWithHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4994, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/articles.ts"],"sourcesContent":["import { collection, addDoc, getDocs, getDoc, doc, query, orderBy, Timestamp, where, DocumentData, DocumentSnapshot, deleteDoc, updateDoc, arrayUnion, arrayRemove, limit as firestoreLimit, QueryConstraint } from 'firebase/firestore';\nimport { db, auth } from './clientApp';\nimport { createCommentNotification } from './notifications';\n\n// Article interface matching our Firestore structure\nexport interface Article {\n    id?: string;\n    title: string;\n    body: string;\n    createdAt: Timestamp;\n    updatedAt?: Timestamp;\n    authorId: string;\n    authorName: string;\n    tags?: string[];\n    coverImage?: string | null;\n    slug?: string;\n    status?: 'published' | 'drafts';\n    likes?: string[];\n    excerpt?: string;\n    viewCount?: number;\n    reposts?: string[];\n    comments?: any[];\n}\n\n// Comment interfaces for Firestore\nexport interface ArticleComment {\n    id?: string;\n    commentId?: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n}\n\n// Get articles from Firestore, ordered by createdAt desc, with optional limit and draft inclusion\nexport async function getArticles(options: { limit?: number; includeDrafts?: boolean } = {}) {\n    const { limit, includeDrafts = false } = options;\n    console.log('getArticles called with limit:', limit);\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints = [];\n\n        if (!includeDrafts) {\n            // If status is explicitly 'published' OR if status field does not exist (older data might not have it)\n            // Firestore doesn't easily support \"OR\" across different fields or \"field not exists\" in combination with other `where` on same field.\n            // A common approach is to ensure all articles have a status.\n            // For now, we'll explicitly query for 'published'. If you need to include articles where 'status' is undefined\n            // as 'published', you might need two separate queries or adjust your data model to always include a 'status'.\n            queryConstraints.push(where('status', '==', 'published'));\n        }\n        // Always order by creation date\n        queryConstraints.push(orderBy('createdAt', 'desc'));\n\n        if (limit && limit > 0) {\n            console.log('Adding limit constraint:', limit);\n            queryConstraints.push(firestoreLimit(limit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n        console.log('Query returned document count:', querySnapshot.size);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            const articleData = docSnapshot.data() as Omit<Article, 'id'>;\n\n            // The query now handles filtering for published status if includeDrafts is false.\n            // If includeDrafts is true, no status filter is applied in the query.\n            articles.push({\n                id: docSnapshot.id,\n                ...articleData\n            });\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles:', error);\n        throw error;\n    }\n}\n\n// Get a single article by ID - DIRECT NO-CACHE VERSION\nexport async function getArticleById(id: string): Promise<Article | null> {\n    try {\n        // Super aggressive cache-busting\n        const timestamp = Date.now();\n        console.log(` DIRECT FETCH: Getting article with ID: ${id} (time: ${timestamp})`);\n\n        // Completely bypass any caching by making a direct Firestore call\n        const docRef = doc(db, 'articles', id);\n\n        // Direct Firestore fetch with no caching\n\n        // Get fresh data directly\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const articleData = {\n                id: docSnap.id,\n                ...docSnap.data()\n            } as Article;\n\n            console.log(' Article found:', articleData.title);\n            console.log(' Content length:', articleData.body?.length || 0);\n            console.log(' Tags:', articleData.tags?.join(', ') || 'none');\n\n            // Return fresh data\n            return articleData;\n        } else {\n            console.log(' Article not found for ID:', id);\n            return null;\n        }\n    } catch (error) {\n        console.error(' Error getting article:', error);\n        throw error;\n    }\n}\n\n// Get a single article by slug\nexport async function getArticleBySlug(slug: string): Promise<Article | null> {\n    try {\n        console.log(`Getting article by slug: ${slug}, timestamp: ${Date.now()}`);\n\n        // Try multiple attempts to get fresh data\n        let attempts = 0;\n        const maxAttempts = 2;\n\n        while (attempts < maxAttempts) {\n            attempts++;\n            console.log(`Attempt ${attempts} to get article by slug`);\n\n            // Short delay between attempts\n            if (attempts > 1) {\n                await new Promise(resolve => setTimeout(resolve, 500));\n            }\n\n            const articlesRef = collection(db, 'articles');\n            const q = query(articlesRef, where('slug', '==', slug), where('status', '==', 'published'));\n            const querySnapshot = await getDocs(q);\n\n            if (!querySnapshot.empty) {\n                const docSnap = querySnapshot.docs[0];\n                const articleData = {\n                    id: docSnap.id,\n                    ...docSnap.data()\n                } as Article;\n\n                console.log('Article found by slug:', articleData.title, 'Content length:', articleData.body?.length || 0);\n                return articleData;\n            } else if (attempts >= maxAttempts) {\n                console.log('Article not found for slug after multiple attempts:', slug);\n                return null;\n            }\n\n            console.log(`Article not found by slug on attempt ${attempts}, will retry...`);\n        }\n\n        return null;\n    } catch (error) {\n        console.error('Error getting article by slug:', error);\n        throw error;\n    }\n}\n\n// Create a new article\nexport async function createArticle(articleInput: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>> & { title: string; body: string; }) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to create an article');\n        }\n\n        const newArticleData: Omit<Article, 'id'> = {\n            title: articleInput.title,\n            body: articleInput.body,\n            slug: articleInput.slug || articleInput.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, ''),\n            createdAt: Timestamp.now(),\n            authorId: user.uid,\n            authorName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            tags: articleInput.tags || [],\n            status: articleInput.status || 'published',\n            coverImage: articleInput.coverImage || null,\n            likes: [],\n            excerpt: articleInput.excerpt || '',\n            viewCount: 0,\n            reposts: [],\n            comments: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles'), newArticleData);\n        return {\n            id: docRef.id,\n            ...newArticleData\n        } as Article;\n    } catch (error) {\n        console.error('Error creating article:', error);\n        throw error;\n    }\n}\n\n// Update an existing article\nexport async function updateArticle(articleId: string, articleData: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>>) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to edit an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleSnap = await getDoc(articleRef);\n\n        if (!articleSnap.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const existingArticleData = articleSnap.data() as Article;\n        if (existingArticleData.authorId !== user.uid) {\n            throw new Error('You can only edit your own articles');\n        }\n\n        const updateData: Partial<Article> = { ...articleData };\n\n        // Always update slug when title changes to ensure published articles reflect changes\n        if (articleData.title) {\n            updateData.slug = articleData.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, '');\n            console.log('Updated slug to:', updateData.slug);\n        }\n        updateData.updatedAt = Timestamp.now();\n\n        await updateDoc(articleRef, updateData);\n\n        const updatedArticleSnap = await getDoc(articleRef);\n        return {\n            id: updatedArticleSnap.id,\n            ...updatedArticleSnap.data()\n        } as Article;\n    } catch (error) {\n        console.error('Error updating article:', error);\n        throw error;\n    }\n}\n\n// Comments functions\nexport async function getArticleComments(articleId: string) {\n    try {\n        const commentsRef = collection(db, 'articles', articleId, 'comments');\n        const q = query(commentsRef, orderBy('createdAt', 'desc'));\n        const querySnapshot = await getDocs(q);\n\n        const comments: ArticleComment[] = [];\n        querySnapshot.forEach((doc) => {\n            const commentData = doc.data() as Omit<ArticleComment, 'id' | 'commentId'>;\n            comments.push({\n                id: doc.id,\n                commentId: doc.id,\n                ...commentData,\n                replies: commentData.replies || []\n            });\n        });\n\n        return comments;\n    } catch (error) {\n        console.error('Error getting comments:', error);\n        throw error;\n    }\n}\n\nexport async function addComment(articleId: string, content: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to comment');\n        }\n\n        const newComment: Omit<ArticleComment, 'id' | 'commentId'> = {\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: [],\n            replies: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles', articleId, 'comments'), newComment);\n\n        const articleInfoForNotification = await getArticleById(articleId);\n        if (articleInfoForNotification && articleInfoForNotification.authorId !== user.uid) {\n            await createCommentNotification(\n                articleInfoForNotification.authorId,\n                articleId,\n                articleInfoForNotification.slug || '',\n                articleInfoForNotification.title || 'Article',\n                docRef.id,\n                content\n            );\n        }\n\n        return {\n            id: docRef.id,\n            commentId: docRef.id,\n            ...newComment\n        } as ArticleComment;\n    } catch (error) {\n        console.error('Error adding comment:', error);\n        throw error;\n    }\n}\n\nexport async function addReply(articleId: string, commentId: string, content: string): Promise<CommentReply> {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to reply');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const newReply: CommentReply = {\n            replyId: Math.random().toString(36).substring(2, 15),\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: []\n        };\n\n        await updateDoc(commentRef, {\n            replies: arrayUnion(newReply)\n        });\n\n        const commentData = commentSnap.data() as ArticleComment;\n        if (commentData.userId !== user.uid) {\n            const articleInfo = await getArticleById(articleId);\n            console.log(`User ${user.uid} replied to comment ${commentId} by ${commentData.userId} on article ${articleInfo?.title}`);\n        }\n\n        return newReply;\n    } catch (error) {\n        console.error('Error adding reply:', error);\n        throw error;\n    }\n}\n\nexport async function likeComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to like a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n        const userId = user.uid;\n\n        const likes = commentData.likes || [];\n        const hasLiked = likes.includes(userId);\n\n        await updateDoc(commentRef, {\n            likes: hasLiked ? arrayRemove(userId) : arrayUnion(userId)\n        });\n\n        const updatedSnap = await getDoc(commentRef);\n        const updatedData = updatedSnap.data() as ArticleComment;\n\n        return {\n            success: true,\n            action: hasLiked ? 'unliked' : 'liked',\n            likes: updatedData.likes,\n            count: updatedData.likes.length\n        };\n    } catch (error) {\n        console.error('Error liking comment:', error);\n        throw error;\n    }\n}\n\nexport async function deleteComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n\n        if (commentData.userId !== user.uid) {\n            throw new Error('You can only delete your own comments');\n        }\n\n        await deleteDoc(commentRef);\n\n        return {\n            success: true,\n            message: 'Comment deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting comment:', error);\n        throw error;\n    }\n}\n\n// Delete an article\nexport async function deleteArticle(articleId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleDoc = await getDoc(articleRef);\n\n        if (!articleDoc.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const articleData = articleDoc.data() as Article;\n\n        if (articleData.authorId !== user.uid) {\n            throw new Error('You can only delete your own articles');\n        }\n\n        await deleteDoc(articleRef);\n\n        return {\n            success: true,\n            message: 'Article deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting article:', error);\n        throw error;\n    }\n}\n\n// Get articles by tag\nexport async function getArticlesByTag(tag: string, options: { limit?: number } = {}) {\n    const { limit: queryLimit } = options;\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints: QueryConstraint[] = [\n            where('tags', 'array-contains', tag),\n            where('status', '==', 'published'),\n            orderBy('createdAt', 'desc')\n        ];\n\n        if (queryLimit && queryLimit > 0) {\n            queryConstraints.push(firestoreLimit(queryLimit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            articles.push({\n                id: docSnapshot.id,\n                ...docSnapshot.data()\n            } as Article);\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles by tag:', error);\n        throw error;\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5382, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/comment.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"commentActions\": \"comment-module__H_rXLG__commentActions\",\n  \"commentAvatar\": \"comment-module__H_rXLG__commentAvatar\",\n  \"commentContent\": \"comment-module__H_rXLG__commentContent\",\n  \"commentDate\": \"comment-module__H_rXLG__commentDate\",\n  \"commentDeleteBtn\": \"comment-module__H_rXLG__commentDeleteBtn\",\n  \"commentError\": \"comment-module__H_rXLG__commentError\",\n  \"commentForm\": \"comment-module__H_rXLG__commentForm\",\n  \"commentHeader\": \"comment-module__H_rXLG__commentHeader\",\n  \"commentInput\": \"comment-module__H_rXLG__commentInput\",\n  \"commentInputContainer\": \"comment-module__H_rXLG__commentInputContainer\",\n  \"commentItem\": \"comment-module__H_rXLG__commentItem\",\n  \"commentLikeBtn\": \"comment-module__H_rXLG__commentLikeBtn\",\n  \"commentLoading\": \"comment-module__H_rXLG__commentLoading\",\n  \"commentSection\": \"comment-module__H_rXLG__commentSection\",\n  \"commentSectionTitle\": \"comment-module__H_rXLG__commentSectionTitle\",\n  \"commentSubmit\": \"comment-module__H_rXLG__commentSubmit\",\n  \"commentUser\": \"comment-module__H_rXLG__commentUser\",\n  \"commentsList\": \"comment-module__H_rXLG__commentsList\",\n  \"inThread\": \"comment-module__H_rXLG__inThread\",\n  \"liked\": \"comment-module__H_rXLG__liked\",\n  \"loadingDot\": \"comment-module__H_rXLG__loadingDot\",\n  \"loadingDots\": \"comment-module__H_rXLG__loadingDots\",\n  \"loginButton\": \"comment-module__H_rXLG__loginButton\",\n  \"loginModal\": \"comment-module__H_rXLG__loginModal\",\n  \"loginModalButton\": \"comment-module__H_rXLG__loginModalButton\",\n  \"loginModalButtons\": \"comment-module__H_rXLG__loginModalButtons\",\n  \"loginModalClose\": \"comment-module__H_rXLG__loginModalClose\",\n  \"loginModalOverlay\": \"comment-module__H_rXLG__loginModalOverlay\",\n  \"loginModalText\": \"comment-module__H_rXLG__loginModalText\",\n  \"loginModalTitle\": \"comment-module__H_rXLG__loginModalTitle\",\n  \"loginPromptContainer\": \"comment-module__H_rXLG__loginPromptContainer\",\n  \"noComments\": \"comment-module__H_rXLG__noComments\",\n  \"open\": \"comment-module__H_rXLG__open\",\n  \"primary\": \"comment-module__H_rXLG__primary\",\n  \"pulse\": \"comment-module__H_rXLG__pulse\",\n  \"repliesToggle\": \"comment-module__H_rXLG__repliesToggle\",\n  \"repliesToggleIcon\": \"comment-module__H_rXLG__repliesToggleIcon\",\n  \"replyAvatar\": \"comment-module__H_rXLG__replyAvatar\",\n  \"replyButtons\": \"comment-module__H_rXLG__replyButtons\",\n  \"replyCancel\": \"comment-module__H_rXLG__replyCancel\",\n  \"replyContent\": \"comment-module__H_rXLG__replyContent\",\n  \"replyDate\": \"comment-module__H_rXLG__replyDate\",\n  \"replyForm\": \"comment-module__H_rXLG__replyForm\",\n  \"replyHeader\": \"comment-module__H_rXLG__replyHeader\",\n  \"replyInput\": \"comment-module__H_rXLG__replyInput\",\n  \"replyItem\": \"comment-module__H_rXLG__replyItem\",\n  \"replySection\": \"comment-module__H_rXLG__replySection\",\n  \"replySubmit\": \"comment-module__H_rXLG__replySubmit\",\n  \"replyToggle\": \"comment-module__H_rXLG__replyToggle\",\n  \"replyUser\": \"comment-module__H_rXLG__replyUser\",\n  \"secondary\": \"comment-module__H_rXLG__secondary\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 5441, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/CommentSection.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { auth } from '@/firebase/clientApp';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { \n  getArticleComments, \n  addComment, \n  addReply,\n  likeComment,\n  deleteComment,\n  getArticleBySlug,\n  ArticleComment as FirestoreComment,\n  CommentReply as FirestoreReply\n} from '@/firebase/articles';\nimport { moodThemes } from '@/utils/moodThemes';\nimport styles from '@/styles/comment.module.css';\n\ninterface CommentSectionProps {\n  articleId: string;\n  slug?: string; // Keep slug as optional for backward compatibility\n  isComplex?: boolean; // New prop for article type\n  mood?: 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic';\n  moodFeatureEnabled?: boolean;\n}\n\nconst CommentSection: React.FC<CommentSectionProps> = ({ \n  slug, \n  articleId: propArticleId, \n  isComplex, \n  mood = 'reflective', \n  moodFeatureEnabled = false \n}) => {\n  const [comments, setComments] = useState<FirestoreComment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [newComment, setNewComment] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [focusState, setFocusState] = useState(false);\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [replyContent, setReplyContent] = useState('');\n  const [submittingReply, setSubmittingReply] = useState(false);\n  const [expandedReplies, setExpandedReplies] = useState<Record<string, boolean>>({});\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n  const [articleId, setArticleId] = useState<string | null>(propArticleId || null);\n  \n  // This user object will be updated when authenticated\n  const [currentUser, setCurrentUser] = useState({ id: '', name: 'Reader' });\n\n  useEffect(() => {\n    // Check authentication status\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      const isAuth = !!user;\n      setIsAuthenticated(isAuth);\n      \n      if (isAuth && user) {\n        setCurrentUser({\n          id: user.uid,\n          name: user.displayName || user.email?.split('@')[0] || 'User'\n        });\n      } else {\n        setCurrentUser({ id: '', name: 'Reader' });\n      }\n    });\n    \n    return () => unsubscribe();\n  }, []);\n\n  // First, get the article ID from the slug if not provided directly\n  useEffect(() => {\n    if (propArticleId) {\n      setArticleId(propArticleId);\n      return;\n    }\n    \n    if (!slug) return;\n\n    const fetchArticleId = async () => {\n      try {\n        const article = await getArticleBySlug(slug);\n        if (article && article.id) {\n          setArticleId(article.id);\n        }\n      } catch (err) {\n        console.error('Error fetching article:', err);\n        setError('Unable to load article details.');\n      }\n    };\n\n    fetchArticleId();\n  }, [slug, propArticleId]);\n\n  // Then, fetch comments when we have the articleId\n  useEffect(() => {\n    if (!articleId) return;\n    \n    setLoading(true);\n    const fetchComments = async () => {\n      try {\n        const commentsData = await getArticleComments(articleId);\n        \n        // Add a small delay to show loading animation\n        setTimeout(() => {\n          setComments(commentsData);\n          setLoading(false);\n        }, 800);\n      } catch (err) {\n        console.error('Error fetching comments:', err);\n        setError('Unable to load discussions. Please refresh the page to try again.');\n        setLoading(false);\n      }\n    };\n\n    fetchComments();\n  }, [articleId]);\n\n  const handleCommentSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim() || submitting || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      const comment = await addComment(articleId, newComment);\n      setComments(prev => [comment, ...prev]);\n      setNewComment('');\n      setSubmitting(false);\n      setFocusState(false); // Reset focus state after submission\n    } catch (err) {\n      console.error('Error adding comment:', err);\n      setError('Your response could not be posted. Please try again.');\n      setSubmitting(false);\n    }\n  };\n\n  const handleReplySubmit = async (commentId: string) => {\n    if (!replyContent.trim() || submittingReply || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmittingReply(true);\n      const reply = await addReply(articleId, commentId, replyContent);\n      \n      // Update the local state with the new reply\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { \n                ...comment, \n                replies: [...(comment.replies || []), reply]\n              }\n            : comment\n        )\n      );\n      \n      // Reset reply state\n      setReplyContent('');\n      setReplyingTo(null);\n      setSubmittingReply(false);\n      \n      // Ensure replies for this comment are expanded\n      setExpandedReplies(prev => ({\n        ...prev,\n        [commentId]: true\n      }));\n    } catch (err) {\n      console.error('Error adding reply:', err);\n      setSubmittingReply(false);\n    }\n  };\n\n  const handleLikeComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      const result = await likeComment(articleId, commentId);\n      \n      // Update local state\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { ...comment, likes: result.likes } \n            : comment\n        )\n      );\n    } catch (err) {\n      console.error('Error liking comment:', err);\n    }\n  };\n\n  const handleDeleteComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      return;\n    }\n    \n    try {\n      await deleteComment(articleId, commentId);\n      \n      // Remove comment from local state\n      setComments(prev => \n        prev.filter(comment => \n          comment.commentId !== commentId && comment.id !== commentId\n        )\n      );\n    } catch (err) {\n      console.error('Error deleting comment:', err);\n    }\n  };\n\n  const toggleReplies = (commentId: string) => {\n    setExpandedReplies(prev => ({\n      ...prev,\n      [commentId]: !prev[commentId]\n    }));\n  };\n\n  // Helper to format dates\n  const formatDate = (timestamp: any) => {\n    if (!timestamp) return 'Unknown date';\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    const now = new Date();\n    const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n    \n    // For recent dates, use relative time (which is less prone to hydration issues)\n    if (diffInSeconds < 60) {\n      return 'Just now';\n    } else if (diffInSeconds < 3600) {\n      const minutes = Math.floor(diffInSeconds / 60);\n      return `${minutes} ${minutes === 1 ? 'minute' : 'minutes'} ago`;\n    } else if (diffInSeconds < 86400) {\n      const hours = Math.floor(diffInSeconds / 3600);\n      return `${hours} ${hours === 1 ? 'hour' : 'hours'} ago`;\n    } else if (diffInSeconds < 604800) {\n      const days = Math.floor(diffInSeconds / 86400);\n      return `${days} ${days === 1 ? 'day' : 'days'} ago`;\n    } else {\n      // Use consistent UTC timezone and locale for older dates\n      try {\n        const options: Intl.DateTimeFormatOptions = { \n          year: 'numeric', \n          month: 'short', \n          day: 'numeric',\n          timeZone: 'UTC'\n        };\n        \n        return date.toLocaleDateString('en-US', options);\n      } catch (error) {\n        console.error('Error formatting date:', error);\n        return 'Unknown date';\n      }\n    }\n  };\n\n  // Generate a user avatar with initial\n  const getUserAvatar = (name: string, userId: string, isReply = false) => {\n    const initial = name?.charAt(0).toUpperCase() || 'A';\n    const colors = ['#4f46e5', '#0ea5e9', '#10b981', '#f59e0b', '#ef4444'];\n    const colorIndex = userId ? Math.abs(userId.charCodeAt(0) % colors.length) : 0;\n    const bgColor = colors[colorIndex];\n    \n    return (\n      <div \n        className={isReply ? styles.replyAvatar : styles.commentAvatar} \n        style={{ \n          backgroundColor: bgColor, \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center',\n          color: 'white',\n          fontWeight: 'bold',\n          fontSize: isReply ? '0.9rem' : '1.2rem'\n        }}\n      >\n        {initial}\n      </div>\n    );\n  };\n\n  return (\n    <section \n      className={styles.commentSection}\n      style={moodFeatureEnabled ? {\n        background: `linear-gradient(160deg, \n          rgba(255, 255, 255, 0.1) 0%, \n          ${moodThemes[mood].gradientStart}08 30%, \n          ${moodThemes[mood].gradientEnd}06 70%, \n          rgba(255, 255, 255, 0.05) 100%)`,\n        borderRadius: '32px',\n        border: `1px solid ${moodThemes[mood].gradientStart}12`,\n        boxShadow: `\n          0 8px 32px -8px ${moodThemes[mood].gradientStart}08,\n          inset 0 1px 0 rgba(255, 255, 255, 0.1)\n        `,\n        backdropFilter: 'blur(20px) saturate(1.1)',\n        transition: 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)',\n        position: 'relative',\n        overflow: 'hidden',\n        padding: '2rem'\n      } : {}}\n    >\n      {moodFeatureEnabled && (\n        <>\n          {/* Subtle animated background */}\n          <div\n            style={{\n              position: 'absolute',\n              top: '-50%',\n              left: '-50%',\n              right: '-50%',\n              bottom: '-50%',\n              background: `\n                radial-gradient(circle at 30% 20%, ${moodThemes[mood].gradientStart}04, transparent 40%), \n                radial-gradient(circle at 70% 80%, ${moodThemes[mood].gradientEnd}03, transparent 40%),\n                radial-gradient(circle at 20% 70%, ${moodThemes[mood].gradientStart}02, transparent 30%)\n              `,\n              animation: 'moodFloat 20s ease-in-out infinite',\n              pointerEvents: 'none',\n              zIndex: 0\n            }}\n          />\n          {/* Decorative border glow */}\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              borderRadius: '32px',\n              background: `linear-gradient(45deg, \n                ${moodThemes[mood].gradientStart}05, \n                transparent, \n                ${moodThemes[mood].gradientEnd}05)`,\n              filter: 'blur(1px)',\n              opacity: 0.6,\n              pointerEvents: 'none',\n              zIndex: 0\n            }}\n          />\n        </>\n      )}\n      <div style={{ position: 'relative', zIndex: 1 }}>\n        <h2 \n          className={styles.commentSectionTitle}\n          style={moodFeatureEnabled ? {\n            color: moodThemes[mood].accent,\n            fontWeight: '600',\n            marginBottom: '1.5rem',\n            textShadow: `0 0 20px ${moodThemes[mood].gradientStart}30, 0 0 40px ${moodThemes[mood].gradientStart}15`,\n            transition: 'all 0.3s ease'\n          } : {\n            fontWeight: '600',\n            marginBottom: '1.5rem',\n            color: '#333'\n          }}\n        >\n           Join the Discussion\n        </h2>\n      \n      {error && (\n        <div className={styles.commentError}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\n            <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\n          </svg>\n          {error}\n        </div>\n      )}\n      \n      <form className={styles.commentForm} onSubmit={handleCommentSubmit}>\n        <div\n          className={styles.commentInputContainer}\n          style={moodFeatureEnabled ? {\n            background: `linear-gradient(135deg, \n              rgba(255, 255, 255, ${focusState ? '0.15' : '0.08'}), \n              ${moodThemes[mood].gradientStart}${focusState ? '12' : '06'}, \n              ${moodThemes[mood].gradientEnd}${focusState ? '08' : '04'})`,\n            border: `1px solid ${moodThemes[mood].gradientStart}${focusState ? '25' : '15'}`,\n            borderRadius: '24px',\n            boxShadow: focusState \n              ? `0 8px 32px -4px ${moodThemes[mood].gradientStart}20, \n                 inset 0 1px 0 rgba(255, 255, 255, 0.2)`\n              : `0 4px 16px -4px ${moodThemes[mood].gradientStart}10`,\n            backdropFilter: 'blur(12px)',\n            transform: focusState ? 'translateY(-2px)' : 'translateY(0)',\n            transition: 'all 0.4s cubic-bezier(0.4, 0, 0.2, 1)',\n            position: 'relative',\n            overflow: 'hidden'\n          } : { \n            opacity: focusState ? 1 : 0.85,\n            transition: 'opacity 0.3s ease'\n          }}\n        >\n          {isAuthenticated ? (\n            <>\n              <div className={styles.commentAvatar}>\n                {getUserAvatar(currentUser.name, currentUser.id)}\n              </div>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Share your thoughts...\"\n                value={newComment}\n                onChange={e => setNewComment(e.target.value)}\n                onFocus={() => setFocusState(true)}\n                onBlur={() => {\n                  if (!newComment.trim()) {\n                    setFocusState(false);\n                  }\n                }}\n                style={moodFeatureEnabled ? {\n                  background: 'rgba(255, 255, 255, 0.1)',\n                  border: 'none',\n                  borderRadius: '20px',\n                  color: '#2d3748',\n                  fontSize: '1rem',\n                  padding: '1rem',\n                  resize: 'vertical',\n                  minHeight: '120px',\n                  backdropFilter: 'blur(8px)',\n                  transition: 'all 0.3s ease'\n                } : {}}\n              />\n              <button \n                className={styles.commentSubmit}\n                type=\"submit\" \n                disabled={!newComment.trim() || submitting}\n                style={moodFeatureEnabled ? {\n                  background: `linear-gradient(135deg, \n                    ${moodThemes[mood].accent}, \n                    ${moodThemes[mood].gradientEnd})`,\n                  border: 'none',\n                  color: 'white',\n                  borderRadius: '20px',\n                  fontWeight: '600',\n                  padding: '0.75rem 1.5rem',\n                  boxShadow: `0 4px 16px -4px ${moodThemes[mood].accent}40`,\n                  transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n                  transform: 'translateY(0)',\n                  cursor: 'pointer'\n                } : {}}\n                onMouseEnter={moodFeatureEnabled ? (e) => {\n                  if (!e.currentTarget.disabled) {\n                    e.currentTarget.style.transform = 'translateY(-2px)';\n                    e.currentTarget.style.boxShadow = `0 8px 24px -4px ${moodThemes[mood].accent}60`;\n                  }\n                } : undefined}\n                onMouseLeave={moodFeatureEnabled ? (e) => {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = `0 4px 16px -4px ${moodThemes[mood].accent}40`;\n                } : undefined}\n              >\n                {submitting ? ' Posting...' : ' Post'}\n              </button>\n            </>\n          ) : (\n            <div className={styles.loginPromptContainer} onClick={() => setShowLoginPrompt(true)}>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Login to join the discussion...\"\n                disabled\n              />\n              <button\n                className={`${styles.commentSubmit} ${styles.loginButton}`}\n                type=\"button\"\n                onClick={() => setShowLoginPrompt(true)}\n              >\n                Login to comment\n              </button>\n            </div>\n          )}\n        </div>\n      </form>\n\n      {/* Login Prompt Modal */}\n      {showLoginPrompt && (\n        <div className={styles.loginModalOverlay} onClick={() => setShowLoginPrompt(false)}>\n          <div className={styles.loginModal} onClick={e => e.stopPropagation()}>\n            <button className={styles.loginModalClose} onClick={() => setShowLoginPrompt(false)}></button>\n            <h3 className={styles.loginModalTitle}>Join the conversation</h3>\n            <p className={styles.loginModalText}>\n              Sign in to Journalite to share your thoughts and join the discussion.\n            </p>\n            <div className={styles.loginModalButtons}>\n              <Link href=\"/login\" className={`${styles.loginModalButton} ${styles.primary}`}>\n                Log In\n              </Link>\n              <Link href=\"/register\" className={`${styles.loginModalButton} ${styles.secondary}`}>\n                Create Account\n              </Link>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {loading ? (\n        <div \n          className={styles.commentLoading}\n          style={moodFeatureEnabled ? {\n            background: `linear-gradient(135deg, \n              rgba(255, 255, 255, 0.1), \n              ${moodThemes[mood].gradientStart}06)`,\n                         borderRadius: '24px',\n             padding: '2rem',\n            backdropFilter: 'blur(10px)',\n            border: `1px solid ${moodThemes[mood].gradientStart}10`,\n            textAlign: 'center'\n          } : {}}\n        >\n          <p style={moodFeatureEnabled ? {\n            color: moodThemes[mood].accent,\n            fontWeight: '500',\n            marginBottom: '1rem'\n          } : {}}>\n             Loading comments...\n          </p>\n          <div className={styles.loadingDots}>\n            <div \n              className={styles.loadingDot}\n              style={moodFeatureEnabled ? {\n                background: moodThemes[mood].gradientStart\n              } : {}}\n            ></div>\n            <div \n              className={styles.loadingDot}\n              style={moodFeatureEnabled ? {\n                background: moodThemes[mood].accent\n              } : {}}\n            ></div>\n            <div \n              className={styles.loadingDot}\n              style={moodFeatureEnabled ? {\n                background: moodThemes[mood].gradientEnd\n              } : {}}\n            ></div>\n          </div>\n        </div>\n      ) : comments.length === 0 ? (\n        <div \n          className={styles.noComments}\n          style={moodFeatureEnabled ? {\n            background: `linear-gradient(135deg, \n              rgba(255, 255, 255, 0.15) 0%, \n              ${moodThemes[mood].gradientStart}08 50%, \n              ${moodThemes[mood].gradientEnd}06 100%)`,\n            border: `1px solid ${moodThemes[mood].gradientStart}12`,\n            borderRadius: '24px',\n            boxShadow: `\n              0 6px 24px -8px ${moodThemes[mood].gradientStart}10,\n              inset 0 1px 0 rgba(255, 255, 255, 0.12)\n            `,\n            backdropFilter: 'blur(12px)',\n            color: moodThemes[mood].accent,\n            fontWeight: '500',\n            padding: '2rem',\n            textAlign: 'center',\n            transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)'\n          } : {}}\n        >\n          Be the first to share your thoughts on this article.\n        </div>\n      ) : (\n        <div className={styles.commentsList}>\n          {comments.map(comment => {\n            const commentId = comment.commentId || comment.id || '';\n            return (\n              <div \n                key={commentId} \n                className={styles.commentItem}\n                style={moodFeatureEnabled ? {\n                  background: `linear-gradient(135deg, \n                    rgba(255, 255, 255, 0.12) 0%, \n                    ${moodThemes[mood].gradientStart}06 50%, \n                    ${moodThemes[mood].gradientEnd}04 100%)`,\n                  border: `1px solid ${moodThemes[mood].gradientStart}10`,\n                  borderRadius: '24px',\n                  boxShadow: `\n                    0 4px 20px -6px ${moodThemes[mood].gradientStart}08,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.1)\n                  `,\n                  backdropFilter: 'blur(10px)',\n                  transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n                  position: 'relative',\n                  overflow: 'hidden'\n                } : {}}\n                onMouseEnter={moodFeatureEnabled ? (e) => {\n                  e.currentTarget.style.transform = 'translateY(-1px)';\n                  e.currentTarget.style.boxShadow = `\n                    0 8px 28px -6px ${moodThemes[mood].gradientStart}12,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.15)\n                  `;\n                } : undefined}\n                onMouseLeave={moodFeatureEnabled ? (e) => {\n                  e.currentTarget.style.transform = 'translateY(0)';\n                  e.currentTarget.style.boxShadow = `\n                    0 4px 20px -6px ${moodThemes[mood].gradientStart}08,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.1)\n                  `;\n                } : undefined}\n              >\n                <div className={styles.commentHeader}>\n                  {getUserAvatar(comment.userName, comment.userId)}\n                  <span className={styles.commentUser}>{comment.userName}</span>\n                  <span className={styles.commentDate}>{formatDate(comment.createdAt)}</span>\n                </div>\n                <div className={styles.commentContent}>\n                  {comment.content}\n                </div>\n                <div className={styles.commentActions}>\n                  <button \n                    className={`${styles.commentLikeBtn} ${comment.likes.includes(currentUser.id) ? styles.liked : ''}`}\n                    onClick={() => handleLikeComment(commentId)}\n                    aria-pressed={comment.likes.includes(currentUser.id)}\n                    aria-label={comment.likes.includes(currentUser.id) ? \"Unlike comment\" : \"Like comment\"}\n                  >\n                    {comment.likes.includes(currentUser.id) ? (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-4 h-4\">\n                        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n                      </svg>\n                    ) : (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z\" />\n                      </svg>\n                    )}\n                    <span>{comment.likes.length > 0 ? comment.likes.length : ''}</span>\n                  </button>\n                  \n                  <button \n                    className={styles.replyToggle}\n                    onClick={() => {\n                      if (isAuthenticated) {\n                        setReplyingTo(replyingTo === commentId ? null : commentId);\n                      } else {\n                        setShowLoginPrompt(true);\n                      }\n                    }}\n                    aria-label=\"Reply to comment\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n                    </svg>\n                    <span>Reply</span>\n                  </button>\n                  \n                  {/* Only show delete button for the user's own comments */}\n                  {comment.userId === currentUser.id && (\n                    <button \n                      className={styles.commentDeleteBtn}\n                      onClick={() => handleDeleteComment(commentId)}\n                      aria-label=\"Delete comment\"\n                    >\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\" />\n                      </svg>\n                      <span>Delete</span>\n                    </button>\n                  )}\n                </div>\n                \n                {/* Replies */}\n                {comment.replies && comment.replies.length > 0 && (\n                  <>\n                    <button\n                      className={styles.repliesToggle}\n                      onClick={() => toggleReplies(commentId)}\n                    >\n                      <span className={`${styles.repliesToggleIcon} ${expandedReplies[commentId] ? styles.open : ''}`}>\n                        \n                      </span>\n                      {`${comment.replies.length} ${comment.replies.length === 1 ? 'reply' : 'replies'}`}\n                    </button>\n                    \n                    {expandedReplies[commentId] && (\n                      <div className={styles.replySection}>\n                        {comment.replies.map(reply => (\n                          <div \n                            key={reply.replyId} \n                            className={styles.replyItem}\n                            style={moodFeatureEnabled ? {\n                              background: `linear-gradient(135deg, \n                                rgba(255, 255, 255, 0.08) 0%, \n                                ${moodThemes[mood].gradientStart}04 50%, \n                                ${moodThemes[mood].gradientEnd}03 100%)`,\n                              border: `1px solid ${moodThemes[mood].gradientStart}08`,\n                              borderRadius: '20px',\n                              boxShadow: `\n                                0 2px 12px -4px ${moodThemes[mood].gradientStart}06,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.08)\n                              `,\n                              backdropFilter: 'blur(8px)',\n                              transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n                              margin: '0.75rem 0',\n                              padding: '1rem'\n                            } : {}}\n                            onMouseEnter={moodFeatureEnabled ? (e) => {\n                              e.currentTarget.style.transform = 'translateX(4px)';\n                              e.currentTarget.style.boxShadow = `\n                                0 4px 16px -4px ${moodThemes[mood].gradientStart}10,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.12)\n                              `;\n                            } : undefined}\n                            onMouseLeave={moodFeatureEnabled ? (e) => {\n                              e.currentTarget.style.transform = 'translateX(0)';\n                              e.currentTarget.style.boxShadow = `\n                                0 2px 12px -4px ${moodThemes[mood].gradientStart}06,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.08)\n                              `;\n                            } : undefined}\n                          >\n                            <div className={styles.replyHeader}>\n                              {getUserAvatar(reply.userName, reply.userId, true)}\n                              <span className={styles.replyUser}>{reply.userName}</span>\n                              <span className={styles.replyDate}>{formatDate(reply.createdAt)}</span>\n                            </div>\n                            <div className={styles.replyContent}>\n                              {reply.content}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </>\n                )}\n                \n                {/* Reply form */}\n                {replyingTo === commentId && (\n                  <div \n                    className={`${styles.replyForm} ${comment.replies && comment.replies.length > 0 ? styles.inThread : ''}`}\n                    style={moodFeatureEnabled ? {\n                      background: `linear-gradient(135deg, \n                        rgba(255, 255, 255, 0.1) 0%, \n                        ${moodThemes[mood].gradientStart}06 50%, \n                        ${moodThemes[mood].gradientEnd}04 100%)`,\n                      border: `1px solid ${moodThemes[mood].gradientStart}12`,\n                      borderRadius: '20px',\n                      boxShadow: `0 3px 16px -4px ${moodThemes[mood].gradientStart}08`,\n                      backdropFilter: 'blur(10px)',\n                      padding: '1.5rem',\n                      margin: '1rem 0'\n                    } : {}}\n                  >\n                    <textarea\n                      className={styles.replyInput}\n                      placeholder=\"Write a reply...\"\n                      value={replyContent}\n                      onChange={e => setReplyContent(e.target.value)}\n                      style={moodFeatureEnabled ? {\n                        background: 'rgba(255, 255, 255, 0.08)',\n                        border: `1px solid ${moodThemes[mood].gradientStart}10`,\n                        borderRadius: '16px',\n                        backdropFilter: 'blur(6px)',\n                        color: '#2d3748',\n                        padding: '1rem',\n                        fontSize: '0.95rem'\n                      } : {}}\n                    />\n                    <div className={styles.replyButtons}>\n                      <button \n                        className={styles.replyCancel}\n                        onClick={() => {\n                          setReplyingTo(null);\n                          setReplyContent('');\n                        }}\n                        style={moodFeatureEnabled ? {\n                          background: 'rgba(255, 255, 255, 0.1)',\n                          border: `1px solid ${moodThemes[mood].gradientStart}15`,\n                          borderRadius: '12px',\n                          color: moodThemes[mood].accent,\n                          padding: '0.5rem 1rem',\n                          transition: 'all 0.3s ease'\n                        } : {}}\n                      >\n                        Cancel\n                      </button>\n                      <button \n                        className={styles.replySubmit}\n                        disabled={!replyContent.trim() || submittingReply}\n                        onClick={() => handleReplySubmit(commentId)}\n                        style={moodFeatureEnabled ? {\n                          background: `linear-gradient(135deg, \n                            ${moodThemes[mood].accent}, \n                            ${moodThemes[mood].gradientEnd})`,\n                          border: 'none',\n                          borderRadius: '12px',\n                          color: 'white',\n                          fontWeight: '600',\n                          padding: '0.5rem 1rem',\n                          boxShadow: `0 2px 8px -2px ${moodThemes[mood].accent}40`,\n                          transition: 'all 0.3s ease'\n                        } : {}}\n                      >\n                        {submittingReply ? ' Posting...' : ' Post Reply'}\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n      </div>\n    </section>\n  );\n};\n\nexport default CommentSection; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6591, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/schema.js"],"sourcesContent":["import { Schema, DOMParser, DOMSerializer } from 'prosemirror-model';\n\n// Define all nodes manually including list nodes\nconst nodes = {\n    // Document node - the root\n    doc: {\n        content: 'block+'\n    },\n\n    // Text node - inline text content\n    text: {\n        group: 'inline'\n    },\n\n    // Paragraph node - basic block containing inline content\n    paragraph: {\n        content: 'inline*',\n        group: 'block',\n        parseDOM: [{ tag: 'p' }],\n        toDOM() { return ['p', 0] }\n    },\n\n    // Heading node with levels 1-6\n    heading: {\n        attrs: { level: { default: 1 } },\n        content: 'inline*',\n        group: 'block',\n        defining: true,\n        parseDOM: [\n            { tag: 'h1', attrs: { level: 1 } },\n            { tag: 'h2', attrs: { level: 2 } },\n            { tag: 'h3', attrs: { level: 3 } },\n            { tag: 'h4', attrs: { level: 4 } },\n            { tag: 'h5', attrs: { level: 5 } },\n            { tag: 'h6', attrs: { level: 6 } }\n        ],\n        toDOM(node) { return [`h${node.attrs.level}`, 0] }\n    },\n\n    // Hard break node\n    hard_break: {\n        inline: true,\n        group: 'inline',\n        selectable: false,\n        parseDOM: [{ tag: 'br' }],\n        toDOM() { return ['br'] }\n    },\n\n    // Image node with enhanced attributes\n    image: {\n        inline: true,\n        attrs: {\n            src: {},\n            alt: { default: null },\n            title: { default: null },\n            width: { default: null },\n            height: { default: null }\n        },\n        group: 'inline',\n        draggable: true,\n        parseDOM: [\n            {\n                tag: 'img[src]',\n                getAttrs(dom) {\n                    return {\n                        src: dom.getAttribute('src'),\n                        title: dom.getAttribute('title'),\n                        alt: dom.getAttribute('alt'),\n                        width: dom.getAttribute('width'),\n                        height: dom.getAttribute('height')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { src, alt, title, width, height } = node.attrs;\n            const attrs = { src };\n            if (alt != null) attrs.alt = alt;\n            if (title != null) attrs.title = title;\n            if (width != null) attrs.width = width;\n            if (height != null) attrs.height = height;\n            return ['img', attrs];\n        }\n    },\n\n    // Blockquote node\n    blockquote: {\n        content: 'block+',\n        group: 'block',\n        defining: true,\n        parseDOM: [{ tag: 'blockquote' }],\n        toDOM() { return ['blockquote', 0] }\n    },\n\n    // Code block node with language support\n    code_block: {\n        content: 'text*',\n        marks: '',\n        group: 'block',\n        code: true,\n        defining: true,\n        attrs: {\n            language: { default: 'javascript' }\n        },\n        parseDOM: [{\n            tag: 'pre',\n            preserveWhitespace: 'full',\n            getAttrs(node) {\n                // First check for data-language attribute on pre element\n                const dataLanguage = node.getAttribute('data-language');\n                if (dataLanguage) {\n                    return { language: dataLanguage };\n                }\n\n                // Then check for language-* class on code element\n                const codeElement = node.querySelector('code');\n                if (codeElement) {\n                    const className = codeElement.className || '';\n                    const languageMatch = className.match(/language-(\\w+)/);\n                    if (languageMatch) {\n                        return { language: languageMatch[1] };\n                    }\n                }\n\n                // Default to javascript\n                return { language: 'javascript' };\n            },\n            getContent(node, schema) {\n                // Extract plain text content from the code element, \n                // ignoring any HTML syntax highlighting spans\n                const codeElement = node.querySelector('code');\n                if (codeElement) {\n                    const text = codeElement.textContent || codeElement.innerText || '';\n                    return text ? [schema.text(text)] : [];\n                }\n                return [];\n            }\n        }],\n        toDOM(node) {\n            return ['pre', { 'data-language': node.attrs.language },\n                ['code', { class: `language-${node.attrs.language}` }, 0]];\n        }\n    },\n\n    // Horizontal rule\n    horizontal_rule: {\n        group: 'block',\n        parseDOM: [{ tag: 'hr' }],\n        toDOM() { return ['hr'] }\n    },\n\n    // List nodes - manually defined to avoid addListNodes issue\n    bullet_list: {\n        content: 'list_item+',\n        group: 'block',\n        parseDOM: [{ tag: 'ul' }],\n        toDOM() { return ['ul', 0] }\n    },\n\n    ordered_list: {\n        content: 'list_item+',\n        group: 'block',\n        attrs: { order: { default: 1 } },\n        parseDOM: [{\n            tag: 'ol',\n            getAttrs(dom) {\n                return { order: dom.hasAttribute('start') ? +dom.getAttribute('start') : 1 }\n            }\n        }],\n        toDOM(node) {\n            return node.attrs.order == 1 ? ['ol', 0] : ['ol', { start: node.attrs.order }, 0]\n        }\n    },\n\n    list_item: {\n        content: 'paragraph block*',\n        parseDOM: [{ tag: 'li' }],\n        toDOM() { return ['li', 0] },\n        defining: true\n    }\n};\n\n// Define marks\nconst marks = {\n    // Strong mark (bold)\n    strong: {\n        parseDOM: [\n            { tag: 'strong' },\n            { tag: 'b', getAttrs: node => node.style.fontWeight != 'normal' && null },\n            { style: 'font-weight', getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null }\n        ],\n        toDOM() { return ['strong', 0] }\n    },\n\n    // Emphasis mark (italic)\n    em: {\n        parseDOM: [\n            { tag: 'i' }, { tag: 'em' },\n            { style: 'font-style=italic' }\n        ],\n        toDOM() { return ['em', 0] }\n    },\n\n    // Code mark (inline code)\n    code: {\n        parseDOM: [{ tag: 'code' }],\n        toDOM() { return ['code', 0] }\n    },\n\n    // Link mark with enhanced attributes\n    link: {\n        attrs: {\n            href: {},\n            title: { default: null },\n            target: { default: null }\n        },\n        inclusive: false,\n        parseDOM: [\n            {\n                tag: 'a[href]',\n                getAttrs(dom) {\n                    return {\n                        href: dom.getAttribute('href'),\n                        title: dom.getAttribute('title'),\n                        target: dom.getAttribute('target')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { href, title, target } = node.attrs;\n            const attrs = { href };\n            if (title != null) attrs.title = title;\n            if (target != null) attrs.target = target;\n            return ['a', attrs, 0];\n        }\n    }\n};\n\n// Create and export the schema\nexport const schema = new Schema({\n    nodes,\n    marks\n});\n\n// Helper function to create an empty document\nexport function createEmptyDocument() {\n    return schema.node('doc', null, [\n        schema.node('paragraph')\n    ]);\n}\n\n// Parse HTML content to ProseMirror document\nexport function parseHTML(html) {\n    if (!html || html.trim() === '') {\n        return createEmptyDocument();\n    }\n\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    return DOMParser.fromSchema(schema).parse(div);\n}\n\n// Serialize ProseMirror document to HTML\nexport function serializeToHTML(doc) {\n    const div = document.createElement('div');\n    div.appendChild(DOMSerializer.fromSchema(schema).serializeFragment(doc.content));\n    return div.innerHTML;\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7034, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commandHelpers.js"],"sourcesContent":["import { liftListItem } from 'prosemirror-schema-list';\n\n/**\n * If the selection is inside a list, lift it out first,\n * then run the real command (cmd).\n */\nexport const withListLift = (cmd, listItemNode) => {\n    return (state, dispatch, view) => {\n        let lifted = false;\n\n        if (liftListItem(listItemNode)(state, dispatch, view)) {\n            // state has changed, pull the fresh state from the view\n            state = view.state;\n            lifted = true;\n        }\n        const ok = cmd(state, dispatch, view);\n        return lifted || ok;\n    };\n}; "],"names":[],"mappings":";;;AAAA;;AAMO,MAAM,eAAe,CAAC,KAAK;IAC9B,OAAO,CAAC,OAAO,UAAU;QACrB,IAAI,SAAS;QAEb,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,cAAc,OAAO,UAAU,OAAO;YACnD,wDAAwD;YACxD,QAAQ,KAAK,KAAK;YAClB,SAAS;QACb;QACA,MAAM,KAAK,IAAI,OAAO,UAAU;QAChC,OAAO,UAAU;IACrB;AACJ","debugId":null}},
    {"offset": {"line": 7057, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commands.js"],"sourcesContent":["import { setBlockType, wrapIn, lift } from 'prosemirror-commands';\nimport { liftListItem } from 'prosemirror-schema-list';\nimport { schema } from './schema.js';\nimport { withListLift } from './commandHelpers.js';\n\nconst { heading, paragraph, list_item, blockquote } = schema.nodes;\n\n/**\n * Heading command that works even when text is inside lists\n * Lifts out of lists first, then applies heading level\n */\nexport const headingCmd = (level) =>\n    withListLift(\n        setBlockType(heading, { level }),\n        list_item\n    );\n\n/**\n * Paragraph command that works even when text is inside lists\n * Lifts out of lists first, then applies paragraph format\n */\nexport const paragraphCmd = () =>\n    withListLift(\n        setBlockType(paragraph),\n        list_item\n    );\n\n/**\n * Toggle block-quote on the current selection:\n *    if already quoted   lift out\n *    otherwise           wrap in <blockquote>\n * Works on multiple paragraphs and inside lists.\n */\nexport const toggleBlockquote = (state, dispatch, view) => {\n    // 1. If we're *inside* a blockquote anywhere in the selection, lift it out\n    const { from, to } = state.selection;\n    let inQuote = false;\n    state.doc.nodesBetween(from, to, node => {\n        if (node.type === blockquote) {\n            inQuote = true;\n            return false;              // early exit\n        }\n        return true;\n    });\n\n    if (inQuote) {\n        // also lift once if we're inside a list  blockquote  paragraph\n        if (liftListItem(list_item)(state, dispatch)) return true;\n        return lift(state, dispatch);\n    }\n\n    // 2. Otherwise wrap the selection in a new blockquote\n    //    (lift out of list first so the quote sits at top level)\n    if (liftListItem(list_item)(state, dispatch)) {\n        // state has changed; fetch the fresh state from the view\n        state = view.state;\n    }\n    return wrapIn(blockquote)(state, dispatch, view);\n}; "],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,uHAAA,CAAA,SAAM,CAAC,KAAK;AAM3D,MAAM,aAAa,CAAC,QACvB,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,SAAS;QAAE;IAAM,IAC9B;AAOD,MAAM,eAAe,IACxB,CAAA,GAAA,+HAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,YACb;AASD,MAAM,mBAAmB,CAAC,OAAO,UAAU;IAC9C,2EAA2E;IAC3E,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,MAAM,SAAS;IACpC,IAAI,UAAU;IACd,MAAM,GAAG,CAAC,YAAY,CAAC,MAAM,IAAI,CAAA;QAC7B,IAAI,KAAK,IAAI,KAAK,YAAY;YAC1B,UAAU;YACV,OAAO,OAAoB,aAAa;QAC5C;QACA,OAAO;IACX;IAEA,IAAI,SAAS;QACT,iEAAiE;QACjE,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW,OAAO;QACrD,OAAO,CAAA,GAAA,wJAAA,CAAA,OAAI,AAAD,EAAE,OAAO;IACvB;IAEA,sDAAsD;IACtD,6DAA6D;IAC7D,IAAI,CAAA,GAAA,8JAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW;QAC1C,yDAAyD;QACzD,QAAQ,KAAK,KAAK;IACtB;IACA,OAAO,CAAA,GAAA,wJAAA,CAAA,SAAM,AAAD,EAAE,YAAY,OAAO,UAAU;AAC/C","debugId":null}},
    {"offset": {"line": 7105, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/exitHeadingPlugin.js"],"sourcesContent":["import { Plugin, PluginKey } from 'prosemirror-state';\nimport { setBlockType } from 'prosemirror-commands';\nimport { schema } from './schema.js';\n\nexport const exitHeadingPlugin = new Plugin({\n    key: new PluginKey('exitHeading'),\n    props: {\n        handleKeyDown(view, event) {\n            if (event.key !== 'Enter' || event.shiftKey) return false;\n\n            const { state, dispatch } = view;\n            const { $from, empty } = state.selection;\n            const { heading, paragraph } = schema.nodes;\n\n            // Only trigger if the cursor is at the *end* of a heading\n            if (\n                empty &&\n                $from.parent.type === heading &&\n                $from.parentOffset === $from.parent.content.size\n            ) {\n                event.preventDefault();           // stop default split behaviour\n                return setBlockType(paragraph)(state, dispatch, view);\n            }\n            return false; // let other handlers run\n        },\n    },\n}); "],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEO,MAAM,oBAAoB,IAAI,qJAAA,CAAA,SAAM,CAAC;IACxC,KAAK,IAAI,qJAAA,CAAA,YAAS,CAAC;IACnB,OAAO;QACH,eAAc,IAAI,EAAE,KAAK;YACrB,IAAI,MAAM,GAAG,KAAK,WAAW,MAAM,QAAQ,EAAE,OAAO;YAEpD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;YAC5B,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS;YACxC,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,GAAG,uHAAA,CAAA,SAAM,CAAC,KAAK;YAE3C,0DAA0D;YAC1D,IACI,SACA,MAAM,MAAM,CAAC,IAAI,KAAK,WACtB,MAAM,YAAY,KAAK,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI,EAClD;gBACE,MAAM,cAAc,IAAc,+BAA+B;gBACjE,OAAO,CAAA,GAAA,wJAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,UAAU;YACpD;YACA,OAAO,OAAO,yBAAyB;QAC3C;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 7137, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/syntaxHighlighting.js"],"sourcesContent":["import { Plugin } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from 'prosemirror-view';\nimport Prism from 'prismjs';\n\n// Import language support\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/components/prism-typescript';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-tsx';\nimport 'prismjs/components/prism-css';\nimport 'prismjs/components/prism-scss';\nimport 'prismjs/components/prism-json';\nimport 'prismjs/components/prism-python';\nimport 'prismjs/components/prism-java';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-cpp';\nimport 'prismjs/components/prism-csharp';\nimport 'prismjs/components/prism-php';\nimport 'prismjs/components/prism-ruby';\nimport 'prismjs/components/prism-go';\nimport 'prismjs/components/prism-rust';\nimport 'prismjs/components/prism-sql';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-markdown';\n\nfunction createCodeBlockDecorations(doc, schema) {\n    const decorations = [];\n\n    doc.descendants((node, pos) => {\n        if (node.type === schema.nodes.code_block) {\n            const language = node.attrs.language || 'javascript';\n            const text = node.textContent;\n\n            if (text && Prism.languages[language]) {\n                try {\n                    // Use Prism to tokenize the code\n                    const tokens = Prism.tokenize(text, Prism.languages[language]);\n\n                    let from = pos + 1; // Start after the opening tag\n                    let offset = 0;\n\n                    function processTokens(tokens) {\n                        tokens.forEach(token => {\n                            if (typeof token === 'string') {\n                                offset += token.length;\n                            } else if (typeof token === 'object' && token.type && token.content) {\n                                let tokenContent = token.content;\n                                let tokenLength = 0;\n\n                                // Handle nested tokens\n                                if (Array.isArray(tokenContent)) {\n                                    // For complex tokens with nested content, flatten to string\n                                    tokenContent = token.content.map(t => typeof t === 'string' ? t : t.content || '').join('');\n                                    tokenLength = tokenContent.length;\n                                } else if (typeof tokenContent === 'string') {\n                                    tokenLength = tokenContent.length;\n                                } else {\n                                    tokenLength = String(tokenContent).length;\n                                }\n\n                                if (tokenLength > 0) {\n                                    const tokenStart = from + offset;\n                                    const tokenEnd = tokenStart + tokenLength;\n\n                                    // Create decoration for this token\n                                    decorations.push(\n                                        Decoration.inline(tokenStart, tokenEnd, {\n                                            class: `token ${token.type}`,\n                                            'data-token-type': token.type\n                                        })\n                                    );\n                                }\n\n                                offset += tokenLength;\n                            }\n                        });\n                    }\n\n                    processTokens(tokens);\n                } catch (error) {\n                    console.warn('Syntax highlighting failed for language:', language, error);\n                }\n            }\n        }\n    });\n\n    return DecorationSet.create(doc, decorations);\n}\n\nexport function syntaxHighlightingPlugin(schema) {\n    return new Plugin({\n        key: 'syntaxHighlighting',\n        state: {\n            init(_, { doc }) {\n                return createCodeBlockDecorations(doc, schema);\n            },\n            apply(transaction, oldState) {\n                if (transaction.docChanged) {\n                    return createCodeBlockDecorations(transaction.doc, schema);\n                }\n                return oldState.map(transaction.mapping, transaction.doc);\n            }\n        },\n        props: {\n            decorations(state) {\n                return this.getState(state);\n            }\n        }\n    });\n} "],"names":[],"mappings":";;;AAAA;AACA;AACA;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAAS,2BAA2B,GAAG,EAAE,MAAM;IAC3C,MAAM,cAAc,EAAE;IAEtB,IAAI,WAAW,CAAC,CAAC,MAAM;QACnB,IAAI,KAAK,IAAI,KAAK,OAAO,KAAK,CAAC,UAAU,EAAE;YACvC,MAAM,WAAW,KAAK,KAAK,CAAC,QAAQ,IAAI;YACxC,MAAM,OAAO,KAAK,WAAW;YAE7B,IAAI,QAAQ,gIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;gBACnC,IAAI;oBACA,iCAAiC;oBACjC,MAAM,SAAS,gIAAA,CAAA,UAAK,CAAC,QAAQ,CAAC,MAAM,gIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS;oBAE7D,IAAI,OAAO,MAAM,GAAG,8BAA8B;oBAClD,IAAI,SAAS;oBAEb,SAAS,cAAc,MAAM;wBACzB,OAAO,OAAO,CAAC,CAAA;4BACX,IAAI,OAAO,UAAU,UAAU;gCAC3B,UAAU,MAAM,MAAM;4BAC1B,OAAO,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,IAAI,MAAM,OAAO,EAAE;gCACjE,IAAI,eAAe,MAAM,OAAO;gCAChC,IAAI,cAAc;gCAElB,uBAAuB;gCACvB,IAAI,MAAM,OAAO,CAAC,eAAe;oCAC7B,4DAA4D;oCAC5D,eAAe,MAAM,OAAO,CAAC,GAAG,CAAC,CAAA,IAAK,OAAO,MAAM,WAAW,IAAI,EAAE,OAAO,IAAI,IAAI,IAAI,CAAC;oCACxF,cAAc,aAAa,MAAM;gCACrC,OAAO,IAAI,OAAO,iBAAiB,UAAU;oCACzC,cAAc,aAAa,MAAM;gCACrC,OAAO;oCACH,cAAc,OAAO,cAAc,MAAM;gCAC7C;gCAEA,IAAI,cAAc,GAAG;oCACjB,MAAM,aAAa,OAAO;oCAC1B,MAAM,WAAW,aAAa;oCAE9B,mCAAmC;oCACnC,YAAY,IAAI,CACZ,oJAAA,CAAA,aAAU,CAAC,MAAM,CAAC,YAAY,UAAU;wCACpC,OAAO,CAAC,MAAM,EAAE,MAAM,IAAI,EAAE;wCAC5B,mBAAmB,MAAM,IAAI;oCACjC;gCAER;gCAEA,UAAU;4BACd;wBACJ;oBACJ;oBAEA,cAAc;gBAClB,EAAE,OAAO,OAAO;oBACZ,QAAQ,IAAI,CAAC,4CAA4C,UAAU;gBACvE;YACJ;QACJ;IACJ;IAEA,OAAO,oJAAA,CAAA,gBAAa,CAAC,MAAM,CAAC,KAAK;AACrC;AAEO,SAAS,yBAAyB,MAAM;IAC3C,OAAO,IAAI,qJAAA,CAAA,SAAM,CAAC;QACd,KAAK;QACL,OAAO;YACH,MAAK,CAAC,EAAE,EAAE,GAAG,EAAE;gBACX,OAAO,2BAA2B,KAAK;YAC3C;YACA,OAAM,WAAW,EAAE,QAAQ;gBACvB,IAAI,YAAY,UAAU,EAAE;oBACxB,OAAO,2BAA2B,YAAY,GAAG,EAAE;gBACvD;gBACA,OAAO,SAAS,GAAG,CAAC,YAAY,OAAO,EAAE,YAAY,GAAG;YAC5D;QACJ;QACA,OAAO;YACH,aAAY,KAAK;gBACb,OAAO,IAAI,CAAC,QAAQ,CAAC;YACzB;QACJ;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 7265, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/plugins.js"],"sourcesContent":["import { history, undo, redo } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { baseKeymap, toggleMark, setBlockType } from 'prosemirror-commands';\nimport {\n    wrapInList,\n    splitListItem,\n    liftListItem,\n    sinkListItem\n} from 'prosemirror-schema-list';\nimport {\n    inputRules,\n    wrappingInputRule,\n    textblockTypeInputRule,\n    smartQuotes,\n    emDash,\n    ellipsis\n} from 'prosemirror-inputrules';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { schema } from './schema.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from './commands.js';\nimport { exitHeadingPlugin } from './exitHeadingPlugin.js';\nimport { syntaxHighlightingPlugin } from './syntaxHighlighting.js';\n\n// Create input rules for automatic formatting\nfunction buildInputRulesPlugin() {\n    const rules = [];\n\n    // 1) Smart text rules - only ellipsis to avoid conflicts\n    rules.push(ellipsis);\n\n    // 2) Bullet list: typing \"- \" at start of line\n    const bulletRule = wrappingInputRule(\n        /^([-+*])\\s$/,\n        schema.nodes.bullet_list,\n        match => null,\n        (match, node) => ({ tight: true })\n    );\n    rules.push(bulletRule);\n\n    // 3) Ordered list: typing \"1. \" at start of line\n    const orderedRule = wrappingInputRule(\n        /^(\\d+)\\.\\s$/,\n        schema.nodes.ordered_list,\n        match => ({ order: +match[1] }),\n        (match, node) => ({ tight: true })\n    );\n    rules.push(orderedRule);\n\n    // 4) Headings: typing \"#\" to \"######\" followed by space\n    const headingRule = textblockTypeInputRule(\n        /^(#{1,6})\\s$/,\n        schema.nodes.heading,\n        match => ({ level: match[1].length })\n    );\n    rules.push(headingRule);\n\n    // 5) Blockquote: typing \"> \" at start of line\n    const blockquoteRule = wrappingInputRule(\n        /^>\\s$/,\n        schema.nodes.blockquote\n    );\n    rules.push(blockquoteRule);\n\n    // 6) Code block: typing \"```\" or \"```javascript\" at start of line\n    const codeRule = textblockTypeInputRule(\n        /^```([a-zA-Z0-9]*)?$/,\n        schema.nodes.code_block,\n        match => ({ language: match[1] || 'javascript' })\n    );\n    rules.push(codeRule);\n\n    return inputRules({ rules });\n}\n\n// Build keymap with common shortcuts\nfunction buildKeymap() {\n    const keys = {\n        // Text formatting shortcuts\n        'Mod-b': toggleMark(schema.marks.strong),\n        'Mod-i': toggleMark(schema.marks.em),\n\n        // Block type shortcuts - now using selection-aware commands\n        'Mod-0': paragraphCmd(),\n        'Mod-Shift-1': headingCmd(1),\n        'Mod-Shift-2': headingCmd(2),\n        'Mod-Shift-3': headingCmd(3),\n        'Mod-Shift-4': headingCmd(4),\n        'Mod-Shift-5': headingCmd(5),\n        'Mod-Shift-6': headingCmd(6),\n        'Mod->': toggleBlockquote,          // /Ctrl + Shift + .\n        'Shift-Ctrl->': toggleBlockquote,   // Windows/Linux variant\n\n        // List shortcuts\n        'Shift-Ctrl-8': wrapInList(schema.nodes.bullet_list),\n        'Shift-Ctrl-9': wrapInList(schema.nodes.ordered_list),\n\n        // Enhanced list item navigation - only for list items\n        'Enter': (state, dispatch, view) => {\n            const { $from, empty } = state.selection;\n\n            // Handle Enter in list items\n            if ($from.parent.type === schema.nodes.list_item) {\n                return splitListItem(schema.nodes.list_item)(state, dispatch);\n            }\n\n            // For all other cases, return false to let baseKeymap handle it\n            return false;\n        },\n        'Mod-[': liftListItem(schema.nodes.list_item),\n        'Mod-]': sinkListItem(schema.nodes.list_item),\n\n        // Only handle backspace for empty list items\n        'Backspace': (state, dispatch, view) => {\n            const { $from, empty } = state.selection;\n            if (empty && $from.parent.type === schema.nodes.list_item &&\n                $from.parentOffset === 0 && $from.parent.content.size === 0) {\n                return liftListItem(schema.nodes.list_item)(state, dispatch);\n            }\n            return false; // Let baseKeymap handle normal backspace\n        },\n\n        // History\n        'Mod-z': undo,\n        'Mod-y': redo,\n        'Shift-Mod-z': redo,\n        // REMOVED custom 'Space' handler to let input rules and default behavior manage it.\n    };\n\n    return keymap(keys);\n}\n\n// Create and export the complete plugins array\nexport function createPlugins() {\n    const inputRulesPlugin = buildInputRulesPlugin();\n    const historyPlugin = history();\n    const baseKeymapPlugin = keymap(baseKeymap); // Essential for basic editor functionality\n    const customKeymapPlugin = buildKeymap();\n    const dropCursorPlugin = dropCursor();\n    const gapCursorPlugin = gapCursor();\n\n    const allPlugins = [\n        // Input rules MUST come before keymap for auto-formatting to work\n        inputRulesPlugin,\n        historyPlugin,\n        // Base keymap MUST come first to handle basic interactions\n        baseKeymapPlugin,\n        // Exit heading plugin must come before custom keymap\n        exitHeadingPlugin,\n        // Custom keymap comes after base keymap\n        customKeymapPlugin,\n        dropCursorPlugin,\n        gapCursorPlugin,\n        // Syntax highlighting for code blocks\n        syntaxHighlightingPlugin(schema),\n    ];\n\n    return allPlugins;\n}\n\n// Export individual plugins for custom configurations\nexport {\n    buildInputRulesPlugin,\n    buildKeymap\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7402, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/Editor.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"ProseMirror\": \"Editor-module__x7ssIG__ProseMirror\",\n  \"active\": \"Editor-module__x7ssIG__active\",\n  \"divider\": \"Editor-module__x7ssIG__divider\",\n  \"editor\": \"Editor-module__x7ssIG__editor\",\n  \"editorContainer\": \"Editor-module__x7ssIG__editorContainer\",\n  \"editorContent\": \"Editor-module__x7ssIG__editorContent\",\n  \"formatGroup\": \"Editor-module__x7ssIG__formatGroup\",\n  \"headingIcon\": \"Editor-module__x7ssIG__headingIcon\",\n  \"loading\": \"Editor-module__x7ssIG__loading\",\n  \"loadingSpinner\": \"Editor-module__x7ssIG__loadingSpinner\",\n  \"modernToolbar\": \"Editor-module__x7ssIG__modernToolbar\",\n  \"prosemirrorEditor\": \"Editor-module__x7ssIG__prosemirrorEditor\",\n  \"slideInFromTop\": \"Editor-module__x7ssIG__slideInFromTop\",\n  \"spin\": \"Editor-module__x7ssIG__spin\",\n  \"toolBtn\": \"Editor-module__x7ssIG__toolBtn\",\n  \"toolbarContainer\": \"Editor-module__x7ssIG__toolbarContainer\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 7426, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/Editor.jsx"],"sourcesContent":["'use client'\n\n// Import ProseMirror base styles FIRST\nimport 'prosemirror-view/style/prosemirror.css';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { EditorState, TextSelection } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { toggleMark, setBlockType, baseKeymap } from 'prosemirror-commands';\nimport { wrapInList, splitListItem, liftListItem, sinkListItem } from 'prosemirror-schema-list';\nimport { undo, redo, history } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { schema, createEmptyDocument, parseHTML, serializeToHTML } from '@/editor/schema.js';\nimport { createPlugins } from '@/editor/plugins.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from '@/editor/commands.js';\nimport styles from '@/styles/Editor.module.css';\n\n/**\n * ProseMirror-based Rich Text Editor\n * \n * A modern, extensible editor built with ProseMirror\n * \n * Props:\n * - articleId: string - Unique identifier for the article\n * - initialContent?: string - JSON string or HTML initial content\n * - onChange?: function - Callback when content changes (content: string, json: any) => void\n * - placeholder?: string - Placeholder text for empty editor\n * - className?: string - Additional CSS classes\n */\nconst Editor = React.forwardRef(({\n    articleId,\n    initialContent = '',\n    onChange,\n    placeholder = 'Tell your story...',\n    className = ''\n}, ref) => {\n    const editorRef = useRef(null);\n    const viewRef = useRef(null);\n    const onChangeRef = useRef(onChange); // Store onChange in ref to avoid re-renders\n    const [isReady, setIsReady] = useState(false);\n\n    // Update onChange ref when it changes\n    onChangeRef.current = onChange;\n\n    // Method to insert text at cursor position\n    const insertTextAtCursor = useCallback((text) => {\n        if (!viewRef.current) return;\n\n        const { state, dispatch } = viewRef.current;\n        const { selection } = state;\n\n        // Create a text node with the new content\n        const textNode = schema.text(text);\n\n        // Create transaction to insert text at current position\n        const transaction = state.tr.replaceSelectionWith(textNode);\n\n        // Apply the transaction\n        dispatch(transaction);\n\n        // Focus the editor\n        viewRef.current.focus();\n    }, []);\n\n    // Expose method to parent component\n    React.useImperativeHandle(ref, () => ({\n        insertText: insertTextAtCursor,\n        focus: () => viewRef.current?.focus()\n    }), [insertTextAtCursor]);\n\n    // Initialize ProseMirror editor\n    useEffect(() => {\n        // Guard against SSR - ProseMirror needs browser environment\n        if (typeof window === 'undefined') {\n            return;\n        }\n\n        if (!editorRef.current || viewRef.current) {\n            return;\n        }\n\n        try {\n            // Create document with initial content if provided\n            let initialDoc;\n            if (initialContent && initialContent.trim()) {\n                console.log('Editor: Loading initial content, length:', initialContent.length);\n                try {\n                    initialDoc = parseHTML(initialContent);\n                    console.log('Editor: Successfully parsed HTML content');\n                } catch (parseError) {\n                    console.error('Editor: Failed to parse HTML content:', parseError);\n                    initialDoc = createEmptyDocument();\n                }\n            } else {\n                console.log('Editor: No initial content, creating empty document');\n                initialDoc = createEmptyDocument();\n            }\n\n            // Debug: console.log('Created initial document:', initialDoc.toJSON());\n\n            // Add back essential plugins gradually\n            const state = EditorState.create({\n                doc: initialDoc,\n                plugins: [\n                    keymap({\n                        // Custom shortcuts FIRST (higher priority)\n                        'Mod-b': toggleMark(schema.marks.strong),\n                        'Mod-i': toggleMark(schema.marks.em),\n                        'Mod-z': undo,\n                        'Mod-y': redo,\n                        // Auto-formatting shortcuts\n                        'Enter': splitListItem(schema.nodes.list_item),\n                        'Mod-[': liftListItem(schema.nodes.list_item),\n                        'Mod-]': sinkListItem(schema.nodes.list_item),\n                        'Space': (state, dispatch) => {\n                            const { $from } = state.selection;\n\n                            console.log(\" Space handler triggered. beforeCursor:\", $from.parent.textContent.slice(0, $from.parentOffset));\n\n                            if ($from.parent.type === schema.nodes.paragraph) {\n                                const beforeCursor = $from.parent.textContent.slice(0, $from.parentOffset);\n\n                                // Auto-heading: ## + space = H2, ### + space = H3\n                                const headingMatch = beforeCursor.match(/^(#{1,6})$/);\n                                if (headingMatch) {\n                                    const level = headingMatch[1].length;\n                                    const tr = state.tr\n                                        .delete($from.start(), $from.pos)\n                                        .setBlockType($from.start(), $from.start(), schema.nodes.heading, { level });\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-bold: **text** + space = bold\n                                const boldMatch = beforeCursor.match(/\\*\\*([^*]+)\\*\\*$/);\n                                if (boldMatch) {\n                                    const start = $from.pos - boldMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(boldMatch[1] + ' ', start)\n                                        .addMark(start, start + boldMatch[1].length, schema.marks.strong);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-italic: *text* + space = italic\n                                const italicMatch = beforeCursor.match(/(?<!\\*)\\*([^*]+)\\*$/);\n                                if (italicMatch) {\n                                    const start = $from.pos - italicMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(italicMatch[1] + ' ', start)\n                                        .addMark(start, start + italicMatch[1].length, schema.marks.em);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-code: `text` + space = inline code\n                                const codeMatch = beforeCursor.match(/`([^`]+)`$/);\n                                if (codeMatch) {\n                                    const start = $from.pos - codeMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(codeMatch[1] + ' ', start)\n                                        .addMark(start, start + codeMatch[1].length, schema.marks.code);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-bullet list: - + space or * + space = bullet list\n                                const bulletMatch = beforeCursor.match(/^[-*]$/);\n                                if (bulletMatch) {\n                                    console.log('Bullet list match:', bulletMatch[0]);\n                                    try {\n                                        // Create a simple list item with empty paragraph\n                                        const listItem = schema.nodes.list_item.create(null,\n                                            schema.nodes.paragraph.create()\n                                        );\n                                        const bulletList = schema.nodes.bullet_list.create(null, listItem);\n\n                                        // Delete exactly the dash/asterisk character\n                                        const dashPos = $from.pos - 1; // Position of the dash\n                                        let tr = state.tr\n                                            .delete(dashPos, $from.pos) // Remove exactly the - or *\n                                            .replaceWith(dashPos, dashPos, bulletList);\n\n                                        // Position cursor inside list item (after the transaction is built)\n                                        tr = tr.setSelection(TextSelection.create(tr.doc, dashPos + 2));\n\n                                        dispatch(tr);\n                                        console.log('Auto bullet list creation: success');\n                                        return true;\n                                    } catch (error) {\n                                        console.log('Auto bullet list creation failed:', error);\n                                    }\n                                }\n\n                                // Auto-ordered list: 1. + space = ordered list\n                                const orderedMatch = beforeCursor.match(/^1\\.$/);\n                                if (orderedMatch) {\n                                    console.log('Ordered list match:', orderedMatch[0]);\n                                    try {\n                                        // Create a simple list item with empty paragraph\n                                        const listItem = schema.nodes.list_item.create(null,\n                                            schema.nodes.paragraph.create()\n                                        );\n                                        const orderedList = schema.nodes.ordered_list.create(null, listItem);\n\n                                        // Delete exactly the \"1.\" characters\n                                        const numberedPos = $from.pos - 2; // Position of the \"1.\"\n                                        let tr = state.tr\n                                            .delete(numberedPos, $from.pos) // Remove exactly the 1.\n                                            .replaceWith(numberedPos, numberedPos, orderedList);\n\n                                        // Position cursor inside list item (after the transaction is built)\n                                        tr = tr.setSelection(TextSelection.create(tr.doc, numberedPos + 2));\n\n                                        dispatch(tr);\n                                        console.log('Auto ordered list creation: success');\n                                        return true;\n                                    } catch (error) {\n                                        console.log('Auto ordered list creation failed:', error);\n                                    }\n                                }\n                            }\n\n                            // Default space behavior\n                            return false;\n                        }\n                    }),\n                    keymap(baseKeymap), // Base keymap AFTER custom\n                    history(), // For undo/redo\n                    dropCursor(),\n                    gapCursor()\n                ]\n            });\n\n            // Add back minimal transaction handling\n            const view = new EditorView(editorRef.current, {\n                state,\n                editable: () => true,\n                dispatchTransaction: (transaction) => {\n                    // Apply transaction normally\n                    const newState = view.state.apply(transaction);\n                    view.updateState(newState);\n\n                    // Call onChange only when content actually changes\n                    if (transaction.docChanged && onChangeRef.current) {\n                        const html = serializeToHTML(newState.doc);\n                        const json = newState.doc.toJSON();\n                        onChangeRef.current(html, json);\n                    }\n                },\n                attributes: {\n                    'data-placeholder': placeholder || 'Tell your story...',\n                },\n            });\n\n            viewRef.current = view;\n            setIsReady(true);\n\n            // Focus the editor after it's ready\n            setTimeout(() => {\n                if (view && !view.isDestroyed) {\n                    view.focus();\n                }\n            }, 100);\n\n        } catch (error) {\n            console.error('Error initializing editor:', error);\n            setIsReady(true);\n        }\n\n        // Cleanup function\n        return () => {\n            if (viewRef.current) {\n                viewRef.current.destroy();\n                viewRef.current = null;\n            }\n        };\n    }, []); // Only initialize once\n\n    // Separate effect to handle initialContent changes without destroying editor\n    useEffect(() => {\n        if (!viewRef.current || !isReady || !initialContent) return;\n\n        console.log('Editor: Updating content without reinitializing, length:', initialContent.length);\n\n        try {\n            const newDoc = parseHTML(initialContent);\n            const currentContent = serializeToHTML(viewRef.current.state.doc);\n\n            // Only update if content is actually different\n            if (initialContent !== currentContent) {\n                const transaction = viewRef.current.state.tr.replaceWith(\n                    0,\n                    viewRef.current.state.doc.content.size,\n                    newDoc.content\n                );\n                viewRef.current.dispatch(transaction);\n                console.log('Editor: Content updated successfully');\n            }\n        } catch (error) {\n            console.error('Editor: Failed to update content:', error);\n        }\n    }, [initialContent, isReady]);\n\n    // Toolbar action handlers - properly implemented\n    const toggleBold = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleMark(schema.marks.strong);\n        if (command(state, dispatch)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleItalic = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleMark(schema.marks.em);\n        if (command(state, dispatch)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setHeading = useCallback((level) => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = headingCmd(level);\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setParagraph = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = paragraphCmd();\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setBlockquote = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleBlockquote;\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setCodeBlock = useCallback(() => {\n        if (!viewRef.current) return;\n\n        // Ask user for language\n        const language = prompt('Enter programming language (e.g., javascript, python, css):', 'javascript');\n        if (!language) return;\n\n        const { state, dispatch } = viewRef.current;\n        const { from, to } = state.selection;\n\n        // Create code block with language attribute\n        const codeBlock = schema.nodes.code_block.create({ language: language.toLowerCase() });\n        const transaction = state.tr.replaceRangeWith(from, to, codeBlock);\n\n        if (dispatch) {\n            dispatch(transaction);\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleBulletList = useCallback(() => {\n        if (!viewRef.current) return;\n        console.log('Bullet list button clicked');\n        const { state, dispatch } = viewRef.current;\n        const { $from, $to } = state.selection;\n\n        try {\n            // Try simple list creation approach\n            const listItem = schema.nodes.list_item.create(null,\n                schema.nodes.paragraph.create(null, $from.parent.content)\n            );\n            const bulletList = schema.nodes.bullet_list.create(null, listItem);\n\n            const tr = state.tr.replaceWith($from.start(), $to.end(), bulletList);\n            dispatch(tr);\n            console.log('Manual bullet list creation: success');\n            viewRef.current.focus();\n        } catch (error) {\n            console.log('Manual bullet list creation failed:', error);\n            // Fallback to wrapInList\n            const command = wrapInList(schema.nodes.bullet_list);\n            const result = command(state, dispatch);\n            console.log('wrapInList fallback result:', result);\n            if (result) viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleOrderedList = useCallback(() => {\n        if (!viewRef.current) return;\n        console.log('Ordered list button clicked');\n        const { state, dispatch } = viewRef.current;\n        const { $from, $to } = state.selection;\n\n        try {\n            // Try simple list creation approach\n            const listItem = schema.nodes.list_item.create(null,\n                schema.nodes.paragraph.create(null, $from.parent.content)\n            );\n            const orderedList = schema.nodes.ordered_list.create(null, listItem);\n\n            const tr = state.tr.replaceWith($from.start(), $to.end(), orderedList);\n            dispatch(tr);\n            console.log('Manual ordered list creation: success');\n            viewRef.current.focus();\n        } catch (error) {\n            console.log('Manual ordered list creation failed:', error);\n            // Fallback to wrapInList\n            const command = wrapInList(schema.nodes.ordered_list);\n            const result = command(state, dispatch);\n            console.log('wrapInList fallback result:', result);\n            if (result) viewRef.current.focus();\n        }\n    }, []);\n\n    const insertImage = useCallback(() => {\n        const url = prompt('Enter image URL:');\n        if (url && viewRef.current) {\n            const { state, dispatch } = viewRef.current;\n            const imageNode = schema.nodes.image.create({ src: url, alt: '' });\n            const transaction = state.tr.replaceSelectionWith(imageNode);\n            dispatch(transaction);\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const undoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        undo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    const redoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        redo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    // Check if a mark or node is active (range-aware for multi-block selections)\n    const isMarkActive = useCallback((markType) => {\n        if (!viewRef.current) return false;\n        const { from, $from, to, empty } = viewRef.current.state.selection;\n        if (empty) {\n            return markType.isInSet(viewRef.current.state.storedMarks || $from.marks());\n        }\n        return viewRef.current.state.doc.rangeHasMark(from, to, markType);\n    }, []);\n\n    const isBlockActive = useCallback((nodeType, attrs = {}) => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let allMatch = true;\n\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.isTextblock && !node.hasMarkup(nodeType, attrs)) {\n                allMatch = false;\n                return false;          // early exit\n            }\n            return true;\n        });\n        return allMatch;\n    }, []);\n\n    const isInBlockquote = useCallback(() => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let inQuote = false;\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.type === schema.nodes.blockquote) {\n                inQuote = true;\n                return false;              // early exit\n            }\n            return true;\n        });\n        return inQuote;\n    }, []);\n\n    return (\n        <div className={styles.editor} style={{ maxWidth: '800px', margin: '0 auto', padding: '20px' }}>\n            {/* Modern Toolbar - Always visible for now */}\n            {isReady && (\n                <div className={styles.modernToolbar} style={{ opacity: 1, visibility: 'visible', position: 'relative', top: 'auto', left: 'auto', transform: 'none', marginBottom: '20px' }}>\n                    <div className={styles.toolbarContainer}>\n                        {/* Text formatting */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={`${styles.toolBtn} ${isMarkActive(schema.marks.strong) ? styles.active : ''}`}\n                                onClick={toggleBold}\n                                title=\"Bold (B)\"\n                                aria-label=\"Bold\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M13.5 15.5H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM10 6.5h3c.55 0 1 .45 1 1s-.45 1-1 1h-3v-2zm5.6 4.5c.75-.9 1.2-2.05 1.2-3.3 0-2.76-2.24-5-5-5H6.5C5.67 2.7 5 3.37 5 4.2v15.6c0 .83.67 1.5 1.5 1.5h8.5c3.31 0 6-2.69 6-6 0-2.5-1.49-4.65-3.4-5.3z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isMarkActive(schema.marks.em) ? styles.active : ''}`}\n                                onClick={toggleItalic}\n                                title=\"Italic (I)\"\n                                aria-label=\"Italic\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Block types */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 1 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(1)}\n                                title=\"Large Heading (1)\"\n                                aria-label=\"Heading 1\"\n                            >\n                                <span className={styles.headingIcon}>H1</span>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 2 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(2)}\n                                title=\"Medium Heading (2)\"\n                                aria-label=\"Heading 2\"\n                            >\n                                <span className={styles.headingIcon}>H2</span>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 3 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(3)}\n                                title=\"Small Heading (3)\"\n                                aria-label=\"Heading 3\"\n                            >\n                                <span className={styles.headingIcon}>H3</span>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Lists and special blocks */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={toggleBulletList}\n                                title=\"Bullet List\"\n                                aria-label=\"Bullet list\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={toggleOrderedList}\n                                title=\"Numbered List\"\n                                aria-label=\"Numbered list\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isInBlockquote() ? styles.active : ''}`}\n                                onClick={setBlockquote}\n                                title=\"Quote (>)\"\n                                aria-label=\"Quote\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Media and special */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={insertImage}\n                                title=\"Add Image\"\n                                aria-label=\"Insert image\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.code_block) ? styles.active : ''}`}\n                                onClick={setCodeBlock}\n                                title=\"Code Block\"\n                                aria-label=\"Code block\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0L19.2 12l-4.6-4.6L16 6l6 6-6 6-1.4-1.4z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* History */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={undoCommand}\n                                title=\"Undo (Z)\"\n                                aria-label=\"Undo\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={redoCommand}\n                                title=\"Redo (Y)\"\n                                aria-label=\"Redo\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z\" />\n                                </svg>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Loading state */}\n            {!isReady && (\n                <div className={styles.loading}>\n                    <div className={styles.loadingSpinner}></div>\n                    <span>Loading editor...</span>\n                </div>\n            )}\n\n            {/* Editor content with safe styling */}\n            <div\n                ref={editorRef}\n                className={styles.prosemirrorEditor}\n                aria-label=\"Rich text editor\"\n                style={{\n                    minHeight: '400px',\n                    opacity: isReady ? 1 : 0.3\n                }}\n            />\n        </div>\n    );\n});\n\nEditor.displayName = 'Editor';\n\nexport default Editor; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8143, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/reflectionService.ts"],"sourcesContent":["import {\n    doc,\n    setDoc,\n    getDoc,\n    query,\n    collection,\n    where,\n    getDocs,\n    orderBy,\n    limit,\n    serverTimestamp,\n    Timestamp,\n    deleteDoc\n} from 'firebase/firestore';\nimport { db, auth } from '../firebase/clientApp';\n\nexport interface ReflectionPrompt {\n    id: string;\n    text: string;\n    type: 'emotion' | 'choice' | 'note' | 'custom';\n    triggerPosition?: 'paragraph' | 'percentage'; // Where to trigger the prompt\n    isDefault: boolean;\n}\n\nexport interface ReflectionResponse {\n    id: string;\n    userId: string;\n    articleId: string;\n    promptId: string;\n    promptText: string;\n    response: string;\n    position: number; // Paragraph index or percentage where prompt appeared\n    createdAt: Timestamp;\n    isPrivate: boolean;\n}\n\nexport interface ReflectionJournalEntry {\n    userId: string;\n    articleId: string;\n    articleTitle: string;\n    articleSlug: string;\n    responses: ReflectionResponse[];\n    createdAt: Timestamp;\n    updatedAt: Timestamp;\n}\n\n// Default reflection prompts\nexport const DEFAULT_REFLECTION_PROMPTS: ReflectionPrompt[] = [\n    {\n        id: 'emotion-1',\n        text: 'How does this make you feel?',\n        type: 'emotion',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'choice-1',\n        text: 'Would you have made the same choice?',\n        type: 'choice',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'note-1',\n        text: 'Write your own note to the author.',\n        type: 'note',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'custom-1',\n        text: 'What questions does this raise for you?',\n        type: 'custom',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'custom-2',\n        text: 'How does this relate to your own experience?',\n        type: 'custom',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    }\n];\n\n// Save reflection response to Firestore and local storage\nexport async function saveReflectionResponse(\n    articleId: string,\n    promptId: string,\n    promptText: string,\n    response: string,\n    position: number,\n    isPrivate: boolean = true\n): Promise<void> {\n    console.log('saveReflectionResponse called with:', {\n        articleId,\n        promptId,\n        promptText,\n        response,\n        position,\n        isPrivate\n    });\n\n    const user = auth.currentUser;\n    console.log('Current user:', user ? user.uid : 'Not authenticated');\n\n    if (!user) {\n        // Save to local storage if user is not authenticated\n        console.log('User not authenticated, saving to local storage');\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n        return;\n    }\n\n    const responseId = `${user.uid}_${articleId}_${promptId}_${Date.now()}`;\n    const reflectionDoc = doc(db, 'reflectionResponses', responseId);\n\n    const reflectionResponse: ReflectionResponse = {\n        id: responseId,\n        userId: user.uid,\n        articleId,\n        promptId,\n        promptText,\n        response,\n        position,\n        createdAt: serverTimestamp() as Timestamp,\n        isPrivate\n    };\n\n    try {\n        console.log('Attempting to save to Firestore with ID:', responseId);\n        await setDoc(reflectionDoc, reflectionResponse);\n        console.log('Successfully saved to Firestore');\n\n        // Also save a backup to local storage\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n    } catch (error) {\n        console.error('Error saving reflection response:', error);\n        // Fallback to local storage\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n    }\n}\n\n// Save to local storage for offline functionality\nfunction saveReflectionToLocalStorage(\n    articleId: string,\n    promptId: string,\n    promptText: string,\n    response: string,\n    position: number,\n    isPrivate: boolean\n): void {\n    try {\n        const storageKey = `reflection_${articleId}`;\n        console.log('Saving to local storage with key:', storageKey);\n\n        const existingData = localStorage.getItem(storageKey);\n        const reflections = existingData ? JSON.parse(existingData) : [];\n        console.log('Existing reflections:', reflections.length);\n\n        const newReflection = {\n            id: `local_${Date.now()}`,\n            promptId,\n            promptText,\n            response,\n            position,\n            createdAt: new Date().toISOString(),\n            isPrivate\n        };\n\n        reflections.push(newReflection);\n        localStorage.setItem(storageKey, JSON.stringify(reflections));\n        console.log('Successfully saved to local storage. Total reflections:', reflections.length);\n    } catch (error) {\n        console.error('Error saving reflection to local storage:', error);\n    }\n}\n\n// Get reflection responses for an article\nexport async function getReflectionResponses(articleId: string): Promise<ReflectionResponse[]> {\n    const user = auth.currentUser;\n\n    // Start with local storage data\n    const localReflections = getReflectionsFromLocalStorage(articleId);\n\n    if (!user) {\n        return localReflections;\n    }\n\n    try {\n        const reflectionRef = collection(db, 'reflectionResponses');\n        const q = query(\n            reflectionRef,\n            where('userId', '==', user.uid),\n            where('articleId', '==', articleId),\n            orderBy('createdAt', 'asc')\n        );\n\n        const querySnapshot = await getDocs(q);\n        const firestoreReflections = querySnapshot.docs.map(doc => ({\n            ...doc.data(),\n            createdAt: doc.data().createdAt\n        })) as ReflectionResponse[];\n\n        // Merge local and Firestore data, removing duplicates\n        const allReflections = [...firestoreReflections, ...localReflections];\n        const uniqueReflections = allReflections.filter((reflection, index, self) =>\n            index === self.findIndex(r => r.promptId === reflection.promptId && r.position === reflection.position)\n        );\n\n        return uniqueReflections.sort((a, b) => a.position - b.position);\n    } catch (error) {\n        console.error('Error fetching reflection responses:', error);\n        return localReflections;\n    }\n}\n\n// Get reflections from local storage\nfunction getReflectionsFromLocalStorage(articleId: string): ReflectionResponse[] {\n    try {\n        const storageKey = `reflection_${articleId}`;\n        const data = localStorage.getItem(storageKey);\n        if (!data) return [];\n\n        const reflections = JSON.parse(data);\n        return reflections.map((reflection: any) => ({\n            ...reflection,\n            userId: 'local',\n            articleId,\n            createdAt: new Date(reflection.createdAt) as any\n        }));\n    } catch (error) {\n        console.error('Error reading reflections from local storage:', error);\n        return [];\n    }\n}\n\n// Get a random reflection prompt - optimized for speed\nexport function getRandomReflectionPrompt(): ReflectionPrompt {\n    const randomIndex = Math.floor(Math.random() * DEFAULT_REFLECTION_PROMPTS.length);\n    return DEFAULT_REFLECTION_PROMPTS[randomIndex];\n}\n\n// Get a specific prompt by index for testing (faster than random)\nexport function getPromptByIndex(index: number): ReflectionPrompt {\n    return DEFAULT_REFLECTION_PROMPTS[index % DEFAULT_REFLECTION_PROMPTS.length];\n}\n\n// Create a reflection journal entry\nexport async function createReflectionJournal(\n    articleId: string,\n    articleTitle: string,\n    articleSlug: string,\n    responses: ReflectionResponse[]\n): Promise<void> {\n    const user = auth.currentUser;\n    if (!user) return;\n\n    const journalId = `${user.uid}_${articleId}`;\n    const journalDoc = doc(db, 'reflectionJournals', journalId);\n\n    const journalEntry: ReflectionJournalEntry = {\n        userId: user.uid,\n        articleId,\n        articleTitle,\n        articleSlug,\n        responses,\n        createdAt: serverTimestamp() as Timestamp,\n        updatedAt: serverTimestamp() as Timestamp\n    };\n\n    try {\n        await setDoc(journalDoc, journalEntry);\n    } catch (error) {\n        console.error('Error creating reflection journal:', error);\n    }\n}\n\n// Get user's reflection journals - build from individual responses\nexport async function getUserReflectionJournals(userId?: string): Promise<ReflectionJournalEntry[]> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    // Get all reflection responses and build journal entries from them\n    const journalMap = new Map<string, ReflectionJournalEntry>();\n\n    // Get from Firestore if user is authenticated\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc')\n            );\n\n            const querySnapshot = await getDocs(q);\n            querySnapshot.docs.forEach(doc => {\n                const response = doc.data() as ReflectionResponse;\n                const articleId = response.articleId;\n\n                if (!journalMap.has(articleId)) {\n                    journalMap.set(articleId, {\n                        userId: response.userId,\n                        articleId: articleId,\n                        articleTitle: `Loading...`, // Will be updated with actual title\n                        articleSlug: articleId,\n                        responses: [],\n                        createdAt: response.createdAt,\n                        updatedAt: response.createdAt\n                    });\n                }\n\n                const journal = journalMap.get(articleId)!;\n                journal.responses.push(response);\n                // Update the updated time to the latest response\n                if (response.createdAt > journal.updatedAt) {\n                    journal.updatedAt = response.createdAt;\n                }\n            });\n        } catch (error) {\n            console.error('Error fetching reflection responses from Firestore:', error);\n        }\n    }\n\n    // Also get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n\n        localStorageKeys.forEach(key => {\n            const articleId = key.replace('reflection_', '');\n            const data = localStorage.getItem(key);\n            if (!data) return;\n\n            try {\n                const reflections = JSON.parse(data);\n                if (!Array.isArray(reflections)) return;\n\n                reflections.forEach((reflection: any) => {\n                    const response: ReflectionResponse = {\n                        id: reflection.id || `local_${Date.now()}`,\n                        userId: 'local',\n                        articleId: articleId,\n                        promptId: reflection.promptId,\n                        promptText: reflection.promptText,\n                        response: reflection.response,\n                        position: reflection.position,\n                        createdAt: new Date(reflection.createdAt) as any,\n                        isPrivate: reflection.isPrivate\n                    };\n\n                    if (!journalMap.has(articleId)) {\n                        journalMap.set(articleId, {\n                            userId: 'local',\n                            articleId: articleId,\n                            articleTitle: `Loading...`, // Will be updated with actual title\n                            articleSlug: articleId,\n                            responses: [],\n                            createdAt: response.createdAt,\n                            updatedAt: response.createdAt\n                        });\n                    }\n\n                    const journal = journalMap.get(articleId)!;\n                    // Check if this response already exists (avoid duplicates)\n                    const exists = journal.responses.some(r =>\n                        r.promptId === response.promptId &&\n                        r.position === response.position &&\n                        r.response === response.response\n                    );\n\n                    if (!exists) {\n                        journal.responses.push(response);\n                        if (response.createdAt > journal.updatedAt) {\n                            journal.updatedAt = response.createdAt;\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Error parsing local storage reflection data:', error);\n            }\n        });\n    } catch (error) {\n        console.error('Error reading from local storage:', error);\n    }\n\n    // Convert map to array and fetch article titles\n    const journals = Array.from(journalMap.values()).filter(journal => journal.responses.length > 0);\n\n    // Fetch article metadata for each journal using Firebase document ID\n    await Promise.all(journals.map(async (journal) => {\n        try {\n            // Use Firebase getArticleById since the articleId is a Firebase document ID\n            const { getArticleById } = await import('@/firebase/articles');\n            const firebaseArticle = await getArticleById(journal.articleId);\n\n            if (firebaseArticle) {\n                journal.articleTitle = firebaseArticle.title;\n                journal.articleSlug = firebaseArticle.slug || journal.articleId; // Update slug if available\n                console.log(`Successfully fetched title for ${journal.articleId}: ${firebaseArticle.title}`);\n            } else {\n                journal.articleTitle = `Article: ${journal.articleId}`;\n                console.log(`Article not found for ID: ${journal.articleId}`);\n            }\n        } catch (error) {\n            console.error(`Error fetching article for ${journal.articleId}:`, error);\n            journal.articleTitle = `Article: ${journal.articleId}`;\n        }\n    }));\n\n    // Sort by updated time\n    journals.sort((a, b) => {\n        const timeA = a.updatedAt instanceof Date ? a.updatedAt.getTime() : a.updatedAt.toMillis();\n        const timeB = b.updatedAt instanceof Date ? b.updatedAt.getTime() : b.updatedAt.toMillis();\n        return timeB - timeA;\n    });\n\n    return journals;\n}\n\n// Delete a reflection response\nexport async function deleteReflectionResponse(\n    articleId: string,\n    reflectionId: string\n): Promise<boolean> {\n    console.log('Deleting reflection:', { articleId, reflectionId });\n\n    const user = auth.currentUser;\n    let deletedFromFirestore = false;\n    let deletedFromLocal = false;\n\n    // Delete from Firestore if user is authenticated\n    if (user) {\n        try {\n            // Try to find and delete from Firestore\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', user.uid),\n                where('articleId', '==', articleId),\n                where('id', '==', reflectionId)\n            );\n\n            const querySnapshot = await getDocs(q);\n            if (!querySnapshot.empty) {\n                const docToDelete = querySnapshot.docs[0];\n                await deleteDoc(docToDelete.ref);\n                console.log('Successfully deleted from Firestore');\n                deletedFromFirestore = true;\n            }\n        } catch (error) {\n            console.error('Error deleting from Firestore:', error);\n        }\n    }\n\n    // Delete from local storage\n    try {\n        const storageKey = `reflection_${articleId}`;\n        const existingData = localStorage.getItem(storageKey);\n\n        if (existingData) {\n            const reflections = JSON.parse(existingData);\n            const filteredReflections = reflections.filter((r: any) => r.id !== reflectionId);\n\n            if (filteredReflections.length !== reflections.length) {\n                if (filteredReflections.length === 0) {\n                    localStorage.removeItem(storageKey);\n                } else {\n                    localStorage.setItem(storageKey, JSON.stringify(filteredReflections));\n                }\n                console.log('Successfully deleted from local storage');\n                deletedFromLocal = true;\n            }\n        }\n    } catch (error) {\n        console.error('Error deleting from local storage:', error);\n    }\n\n    return deletedFromFirestore || deletedFromLocal;\n}\n\n// Get inspiration from user's reflections with metadata\nexport async function getReflectionInspiration(userId?: string): Promise<Array<{ response: string, articleTitle?: string, promptText?: string }>> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    const inspirations: Array<{ response: string, articleTitle?: string, promptText?: string }> = [];\n    const seenResponses = new Set<string>();\n\n    // Get from Firestore if user is authenticated\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc'),\n                limit(10) // Get recent reflections\n            );\n\n            const querySnapshot = await getDocs(q);\n\n            // Create a map to get article titles\n            const articleTitleMap = new Map<string, string>();\n\n            for (const doc of querySnapshot.docs) {\n                const response = doc.data() as ReflectionResponse;\n                if (response.response && response.response.length > 20) {\n                    const normalizedResponse = response.response.toLowerCase().trim();\n                    if (!seenResponses.has(normalizedResponse)) {\n                        seenResponses.add(normalizedResponse);\n\n                        // Try to get article title if not cached\n                        let articleTitle = articleTitleMap.get(response.articleId);\n                        if (!articleTitle) {\n                            try {\n                                const { getArticleById } = await import('@/firebase/articles');\n                                const article = await getArticleById(response.articleId);\n                                articleTitle = article?.title || 'Unknown Article';\n                                articleTitleMap.set(response.articleId, articleTitle);\n                            } catch (error) {\n                                articleTitle = 'Unknown Article';\n                            }\n                        }\n\n                        inspirations.push({\n                            response: response.response,\n                            articleTitle: articleTitle,\n                            promptText: response.promptText\n                        });\n                    }\n                }\n            }\n        } catch (error) {\n            console.error('Error fetching inspiration from Firestore:', error);\n        }\n    }\n\n    // Also get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n        const localReflections: any[] = [];\n\n        localStorageKeys.forEach(key => {\n            const data = localStorage.getItem(key);\n            if (data) {\n                try {\n                    const reflections = JSON.parse(data);\n                    if (Array.isArray(reflections)) {\n                        localReflections.push(...reflections);\n                    }\n                } catch (error) {\n                    console.error('Error parsing local storage reflection:', error);\n                }\n            }\n        });\n\n        // Sort by creation date and take recent ones\n        localReflections\n            .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n            .slice(0, 10)\n            .forEach(reflection => {\n                if (reflection.response && reflection.response.length > 20) {\n                    const normalizedResponse = reflection.response.toLowerCase().trim();\n                    if (!seenResponses.has(normalizedResponse)) {\n                        seenResponses.add(normalizedResponse);\n                        inspirations.push({\n                            response: reflection.response,\n                            articleTitle: 'Local Article', // We could enhance this later\n                            promptText: reflection.promptText\n                        });\n                    }\n                }\n            });\n    } catch (error) {\n        console.error('Error reading inspiration from local storage:', error);\n    }\n\n    // Shuffle and return up to 5 inspirations\n    const shuffled = inspirations.sort(() => Math.random() - 0.5);\n    return shuffled.slice(0, 5);\n}\n\n// Get reflection themes/topics for inspiration\nexport async function getReflectionThemes(userId?: string): Promise<string[]> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    const themes = new Set<string>();\n    const prompts: string[] = [];\n\n    // Get prompts from Firestore\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc'),\n                limit(20)\n            );\n\n            const querySnapshot = await getDocs(q);\n            querySnapshot.docs.forEach(doc => {\n                const response = doc.data() as ReflectionResponse;\n                if (response.promptText) {\n                    prompts.push(response.promptText);\n                }\n            });\n        } catch (error) {\n            console.error('Error fetching themes from Firestore:', error);\n        }\n    }\n\n    // Get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n\n        localStorageKeys.forEach(key => {\n            const data = localStorage.getItem(key);\n            if (data) {\n                try {\n                    const reflections = JSON.parse(data);\n                    if (Array.isArray(reflections)) {\n                        reflections.forEach((reflection: any) => {\n                            if (reflection.promptText) {\n                                prompts.push(reflection.promptText);\n                            }\n                        });\n                    }\n                } catch (error) {\n                    console.error('Error parsing local storage for themes:', error);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('Error reading themes from local storage:', error);\n    }\n\n    // Extract themes from prompts\n    prompts.forEach(prompt => {\n        const lowerPrompt = prompt.toLowerCase();\n        if (lowerPrompt.includes('feel')) themes.add('emotions');\n        if (lowerPrompt.includes('choice') || lowerPrompt.includes('decision')) themes.add('decision-making');\n        if (lowerPrompt.includes('experience')) themes.add('personal experience');\n        if (lowerPrompt.includes('question')) themes.add('questioning');\n        if (lowerPrompt.includes('surprise')) themes.add('unexpected insights');\n        if (lowerPrompt.includes('perspective') || lowerPrompt.includes('view')) themes.add('perspectives');\n        if (lowerPrompt.includes('author')) themes.add('dialogue with authors');\n        if (lowerPrompt.includes('relate') || lowerPrompt.includes('connect')) themes.add('connections');\n    });\n\n    return Array.from(themes).slice(0, 6);\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8642, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/InspirationWidget.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"active\": \"InspirationWidget-module__v4iIya__active\",\n  \"closeButton\": \"InspirationWidget-module__v4iIya__closeButton\",\n  \"content\": \"InspirationWidget-module__v4iIya__content\",\n  \"empty\": \"InspirationWidget-module__v4iIya__empty\",\n  \"footer\": \"InspirationWidget-module__v4iIya__footer\",\n  \"header\": \"InspirationWidget-module__v4iIya__header\",\n  \"inspirationButton\": \"InspirationWidget-module__v4iIya__inspirationButton\",\n  \"inspirationItem\": \"InspirationWidget-module__v4iIya__inspirationItem\",\n  \"inspirationWidget\": \"InspirationWidget-module__v4iIya__inspirationWidget\",\n  \"loading\": \"InspirationWidget-module__v4iIya__loading\",\n  \"refreshButton\": \"InspirationWidget-module__v4iIya__refreshButton\",\n  \"spin\": \"InspirationWidget-module__v4iIya__spin\",\n  \"spinner\": \"InspirationWidget-module__v4iIya__spinner\",\n  \"subtitle\": \"InspirationWidget-module__v4iIya__subtitle\",\n  \"tab\": \"InspirationWidget-module__v4iIya__tab\",\n  \"tabs\": \"InspirationWidget-module__v4iIya__tabs\",\n  \"themeItem\": \"InspirationWidget-module__v4iIya__themeItem\",\n  \"themePrompt\": \"InspirationWidget-module__v4iIya__themePrompt\",\n  \"themeTag\": \"InspirationWidget-module__v4iIya__themeTag\",\n  \"useButton\": \"InspirationWidget-module__v4iIya__useButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 8670, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/InspirationWidget.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { getReflectionInspiration, getReflectionThemes } from '@/services/reflectionService';\nimport styles from './InspirationWidget.module.css';\n\ninterface InspirationWidgetProps {\n    onInsert?: (text: string) => void;\n}\n\nconst InspirationWidget: React.FC<InspirationWidgetProps> = ({ onInsert }) => {\n    const [isOpen, setIsOpen] = useState(false);\n    const [inspirations, setInspirations] = useState<Array<{response: string, articleTitle?: string, promptText?: string}>>([]);\n    const [themes, setThemes] = useState<string[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [activeTab, setActiveTab] = useState<'inspirations' | 'themes'>('inspirations');\n\n    const loadInspirationData = async () => {\n        setLoading(true);\n        try {\n            const [inspirationData, themeData] = await Promise.all([\n                getReflectionInspiration(),\n                getReflectionThemes()\n            ]);\n            setInspirations(inspirationData);\n            setThemes(themeData);\n        } catch (error) {\n            console.error('Error loading inspiration data:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleToggle = () => {\n        if (!isOpen) {\n            loadInspirationData();\n        }\n        setIsOpen(!isOpen);\n    };\n\n    const handleInsert = (text: string) => {\n        if (onInsert) {\n            onInsert(text);\n        }\n        setIsOpen(false);\n    };\n\n    const generateWritingPrompt = (theme: string) => {\n        const prompts = {\n            'emotions': 'Explore a moment when your emotions surprised you...',\n            'decision-making': 'Write about a decision that changed your perspective...',\n            'personal experience': 'Reflect on an experience that shaped who you are today...',\n            'questioning': 'What questions have been on your mind lately?',\n            'unexpected insights': 'Share something that recently surprised you...',\n            'perspectives': 'How has your viewpoint on something important changed?',\n            'dialogue with authors': 'What would you say to an author whose work moved you?',\n            'connections': 'Write about connections you\\'ve discovered between different ideas...'\n        };\n        return prompts[theme as keyof typeof prompts] || `Write about ${theme}...`;\n    };\n\n    if (!isOpen) {\n        return (\n            <button\n                onClick={handleToggle}\n                className={styles.inspirationButton}\n                title=\"Get inspiration from your reflections\"\n            >\n                 Inspiration\n            </button>\n        );\n    }\n\n    return (\n        <div className={styles.inspirationWidget}>\n            <div className={styles.header}>\n                <h3> Your Reflection Insights</h3>\n                <button \n                    onClick={() => setIsOpen(false)}\n                    className={styles.closeButton}\n                >\n                    \n                </button>\n            </div>\n\n            <div className={styles.tabs}>\n                <button\n                    className={`${styles.tab} ${activeTab === 'inspirations' ? styles.active : ''}`}\n                    onClick={() => setActiveTab('inspirations')}\n                >\n                    Recent Thoughts ({inspirations.length})\n                </button>\n                <button\n                    className={`${styles.tab} ${activeTab === 'themes' ? styles.active : ''}`}\n                    onClick={() => setActiveTab('themes')}\n                >\n                    Writing Themes ({themes.length})\n                </button>\n            </div>\n\n            <div className={styles.content}>\n                {loading ? (\n                    <div className={styles.loading}>\n                        <div className={styles.spinner}></div>\n                        <p>Loading your insights...</p>\n                    </div>\n                ) : activeTab === 'inspirations' ? (\n                    <div className={styles.inspirationsList}>\n                        {inspirations.length === 0 ? (\n                            <div className={styles.empty}>\n                                <p> No reflections yet!</p>\n                                <p>Start reading articles and reflecting to build your inspiration library.</p>\n                            </div>\n                        ) : (\n                            <>\n                                <p className={styles.subtitle}>Your past reflections that might spark new ideas:</p>\n                                {inspirations.map((inspiration, index) => (\n                                    <div key={index} className={styles.inspirationItem}>\n                                        <p>\"{inspiration.response}\"</p>\n                                        {inspiration.articleTitle && (\n                                            <p style={{ fontSize: '12px', color: '#6b7280', marginTop: '4px' }}>\n                                                From: {inspiration.articleTitle}\n                                            </p>\n                                        )}\n                                        <button\n                                            onClick={() => {\n                                                const attribution = inspiration.articleTitle ? ` (inspired by \"${inspiration.articleTitle}\")` : '';\n                                                handleInsert(`\"${inspiration.response}\"${attribution} - This reminds me of...`);\n                                            }}\n                                            className={styles.useButton}\n                                        >\n                                            Use as starting point\n                                        </button>\n                                    </div>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                ) : (\n                    <div className={styles.themesList}>\n                        {themes.length === 0 ? (\n                            <div className={styles.empty}>\n                                <p> No themes identified yet!</p>\n                                <p>Keep reflecting on articles to discover your writing themes.</p>\n                            </div>\n                        ) : (\n                            <>\n                                <p className={styles.subtitle}>Writing prompts based on your reflection patterns:</p>\n                                {themes.map((theme, index) => (\n                                    <div key={index} className={styles.themeItem}>\n                                        <div className={styles.themeTag}>{theme}</div>\n                                        <p className={styles.themePrompt}>{generateWritingPrompt(theme)}</p>\n                                        <button\n                                            onClick={() => handleInsert(generateWritingPrompt(theme))}\n                                            className={styles.useButton}\n                                        >\n                                            Start writing\n                                        </button>\n                                    </div>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                )}\n            </div>\n\n            <div className={styles.footer}>\n                <button\n                    onClick={loadInspirationData}\n                    className={styles.refreshButton}\n                    disabled={loading}\n                >\n                     Refresh insights\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default InspirationWidget; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9024, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleComposer.module.css [app-ssr] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actionButton\": \"ArticleComposer-module__UcJHvq__actionButton\",\n  \"actionButtons\": \"ArticleComposer-module__UcJHvq__actionButtons\",\n  \"articleComposer\": \"ArticleComposer-module__UcJHvq__articleComposer\",\n  \"composerContent\": \"ArticleComposer-module__UcJHvq__composerContent\",\n  \"composerHeader\": \"ArticleComposer-module__UcJHvq__composerHeader\",\n  \"composerLoading\": \"ArticleComposer-module__UcJHvq__composerLoading\",\n  \"coverImageInput\": \"ArticleComposer-module__UcJHvq__coverImageInput\",\n  \"coverImagePreview\": \"ArticleComposer-module__UcJHvq__coverImagePreview\",\n  \"editorContainer\": \"ArticleComposer-module__UcJHvq__editorContainer\",\n  \"errorMessage\": \"ArticleComposer-module__UcJHvq__errorMessage\",\n  \"fadeIn\": \"ArticleComposer-module__UcJHvq__fadeIn\",\n  \"imageUrlInput\": \"ArticleComposer-module__UcJHvq__imageUrlInput\",\n  \"loadingIndicator\": \"ArticleComposer-module__UcJHvq__loadingIndicator\",\n  \"logo\": \"ArticleComposer-module__UcJHvq__logo\",\n  \"logoContainer\": \"ArticleComposer-module__UcJHvq__logoContainer\",\n  \"publishButton\": \"ArticleComposer-module__UcJHvq__publishButton\",\n  \"removeTagButton\": \"ArticleComposer-module__UcJHvq__removeTagButton\",\n  \"savedIndicator\": \"ArticleComposer-module__UcJHvq__savedIndicator\",\n  \"spin\": \"ArticleComposer-module__UcJHvq__spin\",\n  \"tag\": \"ArticleComposer-module__UcJHvq__tag\",\n  \"tagContainer\": \"ArticleComposer-module__UcJHvq__tagContainer\",\n  \"tagInput\": \"ArticleComposer-module__UcJHvq__tagInput\",\n  \"titleInput\": \"ArticleComposer-module__UcJHvq__titleInput\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 9055, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleComposer.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { v4 as uuidv4 } from 'uuid';\nimport { createArticle, updateArticle, getArticleById, Article } from '@/firebase/articles';\nimport { auth } from '@/firebase/clientApp';\nimport Editor from './Editor';\nimport InspirationWidget from './InspirationWidget';\nimport styles from '@/styles/ArticleComposer.module.css';\nimport { User } from 'firebase/auth';\n\ninterface ArticleComposerProps {\n  articleId?: string; // Optional - if provided, edit mode, otherwise create mode\n  onUpdateComplete?: (updatedArticle?: Article | null) => void; // Callback when update is complete\n}\n\nconst ArticleComposer: React.FC<ArticleComposerProps> = ({ articleId, onUpdateComplete }) => {\n  const router = useRouter();\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [tags, setTags] = useState<string[]>([]);\n  const [coverImage, setCoverImage] = useState('');\n  const [isPublishing, setIsPublishing] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isSaved, setIsSaved] = useState(false);\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(!!articleId);\n  const [user, setUser] = useState<User | null>(null);\n  const [currentTag, setCurrentTag] = useState('');\n  \n  const titleRef = useRef<HTMLTextAreaElement>(null);\n  const tagInputRef = useRef<HTMLInputElement>(null);\n  const editorRef = useRef<any>(null);\n  \n  // Auto-resize title textarea as content grows\n  const autoResizeTitle = useCallback(() => {\n    if (titleRef.current) {\n      titleRef.current.style.height = 'auto';\n      titleRef.current.style.height = `${titleRef.current.scrollHeight}px`;\n      // Set focus to title if it's empty when component loads\n      if (!title && titleRef.current) {\n        titleRef.current.focus();\n      }\n    }\n  }, [title]);\n  \n  // Set up authentication listener\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setUser(user);\n      if (!user) {\n        // Redirect to login if not authenticated\n        router.push('/login?redirect=compose');\n      }\n    });\n    \n    return () => unsubscribe();\n  }, [router]);\n  \n  // Load article data if in edit mode\n  useEffect(() => {\n    console.log('ArticleComposer useEffect - articleId:', articleId, 'user:', user?.uid);\n    if (articleId && user) {\n      const fetchArticle = async () => {\n        try {\n          console.log('Fetching article for editing, ID:', articleId);\n          setIsLoading(true);\n          const article = await getArticleById(articleId);\n          \n          console.log('Fetched article:', article?.title, 'Body length:', article?.body?.length);\n          \n          if (!article) {\n            console.log('Article not found');\n            setError('Article not found');\n            router.push('/');\n            return;\n          }\n          \n          // Verify article ownership\n          if (article.authorId !== user.uid) {\n            console.log('User not authorized to edit this article');\n            setError('You can only edit your own articles');\n            router.push('/');\n            return;\n          }\n          \n          // Set form data\n          console.log('Setting title:', article.title);\n          setTitle(article.title);\n          \n          // Process HTML to extract and clean the content\n          const cleanContent = article.body.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n          console.log('Setting content, length:', cleanContent.length, 'Preview:', cleanContent.substring(0, 100) + '...');\n          setContent(cleanContent);\n          \n          setTags(article.tags || []);\n          setCoverImage(article.coverImage || '');\n          \n          console.log('Article data loaded successfully for editing');\n        } catch (error) {\n          console.error('Error loading article:', error);\n          setError('Failed to load article');\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      \n      fetchArticle();\n    } else if (!articleId) {\n      console.log('No articleId, starting with empty content');\n      // Editor will start with empty content - no need for document model\n      setIsLoading(false);\n    } else {\n      console.log('User not logged in, waiting...');\n    }\n  }, [articleId, user, router]);\n  \n  // Auto-resize title when it changes\n  useEffect(() => {\n    autoResizeTitle();\n  }, [title, autoResizeTitle]);\n  \n  // Auto-save draft periodically (every 30 seconds)\n  useEffect(() => {\n    let timer: NodeJS.Timeout;\n    \n    if (user && title.trim() && content.trim() && !isSaving && !isPublishing) {\n      timer = setTimeout(() => {\n        saveArticle('drafts');\n      }, 30000);\n    }\n    \n    return () => {\n      if (timer) clearTimeout(timer);\n    };\n  }, [user, title, content, isSaving, isPublishing]);\n  \n  // Handle title changes\n  const handleTitleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setTitle(e.target.value);\n  };\n  \n  // Handle editor content changes with debouncing for better performance\n  const handleEditorChange = useCallback((html: string, json: any) => {\n    // Use functional update to avoid dependency on current content\n    setContent(prevContent => {\n      // Only update if content has actually changed\n      if (html !== prevContent) {\n        // Reset saved status when content changes\n        if (isSaved) {\n          setIsSaved(false);\n        }\n        return html;\n      }\n      return prevContent;\n    });\n  }, [isSaved]);\n  \n  // Handle tag input\n  const handleTagInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCurrentTag(e.target.value);\n  };\n  \n  // Handle tag input keydown\n  const handleTagInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter' || e.key === ',') {\n      e.preventDefault();\n      addTag();\n    }\n  };\n  \n  // Add a tag\n  const addTag = () => {\n    const tag = currentTag.trim().toLowerCase();\n    if (tag && !tags.includes(tag) && tags.length < 5) {\n      setTags([...tags, tag]);\n      setCurrentTag('');\n    }\n  };\n  \n  // Remove a tag\n  const removeTag = (tagToRemove: string) => {\n    setTags(tags.filter(tag => tag !== tagToRemove));\n  };\n  \n  // Handle cover image input\n  const handleCoverImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCoverImage(e.target.value);\n  };\n  \n  // Handle focus moving from title to editor\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    // When user presses Enter in the title field, move focus to the editor\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      // Note: The new Editor component will handle its own focus\n      // when the user starts typing in the editor area\n    }\n  };\n  \n  // Save article (draft or published)\n  const saveArticle = async (status: 'drafts' | 'published' = 'drafts') => {\n    if (!user) {\n      setError('You must be logged in to save an article');\n      return;\n    }\n    \n    if (!title.trim()) {\n      setError('Title is required');\n      return;\n    }\n    \n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    try {\n      setIsSaving(true);\n      setError('');\n      \n      // Clean HTML content to avoid any strange formatting\n      const cleanContent = content.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n      \n      const articleData = {\n        title: title.trim(),\n        body: cleanContent,\n        tags,\n        coverImage: coverImage.trim(),\n        status\n      };\n      \n      console.log('Saving article data:', articleData);\n      \n      if (articleId) {\n        try {\n          // Update existing article\n          const updatedArticle = await updateArticle(articleId, articleData);\n          console.log('Article updated successfully:', updatedArticle?.title);\n          \n          // Show saved indicator\n          setIsSaved(true);\n          \n          // Wait a moment for Firebase to fully process the update\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n          // Get the updated article with fresh data\n          const updatedArticleData = await getArticleById(articleId);\n          console.log('Fetched updated article data:', updatedArticleData?.title);\n          \n          // Call the callback if provided, pass the updated article data\n          if (onUpdateComplete) {\n            console.log('Calling onUpdateComplete callback instead of navigating');\n            onUpdateComplete(updatedArticleData);\n          } else {\n            // Only navigate if no callback is provided (standalone editor usage)\n            console.log('No callback provided, navigating to article page');\n            setTimeout(() => {\n              window.location.href = `/articles/${articleId}/view?updated=true&time=${Date.now()}`;\n            }, 1000);\n          }\n        } catch (error) {\n          console.error('Error updating article:', error);\n          setError('Failed to update article. Please try again.');\n          setIsSaved(false);\n        }\n      } else {\n        // Create new article\n        const newArticle = await createArticle(articleData);\n        if (status === 'published') {\n          // Redirect to the new article page\n          router.push(`/articles/${newArticle.id}`);\n        } else {\n          // Redirect to dashboard\n          router.push(`/dashboard`);\n        }\n      }\n      \n    } catch (error) {\n      console.error('Error saving article:', error);\n      setError('Failed to save article. Please try again.');\n    } finally {\n      setIsSaving(false);\n      setIsPublishing(false);\n    }\n  };\n  \n  // Handle publish button click\n  const handlePublish = async () => {\n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    setIsPublishing(true);\n    await saveArticle('published');\n  };\n  \n  // Handle save draft button click\n  const handleSaveDraft = async () => {\n    await saveArticle('drafts');\n  };\n\n  // Handle inserting text from inspiration widget\n  const handleInsertInspiration = (text: string) => {\n    // Try to insert using the editor ref first\n    if (editorRef.current && editorRef.current.insertText) {\n      editorRef.current.insertText('\\n\\n' + text + '\\n\\n');\n    } else {\n      // Fallback: append to content with proper spacing\n      setContent(prevContent => {\n        const newContent = prevContent.trim() \n          ? prevContent + '\\n\\n<p>' + text + '</p>' \n          : '<p>' + text + '</p>';\n        return newContent;\n      });\n    }\n    \n    // Focus the editor after insertion\n    setTimeout(() => {\n      if (editorRef.current && editorRef.current.focus) {\n        editorRef.current.focus();\n      }\n    }, 100);\n  };\n  \n  if (isLoading) {\n    return (\n      <div className={styles.composerLoading}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n  \n  return (\n    <div className={styles.articleComposer}>\n      {/* Header with actions */}\n      <header className={styles.composerHeader}>\n        <div className={styles.logoContainer}>\n          <div className={styles.logo}>Journalite</div>\n        </div>\n        \n        <div className={styles.actionButtons}>\n          {isSaved && (\n            <span className={styles.savedIndicator}>\n              <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"currentColor\">\n                <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\" />\n              </svg>\n              Saved\n            </span>\n          )}\n          \n          <button\n            className={styles.actionButton}\n            onClick={handleSaveDraft}\n            disabled={isSaving || isPublishing}\n          >\n            Save draft\n          </button>\n          \n          <button\n            className={styles.publishButton}\n            onClick={handlePublish}\n            disabled={isSaving || isPublishing || !title.trim() || !content.trim()}\n          >\n            {articleId ? 'Update' : 'Publish'}\n          </button>\n        </div>\n      </header>\n      \n      {/* Main content area */}\n      <main className={styles.composerContent}>\n        {/* Title input */}\n        <textarea\n          ref={titleRef}\n          className={styles.titleInput}\n          value={title}\n          onChange={handleTitleChange}\n          onKeyDown={handleTitleKeyDown}\n          placeholder=\"Title\"\n          rows={1}\n        />\n        \n        {/* Cover image input */}\n        <div className={styles.coverImageInput}>\n          <input\n            type=\"text\"\n            value={coverImage}\n            onChange={handleCoverImageChange}\n            placeholder=\"Add a cover image (enter image URL)\"\n            className={styles.imageUrlInput}\n          />\n          {coverImage && (\n            <div className={styles.coverImagePreview}>\n              <img src={coverImage} alt=\"Cover preview\" />\n            </div>\n          )}\n        </div>\n        \n        {/* Tag input */}\n        <div className={styles.tagContainer}>\n          {tags.map(tag => (\n            <div key={tag} className={styles.tag}>\n              {tag}\n              <button \n                className={styles.removeTagButton} \n                onClick={() => removeTag(tag)}\n                aria-label={`Remove ${tag} tag`}\n              >\n                &times;\n              </button>\n            </div>\n          ))}\n          \n          {tags.length < 5 && (\n            <input\n              ref={tagInputRef}\n              type=\"text\"\n              value={currentTag}\n              onChange={handleTagInputChange}\n              onKeyDown={handleTagInputKeyDown}\n              onBlur={addTag}\n              placeholder={tags.length === 0 ? \"Add up to 5 tags...\" : \"Add another tag...\"}\n              className={styles.tagInput}\n            />\n          )}\n        </div>\n        \n        {/* Error message */}\n        {error && <div className={styles.errorMessage}>{error}</div>}\n        \n        {/* Article editor */}\n        <div className={styles.editorContainer}>\n          <Editor\n            ref={editorRef}\n            articleId={articleId || uuidv4()}\n            initialContent={content}\n            onChange={handleEditorChange}\n            placeholder=\"Tell your story...\"\n          />\n        </div>\n      </main>\n\n      {/* Inspiration Widget */}\n      <InspirationWidget onInsert={handleInsertInspiration} />\n    </div>\n  );\n};\n\nexport default ArticleComposer; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9618, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/LikeButton.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\n\ninterface LikeButtonProps {\n  articleId: string;\n  initialLikes?: string[];\n  className?: string;\n  styles?: any;\n}\n\nconst LikeButton: React.FC<LikeButtonProps> = ({ \n  articleId, \n  initialLikes = [], \n  className = '',\n  styles = {}\n}) => {\n  const [likes, setLikes] = useState<string[]>(initialLikes);\n  const [isLiked, setIsLiked] = useState(false);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      if (user) {\n        setIsLiked(likes.includes(user.uid));\n      } else {\n        setIsLiked(false);\n      }\n    });\n    return () => unsubscribe();\n  }, [likes]);\n\n  // Update like status when initialLikes change\n  useEffect(() => {\n    setLikes(initialLikes);\n    if (currentUser) {\n      setIsLiked(initialLikes.includes(currentUser.uid));\n    }\n  }, [initialLikes, currentUser]);\n\n  const handleLikeClick = async (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    console.log(' LikeButton clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) {\n      alert('Please login to like articles');\n      return;\n    }\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    try {\n      if (isLiked) {\n        // Unlike\n        const newLikes = likes.filter(uid => uid !== currentUser.uid);\n        setLikes(newLikes);\n        setIsLiked(false);\n        console.log(' Unlike completed - likes:', newLikes.length);\n        \n        // Update Firestore\n        const { doc, updateDoc, arrayRemove } = await import('firebase/firestore');\n        const { db } = await import('@/firebase/clientApp');\n        const articleRef = doc(db, 'articles', articleId);\n        await updateDoc(articleRef, {\n          likes: arrayRemove(currentUser.uid)\n        });\n      } else {\n        // Like\n        const newLikes = [...likes, currentUser.uid];\n        setLikes(newLikes);\n        setIsLiked(true);\n        console.log(' Like completed - likes:', newLikes.length);\n        \n        // Update Firestore\n        const { doc, updateDoc, arrayUnion } = await import('firebase/firestore');\n        const { db } = await import('@/firebase/clientApp');\n        const articleRef = doc(db, 'articles', articleId);\n        await updateDoc(articleRef, {\n          likes: arrayUnion(currentUser.uid)\n        });\n      }\n    } catch (error) {\n      console.error('Error updating like status:', error);\n      // Revert on error\n      if (isLiked) {\n        setLikes([...likes, currentUser.uid]);\n        setIsLiked(true);\n      } else {\n        setLikes(likes.filter(uid => uid !== currentUser.uid));\n        setIsLiked(false);\n      }\n    }\n  };\n\n  return (\n    <button \n      className={`${className} ${isLiked ? styles.liked : ''}`}\n      onClick={handleLikeClick}\n      aria-label={isLiked ? 'Unlike article' : 'Like article'}\n      style={{\n        transition: 'all 0.3s ease',\n        transform: isAnimating ? 'scale(1.2)' : 'scale(1)',\n      }}\n    >\n      <svg \n        xmlns=\"http://www.w3.org/2000/svg\" \n        viewBox=\"0 0 24 24\" \n        fill={isLiked ? \"currentColor\" : \"none\"} \n        stroke=\"currentColor\" \n        strokeWidth=\"2\" \n        className={styles.likeIcon}\n        style={{\n          transition: 'all 0.3s ease',\n          filter: isAnimating ? 'drop-shadow(0 0 8px currentColor)' : 'none',\n        }}\n      >\n        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n      </svg>\n      <span>{likes.length > 0 ? likes.length : ''}</span>\n    </button>\n  );\n};\n\nexport default React.memo(LikeButton); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9767, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/app/articles/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { useSearchParams, useRouter } from 'next/navigation'\nimport { Suspense } from 'react'\nimport styles from '@/styles/home.module.css'\nimport articleStyles from '@/styles/ArticlePage.module.css'\nimport { auth } from '@/firebase/clientApp'\nimport { onAuthStateChanged, signOut } from 'firebase/auth'\nimport MinimalNotificationBell from '@/components/MinimalNotificationBell'\nimport LeftSidebar from '@/components/LeftSidebar'\nimport ArticleWithHighlights from '@/components/ArticleWithHighlights'\nimport CommentSection from '@/components/CommentSection'\nimport ArticleComposer from '@/components/ArticleComposer'\nimport LikeButton from '@/components/LikeButton'\n\n// Import Firestore article service\nimport { getArticleBySlug } from '@/firebase/articles'\nimport { getMoodFromText } from '@/utils/getMoodFromText'\nimport { moodThemes } from '@/utils/moodThemes'\n\n// Author mapping from homepage for consistency\nconst authorMapping: { [key: string]: string } = {\n  '84b2f82c-1e93-498a-983e-3b30a8379e63': 'Samuel Green',\n  user_002: 'Alex Martinez',\n  'kristen-lee-id': 'Kristen Lee',\n  'alex-wen-id': 'Alex Wen',\n  'hannah-cole-id': 'Hannah Cole'\n}\n\n// Convert Firestore article to UI format for RenderArticle\n// This adapter should ensure the object passed to RenderArticle has the fields RenderArticle expects.\nconst adaptFirestoreArticle = (firestoreArticle: any): any => { // Using 'any' for return type temporarily due to unknown FirestoreArticle structure\n  const slug = firestoreArticle.slug || (firestoreArticle.title || 'untitled').toLowerCase().replace(/[\\s\\W-]+/g, '-').replace(/^-+|-+$/g, '');\n  const now = new Date().toISOString();\n\n  // Base fields required by RenderArticle's BaseArticleInfo\n  const adapted = {\n    id: firestoreArticle.id || '', // CRITICAL: Ensure 'id' is present\n    _id: firestoreArticle.id || '', // Keep for compatibility if RenderArticle or other parts use it\n    title: firestoreArticle.title || 'Untitled Article',\n    slug: slug,\n    authorId: firestoreArticle.authorId, // Assuming authorId is on FirestoreArticle\n    authorName: firestoreArticle.authorName || 'Unknown Author',\n    coverImageUrl: firestoreArticle.coverImage || null,\n    tags: firestoreArticle.tags || [],\n    likes: firestoreArticle.likes || [],\n    createdAt: firestoreArticle.createdAt ? firestoreArticle.createdAt.toDate().toISOString() : now,\n    updatedAt: firestoreArticle.updatedAt ? firestoreArticle.updatedAt.toDate().toISOString() : now,\n    excerpt: firestoreArticle.excerpt || '',\n\n    // Fields for SimpleArticle vs ComplexArticle differentiation by RenderArticle\n    // RenderArticle will use its type guards (isSimple, isComplex)\n    // We pass both `body` and a potential `content` array if Firestore structure supports it.\n    body: firestoreArticle.body || '', // For SimpleArticle path in RenderArticle\n    content: firestoreArticle.content || undefined, // For ComplexArticle path if 'content' is an array in Firestore\n                                                       // If firestoreArticle.content is not an array, RenderArticle's isComplex will be false.\n    \n    // Other optional fields RenderArticle might use from ComplexArticle type\n    reposts: firestoreArticle.reposts || [],\n    viewCount: firestoreArticle.viewCount || 0,\n  };\n\n  // If firestoreArticle.content is indeed an array of paragraphs, map it.\n  // This specific mapping logic might be too complex for the adapter if FirestoreArticle's content isn't already structured as Paragraph[].\n  // For now, we pass it as is, and RenderArticle's isComplex will determine how to use it or 'body'.\n  // If `firestoreArticle.content` is an array and matches Paragraph structure, it will be used.\n  // Otherwise, RenderArticle's `isSimple` path will likely take over using `adapted.body`.\n\n  return adapted;\n};\n\nfunction Article() {\n  const params = useSearchParams()\n  const router = useRouter()\n  const slug = params?.get('slug')\n  \n  const [article, setArticle] = useState<any>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [tags, setTags] = useState<string[]>([])\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(true)\n  const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false)\n  const [windowWidth, setWindowWidth] = useState(0)\n  const [articleHtml, setArticleHtml] = useState<string | null>(null)\n  const [likes, setLikes] = useState<string[]>([])\n  const [currentUser, setCurrentUser] = useState<any>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  \n  // Mood detection state\n  const [mood, setMood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective')\n  const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(true)\n  \n  // Initialize window width on client side\n  useEffect(() => {\n    setWindowWidth(window.innerWidth)\n    \n    const handleResize = () => {\n      setWindowWidth(window.innerWidth)\n    }\n    \n    window.addEventListener('resize', handleResize)\n    return () => window.removeEventListener('resize', handleResize)\n  }, [])\n  \n  // Load mood feature preference from localStorage (only for authenticated users)\n  useEffect(() => {\n    if (isAuthenticated) {\n      const savedPreference = localStorage.getItem('moodFeatureEnabled')\n      console.log('Loading mood feature preference from localStorage for authenticated user:', savedPreference);\n      if (savedPreference !== null) {\n        const enabled = JSON.parse(savedPreference);\n        console.log('Setting mood feature enabled to:', enabled);\n        setMoodFeatureEnabled(enabled)\n      } else {\n        console.log('No saved preference found for authenticated user, using default: true');\n        setMoodFeatureEnabled(true);\n      }\n    } else {\n      console.log('User not authenticated, disabling mood feature');\n      setMoodFeatureEnabled(false);\n    }\n  }, [isAuthenticated])\n\n  //  REMOVED: No more mood toggle events that cause React re-renders and lose highlights!\n  // Mood elements are now controlled by direct DOM manipulation in MoodToggle component\n\n\n  \n  // Check if user is authenticated\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setIsAuthenticated(!!user)\n      setCurrentUser(user)\n      \n      // Note: Like status is now handled by LikeButton component\n    })\n    \n    return () => unsubscribe()\n  }, [article])\n  \n  // Handle clicks outside the profile menu to close it\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      const profileMenu = document.getElementById('profile-menu');\n      const profileButton = document.getElementById('profile-button');\n      \n      if (profileMenu && !profileMenu.contains(target) && \n          profileButton && !profileButton.contains(target)) {\n        setIsProfileMenuOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n  \n  // Fetch article data\n  useEffect(() => {\n    const fetchArticle = async () => {\n      if (!slug) {\n        setError('No article slug provided')\n        setIsLoading(false)\n        return\n      }\n      \n      try {\n        const articleData = await getArticleBySlug(slug)\n        \n        if (!articleData) {\n          setError('Article not found')\n          setIsLoading(false)\n          return\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '')\n          \n        setArticleHtml(cleanHtml)\n        setLikes(articleData.likes || [])\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length\n        const readTimeMinutes = Math.ceil(wordCount / 200)\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date'\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug\n        })\n        \n        setTags(articleData.tags || [])\n        setIsLoading(false)\n      } catch (error) {\n        console.error('Error fetching article:', error)\n        setError('Failed to load article')\n        setIsLoading(false)\n      }\n    }\n    \n    fetchArticle()\n  }, [slug])\n  \n  // Analyze mood when article content is loaded (only for authenticated users)\n  useEffect(() => {\n    if (articleHtml && isAuthenticated) {\n      // Extract text from HTML for sentiment analysis\n      const textContent = articleHtml.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim()\n      if (textContent) {\n        const detectedMood = getMoodFromText(textContent)\n        setMood(detectedMood)\n      }\n    }\n  }, [articleHtml, isAuthenticated])\n  \n  const handleSignOut = async () => {\n    try {\n      await signOut(auth)\n      setIsProfileMenuOpen(false)\n    } catch (error) {\n      console.error('Error signing out:', error)\n    }\n  }\n  \n  const toggleSidebar = () => {\n    setIsSidebarCollapsed(!isSidebarCollapsed)\n  }\n\n  const toggleProfileMenu = () => {\n    setIsProfileMenuOpen(!isProfileMenuOpen)\n  }\n  \n  // Debug console for re-renders\n  console.log(' Articles page Article component re-rendered at:', new Date().toLocaleTimeString());\n  \n  if (isLoading) {\n    return (\n      <div className={articleStyles.loadingContainer}>\n        <div className={articleStyles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    )\n  }\n  \n  if (error) {\n    return (\n      <div className={articleStyles.errorContainer}>\n        <p className={articleStyles.errorMessage}>{error}</p>\n      </div>\n    )\n  }\n  \n  // Handle when editing is complete\n  const handleUpdateComplete = () => {\n    console.log('Article update complete - refreshing content');\n    \n    // Set editing state to false\n    setIsEditing(false);\n    \n    // Refetch the article to show updated content without changing routes\n    const refetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        \n        // Add a small delay to ensure Firebase has processed the update\n        await new Promise(resolve => setTimeout(resolve, 500));\n        \n        const articleData = await getArticleBySlug(slug || '');\n        \n        if (!articleData) {\n          setError('Article not found');\n          setIsLoading(false);\n          return;\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n          \n        setArticleHtml(cleanHtml);\n        setLikes(articleData.likes || []);\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length;\n        const readTimeMinutes = Math.ceil(wordCount / 200);\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date';\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug || ''\n        });\n        \n        setTags(articleData.tags || []);\n        \n        console.log('Article refreshed successfully - mood feature state preserved');\n      } catch (error) {\n        console.error('Error refetching article:', error);\n        setError('Failed to refresh article content');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n    \n    refetchArticle();\n  };\n\n  if (isEditing && article) {\n    return (\n      <div>\n        <div className={articleStyles.editingHeader}>\n          <button onClick={() => setIsEditing(false)} className={articleStyles.cancelButton}>\n             Back to Article\n          </button>\n          <h2>Editing: {article.title}</h2>\n        </div>\n        <ArticleComposer articleId={article.id} onUpdateComplete={handleUpdateComplete} />\n      </div>\n    );\n  }\n  \n  return (\n    <div \n      className={articleStyles.articlePageContainer}\n      style={{ position: 'relative', backgroundColor: '#ffffff' }}\n    >\n      {/* Dynamic animated mood gradient overlay (always rendered but controlled by MoodToggle) */}\n      {isAuthenticated && (\n        <>\n          {/* Primary flowing gradient */}\n          <div\n            data-mood-element=\"primary-gradient\"\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundImage: `linear-gradient(45deg, \n                ${moodThemes[mood].gradientStart}40, \n                ${moodThemes[mood].gradientEnd}60, \n                ${moodThemes[mood].gradientStart}30, \n                ${moodThemes[mood].gradientEnd}50)`,\n              backgroundSize: '400% 400%',\n              animation: 'gradientFlow 8s ease-in-out infinite',\n              filter: 'contrast(1.1) brightness(1.05) saturate(1.1)',\n              zIndex: 0,\n              transition: 'background-image 1s ease-in-out',\n              pointerEvents: 'none',\n              // Initial display controlled by localStorage preference\n              display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n            }}\n          />\n          \n          {/* Grain texture overlay */}\n          <div\n            data-mood-element=\"grain-texture\"\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundImage: `\n                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),\n                radial-gradient(circle at 75% 75%, rgba(0,0,0,0.05) 1px, transparent 1px),\n                radial-gradient(circle at 45% 15%, rgba(255,255,255,0.08) 1px, transparent 1px),\n                radial-gradient(circle at 15% 85%, rgba(0,0,0,0.03) 1px, transparent 1px)\n              `,\n              backgroundSize: '4px 4px, 6px 6px, 3px 3px, 5px 5px',\n              animation: 'grainMove 20s linear infinite',\n              opacity: 0.6,\n              mixBlendMode: 'soft-light',\n              zIndex: 0,\n              pointerEvents: 'none',\n              display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n            }}\n          />\n          \n          {/* Secondary wave layer */}\n          <div\n            data-mood-element=\"secondary-wave\"\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundImage: `radial-gradient(ellipse at 30% 50%, \n                ${moodThemes[mood].gradientEnd}25, \n                transparent 70%), \n                radial-gradient(ellipse at 70% 80%, \n                ${moodThemes[mood].gradientStart}30, \n                transparent 70%)`,\n              backgroundSize: '800% 800%',\n              animation: 'waveFlow 12s linear infinite reverse',\n              filter: 'contrast(1.15) blur(0.5px)',\n              zIndex: 0,\n              transition: 'background-image 1s ease-in-out',\n              pointerEvents: 'none',\n              display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n            }}\n          />\n          \n          {/* Floating orbs */}\n          <div\n            data-mood-element=\"floating-orbs\"\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundImage: `radial-gradient(circle at 20% 20%, \n                ${moodThemes[mood].gradientStart}20, \n                transparent 40%), \n                radial-gradient(circle at 80% 60%, \n                ${moodThemes[mood].gradientEnd}25, \n                transparent 50%),\n                radial-gradient(circle at 40% 90%, \n                ${moodThemes[mood].gradientStart}15, \n                transparent 35%)`,\n              animation: 'orbFloat 15s ease-in-out infinite',\n              filter: 'contrast(1.2) saturate(0.9)',\n              zIndex: 0,\n              pointerEvents: 'none',\n              display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n            }}\n          />\n          \n          {/* Fine grain texture */}\n          <div\n            data-mood-element=\"fine-grain\"\n            style={{\n              position: 'fixed',\n              top: 0,\n              left: 0,\n              right: 0,\n              bottom: 0,\n              backgroundImage: `\n                repeating-conic-gradient(from 0deg at 50% 50%, transparent 0deg, rgba(255,255,255,0.02) 1deg, transparent 2deg),\n                repeating-linear-gradient(90deg, transparent, rgba(0,0,0,0.01) 1px, transparent 2px),\n                repeating-linear-gradient(0deg, transparent, rgba(255,255,255,0.015) 1px, transparent 3px)\n              `,\n              backgroundSize: '2px 2px, 1px 1px, 3px 3px',\n              animation: 'fineGrain 25s linear infinite reverse',\n              opacity: 0.4,\n              mixBlendMode: 'overlay',\n              zIndex: 0,\n              pointerEvents: 'none',\n              display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n            }}\n          />\n        </>\n      )}\n              {article && (\n          <>\n            <header \n              className={articleStyles.pageHeader}\n              data-mood-header=\"page-header\"\n              style={moodFeatureEnabled && isAuthenticated ? {\n                position: 'relative', \n                zIndex: 10000,\n                background: `linear-gradient(135deg, \n                  rgba(255, 255, 255, 0.15) 0%, \n                  ${moodThemes[mood].gradientStart}12 40%, \n                  ${moodThemes[mood].gradientEnd}08 100%)`,\n                backdropFilter: 'blur(24px) saturate(180%)',\n                borderBottom: `1px solid ${moodThemes[mood].gradientStart}25`,\n                boxShadow: `\n                  0 2px 8px -2px ${moodThemes[mood].gradientStart}15,\n                  0 8px 32px -8px ${moodThemes[mood].gradientStart}20,\n                  inset 0 1px 0 rgba(255, 255, 255, 0.25),\n                  inset 0 -1px 0 ${moodThemes[mood].gradientStart}10\n                `,\n                transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n                border: `1px solid ${moodThemes[mood].gradientStart}15`,\n                borderTop: 'none'\n              } : { \n                position: 'relative', \n                zIndex: 10000 \n              }}\n            >\n            <div className={articleStyles.headerContainer}>\n              <Link href=\"/\" className={articleStyles.logoLink}>\n                <div \n                  className={articleStyles.headerLogo}\n                  style={moodFeatureEnabled && isAuthenticated ? {\n                    color: moodThemes[mood].accent,\n                    fontWeight: '700',\n                    textShadow: `0 0 20px ${moodThemes[mood].gradientStart}30, 0 0 40px ${moodThemes[mood].gradientStart}15`,\n                    transition: 'all 0.3s ease'\n                  } : {\n                    fontWeight: '700'\n                  }}\n                >\n                  Journalite\n                </div>\n              </Link>\n              \n              <div className={articleStyles.headerActions}>\n                {isAuthenticated && <MinimalNotificationBell />}\n                \n                <div className={articleStyles.profileMenu} id=\"profile-menu\">\n                  {isAuthenticated ? (\n                    <>\n                      <div \n                        className={articleStyles.profileCircle} \n                        onClick={toggleProfileMenu}\n                        id=\"profile-button\"\n                      >\n                        {currentUser?.displayName?.charAt(0) || currentUser?.email?.charAt(0) || 'U'}\n                      </div>\n                      \n                      {isProfileMenuOpen && (\n                        <div className={articleStyles.profileDropdown}>\n                          <Link href=\"/\" className={articleStyles.dropdownItem}>Home</Link>\n                          <Link href=\"/my-thoughts\" className={articleStyles.dropdownItem}>My Thoughts</Link>\n                          <Link href=\"/dashboard\" className={articleStyles.dropdownItem}>Dashboard</Link>\n                          <Link href=\"/write\" className={articleStyles.dropdownItem}>Write a story</Link>\n                          <Link href=\"/create-article\" className={articleStyles.dropdownItem}>Create Article</Link>\n                          <Link href=\"/explore\" className={articleStyles.dropdownItem}>Explore</Link>\n                          <Link href=\"/profile\" className={articleStyles.dropdownItem}>Profile</Link>\n                          <Link href=\"/settings\" className={articleStyles.dropdownItem}>Settings</Link>\n                          <button onClick={handleSignOut} className={articleStyles.dropdownItem}>Sign out</button>\n                        </div>\n                      )}\n                    </>\n                  ) : (\n                    <div className={articleStyles.authButtons}>\n                      <Link href=\"/login\" className={articleStyles.loginButton}>\n                        Sign in\n                      </Link>\n                      <Link href=\"/signup\" className={articleStyles.signupButton}>\n                        Get started\n                      </Link>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </header>\n          \n                      <div className={articleStyles.pageContainer} style={{ position: 'relative', zIndex: 1 }}>\n            {/* Article header */}\n            <header className={articleStyles.articleHeader}>\n              <h1 className={articleStyles.articleTitle}>{article.title}</h1>\n              \n              <div className={articleStyles.articleMeta}>\n                <div className={articleStyles.authorInfo}>\n                  <div className={articleStyles.authorAvatar}>{article.authorName.charAt(0)}</div>\n                  <div className={articleStyles.authorDetails}>\n                    <Link \n                      href={`/user/${article.authorName.toLowerCase().replace(/\\s+/g, '')}`} \n                      className={articleStyles.authorNameLink}\n                    >\n                      <div className={articleStyles.authorName}>{article.authorName}</div>\n                    </Link>\n                    <div className={articleStyles.articleDetails}>\n                      {article.createdAt}  {article.readTime} min read\n                    </div>\n                  </div>\n                </div>\n                \n                <div className={articleStyles.articleActions}>\n                  <LikeButton \n                    articleId={article.id}\n                    initialLikes={likes}\n                    className={`${articleStyles.likeButton}`}\n                    styles={articleStyles}\n                  />\n                  \n                  {isAuthenticated && article.authorId === currentUser?.uid && (\n                    <button \n                      className={articleStyles.editButton}\n                      onClick={() => setIsEditing(true)}\n                    >\n                      Edit\n                    </button>\n                  )}\n                </div>\n              </div>\n              \n              {article.tags && article.tags.length > 0 && (\n                <div className={articleStyles.tagContainer}>\n                  {article.tags.map((tag: string, index: number) => (\n                    <span key={index} className={articleStyles.tag}>{tag}</span>\n                  ))}\n                </div>\n              )}\n            </header>\n            \n            {/* Article content with highlights */}\n            <ArticleWithHighlights \n              articleId={article.id} \n              initialHtml={articleHtml || undefined}\n              isAuthenticated={isAuthenticated}\n              articleTitle={article.title}\n              articleSlug={article.slug}\n            />\n            \n            {/* Comments section */}\n            <div className={articleStyles.commentsContainer}>\n              <CommentSection \n                articleId={article.id} \n                {...(isAuthenticated && {\n                  mood: mood,\n                  moodFeatureEnabled: moodFeatureEnabled\n                })}\n              />\n            </div>\n            \n            {/* Related tags section */}\n            <aside className={articleStyles.relatedTagsSection}>\n              <h2 className={articleStyles.relatedTagsHeading}>Related Tags</h2>\n              <div className={articleStyles.relatedTagsList}>\n                {tags.map((tag: string) => (\n                  <Link\n                    key={tag}\n                    href={`/tag/${tag.toLowerCase()}`}\n                    className={articleStyles.relatedTag}\n                  >\n                    # {tag}\n                  </Link>\n                ))}\n              </div>\n              \n              <Link href='/write' className={articleStyles.writeButton}>\n                Write\n              </Link>\n            </aside>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default function ArticlePage () {\n  return (\n    <Suspense fallback={<div>Loading article...</div>}>\n      <Article />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}