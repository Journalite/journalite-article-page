exports.id=5046,exports.ids=[5046],exports.modules={6248:e=>{e.exports={commentSection:"comment_commentSection__SP_jS",commentSectionTitle:"comment_commentSectionTitle__F_Jxe",commentError:"comment_commentError__A2v6U",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",loginPromptContainer:"comment_loginPromptContainer__X4aZr",commentAvatar:"comment_commentAvatar__uav6Q",replyAvatar:"comment_replyAvatar__dIlrw",commentInput:"comment_commentInput__4DHa1",replyInput:"comment_replyInput__8t_ho",commentSubmit:"comment_commentSubmit__UfvUF",replySubmit:"comment_replySubmit__2eCP7",loginButton:"comment_loginButton__4encR",loginModalOverlay:"comment_loginModalOverlay__Pk_AM",loginModal:"comment_loginModal__n984X",loginModalClose:"comment_loginModalClose__v02Rx",loginModalTitle:"comment_loginModalTitle__nZpZB",loginModalText:"comment_loginModalText__XwRn6",loginModalButtons:"comment_loginModalButtons__XdVNl",loginModalButton:"comment_loginModalButton__d8Bnr",primary:"comment_primary__1UIRJ",secondary:"comment_secondary__zc89j",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6",commentsList:"comment_commentsList__ZRMbc",commentItem:"comment_commentItem__Vx48l",commentHeader:"comment_commentHeader__3oOD6",commentUser:"comment_commentUser__QP5pY",commentDate:"comment_commentDate__5zfpn",commentContent:"comment_commentContent__DiE8h",commentActions:"comment_commentActions___Wpzi",commentLikeBtn:"comment_commentLikeBtn__wAYZO",replyToggle:"comment_replyToggle__bCRZg",commentDeleteBtn:"comment_commentDeleteBtn__BnLQc",liked:"comment_liked__2yWZ9",repliesToggle:"comment_repliesToggle__yepDc",repliesToggleIcon:"comment_repliesToggleIcon__EZRkK",open:"comment_open__cpLDc",replySection:"comment_replySection__mAqn4",replyItem:"comment_replyItem__ndhqf",replyHeader:"comment_replyHeader__Y2bUK",replyUser:"comment_replyUser__rw4V8",replyDate:"comment_replyDate__4Jafb",replyContent:"comment_replyContent__uV2jp",replyForm:"comment_replyForm__aYyum",inThread:"comment_inThread__lUoKT",replyButtons:"comment_replyButtons__KRGyv",replyCancel:"comment_replyCancel__od7Vq"}},8775:(e,t,o)=>{"use strict";o.d(t,{A:()=>c});var r=o(60687),n=o(76180),i=o.n(n),a=o(43210),l=o(41120),s=o(90436);let c=({isOpen:e,onClose:t,highlightText:o,articleTitle:n,shareUrl:c})=>{let[d,m]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(d){let e=setTimeout(()=>m(!1),3e3);return()=>clearTimeout(e)}},[d]),(0,a.useEffect)(()=>{let o=e=>{"Escape"===e.key&&t()};return e&&(document.addEventListener("keydown",o),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",o),document.body.style.overflow="unset"}},[e,t]);let u=async()=>{try{await navigator.clipboard.writeText(c),m(!0)}catch(e){console.error("Failed to copy link:",e)}};return e?(0,s.createPortal)((0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem"},onClick:t,className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"2rem",maxWidth:"500px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",position:"relative",animation:"modalSlideIn 0.3s ease-out"},onClick:e=>e.stopPropagation(),className:"jsx-8795408d21c696e",children:[(0,r.jsx)("button",{onClick:t,style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#6B7280",padding:"0.25rem",borderRadius:"0.375rem",transition:"color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.color="#374151",onMouseOut:e=>e.currentTarget.style.color="#6B7280",className:"jsx-8795408d21c696e",children:"\xd7"}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600",color:"#1F2937"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)(l.uQ,{size:20,color:"#3b82f6"}),"Share Highlight"]}),(0,r.jsxs)("p",{style:{margin:0,color:"#6B7280",fontSize:"0.875rem"},className:"jsx-8795408d21c696e",children:['Share this highlight from "',n,'"']})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#F9FAFB",border:"2px solid #E5E7EB",borderRadius:"0.75rem",padding:"1.25rem",marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("div",{style:{fontSize:"1rem",lineHeight:"1.6",color:"#374151",fontStyle:"italic",marginBottom:"0.75rem"},className:"jsx-8795408d21c696e",children:['"',o,'"']}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6B7280",fontWeight:"500"},className:"jsx-8795408d21c696e",children:['â€” from "',n,'"']})]}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},className:"jsx-8795408d21c696e",children:"Share Link"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)("input",{type:"text",value:c,readOnly:!0,style:{flex:1,padding:"0.75rem",border:"1px solid #D1D5DB",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"#F9FAFB",fontFamily:"monospace"},className:"jsx-8795408d21c696e"}),(0,r.jsx)("button",{onClick:u,style:{padding:"0.75rem 1rem",backgroundColor:d?"#10B981":"#3B82F6",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},className:"jsx-8795408d21c696e",children:d?"âœ“ Copied!":"\uD83D\uDCCB Copy"})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},className:"jsx-8795408d21c696e",children:[!1,(0,r.jsx)("button",{onClick:t,style:{padding:"0.75rem 1.5rem",backgroundColor:"#F3F4F6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#E5E7EB",onMouseOut:e=>e.currentTarget.style.backgroundColor="#F3F4F6",className:"jsx-8795408d21c696e",children:"Close"})]})]}),(0,r.jsx)(i(),{id:"8795408d21c696e",children:"@-webkit-keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-moz-keyframes modalSlideIn{from{opacity:0;-moz-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-moz-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-o-keyframes modalSlideIn{from{opacity:0;-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);-moz-transform:translatey(-20px)scale(.95);-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);-moz-transform:translatey(0)scale(1);-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}"})]}),document.body):null}},18314:(e,t,o)=>{"use strict";o.d(t,{Qx:()=>r});let r={joyful:{gradientStart:"#fde047",gradientEnd:"#fb923c",accent:"#f59e0b"},angry:{gradientStart:"#f87171",gradientEnd:"#dc2626",accent:"#ef4444"},energetic:{gradientStart:"#34d399",gradientEnd:"#059669",accent:"#10b981"},peaceful:{gradientStart:"#60a5fa",gradientEnd:"#2563eb",accent:"#3b82f6"},reflective:{gradientStart:"#a78bfa",gradientEnd:"#7c3aed",accent:"#8b5cf6"},sad:{gradientStart:"#94a3b8",gradientEnd:"#475569",accent:"#64748b"},calm:{gradientStart:"#67e8f9",gradientEnd:"#0891b2",accent:"#06b6d4"}}},32031:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a,metadata:()=>n,viewport:()=>i});var r=o(37413);let n={title:"Articles | Journalite",description:"Explore the latest articles from Journalite"},i={width:"device-width",initialScale:1,maximumScale:1};function a({children:e}){return(0,r.jsx)(r.Fragment,{children:e})}},34377:(e,t,o)=>{"use strict";o.d(t,{I:()=>a,d:()=>i});var r=o(43210),n=o.n(r);let i=(e,t,o=!1)=>{let r=e?.charAt(0)?.toUpperCase()||"A",i=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"],a=t?Math.abs(t.charCodeAt(0)%i.length):0,l=i[a];return n().createElement("div",{style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:o?"0.8rem":"1rem",width:o?"32px":"40px",height:o?"32px":"40px",borderRadius:"50%",flexShrink:0}},r)},a=(e,t)=>(e?.charAt(0)?.toUpperCase()||"")+(t?.charAt(0)?.toUpperCase()||"")||"U"},34738:e=>{e.exports={articleContainer:"ArticleWithHighlights_articleContainer__r1hgP",articleContent:"ArticleWithHighlights_articleContent__qrFhS",loadingContainer:"ArticleWithHighlights_loadingContainer__6cqbO",loadingIndicator:"ArticleWithHighlights_loadingIndicator__ymNyj",spin:"ArticleWithHighlights_spin__Olepl",errorContainer:"ArticleWithHighlights_errorContainer__njqpS",errorMessage:"ArticleWithHighlights_errorMessage__D4C7O"}},36012:e=>{e.exports={articlePageContainer:"ArticlePage_articlePageContainer__S9vO3",pageHeader:"ArticlePage_pageHeader__LpJc9",headerContainer:"ArticlePage_headerContainer__2_FTv",logoLink:"ArticlePage_logoLink__fMNNv",headerLogo:"ArticlePage_headerLogo__QZCOB",headerActions:"ArticlePage_headerActions__gK7Eo",profileMenu:"ArticlePage_profileMenu__LJeQ0",profileCircle:"ArticlePage_profileCircle__mpTwC",profileDropdown:"ArticlePage_profileDropdown__PnV9R",dropdownItem:"ArticlePage_dropdownItem__Lac2v",authButtons:"ArticlePage_authButtons__R_ANg",loginButton:"ArticlePage_loginButton__kpUQh",signupButton:"ArticlePage_signupButton__EvVWG",pageContainer:"ArticlePage_pageContainer__7QNUg",relatedTagsSection:"ArticlePage_relatedTagsSection__SvZ8y",relatedTagsHeading:"ArticlePage_relatedTagsHeading__Ys9Op",relatedTagsList:"ArticlePage_relatedTagsList__Xn3ds",relatedTag:"ArticlePage_relatedTag__DEwLe",writeButton:"ArticlePage_writeButton__yZp3x",articleHeader:"ArticlePage_articleHeader__LJolV",articleHeaderWithReaders:"ArticlePage_articleHeaderWithReaders__Ni9rZ",titleSection:"ArticlePage_titleSection__fYdJv",readersSection:"ArticlePage_readersSection__SRec1",articleTitle:"ArticlePage_articleTitle__euOmw",articleMeta:"ArticlePage_articleMeta__LXXWl",authorInfo:"ArticlePage_authorInfo__nnMSs",authorAvatar:"ArticlePage_authorAvatar__1S1bM",authorDetails:"ArticlePage_authorDetails__65w4B",authorNameLink:"ArticlePage_authorNameLink__c6fCN",authorName:"ArticlePage_authorName__o2DdL",articleDetails:"ArticlePage_articleDetails__mK6k_",articleActions:"ArticlePage_articleActions__IZLcw",editButton:"ArticlePage_editButton__Yl62q",tagContainer:"ArticlePage_tagContainer__kI5Py",tag:"ArticlePage_tag__F5Z0e",likeButton:"ArticlePage_likeButton__V0q84",liked:"ArticlePage_liked__Mzzkj",likeIcon:"ArticlePage_likeIcon__zOA_O",commentsContainer:"ArticlePage_commentsContainer__rpCTJ",loadingContainer:"ArticlePage_loadingContainer__v7RVf",loadingIndicator:"ArticlePage_loadingIndicator__E2bt3",spin:"ArticlePage_spin__yRZnI",errorContainer:"ArticlePage_errorContainer__pxRgD",errorMessage:"ArticlePage_errorMessage__quACi",editingHeader:"ArticlePage_editingHeader__nzcMi",cancelButton:"ArticlePage_cancelButton__V2ihM",articleContent:"ArticlePage_articleContent__NWe57",backLink:"ArticlePage_backLink__Cfs_B",moodControls:"ArticlePage_moodControls__iU3JZ",moodToggleButton:"ArticlePage_moodToggleButton__U3y0U",shareButton:"ArticlePage_shareButton__IgaGg"}},36828:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"useContext")&&o.d(t,{useContext:function(){return r.useContext}}),o.o(r,"useMemo")&&o.d(t,{useMemo:function(){return r.useMemo}}),o.o(r,"useRef")&&o.d(t,{useRef:function(){return r.useRef}}),o.o(r,"useState")&&o.d(t,{useState:function(){return r.useState}})},39535:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"forwardRef")&&o.d(t,{forwardRef:function(){return r.forwardRef}}),o.o(r,"useContext")&&o.d(t,{useContext:function(){return r.useContext}})},45256:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"useId")&&o.d(t,{useId:function(){return r.useId}}),o.o(r,"useMemo")&&o.d(t,{useMemo:function(){return r.useMemo}})},50130:e=>{e.exports={reflectionRoomContainer:"ReflectionRoom_reflectionRoomContainer__6TmAa",backdrop:"ReflectionRoom_backdrop__KGxTG",sidebar:"ReflectionRoom_sidebar__dbvRa",mobileModal:"ReflectionRoom_mobileModal__7pRP5",header:"ReflectionRoom_header__0Ynj_",headerTitle:"ReflectionRoom_headerTitle__sMhoT",closeButton:"ReflectionRoom_closeButton__pqCgf",topicSection:"ReflectionRoom_topicSection__Iywnd",topicLabel:"ReflectionRoom_topicLabel__rhBKQ",topicText:"ReflectionRoom_topicText__tZ6jm",messagesContainer:"ReflectionRoom_messagesContainer__flbBi",messagesList:"ReflectionRoom_messagesList__XdeUo",message:"ReflectionRoom_message__IFqbO",ownMessage:"ReflectionRoom_ownMessage__21F3j",otherMessage:"ReflectionRoom_otherMessage__Azd_Z",messageHeader:"ReflectionRoom_messageHeader__8CyNx",messageHeaderRight:"ReflectionRoom_messageHeaderRight__bkPS2",userName:"ReflectionRoom_userName__B2m8R",messageTime:"ReflectionRoom_messageTime__HmW9V",messageContent:"ReflectionRoom_messageContent__TEe9D",authorMessage:"ReflectionRoom_authorMessage__ywPrb",authorName:"ReflectionRoom_authorName__wHiMA",authorBadge:"ReflectionRoom_authorBadge__uIGSy",messageForm:"ReflectionRoom_messageForm__IStCS",inputContainer:"ReflectionRoom_inputContainer__jICbm",messageInput:"ReflectionRoom_messageInput__xbHQv",sendButton:"ReflectionRoom_sendButton__Op965",characterCount:"ReflectionRoom_characterCount__Pgn4b",authPrompt:"ReflectionRoom_authPrompt__06gaE",loadingState:"ReflectionRoom_loadingState__mCkLq",errorState:"ReflectionRoom_errorState__lLBS3",emptyState:"ReflectionRoom_emptyState__O3Cs7",sendingSpinner:"ReflectionRoom_sendingSpinner__As_2t",spin:"ReflectionRoom_spin__9rYOC",loadingSpinner:"ReflectionRoom_loadingSpinner__dqZv4",emptyIcon:"ReflectionRoom_emptyIcon__jEtSv",reflectionSearchBar:"ReflectionRoom_reflectionSearchBar__pUXJI",reflectionSearchWrapper:"ReflectionRoom_reflectionSearchWrapper__CbCn1",focused:"ReflectionRoom_focused__LOk9v","holographic-shine":"ReflectionRoom_holographic-shine__YGlYP",reflectionIcon:"ReflectionRoom_reflectionIcon__UzCmu",reflectionText:"ReflectionRoom_reflectionText__vB9qw",reflectionLabel:"ReflectionRoom_reflectionLabel__7f_Nj",reflectionTopic:"ReflectionRoom_reflectionTopic__eWDD4",reflectionJoin:"ReflectionRoom_reflectionJoin__U6Usf",reflectionUnread:"ReflectionRoom_reflectionUnread__a6Wc7",reflectionJoinText:"ReflectionRoom_reflectionJoinText__4Z582",reflectionArrow:"ReflectionRoom_reflectionArrow__ST2X_",deleteButton:"ReflectionRoom_deleteButton___BxTC",deleteSpinner:"ReflectionRoom_deleteSpinner__rLa7d",messageDeleting:"ReflectionRoom_messageDeleting__z62yB"}},56208:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"createContext")&&o.d(t,{createContext:function(){return r.createContext}})},62396:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"Component")&&o.d(t,{Component:function(){return r.Component}}),o.o(r,"useContext")&&o.d(t,{useContext:function(){return r.useContext}})},62475:(e,t,o)=>{"use strict";o.d(t,{H:()=>i});var r=o(85311),n=o.n(r);function i(e){let t=new(n())().analyze(e),o=e.toLowerCase(),r=["angry","furious","rage","mad","hate","disgusted","outraged","pissed","frustrated","livid","infuriated","enraged","trump","politician","corrupt","stupid","idiot","terrible","awful","worst","disgusting","pathetic"].filter(e=>o.includes(e)).length,i=["happy","joy","excited","amazing","wonderful","fantastic","great","awesome","brilliant","excellent","perfect","beautiful","love","celebrate","triumph","success","victory","delighted","cheerful","blissful"].filter(e=>o.includes(e)).length,a=["calm","peaceful","serene","tranquil","gentle","soothing","quiet","meditation","zen","harmony","balance","nature","garden","sunset","ocean","mindful","breathe","stillness"].filter(e=>o.includes(e)).length,l=["energy","power","strong","dynamic","intense","passionate","vibrant","bold","fierce","electric","explosive","powerful","charged","pumped","motivated","driven"].filter(e=>o.includes(e)).length,s=["sad","depressed","melancholy","grief","sorrow","tragic","heartbreak","crying","tears","lonely","despair","hopeless","miserable","devastated","broken"].filter(e=>o.includes(e)).length;return r>=2||r>=1&&t.score<-2?"angry":i>=2||i>=1&&t.score>3?"joyful":a>=2||a>=1&&t.score>0?"peaceful":l>=2||l>=1&&Math.abs(t.score)>2?"energetic":s>=2||s>=1&&t.score<-1?"sad":t.score>2?"joyful":t.score<-3?"angry":t.score<-1?"sad":"reflective"}},78335:()=>{},80656:(e,t,o)=>{"use strict";var r=o(43210);o.o(r,"useContext")&&o.d(t,{useContext:function(){return r.useContext}}),o.o(r,"useId")&&o.d(t,{useId:function(){return r.useId}}),o.o(r,"useInsertionEffect")&&o.d(t,{useInsertionEffect:function(){return r.useInsertionEffect}}),o.o(r,"useRef")&&o.d(t,{useRef:function(){return r.useRef}})},80726:(e,t,o)=>{var r={"./en/index":57415};function n(e){return o(i(e))}function i(e){if(!o.o(r,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}n.keys=function(){return Object.keys(r)},n.resolve=i,e.exports=n,n.id=80726},89404:(e,t,o)=>{"use strict";o.d(t,{A:()=>g});var r=o(60687),n=o(43210),i=o.n(n),a=o(75535),l=o(84245),s=o(43649),c=o(6248),d=o.n(c),m=o(41120),u=o(34377);o(62475),o(18314);let g=i().memo(({articleId:e,className:t=""})=>{let[o,i]=(0,n.useState)([]),[c,g]=(0,n.useState)(""),[h,p]=(0,n.useState)(null),[f,x]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!1),[_,S]=(0,n.useState)(null),[v,w]=(0,n.useState)(""),[C,j]=(0,n.useState)(null),[k,R]=(0,n.useState)(""),[N,A]=(0,n.useState)(new Set),[E,T]=(0,n.useState)(!1),[M,I]=(0,n.useState)(0),F=(0,n.useMemo)(()=>({isMobile:M<=768,isTablet:M>768&&M<=1024,isSmallPhone:M<=480,bottomSafeArea:M<=768?120:40}),[M]);(0,n.useEffect)(()=>{let e,t=()=>I(window.innerWidth);t();let o=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),clearTimeout(e)}},[]),(0,n.useEffect)(()=>{let e=(0,l.onAuthStateChanged)(s.j2,e=>{p(e),x(!!e)});return()=>e()},[]),(0,n.useEffect)(()=>{if(!e)return;let t=(0,a.collection)(s.db,"articles",e,"comments"),o=(0,a.query)(t,(0,a.orderBy)("createdAt","desc")),r=(0,a.onSnapshot)(o,e=>{let t=[];e.forEach(e=>{let o=e.data();t.push({id:e.id,...o})}),i(B(t))});return()=>r()},[e]);let B=(0,n.useCallback)(e=>{let t=e.filter(e=>!e.parentId),o=e.filter(e=>e.parentId);return t.map(e=>({...e,replies:o.filter(t=>t.parentId===e.id).sort((e,t)=>e.createdAt?.toDate()-t.createdAt?.toDate())}))},[]),P=(0,n.useMemo)(()=>"calm",[!1,c,v,k]),L=(0,n.useCallback)(async t=>{if(t.preventDefault(),c.trim()&&h&&!b){y(!0);try{let t=(0,a.collection)(s.db,"articles",e,"comments");await (0,a.addDoc)(t,{text:c.trim(),authorId:h.uid,authorName:h.displayName||"Anonymous",authorEmail:h.email||"",createdAt:new Date,likes:[],mood:void 0}),g(""),T(!1)}catch(e){console.error("Error adding comment:",e)}finally{y(!1)}}},[c,h,b,e,P,!1]),$=(0,n.useCallback)(async t=>{if(v.trim()&&h&&!b){y(!0);try{let o=(0,a.collection)(s.db,"articles",e,"comments");await (0,a.addDoc)(o,{text:v.trim(),authorId:h.uid,authorName:h.displayName||"Anonymous",authorEmail:h.email||"",createdAt:new Date,likes:[],parentId:t,mood:void 0}),w(""),S(null)}catch(e){console.error("Error adding reply:",e)}finally{y(!1)}}},[v,h,b,e,!1]),D=(0,n.useCallback)(async(t,o)=>{if(h)try{let r=(0,a.doc)(s.db,"articles",e,"comments",t),n=o.includes(h.uid)?o.filter(e=>e!==h.uid):[...o,h.uid];await (0,a.updateDoc)(r,{likes:n})}catch(e){console.error("Error updating like:",e)}},[h,e]),z=(0,n.useCallback)(async t=>{if(k.trim()&&h&&!b){y(!0);try{let o=(0,a.doc)(s.db,"articles",e,"comments",t);await (0,a.updateDoc)(o,{text:k.trim(),mood:void 0,editedAt:new Date}),j(null),R("")}catch(e){console.error("Error editing comment:",e)}finally{y(!1)}}},[k,h,b,e,!1]),W=(0,n.useCallback)(async t=>{if(h&&!b&&confirm("Are you sure you want to delete this comment?")){y(!0);try{let o=(0,a.doc)(s.db,"articles",e,"comments",t);await (0,a.deleteDoc)(o);let r=(0,a.query)((0,a.collection)(s.db,"articles",e,"comments"),(0,a.where)("parentId","==",t)),n=(await (0,a.getDocs)(r)).docs.map(t=>(0,a.deleteDoc)((0,a.doc)(s.db,"articles",e,"comments",t.id)));await Promise.all(n),A(e=>{let o=new Set(e);return o.delete(t),o})}catch(e){console.error("Error deleting comment:",e)}finally{y(!1)}}},[h,b,e]),H=(0,n.useCallback)(e=>{if(!e)return"Just now";let t=e.toDate?e.toDate():new Date(e),o=Math.floor((new Date().getTime()-t.getTime())/6e4);return o<1?"Just now":o<60?`${o}m ago`:o<1440?`${Math.floor(o/60)}h ago`:`${Math.floor(o/1440)}d ago`},[]),O=(0,n.useMemo)(()=>({marginBottom:F.isMobile?`max(${F.bottomSafeArea+40}px, calc(${F.bottomSafeArea}px + env(safe-area-inset-bottom)))`:"2rem",paddingBottom:F.isMobile?"20px":"0"}),[F]),U=(0,n.useCallback)((e,t=!1)=>(0,r.jsxs)("div",{className:`${d().comment} ${t?d().reply:""}`,children:[(0,r.jsxs)("div",{className:d().commentContent,children:[(0,r.jsxs)("div",{className:d().commentHeader,children:[(0,r.jsx)("div",{className:d().commentAvatar,children:(0,u.d)(e.authorName,e.authorId)}),(0,r.jsxs)("div",{className:d().commentMeta,children:[(0,r.jsx)("span",{className:d().commentAuthor,children:e.authorName}),(0,r.jsx)("span",{className:d().commentTime,children:H(e.createdAt)})]}),h?.uid===e.authorId&&(0,r.jsxs)("div",{className:d().commentActions,children:[(0,r.jsx)("button",{onClick:()=>{let t=new Set(N);N.has(e.id)?t.delete(e.id):t.add(e.id),A(t)},className:d().menuButton,"aria-label":"Comment options",children:(0,r.jsx)(m.Mg,{size:16,color:"#64748b"})}),N.has(e.id)&&(0,r.jsxs)("div",{className:d().dropdownMenu,children:[(0,r.jsxs)("button",{onClick:()=>{j(e.id),R(e.text),A(new Set)},className:d().menuItem,children:[(0,r.jsx)(m.qU,{size:14,color:"#3b82f6"}),"Edit"]}),(0,r.jsxs)("button",{onClick:()=>W(e.id),className:d().menuItem,disabled:b,children:[(0,r.jsx)(m.uc,{size:14,color:"#ef4444"}),"Delete"]})]})]})]}),C===e.id?(0,r.jsxs)("div",{className:d().editForm,children:[(0,r.jsx)("textarea",{value:k,onChange:e=>R(e.target.value),className:`${d().editInput} mobile-optimized-input`,"data-mobile":"true",rows:3,autoFocus:!0}),(0,r.jsxs)("div",{className:d().editActions,children:[(0,r.jsx)("button",{onClick:()=>{j(null),R("")},className:d().cancelButton,disabled:b,children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>z(e.id),className:d().saveButton,disabled:!k.trim()||b,children:b?"Saving...":"Save"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("p",{className:d().commentText,children:e.text}),(0,r.jsxs)("div",{className:d().commentFooter,children:[(0,r.jsxs)("button",{onClick:()=>D(e.id,e.likes||[]),className:`${d().likeButton} ${e.likes?.includes(h?.uid)?d().liked:""}`,disabled:!f,children:[(0,r.jsx)(m.C3,{size:14,color:e.likes?.includes(h?.uid)?"#ef4444":"#64748b"}),e.likes?.length?e.likes.length:""]}),!t&&(0,r.jsxs)("button",{onClick:()=>S(e.id),className:d().replyButton,disabled:!f,children:[(0,r.jsx)(m.Sb,{size:14,color:"#64748b"}),"Reply"]})]})]})]}),_===e.id&&(0,r.jsxs)("div",{className:d().replyForm,children:[(0,r.jsxs)("div",{className:d().replyInputContainer,children:[(0,r.jsx)("div",{className:d().commentAvatar,children:(0,u.d)(h?.displayName||"User",h?.uid)}),(0,r.jsx)("textarea",{value:v,onChange:e=>w(e.target.value),placeholder:"Write a reply...",className:`${d().replyInput} mobile-optimized-input`,"data-mobile":"true",rows:2,autoFocus:!0})]}),(0,r.jsxs)("div",{className:d().replyActions,children:[(0,r.jsx)("button",{onClick:()=>{S(null),w("")},className:d().cancelButton,disabled:b,children:"Cancel"}),(0,r.jsx)("button",{onClick:()=>$(e.id),className:d().submitButton,disabled:!v.trim()||b,children:b?"Replying...":"Reply"})]})]}),e.replies&&e.replies.length>0&&(0,r.jsx)("div",{className:d().repliesContainer,children:e.replies.map(e=>U(e,!0))})]},e.id),[h,N,C,k,_,v,b,f,H,D,W,z,$]);return(0,r.jsxs)("div",{className:`${d().commentsSection} ${t} comment-section`,style:O,children:[(0,r.jsxs)("h3",{className:d().commentsTitle,children:["Comments (",o.length,")"]}),(0,r.jsx)("form",{className:d().commentForm,onSubmit:L,children:(0,r.jsx)("div",{className:d().commentInputContainer,style:{background:`rgba(255, 255, 255, ${E?"0.1":"0.05"})`,border:`1px solid rgba(255, 255, 255, ${E?"0.2":"0.12"})`,borderRadius:"16px",boxShadow:E?`0 4px 20px rgba(0, 0, 0, 0.1),
                     inset 0 1px 0 rgba(255, 255, 255, 0.2)`:`0 2px 12px rgba(0, 0, 0, 0.06),
                     inset 0 1px 0 rgba(255, 255, 255, 0.12)`,backdropFilter:"blur(16px) saturate(180%)",WebkitBackdropFilter:"blur(16px) saturate(180%)",transform:E?"translateY(-1px)":"translateY(0)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",padding:F.isMobile?"0.875rem":"1rem",marginBottom:F.isMobile?"20px":"0"},children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:d().commentAvatar,children:(0,u.d)(h.displayName||h.name,h.uid||h.id)}),(0,r.jsx)("textarea",{className:`${d().commentInput} mobile-optimized-input comment-input`,placeholder:"Share your thoughts...",value:c,onChange:e=>g(e.target.value),onFocus:e=>{T(!0),F.isMobile&&setTimeout(()=>{e.target.scrollIntoView({behavior:"smooth",block:"center"})},100)},onBlur:()=>{c.trim()||T(!1)},"data-mobile":"true",rows:F.isSmallPhone?3:4,style:{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"20px",color:"#2d3748",fontSize:F.isMobile?"16px":"1rem",padding:F.isMobile?"0.875rem":"1rem",resize:"vertical",minHeight:F.isMobile?"80px":"120px",backdropFilter:"blur(8px)",transition:"all 0.3s ease",...{}}}),(E||c.trim())&&(0,r.jsxs)("div",{className:d().commentActions,children:[(0,r.jsx)("button",{type:"button",onClick:()=>{g(""),T(!1)},className:d().cancelButton,disabled:b,children:"Cancel"}),(0,r.jsx)("button",{type:"submit",className:d().submitButton,disabled:!c.trim()||b,style:{minHeight:F.isMobile?"44px":"36px"},children:b?"Posting...":"Post Comment"})]})]}):(0,r.jsx)("div",{className:d().authPrompt,children:(0,r.jsx)("p",{children:"Please log in to join the conversation."})})})}),(0,r.jsx)("div",{className:d().commentsList,children:0===o.length?(0,r.jsx)("div",{className:d().emptyState,children:(0,r.jsx)("p",{children:"No comments yet. Be the first to share your thoughts!"})}):o.map(e=>U(e))})]})})},90436:(e,t,o)=>{"use strict";var r=o(51215);o.o(r,"createPortal")&&o.d(t,{createPortal:function(){return r.createPortal}})},93924:(e,t,o)=>{"use strict";o.d(t,{A:()=>O});var r=o(60687),n=o(43210),i=o.n(n),a=o(43649),l=o(75535);let s=async(e,t,o,r,n,i="insight")=>{try{let s={articleId:e,userId:t,text:o,prefix:r,suffix:n,tag:i,createdAt:(0,l.serverTimestamp)(),comments:[],reactions:{},userReactions:{}};return(await (0,l.addDoc)((0,l.collection)(a.db,"highlights"),s)).id}catch(e){throw console.error("Error saving highlight:",e),e}},c=async(e,t)=>{try{let o=(0,l.query)((0,l.collection)(a.db,"highlights"),(0,l.where)("articleId","==",e));return t&&(o=(0,l.query)((0,l.collection)(a.db,"highlights"),(0,l.where)("articleId","==",e),(0,l.where)("userId","==",t))),(await (0,l.getDocs)(o)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting highlights:",e),[]}},d=async e=>{try{await (0,l.deleteDoc)((0,l.doc)(a.db,"highlights",e))}catch(e){throw console.error("Error deleting highlight:",e),e}},m=(e,t,o="")=>`${o}/articles?slug=${e}#highlight=${t}`,u=(0,n.createContext)(void 0),g=({children:e,articleId:t})=>{let[o,i]=(0,n.useState)([]),[l,m]=(0,n.useState)(!0),[g,h]=(0,n.useState)(null);(0,n.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{h(e)});return()=>e()},[]),(0,n.useEffect)(()=>{(async()=>{if(t&&g){m(!0);try{let e=await c(t,g.uid);i(e)}catch(e){console.error("Error loading highlights:",e)}finally{m(!1)}}else i([]),m(!1)})()},[t,g]);let p=async(e,t,o,r,n)=>{if(!g)return alert("You must be logged in to highlight text"),null;try{let a=await s(r,g.uid,e,t,o,n),l={id:a,articleId:r,userId:g.uid,text:e,prefix:t,suffix:o,tag:n,createdAt:new Date,reactions:{},userReactions:{}};return i(e=>[...e,l]),a}catch(e){return console.error("Error saving highlight:",e),null}},f=async e=>{try{await d(e),i(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error removing highlight:",e)}};return(0,r.jsx)(u.Provider,{value:{highlights:o,loading:l,saveHighlight:p,removeHighlight:f,highlightElement:(e,t)=>{try{if(!e.toString())return;let o=document.createElement("mark");o.className=`article-highlight highlight-${t}`;try{e.surroundContents(o)}catch(t){try{let t=e.extractContents();o.appendChild(t),e.insertNode(o)}catch(r){let t=e.cloneContents();o.appendChild(t),e.deleteContents(),e.insertNode(o)}}window.getSelection()?.removeAllRanges()}catch(t){console.error("Error highlighting range:",t),window.getSelection()?.removeAllRanges(),window.getSelection()?.addRange(e)}}},children:e})},h=()=>{let e=(0,n.useContext)(u);if(void 0===e)throw Error("useHighlights must be used within a HighlightProvider");return e};var p=o(41120);o(90436),p.TG,p.Ko,p.Tw,p.Gg;let f=({selection:e,onHighlight:t,onResponse:o,onShare:r,onAiAssist:i})=>{let[a,l]=(0,n.useState)({top:0,left:0}),[s,c]=(0,n.useState)(!1),[d,m]=(0,n.useState)(!1),u=(0,n.useRef)(null);return(0,n.useEffect)(()=>{if(!e||e.isCollapsed){c(!1),m(!1);return}let t=e.getRangeAt(0).getBoundingClientRect(),o=window.innerWidth,r=window.innerHeight,n=u.current?.offsetWidth||280,i=u.current?.offsetHeight||40,a=t.left+t.width/2;a-n/2<16?a=n/2+16:a+n/2>o-16&&(a=o-n/2-16);let s=t.top-i-10+window.scrollY;if(t.top-i-10<0&&(s=t.bottom+10+window.scrollY),o<=768){let e=window.scrollY,t=window.scrollY+r;s<e+16&&(s=e+16),s+i>t-16&&(s=t-i-16)}l({top:s,left:a}),c(!0)},[e]),null};var x=o(8775);let b=e=>{let t={prefix:"",suffix:""};if(!e||0===e.rangeCount)return t;let o=e.getRangeAt(0),r=o.toString(),n=o.commonAncestorContainer,i=n.nodeType===Node.TEXT_NODE?n.parentElement:n;if(!i)return t;let a=i.textContent||"",l=a.indexOf(r);if(-1===l){let e=r.replace(/\s+/g," ").trim(),t=a.replace(/\s+/g," ").indexOf(e);-1!==t&&(l=t)}if(-1!==l){let e=Math.max(0,l-50),o=Math.min(a.length,l+r.length+50),n=a.substring(e,l),i=a.substring(l+r.length,o);n=n.replace(/^\S*\s/,""),i=i.replace(/\s\S*$/,""),t.prefix=n,t.suffix=i}return t},y=(e,t)=>{if(!e||!t)return;let o=t.querySelectorAll(".article-highlight"),r=Array.from(o).map(e=>e.getAttribute("data-highlight-id")).filter(Boolean),n=e.map(e=>e.id);if(r.length===n.length&&r.every(e=>n.includes(e)))return;o.forEach(e=>{let t=e.parentNode;if(t){let o=document.createTextNode(e.textContent||"");t.replaceChild(o,e),t.normalize()}});let i=[];if(e.forEach(e=>{let o=((e,o,r)=>{let n,i,a,l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);for(;n=l.nextNode();){let t=(n.textContent||"").indexOf(e);if(-1!==t){let o=document.createRange();return o.setStart(n,t),o.setEnd(n,t+e.length),o}}let s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),c=e=>RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\s+/g,"\\s+"),"i");for(;i=s.nextNode();){let t=i.textContent||"",o=c(e),r=t.match(o);if(r&&void 0!==r.index){let e=document.createRange();return e.setStart(i,r.index),e.setEnd(i,r.index+r[0].length),e}}if(o||r){let n,i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),a=c(o+e+r);for(;n=i.nextNode();){let t=(n.textContent||"").match(a);if(t&&void 0!==t.index){let r=t[0],i=c(o),a=r.match(i),l=a?a[0].length:0,s=document.createRange(),d=t.index+l,m=c(e),u=r.substring(l).match(m);if(u)return s.setStart(n,d),s.setEnd(n,d+u[0].length),s}}}let d=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),m=(o+e+r).replace(/\s+/g," ").trim();for(;a=d.nextNode();){let t=(a.textContent||"").replace(/\s+/g," ").indexOf(m);if(-1!==t){let r=document.createRange(),n=o.replace(/\s+/g," ").trim().length,i=t+(n>0?n+1:0);return r.setStart(a,i),r.setEnd(a,i+e.replace(/\s+/g," ").trim().length),r}}return null})(e.text,e.prefix||"",e.suffix||"");if(o)try{let t=document.createElement("mark");t.className=`article-highlight highlight-${e.tag||"insight"}`,t.dataset.highlightId=e.id;try{o.surroundContents(t)}catch(r){let e=o.extractContents();t.appendChild(e),o.insertNode(t)}console.log(`âœ… Applied highlight "${e.text.substring(0,30)}..." with ID: ${e.id}`)}catch(t){console.error("Error applying highlight:",t,{text:e.text,id:e.id,tag:e.tag}),i.push(e.id)}else console.warn(`âŒ Could not find text for highlight: "${e.text.substring(0,30)}..." with ID: ${e.id}`),i.push(e.id)}),i.length>0){console.log(`ðŸ§¹ Found ${i.length} highlights that couldn't be applied. These might be from old text formatting.`);let e=`failed-highlights-${location.pathname}`,t=JSON.parse(sessionStorage.getItem(e)||"{}");i.forEach(e=>{t[e]=(t[e]||0)+1}),sessionStorage.setItem(e,JSON.stringify(t));let o=Object.entries(t).filter(([e,t])=>t>=3).map(([e])=>e);o.length>0&&(console.log(`ðŸ—‘ï¸  Suggesting cleanup of ${o.length} persistently failed highlights`),sessionStorage.getItem(`cleanup-notification-${location.pathname}`)||(console.log("\uD83D\uDD04 Auto-cleaning broken highlights from text format change..."),setTimeout(()=>{o.forEach(async e=>{try{let t=new CustomEvent("cleanup-broken-highlight",{detail:{highlightId:e}});window.dispatchEvent(t)}catch(t){console.error("Failed to cleanup highlight:",e,t)}})},1e3),sessionStorage.setItem(`cleanup-notification-${location.pathname}`,"shown")))}},_=({articleId:e,children:t,articleTitle:o="Article",articleSlug:i=""})=>{let[a,l]=(0,n.useState)(null),{highlights:s,saveHighlight:c,removeHighlight:d,highlightElement:u}=h(),[g,p]=(0,n.useState)(null),[_,S]=(0,n.useState)(!1),[v,w]=(0,n.useState)(""),[C,j]=(0,n.useState)(!1),[k,R]=(0,n.useState)(""),[N,A]=(0,n.useState)(null),[E,T]=(0,n.useState)(!1),[M,I]=(0,n.useState)(!1),[F,B]=(0,n.useState)({top:0,left:0}),[P,L]=(0,n.useState)(!1),[$,D]=(0,n.useState)(""),z=(0,n.useCallback)(()=>{I(!0),setTimeout(()=>{T(!1),I(!1)},150)},[]),W=(0,n.useCallback)(()=>{if(E)return;let e=window.getSelection();if(e&&!e.isCollapsed){let t=e.toString(),o=t.trim();if(o&&o.length>0&&t.length<1e3){let t=e.getRangeAt(0).commonAncestorContainer;(t.nodeType===Node.TEXT_NODE?t.parentElement?.closest(".article-highlight-container"):t?.closest(".article-highlight-container"))?l(e):l(null)}else l(null)}else l(null)},[E]),H=(0,n.useCallback)((t,o,r)=>{if(t&&o){let n=b(window.getSelection());c(t,n.prefix,n.suffix,e,r),u(o,r)}},[e,c,u]),O=(0,n.useCallback)(e=>{let t=e.target;if(t.classList.contains("article-highlight")){e.preventDefault(),e.stopPropagation();let o=t.dataset.highlightId,r=t.textContent||"";if(o){I(!1),A({id:o,text:r});let e=t.getBoundingClientRect();B({top:e.top-40+window.scrollY,left:e.left+e.width/2}),T(!0),l(null)}}else E&&(z(),A(null))},[E,z]),U=(0,n.useCallback)(()=>{if(N&&N.id){z();let e=N.id;if(A(null),d(e),g){let t=g.querySelector(`[data-highlight-id="${e}"]`);if(t&&t.parentNode){let e=document.createTextNode(t.textContent||"");t.parentNode.replaceChild(e,t),t.parentNode.normalize()}}}},[N,d,g,z]),q=(0,n.useCallback)(e=>{w(e),S(!0)},[]),J=(0,n.useCallback)(e=>{D(e),L(!0)},[]),Y=(0,n.useCallback)(e=>{R(e),j(!0)},[]);(0,n.useEffect)(()=>{document.addEventListener("selectionchange",W);let e=()=>{setTimeout(W,150)};return"ontouchstart"in window&&document.addEventListener("touchend",e),()=>{document.removeEventListener("selectionchange",W),"ontouchstart"in window&&document.removeEventListener("touchend",e)}},[W]),(0,n.useEffect)(()=>{if(g)return g.addEventListener("click",O),()=>{g.removeEventListener("click",O)}},[g,O]),(0,n.useEffect)(()=>{let e=e=>{if(E){let t=e.target;t.closest(".highlight-toolbar")||t.classList.contains("article-highlight")||(z(),A(null))}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[E,z]),(0,n.useEffect)(()=>{if(g){let e=setTimeout(()=>{console.log(`ðŸŽ¨ Applying ${s.length} highlights to content`),y(s,g)},100);return()=>clearTimeout(e)}},[s,g]),(0,n.useEffect)(()=>{let e=e=>{let t=e.detail?.highlightId;t&&(console.log(`ðŸ—‘ï¸ Cleaning up broken highlight: ${t}`),d(t))};return window.addEventListener("cleanup-broken-highlight",e),()=>{window.removeEventListener("cleanup-broken-highlight",e)}},[d]);let X=(0,n.useCallback)(e=>{e&&e!==g&&p(e)},[g]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{selection:a,onHighlight:H,onResponse:q,onShare:J,onAiAssist:Y}),E&&N&&(0,r.jsxs)("div",{className:`highlight-toolbar unhighlight-toolbar ${M?"hiding":""}`,style:{position:"absolute",top:`${F.top}px`,left:`${F.left}px`,transform:M?"translateY(-10px) translateX(-50%)":"translateX(-50%)",zIndex:1e3},children:[(0,r.jsxs)("button",{onClick:U,className:"highlight-btn highlight-btn-danger",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),(0,r.jsx)("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),(0,r.jsx)("line",{x1:"12",y1:"9",x2:"18",y2:"15"})]}),(0,r.jsx)("span",{children:"Unhighlight"})]}),(0,r.jsxs)("button",{onClick:()=>{J(N.text),z()},className:"highlight-btn",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,r.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,r.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,r.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,r.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,r.jsx)("span",{children:"Share"})]}),(0,r.jsxs)("button",{onClick:()=>{q(N.text),z()},className:"highlight-btn",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,r.jsx)("span",{children:"Response"})]})]}),(0,r.jsx)("div",{ref:X,className:"article-highlight-container",children:t}),_&&(0,r.jsx)("div",{className:"highlight-response-modal",children:(0,r.jsxs)("div",{className:"highlight-modal-content",children:[(0,r.jsx)("button",{className:"highlight-modal-close",onClick:()=>S(!1),children:"\xd7"}),(0,r.jsx)("h3",{children:"Respond to highlighted text"}),(0,r.jsxs)("div",{className:"highlight-selected-text",children:['"',v,'"']}),(0,r.jsx)("textarea",{className:"highlight-response-input",placeholder:"Write your response..."}),(0,r.jsx)("button",{className:"highlight-response-submit",children:"Submit"})]})}),C&&(0,r.jsx)("div",{className:"highlight-ai-modal",children:(0,r.jsxs)("div",{className:"highlight-modal-content",children:[(0,r.jsx)("button",{className:"highlight-modal-close",onClick:()=>j(!1),children:"\xd7"}),(0,r.jsx)("h3",{children:"Journa AI"}),(0,r.jsxs)("div",{className:"highlight-selected-text",children:['"',k,'"']}),(0,r.jsxs)("div",{className:"highlight-ai-options",children:[(0,r.jsx)("button",{children:"Explain this"}),(0,r.jsx)("button",{children:"Fact check"}),(0,r.jsx)("button",{children:"Provide context"}),(0,r.jsx)("button",{children:"Summarize"})]}),(0,r.jsx)("div",{className:"highlight-ai-response",children:(0,r.jsx)("div",{className:"highlight-ai-loading",children:"Journa AI is thinking..."})})]})}),P&&(0,r.jsx)(x.A,{isOpen:P,onClose:()=>L(!1),highlightText:$,articleTitle:o,shareUrl:m(i,e)})]})},S=({currentMood:e,isVisible:t,moodFeatureEnabled:o})=>{let[i,a]=(0,n.useState)(!1),[l,s]=(0,n.useState)(null),[c,d]=(0,n.useState)({colorStops:[{id:"1",color:"#007AFF",x:30,y:40,isSelected:!0}],opacity:80,grain:30,mode:"auto"}),m=(0,n.useRef)(null);(0,n.useRef)(null),(0,n.useRef)(null);let u=(0,n.useRef)(),g=e=>{let{colorStops:t,opacity:o,grain:r}=e,n=o/100,i=r/100,a="";if(i>.1){let e=.08*i,t=Math.max(15,25-8*i);a=`
        radial-gradient(ellipse at 12% 18%, rgba(255,255,255,${e}) 3px, transparent ${t}px),
        radial-gradient(ellipse at 87% 23%, rgba(0,0,0,${.7*e}) 2px, transparent ${1.2*t}px),
        radial-gradient(ellipse at 43% 82%, rgba(255,255,255,${.5*e}) 4px, transparent ${.9*t}px),
      `}let l="";if(1===t.length){let e=t[0];l=`radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(255*n).toString(16)}, transparent 70%)`}else if(2===t.length){let[e,o]=t;l=`
        radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(.7*n*255).toString(16)}, transparent 50%),
        radial-gradient(circle at ${o.x}% ${o.y}%, ${o.color}${Math.round(.7*n*255).toString(16)}, transparent 50%)
      `}else if(3===t.length){let[e,o,r]=t;l=`
        radial-gradient(circle at ${e.x}% ${e.y}%, ${e.color}${Math.round(.5*n*255).toString(16)}, transparent 40%),
        radial-gradient(circle at ${o.x}% ${o.y}%, ${o.color}${Math.round(.5*n*255).toString(16)}, transparent 40%),
        radial-gradient(circle at ${r.x}% ${r.y}%, ${r.color}${Math.round(.5*n*255).toString(16)}, transparent 40%)
      `}return a?`${a}${l}`:l||"transparent"},h=(0,n.useMemo)(()=>{let e=0;return t=>{let r=Date.now();if(r-e<100||(e=r,!o))return;let n=g(t);requestAnimationFrame(()=>{document.querySelectorAll("[data-mood-element]").forEach(e=>{e&&(e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease")}),clearTimeout(u.current),u.current=setTimeout(()=>{localStorage.setItem("journaColorThemeConfig",JSON.stringify(t))},500)})}},[o,g]),f=(e,t)=>{e.preventDefault(),s(t),d({...c,colorStops:c.colorStops.map(e=>({...e,isSelected:e.id===t}))})},x=e=>{let t,o;if(!l||!m.current)return;let r=m.current.getBoundingClientRect();e instanceof MouseEvent?(t=e.clientX,o=e.clientY):(t=e.touches[0].clientX,o=e.touches[0].clientY);let n=Math.max(0,Math.min(100,(t-r.left)/r.width*100)),i=Math.max(0,Math.min(100,(o-r.top)/r.height*100)),a={...c,colorStops:c.colorStops.map(e=>e.id===l?{...e,x:n,y:i}:e)};d(a),h(a)},b=()=>{s(null)},y=e=>{if(!c.colorStops.find(e=>e.isSelected))return;let t={...c,colorStops:c.colorStops.map(t=>t.isSelected?{...t,color:e}:t)};d(t),h(t)};if((0,n.useEffect)(()=>{if(l)return document.addEventListener("mousemove",x),document.addEventListener("mouseup",b),document.addEventListener("touchmove",x,{passive:!1}),document.addEventListener("touchend",b),()=>{document.removeEventListener("mousemove",x),document.removeEventListener("mouseup",b),document.removeEventListener("touchmove",x),document.removeEventListener("touchend",b)}},[l,c]),(0,n.useEffect)(()=>{let e=localStorage.getItem("journaColorThemeConfig");if(e)try{let t=JSON.parse(e);d(t),h(t)}catch(e){console.error("Failed to load theme config:",e)}},[]),(0,n.useEffect)(()=>()=>{u.current&&clearTimeout(u.current)},[]),!t||!o)return null;let _=g(c),S=c.colorStops.find(e=>e.isSelected)||c.colorStops[0];return(0,r.jsxs)("div",{style:{position:"fixed",bottom:"40px",left:"40px",zIndex:1001,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,r.jsx)("button",{onClick:()=>a(!i),style:{width:"56px",height:"56px",borderRadius:"50%",border:"none",background:_||"#007AFF",color:"white",fontSize:"20px",cursor:"pointer",boxShadow:i?"0 8px 25px rgba(0, 122, 255, 0.4), 0 0 0 2px rgba(0, 122, 255, 0.2)":"0 6px 20px rgba(0, 122, 255, 0.3)",transform:i?"scale(1.05) rotate(45deg)":"scale(1) rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},title:"Journa Color Editor",children:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"white"}),(0,r.jsx)("circle",{cx:"16",cy:"12",r:"2.5",fill:"white"}),(0,r.jsx)("circle",{cx:"12",cy:"18",r:"2",fill:"white"})]})}),i&&(0,r.jsxs)("div",{style:{position:"fixed",bottom:"110px",left:"40px",width:"380px",maxHeight:"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:"24px",padding:"24px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",zIndex:999,overflow:"hidden"},children:[(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem"},children:[{mode:"auto",icon:p.R9,title:"Auto"},{mode:"light",icon:"â˜€ï¸",title:"Light"},{mode:"dark",icon:"\uD83C\uDF19",title:"Dark"}].map(({mode:e,icon:t,title:o})=>(0,r.jsx)("button",{onClick:()=>{let t={...c,mode:e};d(t),h(t)},style:{width:"48px",height:"48px",borderRadius:"12px",border:c.mode===e?"2px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:c.mode===e?"rgba(0, 122, 255, 0.1)":"rgba(0,0,0,0.05)",fontSize:"20px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:o,children:"auto"===e?(0,r.jsx)(p.R9,{size:20,color:c.mode===e?"#007AFF":"#666"}):t},e))}),(0,r.jsx)("div",{ref:m,style:{width:"100%",height:"180px",borderRadius:"16px",background:"linear-gradient(135deg, #f0f0f0, #e8e8e8)",position:"relative",cursor:"grab",marginBottom:"1.5rem",border:"1px solid rgba(0,0,0,0.1)",overflow:"hidden"},children:c.colorStops.map(e=>(0,r.jsx)("div",{onMouseDown:t=>f(t,e.id),onTouchStart:t=>f(t,e.id),style:{position:"absolute",top:`${e.y}%`,left:`${e.x}%`,transform:"translate(-50%, -50%)",width:e.isSelected?"24px":"20px",height:e.isSelected?"24px":"20px",borderRadius:"50%",background:e.color,border:e.isSelected?"3px solid white":"2px solid white",boxShadow:e.isSelected?"0 4px 12px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.3)",cursor:l===e.id?"grabbing":"grab",transition:l===e.id?"none":"all 0.2s ease",zIndex:e.isSelected?10:5}},e.id))}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,r.jsx)("button",{onClick:()=>{if(c.colorStops.length<=1)return;let e={...c,colorStops:c.colorStops.slice(0,-1)};d(e),h(e)},disabled:c.colorStops.length<=1,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:c.colorStops.length<=1?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:c.colorStops.length<=1?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:c.colorStops.length<=1?.5:1},children:"-"}),(0,r.jsxs)("span",{style:{fontSize:"14px",color:"#666",minWidth:"80px",textAlign:"center"},children:[c.colorStops.length,"/3 colors"]}),(0,r.jsx)("button",{onClick:()=>{if(c.colorStops.length>=3)return;let e={id:Date.now().toString(),color:"#FF6B6B",x:50+15*c.colorStops.length,y:50+10*c.colorStops.length,isSelected:!1},t={...c,colorStops:[...c.colorStops,e]};d(t),h(t)},disabled:c.colorStops.length>=3,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:c.colorStops.length>=3?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:c.colorStops.length>=3?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:c.colorStops.length>=3?.5:1},children:"+"})]}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:["#FFFFFF","#FFB3D9","#B19CD9","#FF6B6B","#FF8E53","#FFD93D","#6BCF7F","#4ECDC4","#45B7D1"].map((e,t)=>(0,r.jsx)("button",{onClick:()=>y(e),style:{width:"32px",height:"32px",borderRadius:"50%",border:S.color===e?"3px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:e,cursor:"pointer",transform:S.color===e?"scale(1.15)":"scale(1)",transition:"all 0.2s ease"}},t))})]})]})},v=i().memo(({initialEnabled:e=!0,className:t="",style:o={},currentMood:i="joyful"})=>{let[l,s]=(0,n.useState)(e),[c,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(!1);return((0,n.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(d(e),e){let e=localStorage.getItem("moodFeatureEnabled");if(null!==e){let t=JSON.parse(e);s(t);let o=(e=1)=>{console.log(`ðŸŽ¨ Applying initial mood state (attempt ${e}):`,t);let r=document.querySelectorAll("[data-mood-element]");if(console.log("\uD83C\uDFA8 Found mood elements on init:",r.length),0===r.length&&e<5)return void setTimeout(()=>o(e+1),200);r.forEach(e=>{e.style.transition="opacity 0.3s ease, transform 0.3s ease",t?(e.setAttribute("data-mood-active","true"),e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.transform="scale(1)",console.log("\uD83C\uDFA8 Initial show:",e.getAttribute("data-mood-element"))):(e.setAttribute("data-mood-active","false"),e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Initial hide:",e.getAttribute("data-mood-element")))}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",t||(e.style.background="rgba(255, 255, 255, 0.95)",e.style.border="1px solid rgba(0, 0, 0, 0.1)",e.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)")})};setTimeout(()=>o(),100)}else s(!0)}else s(!1)});return()=>e()},[]),c)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{if(console.log("\uD83C\uDFA8 MoodToggle clicked - should NOT trigger parent re-render"),!c)return;u(!0),setTimeout(()=>u(!1),300);let e=!l;s(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e)),console.log("\uD83C\uDFA8 Mood feature toggled to:",e),console.log("\uD83C\uDFA8 Toggle clicked - searching for mood elements...");let t=(o=1)=>{let r=document.querySelectorAll("[data-mood-element]");if(console.log(`ðŸŽ¨ Found mood elements (attempt ${o}):`,r.length),0===r.length&&o<3)return void setTimeout(()=>t(o+1),100);r.forEach(t=>{t.style.transition="opacity 0.3s ease, transform 0.3s ease",e?(t.setAttribute("data-mood-active","true"),t.style.display="block",t.style.visibility="visible",t.style.opacity="1",t.style.transform="scale(1)",console.log("\uD83C\uDFA8 Showing mood element:",t.getAttribute("data-mood-element"))):(t.setAttribute("data-mood-active","false"),t.style.opacity="0",t.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Hiding mood element:",t.getAttribute("data-mood-element")),setTimeout(()=>{"false"===t.getAttribute("data-mood-active")&&(t.style.display="none",t.style.visibility="hidden")},300))})};t(),document.querySelectorAll("[data-mood-header]").forEach(t=>{if(t.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",e){t.style.background="",t.style.border="",t.style.boxShadow="";let e=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=e,console.log("\uD83C\uDFA8 Header mood styling restored - cleared overrides")}else t.setAttribute("data-mood-style",t.style.background),t.style.background="rgba(255, 255, 255, 0.95)",t.style.border="1px solid rgba(0, 0, 0, 0.1)",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)",console.log("\uD83C\uDFA8 Header mood styling removed")}),console.log("\uD83C\uDFA8 Mood backgrounds updated immediately. Enabled:",e)},className:t,style:{...o,transition:"all 0.3s ease",transform:m?"scale(1.1)":"scale(1)"},title:l?"Turn off mood feature":"Turn on mood feature",children:l?"ON":"OFF"}),(0,r.jsx)(S,{currentMood:i,isVisible:!!c,moodFeatureEnabled:l})]}):null}),w=i().memo(({articleId:e,className:t,style:i})=>{let[l,s]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),[m,u]=(0,n.useState)(""),[g,h]=(0,n.useState)(""),[f,x]=(0,n.useState)(!1),[b,y]=(0,n.useState)(!1),[_,S]=(0,n.useState)(!1),[v,w]=(0,n.useState)({width:0,height:0}),C=(0,n.useMemo)(()=>{let e=v.width;return{isMobile:e<=768,isTablet:e>768&&e<=1024,isDesktop:e>1024,isSmallPhone:e<=480,isLandscape:e>v.height,isIPad11:e>=820&&e<=1024,bottomSafeArea:Math.max(100,e<=768?120:80),sideMargin:e<=480?16:e<=768?20:40}},[v]);(0,n.useEffect)(()=>{let e,t=()=>{w({width:window.innerWidth,height:window.innerHeight})};t();let o=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),clearTimeout(e)}},[]),(0,n.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{s(e)});return()=>e()},[]);let j=(0,n.useMemo)(()=>["How does this make you feel?","What questions does this raise for you?","How does this relate to your own experience?","What would you do differently?","What surprised you most about this?","What's your main takeaway from this?","How might this change your perspective?"],[]),k=(0,n.useCallback)(()=>{let e=Math.floor(Math.random()*j.length);return j[e]},[j]);(0,n.useEffect)(()=>{m||u(k())},[m,k]);let R=(0,n.useCallback)(()=>{S(!0),d(e=>!e),setTimeout(()=>S(!1),300),c&&(x(!1),h(""))},[c]),N=(0,n.useCallback)(()=>{x(!1),m.trim()||u(k())},[m,k]),A=(0,n.useCallback)(async()=>{if(g.trim()&&!b&&l){y(!0);try{let{saveReflectionResponse:t}=await Promise.resolve().then(o.bind(o,45306));await t(e,`custom_${Date.now()}`,m,g.trim(),0,!0),h(""),d(!1),console.log("Reflection saved successfully")}catch(e){console.error("Error saving reflection:",e)}finally{y(!1)}}},[g,b,l,e,m]),E=(0,n.useMemo)(()=>({position:"fixed",bottom:C.isMobile?`max(${C.bottomSafeArea+20}px, calc(${C.bottomSafeArea}px + env(safe-area-inset-bottom)))`:"40px",right:`${C.sideMargin}px`,width:C.isSmallPhone?"48px":C.isMobile?"52px":"56px",height:C.isSmallPhone?"48px":C.isMobile?"52px":"56px",borderRadius:"50%",background:c?"linear-gradient(135deg, #1d4ed8, #7c3aed)":"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",boxShadow:c?"0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)":"0 6px 20px rgba(59, 130, 246, 0.3)",cursor:"pointer",zIndex:1002,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",transform:_?"scale(1.1)":c?"scale(1.05)":"scale(1)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",contain:"layout style paint",willChange:_?"transform":"auto",...i}),[C,c,_,i]),T=(0,n.useMemo)(()=>({position:"fixed",bottom:C.isMobile?`max(${C.bottomSafeArea+80}px, calc(${C.bottomSafeArea+60}px + env(safe-area-inset-bottom)))`:"110px",right:C.isMobile?`${C.sideMargin}px`:"40px",left:C.isMobile?`${C.sideMargin}px`:"auto",width:C.isMobile?"auto":"380px",maxWidth:C.isMobile?"none":"380px",maxHeight:C.isLandscape&&C.isMobile?"60vh":C.isMobile?"50vh":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:C.isSmallPhone?"16px":C.isMobile?"18px":"24px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",zIndex:1001,padding:C.isSmallPhone?"16px":C.isMobile?"18px":"24px",overflow:"hidden auto",contain:"layout style paint",transform:"translateZ(0)"}),[C]);return l?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{"data-reflection-element":"floating-button",onClick:R,className:`reflection-component hw-accelerated ${t||""}`,style:E,title:c?"Close reflection":"Open reflection","aria-label":c?"Close reflection panel":"Open reflection panel",children:(0,r.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:c?(0,r.jsx)(p.US,{size:C.isSmallPhone?12:14,color:"#ffffff"}):(0,r.jsx)(p.zf,{size:C.isSmallPhone?12:14,color:"#ffffff"})})}),c&&(0,r.jsxs)("div",{className:"reflection-component floating-panel hw-accelerated",style:T,role:"dialog","aria-labelledby":"reflection-title","aria-modal":"true",children:[(0,r.jsx)("style",{children:`
              @keyframes gentleSlideUp {
                from {
                  opacity: 0;
                  transform: translateY(20px) scale(0.98);
                }
                to {
                  opacity: 1;
                  transform: translateY(0) scale(1);
                }
              }
              
              .reflection-panel-enter {
                animation: gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
              }
            `}),(0,r.jsxs)("div",{style:{marginBottom:"20px",textAlign:"center"},children:[(0,r.jsxs)("h3",{id:"reflection-title",style:{margin:"0 0 12px 0",fontSize:C.isSmallPhone?"14px":"16px",fontWeight:"600",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,r.jsx)(p.uQ,{size:C.isSmallPhone?14:16,color:"#3b82f6"}),"Time to Reflect"]}),(0,r.jsx)("div",{style:{position:"relative"},children:f?(0,r.jsx)("input",{type:"text",value:m,onChange:e=>u(e.target.value),onBlur:N,onKeyDown:e=>{"Enter"===e.key&&N(),"Escape"===e.key&&(u(k()),x(!1))},autoFocus:!0,className:"mobile-optimized-input",style:{width:"100%",padding:"8px 12px",border:"2px solid #3b82f6",borderRadius:"12px",background:"white",fontSize:C.isSmallPhone?"13px":"14px",textAlign:"center",outline:"none"}}):(0,r.jsx)("button",{onClick:()=>x(!0),style:{background:"transparent",border:"2px solid transparent",borderRadius:"12px",padding:"8px 12px",fontSize:C.isSmallPhone?"13px":"14px",color:"#3b82f6",cursor:"pointer",transition:"all 0.2s ease",fontWeight:"500",textAlign:"center",width:"100%"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.background="#f8fafc"},onMouseLeave:e=>{e.currentTarget.style.borderColor="transparent",e.currentTarget.style.background="transparent"},title:"Click to edit prompt",children:m})})]}),(0,r.jsx)("textarea",{value:g,onChange:e=>h(e.target.value),placeholder:"Share your thoughts...",className:"mobile-optimized-input reflection-input","data-mobile":"true",style:{width:"100%",height:C.isSmallPhone?"100px":"120px",padding:"12px",border:"2px solid #e2e8f0",borderRadius:"12px",background:"white",fontSize:C.isSmallPhone?"15px":"16px",fontFamily:"inherit",resize:"vertical",outline:"none",transition:"border-color 0.2s ease",marginBottom:"16px"},onFocus:e=>{e.target.style.borderColor="#3b82f6",C.isMobile&&setTimeout(()=>{e.target.scrollIntoView({behavior:"smooth",block:"center"})},100)},onBlur:e=>{e.target.style.borderColor="#e2e8f0"}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",flexDirection:C.isSmallPhone?"column":"row"},children:[(0,r.jsx)("button",{onClick:()=>d(!1),style:{background:"transparent",border:"2px solid #e2e8f0",borderRadius:"12px",padding:C.isSmallPhone?"12px 20px":"8px 16px",fontSize:C.isSmallPhone?"15px":"14px",color:"#64748b",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease",width:C.isSmallPhone?"100%":"auto",minHeight:"44px"},children:"Cancel"}),(0,r.jsx)("button",{onClick:A,disabled:!g.trim()||b,style:{background:g.trim()?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"#e2e8f0",border:"none",borderRadius:"12px",padding:C.isSmallPhone?"12px 20px":"8px 20px",fontSize:C.isSmallPhone?"15px":"14px",color:g.trim()?"white":"#94a3b8",cursor:g.trim()?"pointer":"not-allowed",fontWeight:"600",transition:"all 0.2s ease",opacity:b?.7:1,width:C.isSmallPhone?"100%":"auto",minHeight:"44px"},children:b?"Saving...":"Save Reflection"})]})]})]}):null});var C=o(18314);let j=i().memo(({className:e="",style:t={}})=>{let[o,i]=(0,n.useState)(!0),[l,s]=(0,n.useState)(null),[c,d]=(0,n.useState)(!1),[m]=(0,n.useState)("reflective");return((0,n.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(s(e),e){let e=localStorage.getItem("reflectionsEnabled");if(null!==e){let t=JSON.parse(e);i(t),setTimeout(()=>{document.querySelectorAll("[data-reflection-element]").forEach(e=>{e.style.display=t?"":"none"})},100)}else i(!0)}else i(!1)});return()=>e()},[]),l)?(0,r.jsx)("button",{onClick:()=>{if(console.log("ReflectionModeToggle clicked - should NOT trigger parent re-render"),!l)return;d(!0),setTimeout(()=>d(!1),300);let e=!o;i(e),localStorage.setItem("reflectionsEnabled",JSON.stringify(e)),console.log("Reflection mode toggled to:",e),document.querySelectorAll("[data-reflection-element]").forEach(t=>{e?t.style.display="":t.style.display="none"}),window.dispatchEvent(new CustomEvent("reflectionModeToggle",{detail:{enabled:e}}))},className:e,style:{...t,transition:"all 0.3s ease",transform:c?"scale(1.1)":"scale(1)",background:o?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.2)",color:o?C.Qx[m].accent:"#F7FAFC"},title:o?"Turn off reflections":"Turn on reflections",children:o?"ON":"OFF"}):(0,r.jsx)("button",{style:{...t,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"Sign in to use reflections",children:"OFF"})});var k=o(34738),R=o.n(k);async function N(e){let t=`http://127.0.0.1:5001/api/prototype/v1/article/${e}`,o=await fetch(t);if(!o.ok)throw Error(`Failed to fetch article: ${o.status} ${o.statusText}`);return o.json()}o(46997),o(57894),o(8990),o(68960),o(36014),o(71454),o(25865),o(92623),o(25119),o(29173),o(65848),o(88224),o(35630),o(14321),o(48541),o(83075),o(29731),o(34425),o(61707),o(11566),o(86908);var A=o(46677);let E=`
// Simple syntax highlighting without external dependencies
function highlightCode() {
  const codeBlocks = document.querySelectorAll('pre code');
  
  codeBlocks.forEach(codeBlock => {
    const pre = codeBlock.parentElement;
    if (!pre) return;
    
    // Apply dark theme
    pre.style.backgroundColor = '#1e1e1e';
    pre.style.color = '#d4d4d4';
    pre.style.border = '1px solid #333';
    pre.style.borderRadius = '8px';
    pre.style.padding = '16px';
    pre.style.fontFamily = "'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace";
    pre.style.fontSize = '14px';
    pre.style.lineHeight = '1.6';
    pre.style.overflowX = 'auto';
    pre.style.position = 'relative';
    
    const code = codeBlock.textContent || '';
    let highlightedCode = code;
    
    // Simplified highlighting to avoid regex issues
    try {
      // Keywords
      const keywords = ['const', 'let', 'var', 'function', 'class', 'interface', 'type', 'enum', 'import', 'export', 'from', 'as', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'default', 'try', 'catch', 'finally', 'async', 'await', 'new', 'this', 'extends', 'implements', 'private', 'public', 'protected', 'static'];
      keywords.forEach(keyword => {
        const regex = new RegExp('\\\\b' + keyword + '\\\\b', 'g');
        highlightedCode = highlightedCode.replace(regex, '<span style="color: #569cd6; font-weight: 500;">' + keyword + '</span>');
      });
      
      // Simple string highlighting
      highlightedCode = highlightedCode.replace(/"([^"]*)"/g, '<span style="color: #ce9178;">"$1"</span>');
      highlightedCode = highlightedCode.replace(/'([^']*)'/g, '<span style="color: #ce9178;">'$1'</span>');
      
      // Numbers
      highlightedCode = highlightedCode.replace(/\\b\\d+\\.?\\d*\\b/g, '<span style="color: #b5cea8;">$&</span>');
      
      // Comments
      highlightedCode = highlightedCode.replace(///.*$/gm, '<span style="color: #6a9955; font-style: italic;">$&</span>');
    } catch (e) {
      console.warn('Syntax highlighting failed:', e);
      // Keep original code if highlighting fails
    }
    
    codeBlock.innerHTML = highlightedCode;
    
    // Add language indicator if available
    let language = 'code';
    const classNames = codeBlock.className.split(' ');
    for (const className of classNames) {
      if (className.startsWith('language-')) {
        language = className.replace('language-', '');
        break;
      }
    }
    
    if (pre.hasAttribute('data-language')) {
      language = pre.getAttribute('data-language');
    }
    
    // Add language badge
    const badge = document.createElement('div');
    badge.textContent = language.toUpperCase();
    badge.style.position = 'absolute';
    badge.style.top = '8px';
    badge.style.right = '12px';
    badge.style.background = 'rgba(255, 255, 255, 0.1)';
    badge.style.color = '#a0a0a0';
    badge.style.padding = '2px 8px';
    badge.style.borderRadius = '4px';
    badge.style.fontSize = '12px';
    badge.style.fontWeight = '500';
    badge.style.letterSpacing = '0.5px';
    pre.appendChild(badge);
  });
}

// Run when DOM is loaded
if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', highlightCode);
} else {
  highlightCode();
}

// Also run on dynamic content changes
const observer = new MutationObserver(() => {
  setTimeout(highlightCode, 100);
});

observer.observe(document.body, {
  childList: true,
  subtree: true
});
`;function T(){return(0,A.useEffect)(()=>{let e=document.createElement("script");return e.textContent=E,document.head.appendChild(e),()=>{try{document.head.removeChild(e)}catch(e){}}},[]),null}var M=o(62475),I=o(84245),F=o(26001),B=o(50130),P=o.n(B);let L=({topic:e,unreadCount:t,isOpen:o,onClick:n})=>{let i=e.length>60?`${e.substring(0,60)}...`:e;return(0,r.jsx)(F.P.div,{className:P().reflectionSearchBar,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:n,children:(0,r.jsxs)("div",{className:`${P().reflectionSearchWrapper} ${o?P().focused:""}`,children:[(0,r.jsx)("div",{className:P().reflectionIcon,children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),(0,r.jsx)("path",{d:"M8 10h8"}),(0,r.jsx)("path",{d:"M8 14h6"})]})}),(0,r.jsxs)("div",{className:P().reflectionText,children:[(0,r.jsx)("span",{className:P().reflectionLabel,children:"Reflect on:"}),(0,r.jsxs)("span",{className:P().reflectionTopic,children:['"',i,'"']})]}),(0,r.jsxs)("div",{className:P().reflectionJoin,children:[t>0&&(0,r.jsx)("div",{className:P().reflectionUnread,children:t}),(0,r.jsx)("span",{className:P().reflectionJoinText,children:"Join discussion"}),(0,r.jsx)("svg",{className:P().reflectionArrow,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M9 18l6-6-6-6"})})]})]})})};var $=o(88920),D=o(49048);let z=e=>{let[t,o]=(0,n.useState)([]),[r,i]=(0,n.useState)(""),[s,c]=(0,n.useState)(!0),[d,m]=(0,n.useState)(null),[u,g]=(0,n.useState)(0),h=a.j2.currentUser,p=(0,n.useCallback)(async()=>{try{let t=(0,l.doc)(a.db,"reflections",e,"metadata","main"),o=await (0,l.getDoc)(t);if(o.exists()){let e=o.data();i(e.topic)}}catch(e){console.error("Error loading reflection metadata:",e),m("Failed to load discussion topic")}},[e]);(0,n.useEffect)(()=>{if(!e)return;c(!0);let t=(0,l.collection)(a.db,"reflections",e,"messages"),r=(0,l.query)(t,(0,l.orderBy)("createdAt","asc")),n=(0,l.onSnapshot)(r,e=>{let t=[],r=0;e.forEach(e=>{let o=e.data(),n={id:e.id,userId:o.userId,userName:o.userName,content:o.content,createdAt:o.createdAt,read:o.read||!1};t.push(n),!n.read&&n.userId!==h?.uid&&r++}),o(t),g(r),c(!1),m(null)},e=>{console.error("Error listening to messages:",e),m("Failed to load messages"),c(!1)});return p(),()=>n()},[e,h?.uid,p]);let f=(0,n.useCallback)(async t=>{if(h&&t.trim())try{let o=await (0,D.VM)(h.uid),r=o?`${o.firstName} ${o.lastName}`:h.displayName||h.email?.split("@")[0]||"Anonymous",n=(0,l.collection)(a.db,"reflections",e,"messages");await (0,l.addDoc)(n,{userId:h.uid,userName:r,content:t.trim(),createdAt:(0,l.serverTimestamp)(),read:!1})}catch(e){throw console.error("Error sending message:",e),e}},[h,e]),x=(0,n.useCallback)(async()=>{if(h)try{let t=(0,l.collection)(a.db,"reflections",e,"messages"),o=(await (0,l.getDocs)(t)).docs.filter(e=>{let t=e.data();return!t.read&&t.userId!==h.uid}).map(e=>(0,l.setDoc)(e.ref,{read:!0},{merge:!0}));await Promise.all(o)}catch(e){console.error("Error marking messages as read:",e)}},[h,e]),b=(0,n.useCallback)(async t=>{if(h)try{let o=(0,l.doc)(a.db,"reflections",e,"metadata","main");await (0,l.setDoc)(o,{topic:t,createdAt:(0,l.serverTimestamp)(),authorId:h.uid}),i(t)}catch(e){throw console.error("Error creating reflection room:",e),e}},[h,e]),y=(0,n.useCallback)(async t=>{if(h)try{let o=(0,l.doc)(a.db,"reflections",e,"messages",t),r=await (0,l.getDoc)(o);if(!r.exists())throw Error("Message not found");if(r.data().userId!==h.uid)throw Error("You can only delete your own messages");await (0,l.deleteDoc)(o)}catch(e){throw console.error("Error deleting message:",e),e}},[h,e]),_=(0,n.useCallback)(async()=>{if(h)try{let t=(0,l.collection)(a.db,"reflections",e,"messages"),o=(await (0,l.getDocs)(t)).docs.map(e=>(0,l.deleteDoc)(e.ref));await Promise.all(o)}catch(e){throw console.error("Error clearing messages:",e),e}},[h,e]),S=(0,n.useCallback)(async t=>{if(h)try{let o=(0,l.doc)(a.db,"reflections",e,"metadata","main"),r=await (0,l.getDoc)(o);if(!r.exists())throw Error("Reflection room not found");let n=r.data();if(n.authorId!==h.uid)throw Error("Only the author can update the topic");await _(),await (0,l.setDoc)(o,{...n,topic:t,updatedAt:(0,l.serverTimestamp)()}),i(t)}catch(e){throw console.error("Error updating reflection topic:",e),e}},[h,e,_]);return{messages:t,topic:r,loading:s,error:d,unreadCount:u,sendMessage:f,deleteMessage:y,clearAllMessages:_,updateReflectionTopic:S,markAllAsRead:x,createReflectionRoom:b}},W=({articleId:e,isOpen:t,onClose:o,isMobile:i,authorId:l})=>{let[s,c]=(0,n.useState)(""),[d,m]=(0,n.useState)(!1),[u,g]=(0,n.useState)(null),h=(0,n.useRef)(null),f=(0,n.useRef)(null),{messages:x,topic:b,loading:y,error:_,sendMessage:S,deleteMessage:v,unreadCount:w,markAllAsRead:C}=z(e),j=a.j2.currentUser,k=(0,n.useMemo)(()=>({closed:{x:"100%",opacity:0},open:{x:0,opacity:1}}),[]),R=(0,n.useMemo)(()=>({closed:{y:"100%",opacity:0},open:{y:0,opacity:1}}),[]),N=(0,n.useMemo)(()=>({type:"tween",duration:.3,ease:[.4,0,.2,1]}),[]);(0,n.useEffect)(()=>{let e=setTimeout(()=>{h.current?.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(e)},[x.length]),(0,n.useEffect)(()=>{if(t&&w>0){let e=setTimeout(()=>{C()},500);return()=>clearTimeout(e)}},[t,w,C]);let A=(0,n.useCallback)(()=>{f.current&&(f.current.style.height="auto",f.current.style.height=`${f.current.scrollHeight}px`)},[]);(0,n.useEffect)(()=>{A()},[s,A]);let E=(0,n.useCallback)(async e=>{if(e.preventDefault(),s.trim()&&!d&&j){m(!0);try{await S(s.trim()),c("")}catch(e){console.error("Error sending message:",e)}finally{m(!1)}}},[s,d,j,S]),T=(0,n.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),E(e))},[E]),M=(0,n.useCallback)(e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e);return(new Date().getTime()-t.getTime())/36e5<24?t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):t.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},[]),I=(0,n.useCallback)(async e=>{if(j&&!u){g(e);try{await v(e)}catch(e){console.error("Error deleting message:",e)}finally{g(null)}}},[j,v,u]),B=(0,n.useMemo)(()=>x.map(e=>{let t=e.userId===j?.uid,o=e.userId===l,n=u===e.id;return(0,r.jsxs)("div",{className:`${P().message} ${t?P().ownMessage:P().otherMessage} ${o?P().authorMessage:""} ${n?P().messageDeleting:""}`,children:[(0,r.jsxs)("div",{className:P().messageHeader,children:[(0,r.jsxs)("span",{className:`${P().userName} ${o?P().authorName:""}`,children:[e.userName,o&&(0,r.jsx)("span",{className:P().authorBadge,children:"Author"})]}),(0,r.jsxs)("div",{className:P().messageHeaderRight,children:[(0,r.jsx)("span",{className:P().messageTime,children:M(e.createdAt)}),t&&(0,r.jsx)("button",{className:P().deleteButton,onClick:()=>I(e.id),disabled:n,"aria-label":"Delete message",title:"Delete message",children:n?(0,r.jsx)("div",{className:P().deleteSpinner}):(0,r.jsx)(p.uc,{size:14})})]})]}),(0,r.jsx)("div",{className:P().messageContent,children:e.content})]},e.id)}),[x,j?.uid,l,M,u,I]);return(0,r.jsx)($.N,{mode:"wait",children:t&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(F.P.div,{className:P().backdrop,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:o}),(0,r.jsxs)(F.P.div,{className:`${P().sidebar} ${i?P().mobileModal:""}`,variants:i?R:k,initial:"closed",animate:"open",exit:"closed",transition:N,children:[(0,r.jsxs)("div",{className:P().header,children:[(0,r.jsxs)("div",{className:P().headerTitle,children:[(0,r.jsx)("h3",{children:"Reflection Room"}),(0,r.jsx)("button",{className:P().closeButton,onClick:o,"aria-label":"Close reflection room",children:(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),b&&(0,r.jsxs)("div",{className:P().topicSection,children:[(0,r.jsx)("div",{className:P().topicLabel,children:"Discussion Topic"}),(0,r.jsx)("div",{className:P().topicText,children:b})]})]}),(0,r.jsx)("div",{className:P().messagesContainer,children:y?(0,r.jsxs)("div",{className:P().loadingState,children:[(0,r.jsx)("div",{className:P().loadingSpinner}),(0,r.jsx)("p",{children:"Loading messages..."})]}):_?(0,r.jsx)("div",{className:P().errorState,children:(0,r.jsxs)("p",{children:["Error loading messages: ",_]})}):0===x.length?(0,r.jsxs)("div",{className:P().emptyState,children:[(0,r.jsx)("div",{className:P().emptyIcon,children:"\uD83D\uDCAD"}),(0,r.jsx)("p",{children:"No messages yet. Be the first to share your thoughts!"})]}):(0,r.jsxs)("div",{className:P().messagesList,children:[B,(0,r.jsx)("div",{ref:h})]})}),j&&(0,r.jsxs)("form",{onSubmit:E,className:P().messageForm,children:[(0,r.jsxs)("div",{className:P().inputContainer,children:[(0,r.jsx)("textarea",{ref:f,value:s,onChange:e=>c(e.target.value),onKeyDown:T,placeholder:"Share your thoughts...",className:P().messageInput,rows:1,maxLength:1e3,disabled:d}),(0,r.jsx)("button",{type:"submit",className:P().sendButton,disabled:!s.trim()||d,children:d?(0,r.jsx)("div",{className:P().sendingSpinner}):(0,r.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,r.jsx)("path",{d:"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,r.jsxs)("div",{className:P().characterCount,children:[s.length,"/1000"]})]}),!j&&(0,r.jsx)("div",{className:P().authPrompt,children:(0,r.jsx)("p",{children:"Please sign in to join the conversation"})})]})]})})},H=i().memo(({articleId:e,hasReflectionRoom:t,authorId:o})=>{let[i,l]=(0,n.useState)(!1),[s,c]=(0,n.useState)(!1),[d,m]=(0,n.useState)(!1),{topic:u,unreadCount:g}=z(e),h=(0,n.useCallback)(()=>{l(e=>!e)},[]),p=(0,n.useCallback)(()=>{l(!1)},[]);(0,n.useEffect)(()=>{let e=(0,I.onAuthStateChanged)(a.j2,e=>{m(!!e)});return()=>e()},[]),(0,n.useEffect)(()=>{let e,t=()=>{c(window.innerWidth<=768)};t();let o=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",o),()=>{window.removeEventListener("resize",o),clearTimeout(e)}},[]);let f=(0,n.useMemo)(()=>u||"Join the discussion",[u]);return t&&d?(0,r.jsxs)("div",{className:P().reflectionRoomContainer,children:[(0,r.jsx)(L,{topic:f,unreadCount:g,isOpen:i,onClick:h}),(0,r.jsx)(W,{articleId:e,isOpen:i,onClose:p,isMobile:s,authorId:o})]}):null},(e,t)=>e.articleId===t.articleId&&e.hasReflectionRoom===t.hasReflectionRoom&&e.authorId===t.authorId),O=({articleId:e,initialHtml:t,isAuthenticated:o=!1,articleTitle:i="Article",articleSlug:a="",hasReflectionRoom:l=!1,authorId:s})=>{let[c,d]=(0,n.useState)(null),[m,u]=(0,n.useState)(!t),[h,f]=(0,n.useState)(""),[x,b]=(0,n.useState)("reflective"),y=(0,n.useRef)(null);(0,n.useEffect)(()=>{y.current&&(t||c)&&setTimeout(()=>{var e;y.current&&y.current},100)},[t,c]),(0,n.useEffect)(()=>{let e=S();if(e){let t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();t&&b((0,M.H)(t))}},[t,c]),(0,n.useEffect)(()=>{t||c||(async()=>{try{u(!0);let t=await N(e);if(!t)return void f("Article not found");let o="",r=("string"==typeof t.content?t.content:t.content.map(e=>`<p>${e.text}</p>`).join("\n")).replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");d({title:t.title,body:r})}catch(e){console.error("Error loading article:",e),f("Failed to load article")}finally{u(!1)}})()},[e,c,t]);let S=()=>t?t.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):c?.body||"";return m?(0,r.jsxs)("div",{className:R().loadingContainer,children:[(0,r.jsx)("div",{className:R().loadingIndicator}),(0,r.jsx)("p",{children:"Loading article..."})]}):h?(0,r.jsx)("div",{className:R().errorContainer,children:(0,r.jsx)("p",{className:R().errorMessage,children:h})}):(0,r.jsxs)(g,{articleId:e,children:[(0,r.jsx)(T,{}),(0,r.jsxs)("article",{className:R().articleContainer,children:[l&&o&&(0,r.jsx)(H,{articleId:e,hasReflectionRoom:l,authorId:s}),(0,r.jsx)("div",{"data-toggle-bar":"true",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",margin:"1rem 0",padding:"1rem",backgroundImage:o?`linear-gradient(270deg, ${C.Qx[x].gradientStart}, ${C.Qx[x].gradientEnd})`:"linear-gradient(270deg, #9CA3AF, #6B7280)",backgroundSize:"200% 200%",animation:"slideGradient 8s ease infinite alternate",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",fontSize:"0.875rem",flexWrap:"nowrap"},children:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.875rem",opacity:.9},children:o?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.cL,{size:16,color:"#F7FAFC"}),"Atmosphere adapted"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p.JD,{size:16,color:"#F7FAFC"}),"Sign in for enhanced features"]})}),o&&(0,r.jsxs)("span",{style:{color:"#F7FAFC",fontWeight:"600",fontSize:"0.875rem"},children:[(0,r.jsx)(p.gI,{size:16,color:"#F7FAFC"}),"Enhanced features active"]})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Mood Background"}),(0,r.jsx)(v,{style:{padding:"0.4rem 0.8rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Interactive Reflections"}),(0,r.jsx)(j,{style:{padding:"0.4rem 0.8rem",border:"none",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})]})}),(0,r.jsxs)(_,{articleId:e,articleTitle:i,articleSlug:a,children:[(0,r.jsx)("div",{className:R().articleContent,children:(0,r.jsx)("div",{ref:y,dangerouslySetInnerHTML:{__html:S()}})}),(0,r.jsx)(w,{articleId:e})]})]})]})}},96487:()=>{}};