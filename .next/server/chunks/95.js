exports.id=95,exports.ids=[95],exports.modules={20365:(e,t,r)=>{"use strict";r.d(t,{$i:()=>u,FA:()=>d,KB:()=>h,SR:()=>p,_z:()=>m,iS:()=>f,zS:()=>x});var s=r(75535),a=r(43649),n=r(49048);let o=new Map,i=new Map;async function l(e){let t=o.get(e),r=Date.now();if(t&&r-t.timestamp<3e5)return t.profile;let s=await (0,n.VM)(e);return s&&o.set(e,{profile:s,timestamp:r}),s}async function c(e,t){let r=`${e}-${t}`,s=i.get(r),a=Date.now();if(s&&a-s.timestamp<3e4)return s.count;let n=await g(e,t);return i.set(r,{count:n,timestamp:a}),n}async function d(e,t){if(!e||!t)throw Error("Both user IDs are required");if(e===t)throw Error("Cannot create conversation with yourself");try{let r=(0,s.collection)(a.db,"conversations"),n=(0,s.query)(r,(0,s.where)("participants","array-contains",e));for(let e of(await (0,s.getDocs)(n)).docs)if(e.data().participants.includes(t))return e.id;let o={participants:[e,t].sort(),lastMessage:{content:"",senderId:"",timestamp:(0,s.serverTimestamp)(),read:!1},createdAt:(0,s.serverTimestamp)(),updatedAt:(0,s.serverTimestamp)()};return(await (0,s.addDoc)(r,o)).id}catch(e){throw console.error("Error getting or creating conversation:",e),e}}async function m(e,t,r,n="text"){let o=a.j2.currentUser;if(!o)throw Error("User must be authenticated to send messages");if(!r.trim())throw Error("Message content cannot be empty");try{let l=(0,s.collection)(a.db,"messages"),c={conversationId:e,senderId:o.uid,receiverId:t,content:r.trim(),type:n,timestamp:(0,s.serverTimestamp)(),read:!1},d=await (0,s.addDoc)(l,c),m=(0,s.doc)(a.db,"conversations",e);await (0,s.updateDoc)(m,{lastMessage:{content:r.trim(),senderId:o.uid,timestamp:(0,s.serverTimestamp)(),read:!1},updatedAt:(0,s.serverTimestamp)()});let u=`${e}-${t}`;return i.delete(u),d.id}catch(e){throw console.error("Error sending message:",e),e}}async function u(e,t,r){let n=a.j2.currentUser;if(!n)throw Error("User must be authenticated to send messages");if(!r.uid||!r.username)throw Error("Profile data must include uid and username");try{let o=(0,s.collection)(a.db,"messages"),l={conversationId:e,senderId:n.uid,receiverId:t,content:`Shared ${r.firstName} ${r.lastName}'s profile`,type:"profile",timestamp:(0,s.serverTimestamp)(),read:!1,profileAttachment:r},c=await (0,s.addDoc)(o,l),d=(0,s.doc)(a.db,"conversations",e);await (0,s.updateDoc)(d,{lastMessage:{content:`Shared ${r.firstName} ${r.lastName}'s profile`,senderId:n.uid,timestamp:(0,s.serverTimestamp)(),read:!1},updatedAt:(0,s.serverTimestamp)()});let m=`${e}-${t}`;return i.delete(m),c.id}catch(e){throw console.error("Error sending profile message:",e),e}}function p(e,t,r=50){try{let n=(0,s.collection)(a.db,"messages"),o=(0,s.query)(n,(0,s.where)("conversationId","==",e),(0,s.orderBy)("timestamp","desc"),(0,s.limit)(r));return(0,s.onSnapshot)(o,e=>{let r=[];e.forEach(e=>{r.push({id:e.id,...e.data()})}),t(r.reverse())})}catch(e){throw console.error("Error subscribing to messages:",e),e}}function h(e,t){try{let r=(0,s.collection)(a.db,"conversations"),n=(0,s.query)(r,(0,s.where)("participants","array-contains",e),(0,s.orderBy)("updatedAt","desc"));return(0,s.onSnapshot)(n,async r=>{let s=[],a=new Map;for(let t of r.docs){let r=({id:t.id,...t.data()}).participants.find(t=>t!==e);r&&!a.has(r)&&a.set(r,l(r))}let n=new Map;for(let[e,t]of a)try{let r=await t;r&&n.set(e,r)}catch(t){console.error(`Error fetching profile for user ${e}:`,t)}for(let t of r.docs){let r={id:t.id,...t.data()},a=r.participants.find(t=>t!==e);if(!a)continue;let o=n.get(a);if(!o)continue;let i=await c(r.id,e);s.push({conversation:r,otherUser:{uid:o.uid,username:o.username,firstName:o.firstName,lastName:o.lastName},unreadCount:i})}t(s)})}catch(e){throw console.error("Error subscribing to conversations:",e),e}}async function f(e,t){try{let r=(0,s.collection)(a.db,"messages"),n=(0,s.query)(r,(0,s.where)("conversationId","==",e),(0,s.where)("receiverId","==",t),(0,s.where)("read","==",!1)),o=(await (0,s.getDocs)(n)).docs.map(e=>(0,s.updateDoc)(e.ref,{read:!0}));await Promise.all(o);let l=`${e}-${t}`;i.delete(l)}catch(e){throw console.error("Error marking messages as read:",e),e}}async function g(e,t){try{let r=(0,s.collection)(a.db,"messages"),n=(0,s.query)(r,(0,s.where)("conversationId","==",e),(0,s.where)("receiverId","==",t),(0,s.where)("read","==",!1));return(await (0,s.getDocs)(n)).size}catch(e){return console.error("Error getting unread message count:",e),0}}async function x(e){try{let t=(0,s.collection)(a.db,"messages"),r=(0,s.query)(t,(0,s.where)("receiverId","==",e),(0,s.where)("read","==",!1));return(await (0,s.getDocs)(r)).size}catch(e){return console.error("Error getting total unread count:",e),0}}},34889:(e,t,r)=>{"use strict";var s=r(43210);r.o(s,"useEffect")&&r.d(t,{useEffect:function(){return s.useEffect}}),r.o(s,"useState")&&r.d(t,{useState:function(){return s.useState}})},51437:(e,t,r)=>{"use strict";r.d(t,{A:()=>u});var s=r(60687),a=r(43210),n=r(85814),o=r.n(n),i=r(17193),l=r(43649),c=r(20365),d=r(75934),m=r.n(d);let u=()=>{let[e]=(0,i.hD)(l.j2),[t,r]=(0,a.useState)(0),[n,d]=(0,a.useState)(!1),u=(0,a.useRef)(null);return((0,a.useEffect)(()=>{if(!e)return;let t=async()=>{try{let t=await (0,c.zS)(e.uid);r(t)}catch(e){console.error("Error getting message unread count:",e)}};t();let s=(0,c.KB)(e.uid,e=>{r(e.reduce((e,t)=>e+t.unreadCount,0))}),a=setInterval(t,12e4);return()=>{s(),clearInterval(a)}},[e]),(0,a.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),e)?(0,s.jsxs)("div",{className:m().container,ref:u,children:[(0,s.jsx)(o(),{href:"/messages",children:(0,s.jsxs)("button",{className:m().button,onClick:()=>{d(!n)},"aria-label":"Messages",children:[(0,s.jsx)("svg",{className:m().icon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,s.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"})}),t>0&&(0,s.jsx)("span",{className:m().badge,children:t})]})}),n&&(0,s.jsxs)("div",{className:m().dropdown,children:[(0,s.jsxs)("div",{className:m().header,children:[(0,s.jsx)("h3",{children:"Messages"}),(0,s.jsx)(o(),{href:"/messages",className:m().viewAll,children:"View All"})]}),(0,s.jsx)("div",{className:m().content,children:0===t?(0,s.jsx)("div",{className:m().empty,children:"No new messages"}):(0,s.jsxs)("div",{className:m().messageInfo,children:[(0,s.jsxs)("p",{className:m().message,children:["You have ",t," unread message",1!==t?"s":""]}),(0,s.jsx)(o(),{href:"/messages",className:m().viewLink,children:"Go to Messages"})]})})]})]}):null}},75934:e=>{e.exports={container:"MessageNotificationBell_container__5aDLA",button:"MessageNotificationBell_button__csZH1",icon:"MessageNotificationBell_icon__jDLI1",badge:"MessageNotificationBell_badge__XBtr6",dropdown:"MessageNotificationBell_dropdown__FrQoZ",header:"MessageNotificationBell_header__dUyx_",viewAll:"MessageNotificationBell_viewAll__rou73",content:"MessageNotificationBell_content__9BE73",empty:"MessageNotificationBell_empty__5dFf7",messageInfo:"MessageNotificationBell_messageInfo__dDLRK",message:"MessageNotificationBell_message__1p3sE",viewLink:"MessageNotificationBell_viewLink__w6OtV"}},89911:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var s=r(60687),a=r(76180),n=r.n(a),o=r(43210),i=r(85814),l=r.n(i),c=r(16189),d=r(5062),m=r.n(d),u=r(51437);let p=({isAuthenticated:e,handleLogout:t,toggleSidebar:r,isSidebarCollapsed:a})=>{let[i,d]=(0,o.useState)(!1),p=(0,o.useRef)(null),h=(0,o.useRef)(null);(0,c.useRouter)();let f=(0,c.usePathname)();(0,o.useEffect)(()=>{let e=e=>{p.current&&h.current&&!p.current.contains(e.target)&&!h.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let g=()=>{d(!1)};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("aside",{className:m()["left-sidebar"],children:(0,s.jsx)("nav",{className:m()["vertical-nav"],children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{href:"/",className:`${m()["nav-link"]} ${m()["nav-home"]} ${"/"===f?m().active:""}`,title:"Home",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/create-article",className:`${m()["nav-link"]} ${m()["nav-create"]} ${"/create-article"===f?m().active:""}`,title:"Create Article",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/my-thoughts",className:`${m()["nav-link"]} ${m()["nav-thoughts"]} ${"/my-thoughts"===f?m().active:""}`,title:"My Thoughts",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/trending",className:`${m()["nav-link"]} ${m()["nav-trending"]} ${"/trending"===f?m().active:""}`,title:"Trending",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/news",className:`${m()["nav-link"]} ${m()["nav-news"]} ${"/news"===f?m().active:""}`,title:"News",children:(0,s.jsx)("span",{className:m()["nav-icon"]})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(l(),{href:"/",className:`${m()["nav-link"]} ${m()["nav-home"]} ${"/"===f?m().active:""}`,title:"Home",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/explore",className:`${m()["nav-link"]} ${m()["nav-explore"]} ${"/explore"===f?m().active:""}`,title:"Explore",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"https://journalite.app/",className:`${m()["nav-link"]} ${m()["nav-learn"]}`,title:"Learn More",target:"_blank",rel:"noopener noreferrer",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/register",className:`${m()["nav-link"]} ${m()["nav-signin"]} ${"/register"===f?m().active:""}`,title:"Sign Up",children:(0,s.jsx)("span",{className:m()["nav-icon"]})}),(0,s.jsx)(l(),{href:"/login",className:`${m()["nav-link"]} ${m()["nav-login"]} ${"/login"===f?m().active:""}`,title:"Login",children:(0,s.jsx)("span",{className:m()["nav-icon"]})})]})})}),e&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{style:{position:"fixed",top:"30px",right:"90px",zIndex:9999,display:"flex",alignItems:"center",gap:"12px"},children:(0,s.jsxs)("div",{style:{width:"48px",height:"48px",borderRadius:"50%",background:"rgba(255, 255, 255, 0.06)",backdropFilter:"blur(16px) saturate(180%)",WebkitBackdropFilter:"blur(16px) saturate(180%)",border:"1px solid rgba(255, 255, 255, 0.1)",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",boxShadow:"0 4px 16px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},onMouseEnter:e=>{let t=e.target;t.style.transform="translateY(-1px)",t.style.background="rgba(255, 255, 255, 0.09)",t.style.boxShadow="0 8px 24px rgba(0, 0, 0, 0.12), inset 0 1px 0 rgba(255, 255, 255, 0.3)"},onMouseLeave:e=>{let t=e.target;t.style.transform="translateY(0)",t.style.background="rgba(255, 255, 255, 0.06)",t.style.boxShadow="0 4px 16px rgba(0, 0, 0, 0.08), inset 0 1px 0 rgba(255, 255, 255, 0.2)"},className:"jsx-6386f6f2656be473 message-bell-container",children:[(0,s.jsx)(n(),{id:"6386f6f2656be473",children:".message-bell-container.jsx-6386f6f2656be473 button,.message-bell-container.jsx-6386f6f2656be473 a{padding:0!important;background:transparent!important;-webkit-border-radius:0!important;-moz-border-radius:0!important;border-radius:0!important;position:relative!important}.message-bell-container.jsx-6386f6f2656be473 button:hover,.message-bell-container.jsx-6386f6f2656be473 a:hover{background:transparent!important}.message-bell-container.jsx-6386f6f2656be473 span{position:absolute!important;top:-6px!important;right:-6px!important;z-index:20!important;-webkit-transform:translate(50%,-50%)!important;-moz-transform:translate(50%,-50%)!important;-ms-transform:translate(50%,-50%)!important;-o-transform:translate(50%,-50%)!important;transform:translate(50%,-50%)!important}"}),(0,s.jsx)("div",{style:{transform:"scale(1.2)",display:"flex",alignItems:"center",justifyContent:"center"},className:"jsx-6386f6f2656be473",children:(0,s.jsx)(u.A,{})})]})}),(0,s.jsx)("button",{ref:h,className:m()["profile-button"],onClick:()=>{d(!i)},title:"Profile & Settings",children:(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M17.982 18.725A7.488 7.488 0 0 0 12 15.75a7.488 7.488 0 0 0-5.982 2.975m11.963 0a9 9 0 1 0-11.963 0m11.963 0A8.966 8.966 0 0 1 12 21a8.966 8.966 0 0 1-5.982-2.275M15 9.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,s.jsxs)("div",{ref:p,className:`${m()["profile-dropdown"]} ${i?m().open:""}`,children:[(0,s.jsxs)(l(),{href:"/my-profile",className:m()["profile-dropdown-item"],onClick:g,children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z",fill:"currentColor"})}),"My Profile"]}),(0,s.jsxs)(l(),{href:"/messages",className:m()["profile-dropdown-item"],onClick:g,children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.457-.133-.901-.467-1.226C3.93 16.178 3 14.189 3 12c0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})}),"Messages"]}),(0,s.jsxs)(l(),{href:"/my-thoughts/reflections",className:m()["profile-dropdown-item"],onClick:g,children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Reflections"]}),(0,s.jsxs)(l(),{href:"/settings",className:m()["profile-dropdown-item"],onClick:g,children:[(0,s.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,s.jsx)("path",{d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),(0,s.jsx)("path",{d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})]}),"Settings"]}),(0,s.jsxs)(l(),{href:"/notifications",className:m()["profile-dropdown-item"],onClick:g,children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Notifications"]}),(0,s.jsx)("div",{className:m()["profile-dropdown-separator"]}),(0,s.jsxs)("button",{onClick:()=>{g(),t()},className:m()["profile-dropdown-item"],children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m3-3 3-3m0 0-3-3m3 3H9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Log out"]})]})]})]})}}};