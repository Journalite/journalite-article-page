exports.id=686,exports.ids=[686],exports.modules={16189:(r,t,e)=>{"use strict";var o=e(65773);e.o(o,"useRouter")&&e.d(t,{useRouter:function(){return o.useRouter}}),e.o(o,"useSearchParams")&&e.d(t,{useSearchParams:function(){return o.useSearchParams}})},28163:(r,t,e)=>{"use strict";e.d(t,{Hs:()=>u,Ss:()=>n,bA:()=>c,fP:()=>l,fZ:()=>a,he:()=>s});var o=e(75535),i=e(43649);async function a(r,t,e,a,n,c){try{let t=i.j2.currentUser;if(!t||t.uid===r)return null;let s={userId:r,type:"comment",read:!1,sourceId:n,sourceType:"comment",message:`${t.displayName||"Someone"} commented on your article: "${c.substring(0,50)}${c.length>50?"...":""}"`,fromUser:{id:t.uid,name:t.displayName||"Anonymous"},createdAt:o.Dc.now(),articleSlug:e,articleTitle:a};return{id:(await (0,o.gS)((0,o.rJ)(i.db,"notifications"),s)).id,...s}}catch(r){return console.error("Error creating notification:",r),null}}async function n(r=!1){try{let t,e=i.j2.currentUser;if(!e)throw Error("User not authenticated");let a=(0,o.rJ)(i.db,"notifications");t=r?(0,o.P)(a,(0,o._M)("userId","==",e.uid),(0,o._M)("read","==",!1),(0,o.My)("createdAt","desc"),(0,o.AB)(100)):(0,o.P)(a,(0,o._M)("userId","==",e.uid),(0,o.My)("createdAt","desc"),(0,o.AB)(100));let n=await (0,o.GG)(t),c=[];return n.forEach(r=>{c.push({id:r.id,...r.data()})}),c}catch(r){throw console.error("Error fetching notifications:",r),r}}async function c(r){try{let t=i.j2.currentUser;if(!t)throw Error("User not authenticated");let e=(0,o.H9)(i.db,"notifications",r),a=await (0,o.x7)(e);if(!a.exists())throw Error("Notification not found");if(a.data().userId!==t.uid)throw Error("Unauthorized access to notification");return await (0,o.mZ)(e,{read:!0}),{success:!0}}catch(r){throw console.error("Error marking notification as read:",r),r}}async function s(){try{let r=i.j2.currentUser;if(!r)throw Error("User not authenticated");let t=(0,o.rJ)(i.db,"notifications"),e=(0,o.P)(t,(0,o._M)("userId","==",r.uid),(0,o._M)("read","==",!1)),a=await (0,o.GG)(e),n=a.docs.map(r=>(0,o.mZ)(r.ref,{read:!0}));return await Promise.all(n),{success:!0,count:a.size}}catch(r){throw console.error("Error marking all notifications as read:",r),r}}async function l(r){try{let t=i.j2.currentUser;if(!t)throw Error("User not authenticated");let e=(0,o.H9)(i.db,"notifications",r),a=await (0,o.x7)(e);if(!a.exists())throw Error("Notification not found");if(a.data().userId!==t.uid)throw Error("Unauthorized access to notification");return await (0,o.kd)(e),{success:!0}}catch(r){throw console.error("Error deleting notification:",r),r}}async function u(){try{let r=i.j2.currentUser;if(!r)return 0;let t=(0,o.rJ)(i.db,"notifications"),e=(0,o.P)(t,(0,o._M)("userId","==",r.uid),(0,o._M)("read","==",!1));return(await (0,o.GG)(e)).size}catch(r){return console.error("Error counting unread notifications:",r),0}}},77081:r=>{r.exports={articleFormContainer:"ArticleForm_articleFormContainer__Oamhm",articleFormHeader:"ArticleForm_articleFormHeader__lPvz4",articleFormTitle:"ArticleForm_articleFormTitle__GQZ6U",articleFormSubtitle:"ArticleForm_articleFormSubtitle__d0K2B",articleForm:"ArticleForm_articleForm__aPoqs",formGroup:"ArticleForm_formGroup__NG8OF",formLabel:"ArticleForm_formLabel__DP5Fz",optionalLabel:"ArticleForm_optionalLabel__C_B1S",formControl:"ArticleForm_formControl__mBao_",formTextarea:"ArticleForm_formTextarea__ZsknF",formActions:"ArticleForm_formActions__WqypQ",cancelButton:"ArticleForm_cancelButton__OAgVI",submitButton:"ArticleForm_submitButton__o9hsW",errorAlert:"ArticleForm_errorAlert__1DQ3x",errorIcon:"ArticleForm_errorIcon___YV5p",imagePreview:"ArticleForm_imagePreview__92eKB",tagsPreview:"ArticleForm_tagsPreview__48G_v",tag:"ArticleForm_tag__MTDKK",statusDropdown:"ArticleForm_statusDropdown__FfXJV",characterCount:"ArticleForm_characterCount__IqdJb",characterWarning:"ArticleForm_characterWarning__ZKaNu",formHint:"ArticleForm_formHint__h9Deh",loading:"ArticleForm_loading__EUkeX",loadingSpinner:"ArticleForm_loadingSpinner__iaWlv",spin:"ArticleForm_spin__reKcv"}},78335:()=>{},79440:(r,t,e)=>{"use strict";e.d(t,{BC:()=>m,GE:()=>n,N6:()=>l,Oe:()=>f,Tu:()=>w,a:()=>_,fz:()=>d,iZ:()=>u,l6:()=>s,tT:()=>h,zE:()=>c});var o=e(75535),i=e(43649),a=e(28163);async function n(r=!1){try{let t,e=(0,o.rJ)(i.db,"articles");t=(0,o.P)(e,(0,o.My)("createdAt","desc"));let a=await (0,o.GG)(t),n=[];return a.forEach(t=>{let e=t.data();(r||"drafts"!==e.status)&&(r||void 0===e.status||"published"===e.status)&&n.push({id:t.id,...e})}),n}catch(r){throw console.error("Error getting articles:",r),r}}async function c(r){try{let t=(0,o.H9)(i.db,"articles",r),e=await (0,o.x7)(t);if(e.exists())return{id:e.id,...e.data()};throw Error("Article not found")}catch(r){throw console.error("Error getting article:",r),r}}async function s(r){try{let t=(0,o.rJ)(i.db,"articles"),e=(0,o.P)(t,(0,o._M)("slug","==",r)),a=await (0,o.GG)(e);if(a.empty)throw Error("Article not found");let n=a.docs[0];return{id:n.id,...n.data()}}catch(r){throw console.error("Error getting article by slug:",r),r}}async function l(r){try{let t=i.j2.currentUser;if(!t)throw Error("You must be logged in to create an article");let e={title:r.title,body:r.body,slug:r.slug||r.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"),createdAt:o.Dc.now(),authorId:t.uid,authorName:t.displayName||"Anonymous",tags:r.tags||[],status:r.status||"published"};return r.coverImage&&(e.coverImage=r.coverImage),{id:(await (0,o.gS)((0,o.rJ)(i.db,"articles"),e)).id,...e}}catch(r){throw console.error("Error creating article:",r),r}}async function u(r,t){try{let e=i.j2.currentUser;if(!e)throw Error("You must be logged in to edit an article");let a=(0,o.H9)(i.db,"articles",r),n=await (0,o.x7)(a);if(!n.exists())throw Error("Article not found");if(n.data().authorId!==e.uid)throw Error("You can only edit your own articles");let c={};void 0!==t.title&&(c.title=t.title,void 0===t.slug&&(c.slug=t.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"))),void 0!==t.body&&(c.body=t.body),void 0!==t.tags&&(c.tags=t.tags),void 0!==t.status&&(c.status=t.status),void 0!==t.coverImage&&(c.coverImage=t.coverImage),void 0!==t.slug&&(c.slug=t.slug),await (0,o.mZ)(a,c);let s=await (0,o.x7)(a);return{id:s.id,...s.data()}}catch(r){throw console.error("Error updating article:",r),r}}async function d(r){try{let t=(0,o.rJ)(i.db,"articles",r,"comments"),e=(0,o.P)(t,(0,o.My)("createdAt","desc")),a=await (0,o.GG)(e),n=[];return a.forEach(r=>{let t=r.data();n.push({id:r.id,commentId:r.id,...t,replies:t.replies||[]})}),n}catch(r){throw console.error("Error getting comments:",r),r}}async function m(r,t){try{let e=i.j2.currentUser;if(!e)throw Error("You must be logged in to comment");let n={userId:e.uid,userName:e.displayName||e.email?.split("@")[0]||"Anonymous",content:t,createdAt:o.Dc.now(),likes:[],replies:[]},c=await (0,o.gS)((0,o.rJ)(i.db,"articles",r,"comments"),n),s=(0,o.H9)(i.db,"articles",r),l=await (0,o.x7)(s);if(l.exists()){let e=l.data();await (0,a.fZ)(e.authorId,r,e.slug||"",e.title||"Article",c.id,t)}return{id:c.id,commentId:c.id,...n}}catch(r){throw console.error("Error adding comment:",r),r}}async function f(r,t,e){try{let a=i.j2.currentUser;if(!a)throw Error("You must be logged in to reply");let n=(0,o.H9)(i.db,"articles",r,"comments",t);if(!(await (0,o.x7)(n)).exists())throw Error("Comment not found");let c={replyId:Math.random().toString(36).substring(2,15),userId:a.uid,userName:a.displayName||a.email?.split("@")[0]||"Anonymous",content:e,createdAt:o.Dc.now(),likes:[]};return await (0,o.mZ)(n,{replies:(0,o.hq)(c)}),c}catch(r){throw console.error("Error adding reply:",r),r}}async function h(r,t){try{let e=i.j2.currentUser;if(!e)throw Error("You must be logged in to like a comment");let a=(0,o.H9)(i.db,"articles",r,"comments",t),n=await (0,o.x7)(a);if(!n.exists())throw Error("Comment not found");let c=n.data(),s=e.uid;if((c.likes||[]).includes(s)){await (0,o.mZ)(a,{likes:(0,o.C3)(s)});let r=(await (0,o.x7)(a)).data();return{success:!0,action:"unliked",likes:r.likes,count:r.likes.length}}{await (0,o.mZ)(a,{likes:(0,o.hq)(s)});let r=(await (0,o.x7)(a)).data();return{success:!0,action:"liked",likes:r.likes,count:r.likes.length}}}catch(r){throw console.error("Error liking comment:",r),r}}async function w(r,t){try{let e=i.j2.currentUser;if(!e)throw Error("You must be logged in to delete a comment");let a=(0,o.H9)(i.db,"articles",r,"comments",t),n=await (0,o.x7)(a);if(!n.exists())throw Error("Comment not found");if(n.data().userId!==e.uid)throw Error("You can only delete your own comments");return await (0,o.kd)(a),{success:!0,message:"Comment deleted successfully"}}catch(r){throw console.error("Error deleting comment:",r),r}}async function _(r){try{let t=i.j2.currentUser;if(!t)throw Error("You must be logged in to delete an article");let e=await (0,o.x7)((0,o.H9)(i.db,"articles",r));if(!e.exists())throw Error("Article not found");if(e.data().authorId!==t.uid)throw Error("You can only delete your own articles");return await (0,o.kd)((0,o.H9)(i.db,"articles",r)),{success:!0,message:"Article deleted successfully"}}catch(r){throw console.error("Error deleting article:",r),r}}},96487:()=>{}};