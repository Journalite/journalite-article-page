exports.id=372,exports.ids=[372],exports.modules={79440:(e,t,r)=>{"use strict";r.d(t,{BC:()=>h,GE:()=>i,N6:()=>c,Oe:()=>m,Tu:()=>p,a:()=>f,fz:()=>u,getArticleById:()=>n,iZ:()=>d,l6:()=>o,tT:()=>g,zE:()=>x});var s=r(75535),l=r(43649),a=r(28163);async function i(e={}){let{limit:t,includeDrafts:r=!1}=e;try{let e=(0,s.collection)(l.db,"articles"),a=[];r||a.push((0,s.where)("status","==","published")),a.push((0,s.orderBy)("createdAt","desc")),t&&t>0&&a.push((0,s.limit)(t));let i=(0,s.query)(e,...a),n=await (0,s.getDocs)(i),o=[];return n.forEach(e=>{let t=e.data();o.push({id:e.id,...t})}),o}catch(e){throw console.error("Error getting articles:",e),e}}async function n(e){Date.now();try{let t=(0,s.doc)(l.db,"articles",e),r=await (0,s.getDoc)(t);if(!r.exists())return null;return{id:r.id,...r.data()}}catch(e){throw console.error("\uD83D\uDED1 Error getting article:",e),e}}async function o(e){let t=0;for(;t<3;){t++;try{let r=(0,s.collection)(l.db,"articles"),a=(0,s.query)(r,(0,s.where)("slug","==",e),(0,s.where)("status","==","published"),(0,s.limit)(1)),i=await (0,s.getDocs)(a);if(i.empty)if(3===t)break;else await new Promise(e=>setTimeout(e,1e3));else{let e=i.docs[0];return{id:e.id,...e.data()}}}catch(e){if(console.error("Error getting article by slug:",e),3===t)throw e}}return null}async function c(e){try{let t=l.j2.currentUser;if(!t)throw Error("You must be logged in to create an article");let r={title:e.title,body:e.body,slug:e.slug||e.title.toLowerCase().replace(/[\s\W-]+/g,"-").replace(/^-+|-+$/g,""),createdAt:s.Timestamp.now(),authorId:t.uid,authorName:t.displayName||t.email?.split("@")[0]||"Anonymous",tags:e.tags||[],status:e.status||"published",coverImage:e.coverImage||null,likes:[],excerpt:e.excerpt||"",viewCount:0,reposts:[],comments:[]};return{id:(await (0,s.addDoc)((0,s.collection)(l.db,"articles"),r)).id,...r}}catch(e){throw console.error("Error creating article:",e),e}}async function d(e,t){try{let r=l.j2.currentUser;if(!r)throw Error("You must be logged in to edit an article");let a=(0,s.doc)(l.db,"articles",e),i=await (0,s.getDoc)(a);if(!i.exists())throw Error("Article not found");if(i.data().authorId!==r.uid)throw Error("You can only edit your own articles");let n={...t};t.title&&(n.slug=t.title.toLowerCase().replace(/[\s\W-]+/g,"-").replace(/^-+|-+$/g,"")),n.updatedAt=s.Timestamp.now(),await (0,s.updateDoc)(a,n);let o=await (0,s.getDoc)(a);if(!o.exists())return{id:e,...n,createdAt:s.Timestamp.now(),updatedAt:s.Timestamp.now()};{let e=o.data();return{id:o.id,...e}}}catch(e){throw console.error("Error updating article:",e),e}}async function u(e){try{let t=(0,s.collection)(l.db,"articles",e,"comments"),r=(0,s.query)(t,(0,s.orderBy)("createdAt","desc")),a=await (0,s.getDocs)(r),i=[];return a.forEach(e=>{let t=e.data();i.push({id:e.id,commentId:e.id,...t,replies:t.replies||[]})}),i}catch(e){throw console.error("Error getting comments:",e),e}}async function h(e,t){try{let r=l.j2.currentUser;if(!r)throw Error("You must be logged in to comment");let i={userId:r.uid,userName:r.displayName||r.email?.split("@")[0]||"Anonymous",content:t,createdAt:s.Timestamp.now(),likes:[],replies:[]},o=await (0,s.addDoc)((0,s.collection)(l.db,"articles",e,"comments"),i),c=await n(e);return c&&c.authorId!==r.uid&&await (0,a.fZ)(c.authorId,e,c.slug||"",c.title||"Article",o.id,t),{id:o.id,commentId:o.id,...i}}catch(e){throw console.error("Error adding comment:",e),e}}async function m(e,t,r){try{let i=l.j2.currentUser;if(!i)throw Error("You must be logged in to reply");let o=(0,s.doc)(l.db,"articles",e,"comments",t),c=await (0,s.getDoc)(o);if(!c.exists())throw Error("Comment not found");let d={replyId:Math.random().toString(36).substring(2,15),userId:i.uid,userName:i.displayName||i.email?.split("@")[0]||"Anonymous",content:r,createdAt:s.Timestamp.now(),likes:[]};await (0,s.updateDoc)(o,{replies:(0,s.arrayUnion)(d)});let u=c.data();if(u.userId!==i.uid){let t=await n(e);await (0,a.fZ)(u.userId,e,t?.slug||"",t?.title||"Article",d.replyId,r)}return d}catch(e){throw console.error("Error adding reply:",e),e}}async function g(e,t){try{let r=l.j2.currentUser;if(!r)throw Error("You must be logged in to like a comment");let a=(0,s.doc)(l.db,"articles",e,"comments",t),i=await (0,s.getDoc)(a);if(!i.exists())throw Error("Comment not found");let n=i.data(),o=r.uid,c=(n.likes||[]).includes(o);await (0,s.updateDoc)(a,{likes:c?(0,s.arrayRemove)(o):(0,s.arrayUnion)(o)});let d=(await (0,s.getDoc)(a)).data();return{success:!0,action:c?"unliked":"liked",likes:d.likes,count:d.likes.length}}catch(e){throw console.error("Error liking comment:",e),e}}async function p(e,t){try{let r=l.j2.currentUser;if(!r)throw Error("You must be logged in to delete a comment");let a=(0,s.doc)(l.db,"articles",e,"comments",t),i=await (0,s.getDoc)(a);if(!i.exists())throw Error("Comment not found");if(i.data().userId!==r.uid)throw Error("You can only delete your own comments");return await (0,s.deleteDoc)(a),{success:!0,message:"Comment deleted successfully"}}catch(e){throw console.error("Error deleting comment:",e),e}}async function f(e){try{let t=l.j2.currentUser;if(!t)throw Error("You must be logged in to delete an article");let r=(0,s.doc)(l.db,"articles",e),a=await (0,s.getDoc)(r);if(!a.exists())throw Error("Article not found");if(a.data().authorId!==t.uid)throw Error("You can only delete your own articles");return await (0,s.deleteDoc)(r),{success:!0,message:"Article deleted successfully"}}catch(e){throw console.error("Error deleting article:",e),e}}async function x(e,t={}){let{limit:r}=t;try{let t=(0,s.collection)(l.db,"articles"),a=[(0,s.where)("tags","array-contains",e),(0,s.where)("status","==","published"),(0,s.orderBy)("createdAt","desc")];r&&r>0&&a.push((0,s.limit)(r));let i=(0,s.query)(t,...a),n=await (0,s.getDocs)(i),o=[];return n.forEach(e=>{o.push({id:e.id,...e.data()})}),o}catch(e){throw console.error("Error getting articles by tag:",e),e}}},85372:(e,t,r)=>{"use strict";r.d(t,{A:()=>H});var s=r(60687),l=r(43210),a=r.n(l),i=r(16189),n=r(88645),o=r(79440),c=r(43649);r(53764);var d=r(35857);r(98031);var u=r(19954),h=r(67800),m=r(51040);r(31224),r(90021),r(23684);var g=r(81553);let p=new g.Sj({nodes:{doc:{content:"block+"},text:{group:"inline"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},heading:{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>[`h${e.attrs.level}`,0]},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt"),width:e.getAttribute("width"),height:e.getAttribute("height")})}],toDOM(e){let{src:t,alt:r,title:s,width:l,height:a}=e.attrs,i={src:t};return null!=r&&(i.alt=r),null!=s&&(i.title=s),null!=l&&(i.width=l),null!=a&&(i.height=a),["img",i]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,attrs:{language:{default:"javascript"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs(e){let t=e.getAttribute("data-language");if(t)return{language:t};let r=e.querySelector("code");if(r){let e=(r.className||"").match(/language-(\w+)/);if(e)return{language:e[1]}}return{language:"javascript"}},getContent(e,t){let r=e.querySelector("code");if(r){let e=r.textContent||r.innerText||"";return e?[t.text(e)]:[]}return[]}}],toDOM:e=>["pre",{"data-language":e.attrs.language},["code",{class:`language-${e.attrs.language}`},0]]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]},bullet_list:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1})}],toDOM:e=>1==e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]},list_item:{content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM:()=>["li",0],defining:!0}},marks:{strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong",0]},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]},code:{parseDOM:[{tag:"code"}],toDOM:()=>["code",0]},link:{attrs:{href:{},title:{default:null},target:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title"),target:e.getAttribute("target")})}],toDOM(e){let{href:t,title:r,target:s}=e.attrs,l={href:t};return null!=r&&(l.title=r),null!=s&&(l.target=s),["a",l,0]}}}}),f=(e,t)=>(r,s,l)=>{let a=!1;(0,h.T2)(t)(r,s,l)&&(r=l.state,a=!0);let i=e(r,s,l);return a||i},{heading:x,paragraph:b,list_item:v,blockquote:y}=p.nodes,w=e=>f((0,u.y_)(x,{level:e}),v),j=()=>f((0,u.y_)(b),v),N=(e,t,r)=>{let{from:s,to:l}=e.selection,a=!1;return(e.doc.nodesBetween(s,l,e=>e.type!==y||(a=!0,!1)),a)?!!(0,h.T2)(v)(e,t)||(0,u.yY)(e,t):((0,h.T2)(v)(e,t)&&(e=r.state),(0,u.Im)(y)(e,t,r))};new d.k_({key:new d.hs("exitHeading"),props:{handleKeyDown(e,t){if("Enter"!==t.key||t.shiftKey)return!1;let{state:r,dispatch:s}=e,{$from:l,empty:a}=r.selection,{heading:i,paragraph:n}=p.nodes;return!!a&&l.parent.type===i&&l.parentOffset===l.parent.content.size&&(t.preventDefault(),(0,u.y_)(n)(r,s,e))}}}),r(46997),r(57894),r(8990),r(68960),r(36014),r(71454),r(25865),r(92623),r(25119),r(29173),r(65848),r(88224),r(35630),r(14321),r(48541),r(83075),r(29731),r(34425),r(61707),r(11566),r(86908);var k=r(85540),C=r.n(k);let E=a().forwardRef(({articleId:e,initialContent:t="",onChange:r,placeholder:i="Tell your story...",className:n=""},o)=>{let c=(0,l.useRef)(null),d=(0,l.useRef)(null),f=(0,l.useRef)(r),[x,b]=(0,l.useState)(!1);f.current=r;let v=(0,l.useCallback)(e=>{if(!d.current)return;let{state:t,dispatch:r}=d.current,{selection:s}=t,l=p.text(e);r(t.tr.replaceSelectionWith(l)),d.current.focus()},[]);a().useImperativeHandle(o,()=>({insertText:v,focus:()=>d.current?.focus()}),[v]),(0,l.useEffect)(()=>{},[]),(0,l.useEffect)(()=>{if(d.current&&x&&t)try{let e=function(e){if(!e||""===e.trim())return p.node("doc",null,[p.node("paragraph")]);let t=document.createElement("div");return t.innerHTML=e,g.S4.fromSchema(p).parse(t)}(t),r=function(e){let t=document.createElement("div");return t.appendChild(g.ZF.fromSchema(p).serializeFragment(e.content)),t.innerHTML}(d.current.state.doc);if(t!==r){let t=d.current.state.tr.replaceWith(0,d.current.state.doc.content.size,e.content);d.current.dispatch(t)}}catch(e){console.error("Editor: Failed to update content:",e)}},[t,x]);let y=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;(0,u.wh)(p.marks.strong)(e,t)&&d.current.focus()},[]),k=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;(0,u.wh)(p.marks.em)(e,t)&&d.current.focus()},[]),E=(0,l.useCallback)(e=>{if(!d.current)return;let{state:t,dispatch:r}=d.current;w(e)(t,r,d.current)&&d.current.focus()},[]);(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;j()(e,t,d.current)&&d.current.focus()},[]);let _=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;N(e,t,d.current)&&d.current.focus()},[]),D=(0,l.useCallback)(()=>{if(!d.current)return;let e=prompt("Enter programming language (e.g., javascript, python, css):","javascript");if(!e)return;let{state:t,dispatch:r}=d.current,{from:s,to:l}=t.selection,a=p.nodes.code_block.create({language:e.toLowerCase()}),i=t.tr.replaceRangeWith(s,l,a);r&&(r(i),d.current.focus())},[]),M=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current,{$from:r,$to:s}=e.selection;try{let l=p.nodes.list_item.create(null,p.nodes.paragraph.create(null,r.parent.content)),a=p.nodes.bullet_list.create(null,l),i=e.tr.replaceWith(r.start(),s.end(),a);t(i),d.current.focus()}catch(r){(0,h.Sd)(p.nodes.bullet_list)(e,t)&&d.current.focus()}},[]),$=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current,{$from:r,$to:s}=e.selection;try{let l=p.nodes.list_item.create(null,p.nodes.paragraph.create(null,r.parent.content)),a=p.nodes.ordered_list.create(null,l),i=e.tr.replaceWith(r.start(),s.end(),a);t(i),d.current.focus()}catch(r){(0,h.Sd)(p.nodes.ordered_list)(e,t)&&d.current.focus()}},[]),A=(0,l.useCallback)(()=>{let e=prompt("Enter image URL:");if(e&&d.current){let{state:t,dispatch:r}=d.current,s=p.nodes.image.create({src:e,alt:""});r(t.tr.replaceSelectionWith(s)),d.current.focus()}},[]),H=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;(0,m.tN)(e,t),d.current.focus()},[]),S=(0,l.useCallback)(()=>{if(!d.current)return;let{state:e,dispatch:t}=d.current;(0,m.ZS)(e,t),d.current.focus()},[]),z=(0,l.useCallback)(e=>{if(!d.current)return!1;let{from:t,$from:r,to:s,empty:l}=d.current.state.selection;return l?e.isInSet(d.current.state.storedMarks||r.marks()):d.current.state.doc.rangeHasMark(t,s,e)},[]),I=(0,l.useCallback)((e,t={})=>{if(!d.current)return!1;let{from:r,to:s}=d.current.state.selection,l=!0;return d.current.state.doc.nodesBetween(r,s,r=>!r.isTextblock||!!r.hasMarkup(e,t)||(l=!1,!1)),l},[]),B=(0,l.useCallback)(()=>{if(!d.current)return!1;let{from:e,to:t}=d.current.state.selection,r=!1;return d.current.state.doc.nodesBetween(e,t,e=>e.type!==p.nodes.blockquote||(r=!0,!1)),r},[]);return(0,s.jsxs)("div",{className:`${C().editor} ${"seamless-editor"===n?C().seamlessEditor:""}`,style:"seamless-editor"===n?{}:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[x&&(0,s.jsx)("div",{className:C().modernToolbar,style:"seamless-editor"===n?{}:{opacity:1,visibility:"visible",position:"relative",top:"auto",left:"auto",transform:"none",marginBottom:"20px"},children:(0,s.jsxs)("div",{className:C().toolbarContainer,children:[(0,s.jsxs)("div",{className:C().formatGroup,children:[(0,s.jsx)("button",{className:`${C().toolBtn} ${z(p.marks.strong)?C().active:""}`,onClick:y,title:"Bold (⌘B)","aria-label":"Bold",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M13.5 15.5H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM10 6.5h3c.55 0 1 .45 1 1s-.45 1-1 1h-3v-2zm5.6 4.5c.75-.9 1.2-2.05 1.2-3.3 0-2.76-2.24-5-5-5H6.5C5.67 2.7 5 3.37 5 4.2v15.6c0 .83.67 1.5 1.5 1.5h8.5c3.31 0 6-2.69 6-6 0-2.5-1.49-4.65-3.4-5.3z"})})}),(0,s.jsx)("button",{className:`${C().toolBtn} ${z(p.marks.em)?C().active:""}`,onClick:k,title:"Italic (⌘I)","aria-label":"Italic",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"})})})]}),(0,s.jsx)("div",{className:C().divider}),(0,s.jsxs)("div",{className:C().formatGroup,children:[(0,s.jsx)("button",{className:`${C().toolBtn} ${I(p.nodes.heading,{level:1})?C().active:""}`,onClick:()=>E(1),title:"Large Heading (⌘⇧1)","aria-label":"Heading 1",children:(0,s.jsx)("span",{className:C().headingIcon,children:"H1"})}),(0,s.jsx)("button",{className:`${C().toolBtn} ${I(p.nodes.heading,{level:2})?C().active:""}`,onClick:()=>E(2),title:"Medium Heading (⌘⇧2)","aria-label":"Heading 2",children:(0,s.jsx)("span",{className:C().headingIcon,children:"H2"})}),(0,s.jsx)("button",{className:`${C().toolBtn} ${I(p.nodes.heading,{level:3})?C().active:""}`,onClick:()=>E(3),title:"Small Heading (⌘⇧3)","aria-label":"Heading 3",children:(0,s.jsx)("span",{className:C().headingIcon,children:"H3"})})]}),(0,s.jsx)("div",{className:C().divider}),(0,s.jsxs)("div",{className:C().formatGroup,children:[(0,s.jsx)("button",{className:C().toolBtn,onClick:M,title:"Bullet List","aria-label":"Bullet list",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})})}),(0,s.jsx)("button",{className:C().toolBtn,onClick:$,title:"Numbered List","aria-label":"Numbered list",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),(0,s.jsx)("button",{className:`${C().toolBtn} ${B()?C().active:""}`,onClick:_,title:"Quote (⌘>)","aria-label":"Quote",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"})})})]}),(0,s.jsx)("div",{className:C().divider}),(0,s.jsxs)("div",{className:C().formatGroup,children:[(0,s.jsx)("button",{className:C().toolBtn,onClick:A,title:"Add Image","aria-label":"Insert image",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"})})}),(0,s.jsx)("button",{className:`${C().toolBtn} ${I(p.nodes.code_block)?C().active:""}`,onClick:D,title:"Code Block","aria-label":"Code block",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0L19.2 12l-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})})})]}),(0,s.jsx)("div",{className:C().divider}),(0,s.jsxs)("div",{className:C().formatGroup,children:[(0,s.jsx)("button",{className:C().toolBtn,onClick:H,title:"Undo (⌘Z)","aria-label":"Undo",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"})})}),(0,s.jsx)("button",{className:C().toolBtn,onClick:S,title:"Redo (⌘Y)","aria-label":"Redo",children:(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"})})})]})]})}),!x&&(0,s.jsxs)("div",{className:C().loading,children:[(0,s.jsx)("div",{className:C().loadingSpinner}),(0,s.jsx)("span",{children:"Loading editor..."})]}),(0,s.jsx)("div",{ref:c,className:C().prosemirrorEditor,"aria-label":"Rich text editor",style:{minHeight:"seamless-editor"===n?"500px":"400px",opacity:x?1:.3,..."seamless-editor"===n?{background:"transparent",border:"none",boxShadow:"none",padding:0,margin:0,fontSize:"18px",lineHeight:"1.6",color:"#1f2937"}:{}}})]})});E.displayName="Editor";var _=r(45306),D=r(41120),M=r(5062),$=r.n(M);let A=({onInsert:e})=>{let[t,r]=(0,l.useState)(!1),[a,i]=(0,l.useState)([]),[n,o]=(0,l.useState)([]),[c,d]=(0,l.useState)(!1),[u,h]=(0,l.useState)("inspirations"),m=async()=>{d(!0);try{let[e,t]=await Promise.all([(0,_.Aq)(),(0,_.Gy)()]);i(e),o(t)}catch(e){console.error("Error loading inspiration data:",e)}finally{d(!1)}},g=t=>{e&&e(t),r(!1)},p=e=>({emotions:"Explore a moment when your emotions surprised you...","decision-making":"Write about a decision that changed your perspective...","personal experience":"Reflect on an experience that shaped who you are today...",questioning:"What questions have been on your mind lately?","unexpected insights":"Share something that recently surprised you...",perspectives:"How has your viewpoint on something important changed?","dialogue with authors":"What would you say to an author whose work moved you?",connections:"Write about connections you've discovered between different ideas..."})[e]||`Write about ${e}...`;return t?(0,s.jsx)("div",{className:"fixed bottom-8 right-8 z-40 w-96",children:(0,s.jsxs)("div",{className:`${$()["glass-modal"]} max-h-96 overflow-hidden`,children:[(0,s.jsx)("div",{className:$()["glass-highlight"]}),(0,s.jsxs)("div",{className:$()["glass-content"],children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-white/20",children:[(0,s.jsxs)("h3",{className:"text-lg font-bold text-stone-800 flex items-center gap-2 font-serif",children:[(0,s.jsx)(D.TG,{size:18,color:"#f59e0b"}),"Your Reflection Insights"]}),(0,s.jsx)("button",{onClick:()=>r(!1),className:"text-stone-500 hover:text-stone-700 text-xl font-bold leading-none",children:"\xd7"})]}),(0,s.jsxs)("div",{className:"flex p-4 gap-2",children:[(0,s.jsxs)("button",{className:`${$()["glass-tag"]} flex-1 text-center py-2 text-sm font-semibold transition-all ${"inspirations"===u?"bg-blue-500/20 text-blue-700 border-blue-300/30":"hover:bg-white/20"}`,onClick:()=>h("inspirations"),children:["Recent Thoughts (",a.length,")"]}),(0,s.jsxs)("button",{className:`${$()["glass-tag"]} flex-1 text-center py-2 text-sm font-semibold transition-all ${"themes"===u?"bg-blue-500/20 text-blue-700 border-blue-300/30":"hover:bg-white/20"}`,onClick:()=>h("themes"),children:["Writing Themes (",n.length,")"]})]}),(0,s.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:c?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,s.jsx)("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,s.jsx)("p",{className:"text-stone-600",children:"Loading your insights..."})]}):"inspirations"===u?(0,s.jsx)("div",{children:0===a.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-stone-500 mb-2",children:[(0,s.jsx)(D.d3,{size:16,color:"#6b7280"}),(0,s.jsx)("p",{className:"font-semibold",children:"No reflections yet!"})]}),(0,s.jsx)("p",{className:"text-sm text-stone-500",children:"Start reading articles and reflecting to build your inspiration library."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm text-stone-600 mb-4 font-semibold",children:"Your past reflections that might spark new ideas:"}),(0,s.jsx)("div",{className:"space-y-3",children:a.map((e,t)=>(0,s.jsxs)("div",{className:`${$()["glass-card"]} p-4`,children:[(0,s.jsx)("div",{className:$()["glass-card-highlight"]}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsxs)("p",{className:"text-sm text-stone-700 italic mb-2",children:['"',e.response,'"']}),e.articleTitle&&(0,s.jsxs)("p",{className:"text-xs text-stone-500 mb-3",children:["From: ",e.articleTitle]}),(0,s.jsx)("button",{onClick:()=>{let t=e.articleTitle?` (inspired by "${e.articleTitle}")`:"";g(`"${e.response}"${t} - This reminds me of...`)},className:`${$()["glass-button"]} ${$()["glass-button-primary"]} text-xs px-3 py-1 w-full`,children:"Use as starting point"})]})]},t))})]})}):(0,s.jsx)("div",{children:0===n.length?(0,s.jsxs)("div",{className:"text-center py-8",children:[(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-stone-500 mb-2",children:[(0,s.jsx)(D.v1,{size:16,color:"#6b7280"}),(0,s.jsx)("p",{className:"font-semibold",children:"No themes identified yet!"})]}),(0,s.jsx)("p",{className:"text-sm text-stone-500",children:"Keep reflecting on articles to discover your writing themes."})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:"text-sm text-stone-600 mb-4 font-semibold",children:"Writing prompts based on your reflection patterns:"}),(0,s.jsx)("div",{className:"space-y-3",children:n.map((e,t)=>(0,s.jsxs)("div",{className:`${$()["glass-card"]} p-4`,children:[(0,s.jsx)("div",{className:$()["glass-card-highlight"]}),(0,s.jsxs)("div",{className:"relative z-10",children:[(0,s.jsx)("div",{className:`${$()["glass-tag"]} inline-block mb-2 text-xs`,children:e}),(0,s.jsx)("p",{className:"text-sm text-stone-700 mb-3",children:p(e)}),(0,s.jsx)("button",{onClick:()=>g(p(e)),className:`${$()["glass-button"]} ${$()["glass-button-primary"]} text-xs px-3 py-1 w-full`,children:"Start writing"})]})]},t))})]})})}),(0,s.jsx)("div",{className:"p-4 border-t border-white/20",children:(0,s.jsx)("button",{onClick:m,className:`${$()["glass-button"]} text-sm px-4 py-2 w-full disabled:opacity-50`,disabled:c,children:"\uD83D\uDD04 Refresh insights"})})]})]})}):(0,s.jsx)("div",{className:"fixed bottom-8 right-8 z-40",children:(0,s.jsxs)("button",{onClick:()=>{t||m(),r(!t)},className:`${$()["glass-button"]} ${$()["glass-button-primary"]} flex items-center gap-2 px-6 py-4 text-sm font-semibold`,title:"Get inspiration from your reflections",children:[(0,s.jsx)(D.Y_,{size:16,color:"currentColor"}),"Inspiration"]})})},H=({articleId:e,onUpdateComplete:t,backToArticleAction:r,editingTitle:a})=>{let d=(0,i.useRouter)(),[u,h]=(0,l.useState)(""),[m,g]=(0,l.useState)(""),[p,f]=(0,l.useState)([]),[x,b]=(0,l.useState)(""),[v,y]=(0,l.useState)(!1),[w,j]=(0,l.useState)(!1),[N,k]=(0,l.useState)(!1),[C,_]=(0,l.useState)(""),[D,M]=(0,l.useState)(!!e),[H,S]=(0,l.useState)(null),[z,I]=(0,l.useState)(""),B=(0,l.useRef)(null),T=(0,l.useRef)(null),L=(0,l.useRef)(null),O=(0,l.useCallback)(()=>{B.current&&(B.current.style.height="auto",B.current.style.height=`${B.current.scrollHeight}px`,!u&&B.current&&B.current.focus())},[u]);(0,l.useEffect)(()=>{let e=c.j2.onAuthStateChanged(e=>{S(e),e||d.push("/login?redirect=compose")});return()=>e()},[d]),(0,l.useEffect)(()=>{e&&H?(async()=>{try{M(!0);let t=await (0,o.getArticleById)(e);if(!t){_("Article not found"),d.push("/");return}if(t.authorId!==H.uid){_("You can only edit your own articles"),d.push("/");return}h(t.title);let r=t.body.replace(/data-[\w-]+="[^"]*"/g,"");g(r),f(t.tags||[]),b(t.coverImage||"")}catch(e){console.error("Error loading article:",e),_("Failed to load article")}finally{M(!1)}})():e||M(!1)},[e,H,d]),(0,l.useEffect)(()=>{O()},[u,O]),(0,l.useEffect)(()=>{let e;return H&&u.trim()&&m.trim()&&!w&&!v&&(e=setTimeout(()=>{q("drafts")},3e4)),()=>{e&&clearTimeout(e)}},[H,u,m,w,v]);let R=(0,l.useCallback)((e,t)=>{g(t=>e!==t?(N&&k(!1),e):t)},[N]),W=()=>{let e=z.trim().toLowerCase();e&&!p.includes(e)&&p.length<5&&(f([...p,e]),I(""))},U=e=>{f(p.filter(t=>t!==e))},Y=e=>{b(e.target.value)},q=async(r="drafts")=>{if(!H)return void _("You must be logged in to save articles");if(!u.trim())return void _("Title is required");try{_(""),j(!0);let s=u.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),l={title:u.trim(),body:m,tags:p,coverImage:x,status:r,authorId:H.uid,authorName:H.displayName||H.email||"Anonymous",slug:s};if(e)try{let r=await (0,o.iZ)(e,l);k(!0),t?t(r):setTimeout(()=>{d.push(`/articles/?slug=${s}`)},1e3)}catch(e){console.error("Error updating article:",e),_("Failed to update article. Please try again."),k(!1)}else await (0,o.N6)(l),"published"===r?d.push(`/articles/?slug=${s}`):d.push("/dashboard")}catch(e){console.error("Error saving article:",e),_("Failed to save article. Please try again.")}finally{j(!1),y(!1)}},G=async()=>{if(!m.trim())return void _("Content is required");y(!0),await q("published")},F=async()=>{await q("drafts")};return D?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"linear-gradient(135deg, #f0f9ff 0%, #f7fafc 20%, #fef7ff 40%, #f0fdfa 60%, #fff7ed 80%, #f3f4f6 100%)",backgroundAttachment:"fixed"},children:(0,s.jsxs)("div",{className:$()["glass-loading"],children:[(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-stone-600 text-lg",children:"Loading your article..."})]})}):(0,s.jsxs)("div",{className:`${$()["glass-container"]} min-h-screen w-full`,style:{background:"linear-gradient(135deg, #f0f9ff 0%, #f7fafc 20%, #fef7ff 40%, #f0fdfa 60%, #fff7ed 80%, #f3f4f6 100%)",backgroundAttachment:"fixed",position:"relative",borderRadius:"0px",border:"none"},children:[(0,s.jsx)("div",{className:$()["glass-highlight"]}),(0,s.jsxs)("header",{className:`${$()["glass-container"]} fixed top-6 left-6 right-6 z-50 max-w-6xl mx-auto`,style:{backdropFilter:"blur(20px) saturate(180%)"},children:[(0,s.jsx)("div",{className:$()["glass-highlight"]}),(0,s.jsxs)("div",{className:`${$()["glass-content"]} flex items-center justify-between p-4`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[r?(0,s.jsxs)("button",{onClick:r,className:`${$()["glass-button"]} flex items-center gap-2 px-3 py-2 text-sm font-medium text-stone-700 hover:text-stone-900 transition-colors`,children:[(0,s.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,s.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"})}),"Back to Article"]}):(0,s.jsx)("div",{className:"text-xl font-bold text-stone-800 font-serif",children:"Journalite"}),(0,s.jsx)("div",{className:"text-stone-500 text-sm",children:e?a?`Editing: ${a}`:"Editing":"Writing"}),N&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[(0,s.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:(0,s.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),"Saved"]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("button",{className:`${$()["glass-button"]} px-4 py-2 text-sm font-semibold disabled:opacity-50`,onClick:F,disabled:w||v,children:w?"Saving...":"Save Draft"}),(0,s.jsx)("button",{className:`${$()["glass-button"]} ${$()["glass-button-primary"]} px-4 py-2 text-sm font-semibold disabled:opacity-50`,onClick:G,disabled:w||v||!u.trim()||!m.trim(),children:v?"Publishing...":e?"Update":"Publish"})]})]})]}),(0,s.jsxs)("div",{className:`${$()["glass-content"]} pt-32 pb-16 min-h-screen w-full max-w-4xl mx-auto`,style:{paddingLeft:"64px",paddingRight:"64px"},children:[(0,s.jsx)("textarea",{ref:B,value:u,onChange:e=>{h(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},placeholder:"Title",rows:1,className:"w-full bg-transparent border-none outline-none resize-none overflow-hidden text-5xl font-bold text-stone-800 placeholder-stone-400 font-serif leading-tight mb-8 focus:outline-none",style:{minHeight:"60px"}}),(x||u.length>10)&&(0,s.jsxs)("div",{className:"mb-8",children:[!x&&(0,s.jsx)("input",{type:"text",value:x,onChange:Y,placeholder:"Add a cover image URL...",className:"w-full bg-transparent border-none outline-none text-stone-600 placeholder-stone-400 py-2 border-b border-stone-200 focus:border-stone-400 transition-colors"}),x&&(0,s.jsxs)("div",{className:"relative group",children:[(0,s.jsx)("img",{src:x,alt:"Cover",className:"w-full h-64 object-cover rounded-2xl mb-4"}),(0,s.jsx)("input",{type:"text",value:x,onChange:Y,placeholder:"Cover image URL...",className:"w-full bg-white/80 backdrop-blur border border-stone-200 outline-none text-stone-600 placeholder-stone-400 py-2 px-4 rounded-lg focus:border-stone-400 transition-colors"})]})]}),(p.length>0||u.length>5)&&(0,s.jsxs)("div",{className:"mb-8 flex flex-wrap gap-2 items-center",children:[p.map(e=>(0,s.jsxs)("div",{className:"px-3 py-1 bg-blue-100/60 backdrop-blur text-blue-700 rounded-full text-sm font-medium flex items-center gap-2",children:[e,(0,s.jsx)("button",{className:"text-blue-600 hover:text-blue-800 font-bold text-base leading-none",onClick:()=>U(e),"aria-label":`Remove ${e} tag`,children:"\xd7"})]},e)),p.length<5&&(0,s.jsx)("input",{ref:T,type:"text",value:z,onChange:e=>{I(e.target.value)},onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),W())},onBlur:W,placeholder:0===p.length?"Add tags...":"Add tag...",className:"bg-transparent border-none outline-none text-stone-600 placeholder-stone-400 min-w-24 py-1"})]}),C&&(0,s.jsx)("div",{className:"mb-6 p-4 bg-red-50/80 border border-red-200 rounded-xl text-red-700 text-sm",children:C}),(0,s.jsx)("div",{className:"min-h-[500px] w-full",style:{background:"transparent"},children:(0,s.jsx)(E,{ref:L,...{articleId:e||(0,n.A)(),initialContent:m,onChange:R,placeholder:"Write your story...",className:"seamless-editor"}})})]}),(0,s.jsx)(A,{onInsert:e=>{L.current&&L.current.insertText?L.current.insertText("\n\n"+e+"\n\n"):g(t=>t.trim()?t+"\n\n<p>"+e+"</p>":"<p>"+e+"</p>"),setTimeout(()=>{L.current&&L.current.focus&&L.current.focus()},100)}})]})}},85540:e=>{e.exports={editorContainer:"Editor_editorContainer__AxL3W",editorContent:"Editor_editorContent__Hto0I",prosemirrorEditor:"Editor_prosemirrorEditor__jSRn5",editor:"Editor_editor__ys4HH",seamlessEditor:"Editor_seamlessEditor__2leHe",modernToolbar:"Editor_modernToolbar__VDG5b",loading:"Editor_loading___nwXA",loadingSpinner:"Editor_loadingSpinner__JMIXQ",spin:"Editor_spin__5Ufeq",toolbarContainer:"Editor_toolbarContainer__rZaHf",formatGroup:"Editor_formatGroup__OhMWy",divider:"Editor_divider__pHi4V",toolBtn:"Editor_toolBtn__LEamn",active:"Editor_active__UGSnI",headingIcon:"Editor_headingIcon__HKD4e",ProseMirror:"Editor_ProseMirror__DHY3Q",slideInFromTop:"Editor_slideInFromTop__ADbMI"}}};