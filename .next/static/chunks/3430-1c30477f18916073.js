(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3430],{3430:(e,t,r)=>{"use strict";r.d(t,{A:()=>O});var a=r(5155),s=r(2115),l=r(5695),n=r(621),o=r(9210),i=r(3201);r(4488);var c=r(2571),d=r(2695),u=r(290),h=r(1514),m=r(7729),g=r(6770),p=r(7421),f=r(8754),x=r(156);let b=new x.Sj({nodes:{doc:{content:"block+"},text:{group:"inline"},paragraph:{content:"inline*",group:"block",parseDOM:[{tag:"p"}],toDOM:()=>["p",0]},heading:{attrs:{level:{default:1}},content:"inline*",group:"block",defining:!0,parseDOM:[{tag:"h1",attrs:{level:1}},{tag:"h2",attrs:{level:2}},{tag:"h3",attrs:{level:3}},{tag:"h4",attrs:{level:4}},{tag:"h5",attrs:{level:5}},{tag:"h6",attrs:{level:6}}],toDOM:e=>["h".concat(e.attrs.level),0]},hard_break:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:()=>["br"]},image:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null},width:{default:null},height:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:e=>({src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt"),width:e.getAttribute("width"),height:e.getAttribute("height")})}],toDOM(e){let{src:t,alt:r,title:a,width:s,height:l}=e.attrs,n={src:t};return null!=r&&(n.alt=r),null!=a&&(n.title=a),null!=s&&(n.width=s),null!=l&&(n.height=l),["img",n]}},blockquote:{content:"block+",group:"block",defining:!0,parseDOM:[{tag:"blockquote"}],toDOM:()=>["blockquote",0]},code_block:{content:"text*",marks:"",group:"block",code:!0,defining:!0,attrs:{language:{default:"javascript"}},parseDOM:[{tag:"pre",preserveWhitespace:"full",getAttrs(e){let t=e.getAttribute("data-language");if(t)return{language:t};let r=e.querySelector("code");if(r){let e=(r.className||"").match(/language-(\w+)/);if(e)return{language:e[1]}}return{language:"javascript"}},getContent(e,t){let r=e.querySelector("code");if(r){let e=r.textContent||r.innerText||"";return e?[t.text(e)]:[]}return[]}}],toDOM:e=>["pre",{"data-language":e.attrs.language},["code",{class:"language-".concat(e.attrs.language)},0]]},horizontal_rule:{group:"block",parseDOM:[{tag:"hr"}],toDOM:()=>["hr"]},bullet_list:{content:"list_item+",group:"block",parseDOM:[{tag:"ul"}],toDOM:()=>["ul",0]},ordered_list:{content:"list_item+",group:"block",attrs:{order:{default:1}},parseDOM:[{tag:"ol",getAttrs:e=>({order:e.hasAttribute("start")?+e.getAttribute("start"):1})}],toDOM:e=>1==e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]},list_item:{content:"paragraph block*",parseDOM:[{tag:"li"}],toDOM:()=>["li",0],defining:!0}},marks:{strong:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:e=>"normal"!=e.style.fontWeight&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}],toDOM:()=>["strong",0]},em:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:()=>["em",0]},code:{parseDOM:[{tag:"code"}],toDOM:()=>["code",0]},link:{attrs:{href:{},title:{default:null},target:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:e=>({href:e.getAttribute("href"),title:e.getAttribute("title"),target:e.getAttribute("target")})}],toDOM(e){let{href:t,title:r,target:a}=e.attrs,s={href:t};return null!=r&&(s.title=r),null!=a&&(s.target=a),["a",s,0]}}}});function v(){return b.node("doc",null,[b.node("paragraph")])}function y(e){if(!e||""===e.trim())return v();let t=document.createElement("div");return t.innerHTML=e,x.S4.fromSchema(b).parse(t)}function w(e){let t=document.createElement("div");return t.appendChild(x.ZF.fromSchema(b).serializeFragment(e.content)),t.innerHTML}let j=(e,t)=>(r,a,s)=>{let l=!1;(0,h.T2)(t)(r,a,s)&&(r=s.state,l=!0);let n=e(r,a,s);return l||n},{heading:N,paragraph:k,list_item:C,blockquote:E}=b.nodes,_=e=>j((0,u.y_)(N,{level:e}),C),D=()=>j((0,u.y_)(k),C),M=(e,t,r)=>{let{from:a,to:s}=e.selection,l=!1;return(e.doc.nodesBetween(a,s,e=>e.type!==E||(l=!0,!1)),l)?!!(0,h.T2)(C)(e,t)||(0,u.yY)(e,t):((0,h.T2)(C)(e,t)&&(e=r.state),(0,u.Im)(E)(e,t,r))};new c.k_({key:new c.hs("exitHeading"),props:{handleKeyDown(e,t){if("Enter"!==t.key||t.shiftKey)return!1;let{state:r,dispatch:a}=e,{$from:s,empty:l}=r.selection,{heading:n,paragraph:o}=b.nodes;return!!l&&s.parent.type===n&&s.parentOffset===s.parent.content.size&&(t.preventDefault(),(0,u.y_)(o)(r,a,e))}}}),r(3241),r(8042),r(5802),r(7846),r(1280),r(8496),r(941),r(3523),r(4495),r(1177),r(1990),r(3686),r(642),r(7867),r(3337),r(3435),r(1055),r(2103),r(255),r(9829),r(656);var A=r(5901),S=r.n(A);let H=s.forwardRef((e,t)=>{let{articleId:r,initialContent:l="",onChange:n,placeholder:o="Tell your story...",className:i=""}=e,x=(0,s.useRef)(null),j=(0,s.useRef)(null),N=(0,s.useRef)(n),[k,C]=(0,s.useState)(!1);N.current=n;let E=(0,s.useCallback)(e=>{if(!j.current)return;let{state:t,dispatch:r}=j.current,{selection:a}=t,s=b.text(e);r(t.tr.replaceSelectionWith(s)),j.current.focus()},[]);s.useImperativeHandle(t,()=>({insertText:E,focus:()=>{var e;return null==(e=j.current)?void 0:e.focus()}}),[E]),(0,s.useEffect)(()=>{if(x.current&&!j.current){try{let e;if(l&&l.trim())try{e=y(l)}catch(t){console.error("Editor: Failed to parse HTML content:",t),e=v()}else e=v();let t=c.$t.create({doc:e,plugins:[(0,g.w)({"Mod-b":(0,u.wh)(b.marks.strong),"Mod-i":(0,u.wh)(b.marks.em),"Mod-z":m.tN,"Mod-y":m.ZS,Enter:(0,h.wn)(b.nodes.list_item),"Mod-[":(0,h.T2)(b.nodes.list_item),"Mod-]":(0,h.$B)(b.nodes.list_item),Space:(e,t)=>{let{$from:r}=e.selection;if(r.parent.type===b.nodes.paragraph){let a=r.parent.textContent.slice(0,r.parentOffset),s=a.match(/^(#{1,6})$/);if(s){let a=s[1].length,l=e.tr.delete(r.start(),r.pos).setBlockType(r.start(),r.start(),b.nodes.heading,{level:a});return t(l),!0}let l=a.match(/\*\*([^*]+)\*\*$/);if(l){let a=r.pos-l[0].length,s=e.tr.delete(a,r.pos).insertText(l[1]+" ",a).addMark(a,a+l[1].length,b.marks.strong);return t(s),!0}let n=a.match(RegExp("(?<!\\*)\\*([^*]+)\\*$"));if(n){let a=r.pos-n[0].length,s=e.tr.delete(a,r.pos).insertText(n[1]+" ",a).addMark(a,a+n[1].length,b.marks.em);return t(s),!0}let o=a.match(/`([^`]+)`$/);if(o){let a=r.pos-o[0].length,s=e.tr.delete(a,r.pos).insertText(o[1]+" ",a).addMark(a,a+o[1].length,b.marks.code);return t(s),!0}if(a.match(/^[-*]$/))try{let a=b.nodes.list_item.create(null,b.nodes.paragraph.create()),s=b.nodes.bullet_list.create(null,a),l=r.pos-1,n=e.tr.delete(l,r.pos).replaceWith(l,l,s);return n=n.setSelection(c.U3.create(n.doc,l+2)),t(n),!0}catch(e){}if(a.match(/^1\.$/))try{let a=b.nodes.list_item.create(null,b.nodes.paragraph.create()),s=b.nodes.ordered_list.create(null,a),l=r.pos-2,n=e.tr.delete(l,r.pos).replaceWith(l,l,s);return n=n.setSelection(c.U3.create(n.doc,l+2)),t(n),!0}catch(e){}}return!1}}),(0,g.w)(u.RV),(0,m.b6)(),(0,p.A)(),(0,f.z)()]}),r=new d.Lz(x.current,{state:t,editable:()=>!0,dispatchTransaction:e=>{let t=r.state.apply(e);if(r.updateState(t),e.docChanged&&N.current){let e=w(t.doc),r=t.doc.toJSON();N.current(e,r)}},attributes:{"data-placeholder":o||"Tell your story..."}});j.current=r,C(!0),setTimeout(()=>{r&&!r.isDestroyed&&r.focus()},100)}catch(e){console.error("Error initializing editor:",e),C(!0)}return()=>{j.current&&(j.current.destroy(),j.current=null)}}},[]),(0,s.useEffect)(()=>{if(j.current&&k&&l)try{let e=y(l),t=w(j.current.state.doc);if(l!==t){let t=j.current.state.tr.replaceWith(0,j.current.state.doc.content.size,e.content);j.current.dispatch(t)}}catch(e){console.error("Editor: Failed to update content:",e)}},[l,k]);let A=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;(0,u.wh)(b.marks.strong)(e,t)&&j.current.focus()},[]),H=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;(0,u.wh)(b.marks.em)(e,t)&&j.current.focus()},[]),z=(0,s.useCallback)(e=>{if(!j.current)return;let{state:t,dispatch:r}=j.current;_(e)(t,r,j.current)&&j.current.focus()},[]);(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;D()(e,t,j.current)&&j.current.focus()},[]);let T=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;M(e,t,j.current)&&j.current.focus()},[]),B=(0,s.useCallback)(()=>{if(!j.current)return;let e=prompt("Enter programming language (e.g., javascript, python, css):","javascript");if(!e)return;let{state:t,dispatch:r}=j.current,{from:a,to:s}=t.selection,l=b.nodes.code_block.create({language:e.toLowerCase()}),n=t.tr.replaceRangeWith(a,s,l);r&&(r(n),j.current.focus())},[]),I=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current,{$from:r,$to:a}=e.selection;try{let s=b.nodes.list_item.create(null,b.nodes.paragraph.create(null,r.parent.content)),l=b.nodes.bullet_list.create(null,s),n=e.tr.replaceWith(r.start(),a.end(),l);t(n),j.current.focus()}catch(r){(0,h.Sd)(b.nodes.bullet_list)(e,t)&&j.current.focus()}},[]),L=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current,{$from:r,$to:a}=e.selection;try{let s=b.nodes.list_item.create(null,b.nodes.paragraph.create(null,r.parent.content)),l=b.nodes.ordered_list.create(null,s),n=e.tr.replaceWith(r.start(),a.end(),l);t(n),j.current.focus()}catch(r){(0,h.Sd)(b.nodes.ordered_list)(e,t)&&j.current.focus()}},[]),O=(0,s.useCallback)(()=>{let e=prompt("Enter image URL:");if(e&&j.current){let{state:t,dispatch:r}=j.current,a=b.nodes.image.create({src:e,alt:""});r(t.tr.replaceSelectionWith(a)),j.current.focus()}},[]),R=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;(0,m.tN)(e,t),j.current.focus()},[]),W=(0,s.useCallback)(()=>{if(!j.current)return;let{state:e,dispatch:t}=j.current;(0,m.ZS)(e,t),j.current.focus()},[]),U=(0,s.useCallback)(e=>{if(!j.current)return!1;let{from:t,$from:r,to:a,empty:s}=j.current.state.selection;return s?e.isInSet(j.current.state.storedMarks||r.marks()):j.current.state.doc.rangeHasMark(t,a,e)},[]),Y=(0,s.useCallback)(function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!j.current)return!1;let{from:r,to:a}=j.current.state.selection,s=!0;return j.current.state.doc.nodesBetween(r,a,r=>!r.isTextblock||!!r.hasMarkup(e,t)||(s=!1,!1)),s},[]),q=(0,s.useCallback)(()=>{if(!j.current)return!1;let{from:e,to:t}=j.current.state.selection,r=!1;return j.current.state.doc.nodesBetween(e,t,e=>e.type!==b.nodes.blockquote||(r=!0,!1)),r},[]);return(0,a.jsxs)("div",{className:"".concat(S().editor," ").concat("seamless-editor"===i?S().seamlessEditor:""),style:"seamless-editor"===i?{}:{maxWidth:"800px",margin:"0 auto",padding:"20px"},children:[k&&(0,a.jsx)("div",{className:S().modernToolbar,style:"seamless-editor"===i?{}:{opacity:1,visibility:"visible",position:"relative",top:"auto",left:"auto",transform:"none",marginBottom:"20px"},children:(0,a.jsxs)("div",{className:S().toolbarContainer,children:[(0,a.jsxs)("div",{className:S().formatGroup,children:[(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(U(b.marks.strong)?S().active:""),onClick:A,title:"Bold (⌘B)","aria-label":"Bold",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M13.5 15.5H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM10 6.5h3c.55 0 1 .45 1 1s-.45 1-1 1h-3v-2zm5.6 4.5c.75-.9 1.2-2.05 1.2-3.3 0-2.76-2.24-5-5-5H6.5C5.67 2.7 5 3.37 5 4.2v15.6c0 .83.67 1.5 1.5 1.5h8.5c3.31 0 6-2.69 6-6 0-2.5-1.49-4.65-3.4-5.3z"})})}),(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(U(b.marks.em)?S().active:""),onClick:H,title:"Italic (⌘I)","aria-label":"Italic",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z"})})})]}),(0,a.jsx)("div",{className:S().divider}),(0,a.jsxs)("div",{className:S().formatGroup,children:[(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(Y(b.nodes.heading,{level:1})?S().active:""),onClick:()=>z(1),title:"Large Heading (⌘⇧1)","aria-label":"Heading 1",children:(0,a.jsx)("span",{className:S().headingIcon,children:"H1"})}),(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(Y(b.nodes.heading,{level:2})?S().active:""),onClick:()=>z(2),title:"Medium Heading (⌘⇧2)","aria-label":"Heading 2",children:(0,a.jsx)("span",{className:S().headingIcon,children:"H2"})}),(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(Y(b.nodes.heading,{level:3})?S().active:""),onClick:()=>z(3),title:"Small Heading (⌘⇧3)","aria-label":"Heading 3",children:(0,a.jsx)("span",{className:S().headingIcon,children:"H3"})})]}),(0,a.jsx)("div",{className:S().divider}),(0,a.jsxs)("div",{className:S().formatGroup,children:[(0,a.jsx)("button",{className:S().toolBtn,onClick:I,title:"Bullet List","aria-label":"Bullet list",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"})})}),(0,a.jsx)("button",{className:S().toolBtn,onClick:L,title:"Numbered List","aria-label":"Numbered list",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"})})}),(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(q()?S().active:""),onClick:T,title:"Quote (⌘>)","aria-label":"Quote",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"})})})]}),(0,a.jsx)("div",{className:S().divider}),(0,a.jsxs)("div",{className:S().formatGroup,children:[(0,a.jsx)("button",{className:S().toolBtn,onClick:O,title:"Add Image","aria-label":"Insert image",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"})})}),(0,a.jsx)("button",{className:"".concat(S().toolBtn," ").concat(Y(b.nodes.code_block)?S().active:""),onClick:B,title:"Code Block","aria-label":"Code block",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0L19.2 12l-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"})})})]}),(0,a.jsx)("div",{className:S().divider}),(0,a.jsxs)("div",{className:S().formatGroup,children:[(0,a.jsx)("button",{className:S().toolBtn,onClick:R,title:"Undo (⌘Z)","aria-label":"Undo",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"})})}),(0,a.jsx)("button",{className:S().toolBtn,onClick:W,title:"Redo (⌘Y)","aria-label":"Redo",children:(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"})})})]})]})}),!k&&(0,a.jsxs)("div",{className:S().loading,children:[(0,a.jsx)("div",{className:S().loadingSpinner}),(0,a.jsx)("span",{children:"Loading editor..."})]}),(0,a.jsx)("div",{ref:x,className:S().prosemirrorEditor,"aria-label":"Rich text editor",style:{minHeight:"seamless-editor"===i?"500px":"400px",opacity:k?1:.3,..."seamless-editor"===i?{background:"transparent",border:"none",boxShadow:"none",padding:0,margin:0,fontSize:"18px",lineHeight:"1.6",color:"#1f2937"}:{}}})]})});H.displayName="Editor";var z=r(9122),T=r(4814),B=r(8163),I=r.n(B);let L=e=>{let{onInsert:t}=e,[r,l]=(0,s.useState)(!1),[n,o]=(0,s.useState)([]),[i,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(!1),[h,m]=(0,s.useState)("inspirations"),g=async()=>{u(!0);try{let[e,t]=await Promise.all([(0,z.Aq)(),(0,z.Gy)()]);o(e),c(t)}catch(e){console.error("Error loading inspiration data:",e)}finally{u(!1)}},p=e=>{t&&t(e),l(!1)},f=e=>({emotions:"Explore a moment when your emotions surprised you...","decision-making":"Write about a decision that changed your perspective...","personal experience":"Reflect on an experience that shaped who you are today...",questioning:"What questions have been on your mind lately?","unexpected insights":"Share something that recently surprised you...",perspectives:"How has your viewpoint on something important changed?","dialogue with authors":"What would you say to an author whose work moved you?",connections:"Write about connections you've discovered between different ideas..."})[e]||"Write about ".concat(e,"...");return r?(0,a.jsx)("div",{className:"fixed bottom-8 right-8 z-40 w-96",children:(0,a.jsxs)("div",{className:"".concat(I()["glass-modal"]," max-h-96 overflow-hidden"),children:[(0,a.jsx)("div",{className:I()["glass-highlight"]}),(0,a.jsxs)("div",{className:I()["glass-content"],children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-white/20",children:[(0,a.jsxs)("h3",{className:"text-lg font-bold text-stone-800 flex items-center gap-2 font-serif",children:[(0,a.jsx)(T.TG,{size:18,color:"#f59e0b"}),"Your Reflection Insights"]}),(0,a.jsx)("button",{onClick:()=>l(!1),className:"text-stone-500 hover:text-stone-700 text-xl font-bold leading-none",children:"\xd7"})]}),(0,a.jsxs)("div",{className:"flex p-4 gap-2",children:[(0,a.jsxs)("button",{className:"".concat(I()["glass-tag"]," flex-1 text-center py-2 text-sm font-semibold transition-all ").concat("inspirations"===h?"bg-blue-500/20 text-blue-700 border-blue-300/30":"hover:bg-white/20"),onClick:()=>m("inspirations"),children:["Recent Thoughts (",n.length,")"]}),(0,a.jsxs)("button",{className:"".concat(I()["glass-tag"]," flex-1 text-center py-2 text-sm font-semibold transition-all ").concat("themes"===h?"bg-blue-500/20 text-blue-700 border-blue-300/30":"hover:bg-white/20"),onClick:()=>m("themes"),children:["Writing Themes (",i.length,")"]})]}),(0,a.jsx)("div",{className:"p-4 max-h-64 overflow-y-auto",children:d?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-3 border-blue-500 border-t-transparent rounded-full animate-spin mb-4"}),(0,a.jsx)("p",{className:"text-stone-600",children:"Loading your insights..."})]}):"inspirations"===h?(0,a.jsx)("div",{children:0===n.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-stone-500 mb-2",children:[(0,a.jsx)(T.d3,{size:16,color:"#6b7280"}),(0,a.jsx)("p",{className:"font-semibold",children:"No reflections yet!"})]}),(0,a.jsx)("p",{className:"text-sm text-stone-500",children:"Start reading articles and reflecting to build your inspiration library."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-sm text-stone-600 mb-4 font-semibold",children:"Your past reflections that might spark new ideas:"}),(0,a.jsx)("div",{className:"space-y-3",children:n.map((e,t)=>(0,a.jsxs)("div",{className:"".concat(I()["glass-card"]," p-4"),children:[(0,a.jsx)("div",{className:I()["glass-card-highlight"]}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsxs)("p",{className:"text-sm text-stone-700 italic mb-2",children:['"',e.response,'"']}),e.articleTitle&&(0,a.jsxs)("p",{className:"text-xs text-stone-500 mb-3",children:["From: ",e.articleTitle]}),(0,a.jsx)("button",{onClick:()=>{let t=e.articleTitle?' (inspired by "'.concat(e.articleTitle,'")'):"";p('"'.concat(e.response,'"').concat(t," - This reminds me of..."))},className:"".concat(I()["glass-button"]," ").concat(I()["glass-button-primary"]," text-xs px-3 py-1 w-full"),children:"Use as starting point"})]})]},t))})]})}):(0,a.jsx)("div",{children:0===i.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-2 text-stone-500 mb-2",children:[(0,a.jsx)(T.v1,{size:16,color:"#6b7280"}),(0,a.jsx)("p",{className:"font-semibold",children:"No themes identified yet!"})]}),(0,a.jsx)("p",{className:"text-sm text-stone-500",children:"Keep reflecting on articles to discover your writing themes."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("p",{className:"text-sm text-stone-600 mb-4 font-semibold",children:"Writing prompts based on your reflection patterns:"}),(0,a.jsx)("div",{className:"space-y-3",children:i.map((e,t)=>(0,a.jsxs)("div",{className:"".concat(I()["glass-card"]," p-4"),children:[(0,a.jsx)("div",{className:I()["glass-card-highlight"]}),(0,a.jsxs)("div",{className:"relative z-10",children:[(0,a.jsx)("div",{className:"".concat(I()["glass-tag"]," inline-block mb-2 text-xs"),children:e}),(0,a.jsx)("p",{className:"text-sm text-stone-700 mb-3",children:f(e)}),(0,a.jsx)("button",{onClick:()=>p(f(e)),className:"".concat(I()["glass-button"]," ").concat(I()["glass-button-primary"]," text-xs px-3 py-1 w-full"),children:"Start writing"})]})]},t))})]})})}),(0,a.jsx)("div",{className:"p-4 border-t border-white/20",children:(0,a.jsx)("button",{onClick:g,className:"".concat(I()["glass-button"]," text-sm px-4 py-2 w-full disabled:opacity-50"),disabled:d,children:"\uD83D\uDD04 Refresh insights"})})]})]})}):(0,a.jsx)("div",{className:"fixed bottom-8 right-8 z-40",children:(0,a.jsxs)("button",{onClick:()=>{r||g(),l(!r)},className:"".concat(I()["glass-button"]," ").concat(I()["glass-button-primary"]," flex items-center gap-2 px-6 py-4 text-sm font-semibold"),title:"Get inspiration from your reflections",children:[(0,a.jsx)(T.Y_,{size:16,color:"currentColor"}),"Inspiration"]})})},O=e=>{let{articleId:t,onUpdateComplete:r,backToArticleAction:c,editingTitle:d}=e,u=(0,l.useRouter)(),[h,m]=(0,s.useState)(""),[g,p]=(0,s.useState)(""),[f,x]=(0,s.useState)([]),[b,v]=(0,s.useState)(""),[y,w]=(0,s.useState)(!1),[j,N]=(0,s.useState)(!1),[k,C]=(0,s.useState)(!1),[E,_]=(0,s.useState)(""),[D,M]=(0,s.useState)(!!t),[A,S]=(0,s.useState)(null),[z,T]=(0,s.useState)(""),B=(0,s.useRef)(null),O=(0,s.useRef)(null),R=(0,s.useRef)(null),W=(0,s.useCallback)(()=>{B.current&&(B.current.style.height="auto",B.current.style.height="".concat(B.current.scrollHeight,"px"),!h&&B.current&&B.current.focus())},[h]);(0,s.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{S(e),e||u.push("/login?redirect=compose")});return()=>e()},[u]),(0,s.useEffect)(()=>{t&&A?(async()=>{try{M(!0);let e=await (0,o.getArticleById)(t);if(!e){_("Article not found"),u.push("/");return}if(e.authorId!==A.uid){_("You can only edit your own articles"),u.push("/");return}m(e.title);let r=e.body.replace(/data-[\w-]+="[^"]*"/g,"");p(r),x(e.tags||[]),v(e.coverImage||"")}catch(e){console.error("Error loading article:",e),_("Failed to load article")}finally{M(!1)}})():t||M(!1)},[t,A,u]),(0,s.useEffect)(()=>{W()},[h,W]),(0,s.useEffect)(()=>{let e;return A&&h.trim()&&g.trim()&&!j&&!y&&(e=setTimeout(()=>{G("drafts")},3e4)),()=>{e&&clearTimeout(e)}},[A,h,g,j,y]);let U=(0,s.useCallback)((e,t)=>{p(t=>e!==t?(k&&C(!1),e):t)},[k]),Y=()=>{let e=z.trim().toLowerCase();e&&!f.includes(e)&&f.length<5&&(x([...f,e]),T(""))},q=e=>{x(f.filter(t=>t!==e))},F=e=>{v(e.target.value)},G=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"drafts";if(!A)return void _("You must be logged in to save articles");if(!h.trim())return void _("Title is required");try{_(""),N(!0);let a=h.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-|-$/g,""),s={title:h.trim(),body:g,tags:f,coverImage:b,status:e,authorId:A.uid,authorName:A.displayName||A.email||"Anonymous",slug:a};if(t)try{let e=await (0,o.iZ)(t,s);C(!0),r?r(e):setTimeout(()=>{u.push("/articles/?slug=".concat(a))},1e3)}catch(e){console.error("Error updating article:",e),_("Failed to update article. Please try again."),C(!1)}else await (0,o.N6)(s),"published"===e?u.push("/articles/?slug=".concat(a)):u.push("/dashboard")}catch(e){console.error("Error saving article:",e),_("Failed to save article. Please try again.")}finally{N(!1),w(!1)}},V=async()=>{if(!g.trim())return void _("Content is required");w(!0),await G("published")},$=async()=>{await G("drafts")};return D?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",style:{background:"linear-gradient(135deg, #f0f9ff 0%, #f7fafc 20%, #fef7ff 40%, #f0fdfa 60%, #fff7ed 80%, #f3f4f6 100%)",backgroundAttachment:"fixed"},children:(0,a.jsxs)("div",{className:I()["glass-loading"],children:[(0,a.jsx)("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-stone-600 text-lg",children:"Loading your article..."})]})}):(0,a.jsxs)("div",{className:"".concat(I()["glass-container"]," min-h-screen w-full"),style:{background:"linear-gradient(135deg, #f0f9ff 0%, #f7fafc 20%, #fef7ff 40%, #f0fdfa 60%, #fff7ed 80%, #f3f4f6 100%)",backgroundAttachment:"fixed",position:"relative",borderRadius:"0px",border:"none"},children:[(0,a.jsx)("div",{className:I()["glass-highlight"]}),(0,a.jsxs)("header",{className:"".concat(I()["glass-container"]," fixed top-6 left-6 right-6 z-50 max-w-6xl mx-auto"),style:{backdropFilter:"blur(20px) saturate(180%)"},children:[(0,a.jsx)("div",{className:I()["glass-highlight"]}),(0,a.jsxs)("div",{className:"".concat(I()["glass-content"]," flex items-center justify-between p-4"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[c?(0,a.jsxs)("button",{onClick:c,className:"".concat(I()["glass-button"]," flex items-center gap-2 px-3 py-2 text-sm font-medium text-stone-700 hover:text-stone-900 transition-colors"),children:[(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"currentColor",children:(0,a.jsx)("path",{d:"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.42-1.41L7.83 13H20v-2z"})}),"Back to Article"]}):(0,a.jsx)("div",{className:"text-xl font-bold text-stone-800 font-serif",children:"Journalite"}),(0,a.jsx)("div",{className:"text-stone-500 text-sm",children:t?d?"Editing: ".concat(d):"Editing":"Writing"}),k&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600 text-sm",children:[(0,a.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",fill:"currentColor",children:(0,a.jsx)("path",{d:"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"})}),"Saved"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("button",{className:"".concat(I()["glass-button"]," px-4 py-2 text-sm font-semibold disabled:opacity-50"),onClick:$,disabled:j||y,children:j?"Saving...":"Save Draft"}),(0,a.jsx)("button",{className:"".concat(I()["glass-button"]," ").concat(I()["glass-button-primary"]," px-4 py-2 text-sm font-semibold disabled:opacity-50"),onClick:V,disabled:j||y||!h.trim()||!g.trim(),children:y?"Publishing...":t?"Update":"Publish"})]})]})]}),(0,a.jsxs)("div",{className:"".concat(I()["glass-content"]," pt-32 pb-16 min-h-screen w-full max-w-4xl mx-auto"),style:{paddingLeft:"64px",paddingRight:"64px"},children:[(0,a.jsx)("textarea",{ref:B,value:h,onChange:e=>{m(e.target.value)},onKeyDown:e=>{"Enter"===e.key&&e.preventDefault()},placeholder:"Title",rows:1,className:"w-full bg-transparent border-none outline-none resize-none overflow-hidden text-5xl font-bold text-stone-800 placeholder-stone-400 font-serif leading-tight mb-8 focus:outline-none",style:{minHeight:"60px"}}),(b||h.length>10)&&(0,a.jsxs)("div",{className:"mb-8",children:[!b&&(0,a.jsx)("input",{type:"text",value:b,onChange:F,placeholder:"Add a cover image URL...",className:"w-full bg-transparent border-none outline-none text-stone-600 placeholder-stone-400 py-2 border-b border-stone-200 focus:border-stone-400 transition-colors"}),b&&(0,a.jsxs)("div",{className:"relative group",children:[(0,a.jsx)("img",{src:b,alt:"Cover",className:"w-full h-64 object-cover rounded-2xl mb-4"}),(0,a.jsx)("input",{type:"text",value:b,onChange:F,placeholder:"Cover image URL...",className:"w-full bg-white/80 backdrop-blur border border-stone-200 outline-none text-stone-600 placeholder-stone-400 py-2 px-4 rounded-lg focus:border-stone-400 transition-colors"})]})]}),(f.length>0||h.length>5)&&(0,a.jsxs)("div",{className:"mb-8 flex flex-wrap gap-2 items-center",children:[f.map(e=>(0,a.jsxs)("div",{className:"px-3 py-1 bg-blue-100/60 backdrop-blur text-blue-700 rounded-full text-sm font-medium flex items-center gap-2",children:[e,(0,a.jsx)("button",{className:"text-blue-600 hover:text-blue-800 font-bold text-base leading-none",onClick:()=>q(e),"aria-label":"Remove ".concat(e," tag"),children:"\xd7"})]},e)),f.length<5&&(0,a.jsx)("input",{ref:O,type:"text",value:z,onChange:e=>{T(e.target.value)},onKeyDown:e=>{("Enter"===e.key||","===e.key)&&(e.preventDefault(),Y())},onBlur:Y,placeholder:0===f.length?"Add tags...":"Add tag...",className:"bg-transparent border-none outline-none text-stone-600 placeholder-stone-400 min-w-24 py-1"})]}),E&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50/80 border border-red-200 rounded-xl text-red-700 text-sm",children:E}),(0,a.jsx)("div",{className:"min-h-[500px] w-full",style:{background:"transparent"},children:(0,a.jsx)(H,{ref:R,...{articleId:t||(0,n.A)(),initialContent:g,onChange:U,placeholder:"Write your story...",className:"seamless-editor"}})})]}),(0,a.jsx)(L,{onInsert:e=>{R.current&&R.current.insertText?R.current.insertText("\n\n"+e+"\n\n"):p(t=>t.trim()?t+"\n\n<p>"+e+"</p>":"<p>"+e+"</p>"),setTimeout(()=>{R.current&&R.current.focus&&R.current.focus()},100)}})]})}},5901:e=>{e.exports={editorContainer:"Editor_editorContainer__AxL3W",editorContent:"Editor_editorContent__Hto0I",prosemirrorEditor:"Editor_prosemirrorEditor__jSRn5",editor:"Editor_editor__ys4HH",seamlessEditor:"Editor_seamlessEditor__2leHe",modernToolbar:"Editor_modernToolbar__VDG5b",loading:"Editor_loading___nwXA",loadingSpinner:"Editor_loadingSpinner__JMIXQ",spin:"Editor_spin__5Ufeq",toolbarContainer:"Editor_toolbarContainer__rZaHf",formatGroup:"Editor_formatGroup__OhMWy",divider:"Editor_divider__pHi4V",toolBtn:"Editor_toolBtn__LEamn",active:"Editor_active__UGSnI",headingIcon:"Editor_headingIcon__HKD4e",ProseMirror:"Editor_ProseMirror__DHY3Q",slideInFromTop:"Editor_slideInFromTop__ADbMI"}},9210:(e,t,r)=>{"use strict";r.d(t,{BC:()=>h,GE:()=>n,N6:()=>c,Oe:()=>m,Tu:()=>p,a:()=>f,fz:()=>u,getArticleById:()=>o,iZ:()=>d,l6:()=>i,tT:()=>g,zE:()=>x});var a=r(5317),s=r(3201),l=r(9995);async function n(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{limit:t,includeDrafts:r=!1}=e;try{let e=(0,a.collection)(s.db,"articles"),l=[];r||l.push((0,a.where)("status","==","published")),l.push((0,a.orderBy)("createdAt","desc")),t&&t>0&&l.push((0,a.limit)(t));let n=(0,a.query)(e,...l),o=await (0,a.getDocs)(n),i=[];return o.forEach(e=>{let t=e.data();i.push({id:e.id,...t})}),i}catch(e){throw console.error("Error getting articles:",e),e}}async function o(e){Date.now();try{let t=(0,a.doc)(s.db,"articles",e),r=await (0,a.getDoc)(t);if(!r.exists())return null;return{id:r.id,...r.data()}}catch(e){throw console.error("\uD83D\uDED1 Error getting article:",e),e}}async function i(e){let t=0;for(;t<3;){t++;try{let r=(0,a.collection)(s.db,"articles"),l=(0,a.query)(r,(0,a.where)("slug","==",e),(0,a.where)("status","==","published"),(0,a.limit)(1)),n=await (0,a.getDocs)(l);if(n.empty)if(3===t)break;else await new Promise(e=>setTimeout(e,1e3));else{let e=n.docs[0];return{id:e.id,...e.data()}}}catch(e){if(console.error("Error getting article by slug:",e),3===t)throw e}}return null}async function c(e){try{var t;let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to create an article");let l={title:e.title,body:e.body,slug:e.slug||e.title.toLowerCase().replace(/[\s\W-]+/g,"-").replace(/^-+|-+$/g,""),createdAt:a.Timestamp.now(),authorId:r.uid,authorName:r.displayName||(null==(t=r.email)?void 0:t.split("@")[0])||"Anonymous",tags:e.tags||[],status:e.status||"published",coverImage:e.coverImage||null,likes:[],excerpt:e.excerpt||"",viewCount:0,reposts:[],comments:[]};return{id:(await (0,a.addDoc)((0,a.collection)(s.db,"articles"),l)).id,...l}}catch(e){throw console.error("Error creating article:",e),e}}async function d(e,t){try{let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to edit an article");let l=(0,a.doc)(s.db,"articles",e),n=await (0,a.getDoc)(l);if(!n.exists())throw Error("Article not found");if(n.data().authorId!==r.uid)throw Error("You can only edit your own articles");let o={...t};t.title&&(o.slug=t.title.toLowerCase().replace(/[\s\W-]+/g,"-").replace(/^-+|-+$/g,"")),o.updatedAt=a.Timestamp.now(),await (0,a.updateDoc)(l,o);let i=await (0,a.getDoc)(l);if(!i.exists())return{id:e,...o,createdAt:a.Timestamp.now(),updatedAt:a.Timestamp.now()};{let e=i.data();return{id:i.id,...e}}}catch(e){throw console.error("Error updating article:",e),e}}async function u(e){try{let t=(0,a.collection)(s.db,"articles",e,"comments"),r=(0,a.query)(t,(0,a.orderBy)("createdAt","desc")),l=await (0,a.getDocs)(r),n=[];return l.forEach(e=>{let t=e.data();n.push({id:e.id,commentId:e.id,...t,replies:t.replies||[]})}),n}catch(e){throw console.error("Error getting comments:",e),e}}async function h(e,t){try{var r;let n=s.j2.currentUser;if(!n)throw Error("You must be logged in to comment");let i={userId:n.uid,userName:n.displayName||(null==(r=n.email)?void 0:r.split("@")[0])||"Anonymous",content:t,createdAt:a.Timestamp.now(),likes:[],replies:[]},c=await (0,a.addDoc)((0,a.collection)(s.db,"articles",e,"comments"),i),d=await o(e);return d&&d.authorId!==n.uid&&await (0,l.fZ)(d.authorId,e,d.slug||"",d.title||"Article",c.id,t),{id:c.id,commentId:c.id,...i}}catch(e){throw console.error("Error adding comment:",e),e}}async function m(e,t,r){try{var n;let i=s.j2.currentUser;if(!i)throw Error("You must be logged in to reply");let c=(0,a.doc)(s.db,"articles",e,"comments",t),d=await (0,a.getDoc)(c);if(!d.exists())throw Error("Comment not found");let u={replyId:Math.random().toString(36).substring(2,15),userId:i.uid,userName:i.displayName||(null==(n=i.email)?void 0:n.split("@")[0])||"Anonymous",content:r,createdAt:a.Timestamp.now(),likes:[]};await (0,a.updateDoc)(c,{replies:(0,a.arrayUnion)(u)});let h=d.data();if(h.userId!==i.uid){let t=await o(e);await (0,l.fZ)(h.userId,e,(null==t?void 0:t.slug)||"",(null==t?void 0:t.title)||"Article",u.replyId,r)}return u}catch(e){throw console.error("Error adding reply:",e),e}}async function g(e,t){try{let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to like a comment");let l=(0,a.doc)(s.db,"articles",e,"comments",t),n=await (0,a.getDoc)(l);if(!n.exists())throw Error("Comment not found");let o=n.data(),i=r.uid,c=(o.likes||[]).includes(i);await (0,a.updateDoc)(l,{likes:c?(0,a.arrayRemove)(i):(0,a.arrayUnion)(i)});let d=(await (0,a.getDoc)(l)).data();return{success:!0,action:c?"unliked":"liked",likes:d.likes,count:d.likes.length}}catch(e){throw console.error("Error liking comment:",e),e}}async function p(e,t){try{let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to delete a comment");let l=(0,a.doc)(s.db,"articles",e,"comments",t),n=await (0,a.getDoc)(l);if(!n.exists())throw Error("Comment not found");if(n.data().userId!==r.uid)throw Error("You can only delete your own comments");return await (0,a.deleteDoc)(l),{success:!0,message:"Comment deleted successfully"}}catch(e){throw console.error("Error deleting comment:",e),e}}async function f(e){try{let t=s.j2.currentUser;if(!t)throw Error("You must be logged in to delete an article");let r=(0,a.doc)(s.db,"articles",e),l=await (0,a.getDoc)(r);if(!l.exists())throw Error("Article not found");if(l.data().authorId!==t.uid)throw Error("You can only delete your own articles");return await (0,a.deleteDoc)(r),{success:!0,message:"Article deleted successfully"}}catch(e){throw console.error("Error deleting article:",e),e}}async function x(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{limit:r}=t;try{let t=(0,a.collection)(s.db,"articles"),l=[(0,a.where)("tags","array-contains",e),(0,a.where)("status","==","published"),(0,a.orderBy)("createdAt","desc")];r&&r>0&&l.push((0,a.limit)(r));let n=(0,a.query)(t,...l),o=await (0,a.getDocs)(n),i=[];return o.forEach(e=>{i.push({id:e.id,...e.data()})}),i}catch(e){throw console.error("Error getting articles by tag:",e),e}}}}]);