(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9429],{3074:(e,t,n)=>{"use strict";n.d(t,{A:()=>y});var l=n(5155),i=n(2115),r=n(3201),o=n(5317);let a=async(e,t,n,l,i)=>{try{let a={articleId:e,userId:t,text:n,prefix:l,suffix:i,createdAt:(0,o.O5)(),comments:[]};return(await (0,o.gS)((0,o.rJ)(r.db,"highlights"),a)).id}catch(e){throw console.error("Error saving highlight:",e),e}},s=async e=>{try{let t=(0,o.P)((0,o.rJ)(r.db,"highlights"),(0,o._M)("articleId","==",e));return(await (0,o.GG)(t)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting highlights:",e),[]}},c=async e=>{try{await (0,o.kd)((0,o.H9)(r.db,"highlights",e))}catch(e){throw console.error("Error deleting highlight:",e),e}},d=(0,i.createContext)(void 0),h=e=>{let{children:t,articleId:n}=e,[o,h]=(0,i.useState)([]),[m,g]=(0,i.useState)(!0),[u,_]=(0,i.useState)(null);(0,i.useEffect)(()=>{let e=r.j2.onAuthStateChanged(e=>{_(e)});return()=>e()},[]),(0,i.useEffect)(()=>{(async()=>{if(n){g(!0);try{let e=await s(n);h(e)}catch(e){console.error("Error loading highlights:",e)}finally{g(!1)}}})()},[n]);let p=async(e,t,n,l)=>{if(!u)return alert("You must be logged in to highlight text"),null;try{let i=await a(l,u.uid,e,t,n),r={id:i,articleId:l,userId:u.uid,text:e,prefix:t,suffix:n,createdAt:new Date};return h(e=>[...e,r]),i}catch(e){return console.error("Error saving highlight:",e),null}},x=async e=>{try{await c(e),h(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error removing highlight:",e)}};return(0,l.jsx)(d.Provider,{value:{highlights:o,loading:m,saveHighlight:p,removeHighlight:x,highlightElement:e=>{let t=document.createElement("mark");t.className="article-highlight";try{e.surroundContents(t)}catch(l){console.error("Error highlighting range:",l);let n=e.extractContents();t.appendChild(n),e.insertNode(t)}}},children:t})},m=()=>{let e=(0,i.useContext)(d);if(void 0===e)throw Error("useHighlights must be used within a HighlightProvider");return e};var g=n(7650);let u=e=>{let{selection:t,onHighlight:n,onResponse:r,onShare:o,onAiAssist:a}=e,[s,c]=(0,i.useState)({top:0,left:0}),[d,h]=(0,i.useState)(!1),m=(0,i.useRef)(null);return((0,i.useEffect)(()=>{var e;if(!t||t.isCollapsed)return void h(!1);let n=t.getRangeAt(0).getBoundingClientRect();window.innerHeight;let l=(null==(e=m.current)?void 0:e.offsetHeight)||40,i=n.top-l-10+window.scrollY,r=n.left+n.width/2;c({top:i<0?n.bottom+10+window.scrollY:i,left:r}),h(!0)},[t]),d)?(0,g.createPortal)((0,l.jsxs)("div",{ref:m,className:"highlight-toolbar",style:{position:"absolute",top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),transform:"translateX(-50%)",zIndex:1e3},children:[(0,l.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed){var e;let l=t.getRangeAt(0);n(t.toString(),l),null==(e=window.getSelection())||e.removeAllRanges(),h(!1)}},className:"highlight-btn highlight-btn-main",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,l.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,l.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,l.jsx)("span",{children:"Highlight"})]}),r&&(0,l.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&r){var e;r(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),h(!1)}},className:"highlight-btn",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:(0,l.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,l.jsx)("span",{children:"Response"})]}),o&&(0,l.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&o){var e;o(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),h(!1)}},className:"highlight-btn",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,l.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,l.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,l.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,l.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,l.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,l.jsx)("span",{children:"Share"})]}),a&&(0,l.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&a){var e;a(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),h(!1)}},className:"highlight-btn",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,l.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,l.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),(0,l.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"16"})]}),(0,l.jsx)("span",{children:"Journa AI"})]})]}),document.body):null},_=e=>{let t={prefix:"",suffix:""};if(!e||0===e.rangeCount)return t;let n=e.getRangeAt(0),l=n.toString();n.cloneRange();let i=n.commonAncestorContainer.textContent||"",r=i.indexOf(l);if(-1!==r){let e=Math.max(0,r-30),n=Math.min(i.length,r+l.length+30);t.prefix=i.substring(e,r),t.suffix=i.substring(r+l.length,n)}return t},p=(e,t)=>{e&&t&&(t.querySelectorAll(".article-highlight").forEach(e=>{let t=e.parentNode;if(t){let n=document.createTextNode(e.textContent||"");t.replaceChild(n,e),t.normalize()}}),e.forEach(e=>{let n=((e,n,l)=>{let i,r=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),o=(n+e+l).trim();for(;i=r.nextNode();){let t=(i.textContent||"").indexOf(o);if(-1!==t){let l=document.createRange(),r=n.trim().length;return l.setStart(i,t+r),l.setEnd(i,t+r+e.trim().length),l}}return null})(e.text,e.prefix,e.suffix);if(n)try{let t=document.createElement("mark");t.className="article-highlight",t.dataset.highlightId=e.id,n.surroundContents(t)}catch(e){console.error("Error applying highlight:",e)}}))},x=e=>{let{articleId:t,children:n,onShare:r}=e,[o,a]=(0,i.useState)(null),{highlights:s,saveHighlight:c,removeHighlight:d,highlightElement:h}=m(),[g,x]=(0,i.useState)(null),[v,j]=(0,i.useState)(!1),[f,y]=(0,i.useState)(""),[w,C]=(0,i.useState)(!1),[k,N]=(0,i.useState)(""),[b,A]=(0,i.useState)(null),[S,P]=(0,i.useState)(!1),[L,M]=(0,i.useState)(!1),[E,I]=(0,i.useState)({top:0,left:0}),B=(0,i.useCallback)(()=>{M(!0),setTimeout(()=>{P(!1),M(!1)},150)},[]),T=(0,i.useCallback)(()=>{if(S)return;let e=window.getSelection();e&&!e.isCollapsed&&""!==e.toString().trim()?a(e):a(null)},[S]),D=(0,i.useCallback)((e,n)=>{if(e&&n){let l=_(window.getSelection());c(e.trim(),l.prefix,l.suffix,t),h(n)}},[t,c,h]),H=(0,i.useCallback)(e=>{let t=e.target;if(t.classList.contains("article-highlight")){e.preventDefault(),e.stopPropagation();let n=t.dataset.highlightId,l=t.textContent||"";if(n){M(!1),A({id:n,text:l});let e=t.getBoundingClientRect();I({top:e.top-40+window.scrollY,left:e.left+e.width/2}),P(!0),a(null)}}else S&&(B(),A(null))},[S,B]),R=(0,i.useCallback)(()=>{if(b&&b.id){B();let e=b.id;if(A(null),d(e),g){let t=g.querySelector('[data-highlight-id="'.concat(e,'"]'));if(t&&t.parentNode){let e=document.createTextNode(t.textContent||"");t.parentNode.replaceChild(e,t),t.parentNode.normalize()}}}},[b,d,g,B]),U=(0,i.useCallback)(e=>{y(e),j(!0)},[]),z=(0,i.useCallback)(e=>{if(r)r(e);else{let t='"'.concat(e,'" — via Journalite');navigator.share?navigator.share({text:t}).catch(e=>{console.error("Error sharing:",e),navigator.clipboard.writeText(t).then(()=>alert("Quote copied to clipboard!")).catch(e=>console.error("Failed to copy:",e))}):navigator.clipboard.writeText(t).then(()=>alert("Quote copied to clipboard!")).catch(e=>console.error("Failed to copy:",e))}},[r]),W=(0,i.useCallback)(e=>{N(e),C(!0)},[]);(0,i.useEffect)(()=>(document.addEventListener("selectionchange",T),()=>{document.removeEventListener("selectionchange",T)}),[T]),(0,i.useEffect)(()=>{if(g)return g.addEventListener("click",H),()=>{g.removeEventListener("click",H)}},[g,H]),(0,i.useEffect)(()=>{let e=e=>{if(S){let t=e.target;t.closest(".highlight-toolbar")||t.classList.contains("article-highlight")||(B(),A(null))}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[S,B]),(0,i.useEffect)(()=>{g&&s.length>0&&p(s,g)},[s,g]);let F=(0,i.useCallback)(e=>{e&&x(e)},[]);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(u,{selection:o,onHighlight:D,onResponse:U,onShare:z,onAiAssist:W}),S&&b&&(0,l.jsxs)("div",{className:"highlight-toolbar unhighlight-toolbar ".concat(L?"hiding":""),style:{position:"absolute",top:"".concat(E.top,"px"),left:"".concat(E.left,"px"),transform:L?"translateY(-10px) translateX(-50%)":"translateX(-50%)",zIndex:1e3},children:[(0,l.jsxs)("button",{onClick:R,className:"highlight-btn highlight-btn-danger",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),(0,l.jsx)("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),(0,l.jsx)("line",{x1:"12",y1:"9",x2:"18",y2:"15"})]}),(0,l.jsx)("span",{children:"Unhighlight"})]}),(0,l.jsxs)("button",{onClick:()=>{z(b.text),B()},className:"highlight-btn",children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,l.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,l.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,l.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,l.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,l.jsx)("span",{children:"Share"})]}),(0,l.jsxs)("button",{onClick:()=>{U(b.text),B()},className:"highlight-btn",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,l.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,l.jsx)("span",{children:"Response"})]})]}),(0,l.jsx)("div",{ref:F,className:"article-highlight-container",children:n}),v&&(0,l.jsx)("div",{className:"highlight-response-modal",children:(0,l.jsxs)("div",{className:"highlight-modal-content",children:[(0,l.jsx)("button",{className:"highlight-modal-close",onClick:()=>j(!1),children:"\xd7"}),(0,l.jsx)("h3",{children:"Respond to highlighted text"}),(0,l.jsxs)("div",{className:"highlight-selected-text",children:['"',f,'"']}),(0,l.jsx)("textarea",{className:"highlight-response-input",placeholder:"Write your response..."}),(0,l.jsx)("button",{className:"highlight-response-submit",children:"Submit"})]})}),w&&(0,l.jsx)("div",{className:"highlight-ai-modal",children:(0,l.jsxs)("div",{className:"highlight-modal-content",children:[(0,l.jsx)("button",{className:"highlight-modal-close",onClick:()=>C(!1),children:"\xd7"}),(0,l.jsx)("h3",{children:"Journa AI"}),(0,l.jsxs)("div",{className:"highlight-selected-text",children:['"',k,'"']}),(0,l.jsxs)("div",{className:"highlight-ai-options",children:[(0,l.jsx)("button",{children:"Explain this"}),(0,l.jsx)("button",{children:"Fact check"}),(0,l.jsx)("button",{children:"Provide context"}),(0,l.jsx)("button",{children:"Summarize"})]}),(0,l.jsx)("div",{className:"highlight-ai-response",children:(0,l.jsx)("div",{className:"highlight-ai-loading",children:"Journa AI is thinking..."})})]})})]})};var v=n(7036),j=n.n(v),f=n(9210);let y=e=>{let{articleId:t,initialHtml:n}=e,[r,o]=(0,i.useState)(null),[a,s]=(0,i.useState)(!n),[c,d]=(0,i.useState)(""),m=(0,i.useRef)(null);return((0,i.useEffect)(()=>{n||r||(async()=>{try{s(!0);let e=await (0,f.zE)(t);if(!e)return void d("Article not found");let n=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");o({title:e.title,body:n})}catch(e){console.error("Error loading article:",e),d("Failed to load article")}finally{s(!1)}})()},[t,r,n]),a)?(0,l.jsxs)("div",{className:j().loadingContainer,children:[(0,l.jsx)("div",{className:j().loadingIndicator}),(0,l.jsx)("p",{children:"Loading article..."})]}):c?(0,l.jsx)("div",{className:j().errorContainer,children:(0,l.jsx)("p",{className:j().errorMessage,children:c})}):(0,l.jsx)(h,{articleId:t,children:(0,l.jsx)("article",{className:j().articleContainer,children:(0,l.jsx)(x,{articleId:t,onShare:e=>{if(navigator.share)navigator.share({title:(null==r?void 0:r.title)||"Shared highlight",text:'"'.concat(e,'" - from article ').concat(t),url:window.location.href}).catch(e=>console.error("Error sharing:",e));else{let n='"'.concat(e,'" - from article ').concat(t," ").concat(window.location.href);navigator.clipboard.writeText(n).then(()=>alert("Highlight copied to clipboard!")).catch(e=>console.error("Error copying to clipboard:",e))}},children:(0,l.jsx)("div",{className:j().articleContent,ref:m,dangerouslySetInnerHTML:{__html:n?n.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):(null==r?void 0:r.body)||""}})})})})}},5377:e=>{e.exports={commentSection:"comment_commentSection__SP_jS",commentSectionTitle:"comment_commentSectionTitle__F_Jxe",commentError:"comment_commentError__A2v6U",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",loginPromptContainer:"comment_loginPromptContainer__X4aZr",commentAvatar:"comment_commentAvatar__uav6Q",replyAvatar:"comment_replyAvatar__dIlrw",commentInput:"comment_commentInput__4DHa1",replyInput:"comment_replyInput__8t_ho",commentSubmit:"comment_commentSubmit__UfvUF",replySubmit:"comment_replySubmit__2eCP7",loginButton:"comment_loginButton__4encR",loginModalOverlay:"comment_loginModalOverlay__Pk_AM",loginModal:"comment_loginModal__n984X",loginModalClose:"comment_loginModalClose__v02Rx",loginModalTitle:"comment_loginModalTitle__nZpZB",loginModalText:"comment_loginModalText__XwRn6",loginModalButtons:"comment_loginModalButtons__XdVNl",loginModalButton:"comment_loginModalButton__d8Bnr",primary:"comment_primary__1UIRJ",secondary:"comment_secondary__zc89j",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6",commentsList:"comment_commentsList__ZRMbc",commentItem:"comment_commentItem__Vx48l",commentHeader:"comment_commentHeader__3oOD6",commentUser:"comment_commentUser__QP5pY",commentDate:"comment_commentDate__5zfpn",commentContent:"comment_commentContent__DiE8h",commentActions:"comment_commentActions___Wpzi",commentLikeBtn:"comment_commentLikeBtn__wAYZO",replyToggle:"comment_replyToggle__bCRZg",commentDeleteBtn:"comment_commentDeleteBtn__BnLQc",liked:"comment_liked__2yWZ9",repliesToggle:"comment_repliesToggle__yepDc",repliesToggleIcon:"comment_repliesToggleIcon__EZRkK",open:"comment_open__cpLDc",replySection:"comment_replySection__mAqn4",replyItem:"comment_replyItem__ndhqf",replyHeader:"comment_replyHeader__Y2bUK",replyUser:"comment_replyUser__rw4V8",replyDate:"comment_replyDate__4Jafb",replyContent:"comment_replyContent__uV2jp",replyForm:"comment_replyForm__aYyum",inThread:"comment_inThread__lUoKT",replyButtons:"comment_replyButtons__KRGyv",replyCancel:"comment_replyCancel__od7Vq"}},6016:(e,t,n)=>{"use strict";n.d(t,{A:()=>m});var l=n(5155),i=n(2115),r=n(6874),o=n.n(r),a=n(3201),s=n(6203),c=n(9210),d=n(5377),h=n.n(d);let m=e=>{let{slug:t,articleId:n,isComplex:r}=e,[d,m]=(0,i.useState)([]),[g,u]=(0,i.useState)(!0),[_,p]=(0,i.useState)(""),[x,v]=(0,i.useState)(""),[j,f]=(0,i.useState)(!1),[y,w]=(0,i.useState)(!1),[C,k]=(0,i.useState)(null),[N,b]=(0,i.useState)(""),[A,S]=(0,i.useState)(!1),[P,L]=(0,i.useState)({}),[M,E]=(0,i.useState)(!1),[I,B]=(0,i.useState)(!1),[T,D]=(0,i.useState)(n||null),[H,R]=(0,i.useState)({id:"",name:"Reader"});(0,i.useEffect)(()=>{let e=(0,s.hg)(a.j2,e=>{let t=!!e;if(E(t),t&&e){var n;R({id:e.uid,name:e.displayName||(null==(n=e.email)?void 0:n.split("@")[0])||"User"})}else R({id:"",name:"Reader"})});return()=>e()},[]),(0,i.useEffect)(()=>{if(n)return void D(n);t&&(async()=>{try{let e=await (0,c.l6)(t);e&&e.id&&D(e.id)}catch(e){console.error("Error fetching article:",e),p("Unable to load article details.")}})()},[t,n]),(0,i.useEffect)(()=>{T&&(u(!0),(async()=>{try{let e=await (0,c.fz)(T);setTimeout(()=>{m(e),u(!1)},800)}catch(e){console.error("Error fetching comments:",e),p("Unable to load discussions. Please refresh the page to try again."),u(!1)}})())},[T]);let U=async e=>{if(e.preventDefault(),x.trim()&&!j&&T){if(!M)return void B(!0);try{f(!0);let e=await (0,c.BC)(T,x);m(t=>[e,...t]),v(""),f(!1),w(!1)}catch(e){console.error("Error adding comment:",e),p("Your response could not be posted. Please try again."),f(!1)}}},z=async e=>{if(N.trim()&&!A&&T){if(!M)return void B(!0);try{S(!0);let t=await (0,c.Oe)(T,e,N);m(n=>n.map(n=>n.commentId===e||n.id===e?{...n,replies:[...n.replies||[],t]}:n)),b(""),k(null),S(!1),L(t=>({...t,[e]:!0}))}catch(e){console.error("Error adding reply:",e),S(!1)}}},W=async e=>{if(!M||!T)return void B(!0);try{let t=await (0,c.tT)(T,e);m(n=>n.map(n=>n.commentId===e||n.id===e?{...n,likes:t.likes}:n))}catch(e){console.error("Error liking comment:",e)}},F=async e=>{if(M&&T)try{await (0,c.Tu)(T,e),m(t=>t.filter(t=>t.commentId!==e&&t.id!==e))}catch(e){console.error("Error deleting comment:",e)}},O=e=>{L(t=>({...t,[e]:!t[e]}))},J=e=>{if(!e)return"Unknown date";let t=e.toDate?e.toDate():new Date(e),n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"Just now";if(n<3600){let e=Math.floor(n/60);return"".concat(e," ").concat(1===e?"minute":"minutes"," ago")}if(n<86400){let e=Math.floor(n/3600);return"".concat(e," ").concat(1===e?"hour":"hours"," ago")}if(n<604800){let e=Math.floor(n/86400);return"".concat(e," ").concat(1===e?"day":"days"," ago")}try{return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}catch(e){return console.error("Error formatting date:",e),"Unknown date"}},Z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=(null==e?void 0:e.charAt(0).toUpperCase())||"A",r=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444"],o=t?Math.abs(t.charCodeAt(0)%r.length):0,a=r[o];return(0,l.jsx)("div",{className:n?h().replyAvatar:h().commentAvatar,style:{backgroundColor:a,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:n?"0.9rem":"1.2rem"},children:i})};return(0,l.jsxs)("section",{className:h().commentSection,children:[(0,l.jsx)("h2",{className:h().commentSectionTitle,children:"Join the Discussion"}),_&&(0,l.jsxs)("div",{className:h().commentError,children:[(0,l.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,l.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,l.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,l.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),_]}),(0,l.jsx)("form",{className:h().commentForm,onSubmit:U,children:(0,l.jsx)("div",{className:h().commentInputContainer,style:{opacity:y?1:.85},children:M?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:h().commentAvatar,children:Z(H.name,H.id)}),(0,l.jsx)("textarea",{className:h().commentInput,placeholder:"Share your thoughts...",value:x,onChange:e=>v(e.target.value),onFocus:()=>w(!0),onBlur:()=>{x.trim()||w(!1)}}),(0,l.jsx)("button",{className:h().commentSubmit,type:"submit",disabled:!x.trim()||j,children:j?"Posting...":"Post"})]}):(0,l.jsxs)("div",{className:h().loginPromptContainer,onClick:()=>B(!0),children:[(0,l.jsx)("textarea",{className:h().commentInput,placeholder:"Login to join the discussion...",disabled:!0}),(0,l.jsx)("button",{className:"".concat(h().commentSubmit," ").concat(h().loginButton),type:"button",onClick:()=>B(!0),children:"Login to comment"})]})})}),I&&(0,l.jsx)("div",{className:h().loginModalOverlay,onClick:()=>B(!1),children:(0,l.jsxs)("div",{className:h().loginModal,onClick:e=>e.stopPropagation(),children:[(0,l.jsx)("button",{className:h().loginModalClose,onClick:()=>B(!1),children:"\xd7"}),(0,l.jsx)("h3",{className:h().loginModalTitle,children:"Join the conversation"}),(0,l.jsx)("p",{className:h().loginModalText,children:"Sign in to Journalite to share your thoughts and join the discussion."}),(0,l.jsxs)("div",{className:h().loginModalButtons,children:[(0,l.jsx)(o(),{href:"/login",className:"".concat(h().loginModalButton," ").concat(h().primary),children:"Log In"}),(0,l.jsx)(o(),{href:"/register",className:"".concat(h().loginModalButton," ").concat(h().secondary),children:"Create Account"})]})]})}),g?(0,l.jsxs)("div",{className:h().commentLoading,children:[(0,l.jsx)("p",{children:"Loading comments..."}),(0,l.jsxs)("div",{className:h().loadingDots,children:[(0,l.jsx)("div",{className:h().loadingDot}),(0,l.jsx)("div",{className:h().loadingDot}),(0,l.jsx)("div",{className:h().loadingDot})]})]}):0===d.length?(0,l.jsx)("div",{className:h().noComments,children:"Be the first to share your thoughts on this article."}):(0,l.jsx)("div",{className:h().commentsList,children:d.map(e=>{let t=e.commentId||e.id||"";return(0,l.jsxs)("div",{className:h().commentItem,children:[(0,l.jsxs)("div",{className:h().commentHeader,children:[Z(e.userName,e.userId),(0,l.jsx)("span",{className:h().commentUser,children:e.userName}),(0,l.jsx)("span",{className:h().commentDate,children:J(e.createdAt)})]}),(0,l.jsx)("div",{className:h().commentContent,children:e.content}),(0,l.jsxs)("div",{className:h().commentActions,children:[(0,l.jsxs)("button",{className:"".concat(h().commentLikeBtn," ").concat(e.likes.includes(H.id)?h().liked:""),onClick:()=>W(t),"aria-pressed":e.likes.includes(H.id),"aria-label":e.likes.includes(H.id)?"Unlike comment":"Like comment",children:[e.likes.includes(H.id)?(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,l.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,l.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),(0,l.jsx)("span",{children:e.likes.length>0?e.likes.length:""})]}),(0,l.jsxs)("button",{className:h().replyToggle,onClick:()=>{M?k(C===t?null:t):B(!0)},"aria-label":"Reply to comment",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,l.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})}),(0,l.jsx)("span",{children:"Reply"})]}),e.userId===H.id&&(0,l.jsxs)("button",{className:h().commentDeleteBtn,onClick:()=>F(t),"aria-label":"Delete comment",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,l.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),(0,l.jsx)("span",{children:"Delete"})]})]}),e.replies&&e.replies.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("button",{className:h().repliesToggle,onClick:()=>O(t),children:[(0,l.jsx)("span",{className:"".concat(h().repliesToggleIcon," ").concat(P[t]?h().open:""),children:"▷"}),"".concat(e.replies.length," ").concat(1===e.replies.length?"reply":"replies")]}),P[t]&&(0,l.jsx)("div",{className:h().replySection,children:e.replies.map(e=>(0,l.jsxs)("div",{className:h().replyItem,children:[(0,l.jsxs)("div",{className:h().replyHeader,children:[Z(e.userName,e.userId,!0),(0,l.jsx)("span",{className:h().replyUser,children:e.userName}),(0,l.jsx)("span",{className:h().replyDate,children:J(e.createdAt)})]}),(0,l.jsx)("div",{className:h().replyContent,children:e.content})]},e.replyId))})]}),C===t&&(0,l.jsxs)("div",{className:"".concat(h().replyForm," ").concat(e.replies&&e.replies.length>0?h().inThread:""),children:[(0,l.jsx)("textarea",{className:h().replyInput,placeholder:"Write a reply...",value:N,onChange:e=>b(e.target.value)}),(0,l.jsxs)("div",{className:h().replyButtons,children:[(0,l.jsx)("button",{className:h().replyCancel,onClick:()=>{k(null),b("")},children:"Cancel"}),(0,l.jsx)("button",{className:h().replySubmit,disabled:!N.trim()||A,onClick:()=>z(t),children:A?"Posting...":"Post Reply"})]})]})]},t)})})]})}},7036:e=>{e.exports={articleContainer:"ArticleWithHighlights_articleContainer__r1hgP",articleContent:"ArticleWithHighlights_articleContent__qrFhS",loadingContainer:"ArticleWithHighlights_loadingContainer__6cqbO",loadingIndicator:"ArticleWithHighlights_loadingIndicator__ymNyj",spin:"ArticleWithHighlights_spin__Olepl",errorContainer:"ArticleWithHighlights_errorContainer__njqpS",errorMessage:"ArticleWithHighlights_errorMessage__D4C7O"}},8501:e=>{e.exports={articlePageContainer:"ArticlePage_articlePageContainer__S9vO3",pageHeader:"ArticlePage_pageHeader__LpJc9",headerContainer:"ArticlePage_headerContainer__2_FTv",logoLink:"ArticlePage_logoLink__fMNNv",headerLogo:"ArticlePage_headerLogo__QZCOB",headerActions:"ArticlePage_headerActions__gK7Eo",profileMenu:"ArticlePage_profileMenu__LJeQ0",profileCircle:"ArticlePage_profileCircle__mpTwC",profileDropdown:"ArticlePage_profileDropdown__PnV9R",dropdownItem:"ArticlePage_dropdownItem__Lac2v",authButtons:"ArticlePage_authButtons__R_ANg",loginButton:"ArticlePage_loginButton__kpUQh",signupButton:"ArticlePage_signupButton__EvVWG",pageContainer:"ArticlePage_pageContainer__7QNUg",relatedTagsSection:"ArticlePage_relatedTagsSection__SvZ8y",relatedTagsHeading:"ArticlePage_relatedTagsHeading__Ys9Op",relatedTagsList:"ArticlePage_relatedTagsList__Xn3ds",relatedTag:"ArticlePage_relatedTag__DEwLe",writeButton:"ArticlePage_writeButton__yZp3x",articleHeader:"ArticlePage_articleHeader__LJolV",articleTitle:"ArticlePage_articleTitle__euOmw",articleMeta:"ArticlePage_articleMeta__LXXWl",authorInfo:"ArticlePage_authorInfo__nnMSs",authorAvatar:"ArticlePage_authorAvatar__1S1bM",authorDetails:"ArticlePage_authorDetails__65w4B",authorNameLink:"ArticlePage_authorNameLink__c6fCN",authorName:"ArticlePage_authorName__o2DdL",articleDetails:"ArticlePage_articleDetails__mK6k_",articleActions:"ArticlePage_articleActions__IZLcw",editButton:"ArticlePage_editButton__Yl62q",tagContainer:"ArticlePage_tagContainer__kI5Py",tag:"ArticlePage_tag__F5Z0e",likeButton:"ArticlePage_likeButton__V0q84",liked:"ArticlePage_liked__Mzzkj",likeIcon:"ArticlePage_likeIcon__zOA_O",commentsContainer:"ArticlePage_commentsContainer__rpCTJ",loadingContainer:"ArticlePage_loadingContainer__v7RVf",loadingIndicator:"ArticlePage_loadingIndicator__E2bt3",spin:"ArticlePage_spin__yRZnI",errorContainer:"ArticlePage_errorContainer__pxRgD",errorMessage:"ArticlePage_errorMessage__quACi",editingHeader:"ArticlePage_editingHeader__nzcMi",cancelButton:"ArticlePage_cancelButton__V2ihM"}}}]);