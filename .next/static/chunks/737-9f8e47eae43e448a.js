(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[737],{239:(e,t,n)=>{var r={"./en/index":8021};function o(e){return n(a(e))}function a(e){if(!n.o(r,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return r[e]}o.keys=function(){return Object.keys(r)},o.resolve=a,e.exports=o,o.id=239},326:(e,t,n)=>{"use strict";n.d(t,{Qx:()=>r});let r={joyful:{gradientStart:"#FFD700",gradientEnd:"#FF6B6B",accent:"#FF4757"},angry:{gradientStart:"#FF416C",gradientEnd:"#FF4B2B",accent:"#B71C1C"},energetic:{gradientStart:"#00F260",gradientEnd:"#0575E6",accent:"#1565C0"},peaceful:{gradientStart:"#A8E6CF",gradientEnd:"#88D8C0",accent:"#4CAF50"},reflective:{gradientStart:"#667eea",gradientEnd:"#764ba2",accent:"#5E35B1"},sad:{gradientStart:"#4facfe",gradientEnd:"#00f2fe",accent:"#0288D1"}}},5377:e=>{e.exports={commentSection:"comment_commentSection__SP_jS",commentSectionTitle:"comment_commentSectionTitle__F_Jxe",commentError:"comment_commentError__A2v6U",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",loginPromptContainer:"comment_loginPromptContainer__X4aZr",commentAvatar:"comment_commentAvatar__uav6Q",replyAvatar:"comment_replyAvatar__dIlrw",commentInput:"comment_commentInput__4DHa1",replyInput:"comment_replyInput__8t_ho",commentSubmit:"comment_commentSubmit__UfvUF",replySubmit:"comment_replySubmit__2eCP7",loginButton:"comment_loginButton__4encR",loginModalOverlay:"comment_loginModalOverlay__Pk_AM",loginModal:"comment_loginModal__n984X",loginModalClose:"comment_loginModalClose__v02Rx",loginModalTitle:"comment_loginModalTitle__nZpZB",loginModalText:"comment_loginModalText__XwRn6",loginModalButtons:"comment_loginModalButtons__XdVNl",loginModalButton:"comment_loginModalButton__d8Bnr",primary:"comment_primary__1UIRJ",secondary:"comment_secondary__zc89j",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6",commentsList:"comment_commentsList__ZRMbc",commentItem:"comment_commentItem__Vx48l",commentHeader:"comment_commentHeader__3oOD6",commentUser:"comment_commentUser__QP5pY",commentDate:"comment_commentDate__5zfpn",commentContent:"comment_commentContent__DiE8h",commentActions:"comment_commentActions___Wpzi",commentLikeBtn:"comment_commentLikeBtn__wAYZO",replyToggle:"comment_replyToggle__bCRZg",commentDeleteBtn:"comment_commentDeleteBtn__BnLQc",liked:"comment_liked__2yWZ9",repliesToggle:"comment_repliesToggle__yepDc",repliesToggleIcon:"comment_repliesToggleIcon__EZRkK",open:"comment_open__cpLDc",replySection:"comment_replySection__mAqn4",replyItem:"comment_replyItem__ndhqf",replyHeader:"comment_replyHeader__Y2bUK",replyUser:"comment_replyUser__rw4V8",replyDate:"comment_replyDate__4Jafb",replyContent:"comment_replyContent__uV2jp",replyForm:"comment_replyForm__aYyum",inThread:"comment_inThread__lUoKT",replyButtons:"comment_replyButtons__KRGyv",replyCancel:"comment_replyCancel__od7Vq"}},6016:(e,t,n)=>{"use strict";n.d(t,{A:()=>u});var r=n(5155),o=n(2115),a=n(6874),i=n.n(a),l=n(3201),s=n(6203),c=n(9210),d=n(326),g=n(4814),h=n(5377),p=n.n(h);let u=e=>{let{slug:t,articleId:n,isComplex:a,mood:h="reflective",moodFeatureEnabled:u=!1}=e,[m,x]=(0,o.useState)([]),[f,b]=(0,o.useState)(!0),[y,w]=(0,o.useState)(""),[v,S]=(0,o.useState)(""),[j,_]=(0,o.useState)(!1),[k,C]=(0,o.useState)(!1),[A,E]=(0,o.useState)(null),[F,N]=(0,o.useState)(""),[T,M]=(0,o.useState)(!1),[I,B]=(0,o.useState)({}),[R,z]=(0,o.useState)(!1),[D,L]=(0,o.useState)(!1),[W,Q]=(0,o.useState)(n||null),[P,O]=(0,o.useState)({id:"",name:"Reader"});(0,o.useEffect)(()=>{let e=(0,s.hg)(l.j2,e=>{let t=!!e;if(z(t),t&&e){var n;O({id:e.uid,name:e.displayName||(null==(n=e.email)?void 0:n.split("@")[0])||"User"})}else O({id:"",name:"Reader"})});return()=>e()},[]),(0,o.useEffect)(()=>{if(n)return void Q(n);t&&(async()=>{try{let e=await (0,c.l6)(t);e&&e.id&&Q(e.id)}catch(e){console.error("Error fetching article:",e),w("Unable to load article details.")}})()},[t,n]),(0,o.useEffect)(()=>{W&&(b(!0),(async()=>{try{let e=await (0,c.fz)(W);setTimeout(()=>{x(e),b(!1)},800)}catch(e){console.error("Error fetching comments:",e),w("Unable to load discussions. Please refresh the page to try again."),b(!1)}})())},[W]);let H=async e=>{if(e.preventDefault(),v.trim()&&!j&&W){if(!R)return void L(!0);try{_(!0);let e=await (0,c.BC)(W,v);x(t=>[e,...t]),S(""),_(!1),C(!1)}catch(e){console.error("Error adding comment:",e),w("Your response could not be posted. Please try again."),_(!1)}}},U=async e=>{if(F.trim()&&!T&&W){if(!R)return void L(!0);try{M(!0);let t=await (0,c.Oe)(W,e,F);x(n=>n.map(n=>n.commentId===e||n.id===e?{...n,replies:[...n.replies||[],t]}:n)),N(""),E(null),M(!1),B(t=>({...t,[e]:!0}))}catch(e){console.error("Error adding reply:",e),M(!1)}}},q=async e=>{if(!R||!W)return void L(!0);try{let t=await (0,c.tT)(W,e);x(n=>n.map(n=>n.commentId===e||n.id===e?{...n,likes:t.likes}:n))}catch(e){console.error("Error liking comment:",e)}},Y=async e=>{if(R&&W)try{await (0,c.Tu)(W,e),x(t=>t.filter(t=>t.commentId!==e&&t.id!==e))}catch(e){console.error("Error deleting comment:",e)}},X=e=>{B(t=>({...t,[e]:!t[e]}))},J=e=>{if(!e)return"Unknown date";let t=e.toDate?e.toDate():new Date(e),n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"Just now";if(n<3600){let e=Math.floor(n/60);return"".concat(e," ").concat(1===e?"minute":"minutes"," ago")}if(n<86400){let e=Math.floor(n/3600);return"".concat(e," ").concat(1===e?"hour":"hours"," ago")}if(n<604800){let e=Math.floor(n/86400);return"".concat(e," ").concat(1===e?"day":"days"," ago")}try{return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}catch(e){return console.error("Error formatting date:",e),"Unknown date"}},Z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(null==e?void 0:e.charAt(0).toUpperCase())||"A",a=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444"],i=t?Math.abs(t.charCodeAt(0)%a.length):0,l=a[i];return(0,r.jsx)("div",{className:n?p().replyAvatar:p().commentAvatar,style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:n?"0.9rem":"1.2rem"},children:o})};return(0,r.jsxs)("section",{className:p().commentSection,style:u?{background:"linear-gradient(160deg, \n          rgba(255, 255, 255, 0.1) 0%, \n          ".concat(d.Qx[h].gradientStart,"08 30%, \n          ").concat(d.Qx[h].gradientEnd,"06 70%, \n          rgba(255, 255, 255, 0.05) 100%)"),borderRadius:"32px",border:"1px solid ".concat(d.Qx[h].gradientStart,"12"),boxShadow:"\n          0 8px 32px -8px ".concat(d.Qx[h].gradientStart,"08,\n          inset 0 1px 0 rgba(255, 255, 255, 0.1)\n        "),backdropFilter:"blur(20px) saturate(1.1)",transition:"all 0.8s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden",padding:"2rem"}:{},children:[u&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{style:{position:"absolute",top:"-50%",left:"-50%",right:"-50%",bottom:"-50%",background:"\n                radial-gradient(circle at 30% 20%, ".concat(d.Qx[h].gradientStart,"04, transparent 40%), \n                radial-gradient(circle at 70% 80%, ").concat(d.Qx[h].gradientEnd,"03, transparent 40%),\n                radial-gradient(circle at 20% 70%, ").concat(d.Qx[h].gradientStart,"02, transparent 30%)\n              "),animation:"moodFloat 20s ease-in-out infinite",pointerEvents:"none",zIndex:0}}),(0,r.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,borderRadius:"32px",background:"linear-gradient(45deg, \n                ".concat(d.Qx[h].gradientStart,"05, \n                transparent, \n                ").concat(d.Qx[h].gradientEnd,"05)"),filter:"blur(1px)",opacity:.6,pointerEvents:"none",zIndex:0}})]}),(0,r.jsxs)("div",{style:{position:"relative",zIndex:1},children:[(0,r.jsxs)("h2",{className:p().commentSectionTitle,style:u?{color:d.Qx[h].accent,fontWeight:"600",marginBottom:"1.5rem",textShadow:"0 0 20px ".concat(d.Qx[h].gradientStart,"30, 0 0 40px ").concat(d.Qx[h].gradientStart,"15"),transition:"all 0.3s ease"}:{fontWeight:"600",marginBottom:"1.5rem",color:"#333"},children:[(0,r.jsx)(g.Tw,{size:20,color:u?d.Qx[h].accent:"#333"}),"Join the Discussion"]}),y&&(0,r.jsxs)("div",{className:p().commentError,children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),y]}),(0,r.jsx)("form",{className:p().commentForm,onSubmit:H,children:(0,r.jsx)("div",{className:p().commentInputContainer,style:u?{background:"linear-gradient(135deg, \n              rgba(255, 255, 255, ".concat(k?"0.15":"0.08","), \n              ").concat(d.Qx[h].gradientStart).concat(k?"12":"06",", \n              ").concat(d.Qx[h].gradientEnd).concat(k?"08":"04",")"),border:"1px solid ".concat(d.Qx[h].gradientStart).concat(k?"25":"15"),borderRadius:"24px",boxShadow:k?"0 8px 32px -4px ".concat(d.Qx[h].gradientStart,"20, \n                 inset 0 1px 0 rgba(255, 255, 255, 0.2)"):"0 4px 16px -4px ".concat(d.Qx[h].gradientStart,"10"),backdropFilter:"blur(12px)",transform:k?"translateY(-2px)":"translateY(0)",transition:"all 0.4s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"}:{opacity:k?1:.85,transition:"opacity 0.3s ease"},children:R?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:p().commentAvatar,children:Z(P.name,P.id)}),(0,r.jsx)("textarea",{className:p().commentInput,placeholder:"Share your thoughts...",value:v,onChange:e=>S(e.target.value),onFocus:()=>C(!0),onBlur:()=>{v.trim()||C(!1)},style:u?{background:"rgba(255, 255, 255, 0.1)",border:"none",borderRadius:"20px",color:"#2d3748",fontSize:"1rem",padding:"1rem",resize:"vertical",minHeight:"120px",backdropFilter:"blur(8px)",transition:"all 0.3s ease"}:{}}),(0,r.jsx)("button",{className:p().commentSubmit,type:"submit",disabled:!v.trim()||j,style:u?{background:"linear-gradient(135deg, \n                    ".concat(d.Qx[h].accent,", \n                    ").concat(d.Qx[h].gradientEnd,")"),border:"none",color:"white",borderRadius:"20px",fontWeight:"600",padding:"0.75rem 1.5rem",boxShadow:"0 4px 16px -4px ".concat(d.Qx[h].accent,"40"),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",transform:"translateY(0)",cursor:"pointer"}:{},onMouseEnter:u?e=>{e.currentTarget.disabled||(e.currentTarget.style.transform="translateY(-2px)",e.currentTarget.style.boxShadow="0 8px 24px -4px ".concat(d.Qx[h].accent,"60"))}:void 0,onMouseLeave:u?e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="0 4px 16px -4px ".concat(d.Qx[h].accent,"40")}:void 0,children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.uQ,{size:16,color:"white"}),"Posting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.qx,{size:16,color:"white"}),"Post"]})})]}):(0,r.jsxs)("div",{className:p().loginPromptContainer,onClick:()=>L(!0),children:[(0,r.jsx)("textarea",{className:p().commentInput,placeholder:"Login to join the discussion...",disabled:!0}),(0,r.jsx)("button",{className:"".concat(p().commentSubmit," ").concat(p().loginButton),type:"button",onClick:()=>L(!0),children:"Login to comment"})]})})}),D&&(0,r.jsx)("div",{className:p().loginModalOverlay,onClick:()=>L(!1),children:(0,r.jsxs)("div",{className:p().loginModal,onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("button",{className:p().loginModalClose,onClick:()=>L(!1),children:"\xd7"}),(0,r.jsx)("h3",{className:p().loginModalTitle,children:"Join the conversation"}),(0,r.jsx)("p",{className:p().loginModalText,children:"Sign in to Journalite to share your thoughts and join the discussion."}),(0,r.jsxs)("div",{className:p().loginModalButtons,children:[(0,r.jsx)(i(),{href:"/login",className:"".concat(p().loginModalButton," ").concat(p().primary),children:"Log In"}),(0,r.jsx)(i(),{href:"/register",className:"".concat(p().loginModalButton," ").concat(p().secondary),children:"Create Account"})]})]})}),f?(0,r.jsxs)("div",{className:p().commentLoading,style:u?{background:"linear-gradient(135deg, \n              rgba(255, 255, 255, 0.1), \n              ".concat(d.Qx[h].gradientStart,"06)"),borderRadius:"24px",padding:"2rem",backdropFilter:"blur(10px)",border:"1px solid ".concat(d.Qx[h].gradientStart,"10"),textAlign:"center"}:{},children:[(0,r.jsxs)("p",{style:u?{color:d.Qx[h].accent,fontWeight:"500",marginBottom:"1rem"}:{},children:[(0,r.jsx)(g.uQ,{size:16,color:u?d.Qx[h].accent:"#6b7280"}),"Loading comments..."]}),(0,r.jsxs)("div",{className:p().loadingDots,children:[(0,r.jsx)("div",{className:p().loadingDot,style:u?{background:d.Qx[h].gradientStart}:{}}),(0,r.jsx)("div",{className:p().loadingDot,style:u?{background:d.Qx[h].accent}:{}}),(0,r.jsx)("div",{className:p().loadingDot,style:u?{background:d.Qx[h].gradientEnd}:{}})]})]}):0===m.length?(0,r.jsx)("div",{className:p().noComments,style:u?{background:"linear-gradient(135deg, \n              rgba(255, 255, 255, 0.15) 0%, \n              ".concat(d.Qx[h].gradientStart,"08 50%, \n              ").concat(d.Qx[h].gradientEnd,"06 100%)"),border:"1px solid ".concat(d.Qx[h].gradientStart,"12"),borderRadius:"24px",boxShadow:"\n              0 6px 24px -8px ".concat(d.Qx[h].gradientStart,"10,\n              inset 0 1px 0 rgba(255, 255, 255, 0.12)\n            "),backdropFilter:"blur(12px)",color:d.Qx[h].accent,fontWeight:"500",padding:"2rem",textAlign:"center",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"}:{},children:"Be the first to share your thoughts on this article."}):(0,r.jsx)("div",{className:p().commentsList,children:m.map(e=>{let t=e.commentId||e.id||"";return(0,r.jsxs)("div",{className:p().commentItem,style:u?{background:"linear-gradient(135deg, \n                    rgba(255, 255, 255, 0.12) 0%, \n                    ".concat(d.Qx[h].gradientStart,"06 50%, \n                    ").concat(d.Qx[h].gradientEnd,"04 100%)"),border:"1px solid ".concat(d.Qx[h].gradientStart,"10"),borderRadius:"24px",boxShadow:"\n                    0 4px 20px -6px ".concat(d.Qx[h].gradientStart,"08,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.1)\n                  "),backdropFilter:"blur(10px)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",position:"relative",overflow:"hidden"}:{},onMouseEnter:u?e=>{e.currentTarget.style.transform="translateY(-1px)",e.currentTarget.style.boxShadow="\n                    0 8px 28px -6px ".concat(d.Qx[h].gradientStart,"12,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.15)\n                  ")}:void 0,onMouseLeave:u?e=>{e.currentTarget.style.transform="translateY(0)",e.currentTarget.style.boxShadow="\n                    0 4px 20px -6px ".concat(d.Qx[h].gradientStart,"08,\n                    inset 0 1px 0 rgba(255, 255, 255, 0.1)\n                  ")}:void 0,children:[(0,r.jsxs)("div",{className:p().commentHeader,children:[Z(e.userName,e.userId),(0,r.jsx)("span",{className:p().commentUser,children:e.userName}),(0,r.jsx)("span",{className:p().commentDate,children:J(e.createdAt)})]}),(0,r.jsx)("div",{className:p().commentContent,children:e.content}),(0,r.jsxs)("div",{className:p().commentActions,children:[(0,r.jsxs)("button",{className:"".concat(p().commentLikeBtn," ").concat(e.likes.includes(P.id)?p().liked:""),onClick:()=>q(t),"aria-pressed":e.likes.includes(P.id),"aria-label":e.likes.includes(P.id)?"Unlike comment":"Like comment",children:[e.likes.includes(P.id)?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z"})}),(0,r.jsx)("span",{children:e.likes.length>0?e.likes.length:""})]}),(0,r.jsxs)("button",{className:p().replyToggle,onClick:()=>{R?E(A===t?null:t):L(!0)},"aria-label":"Reply to comment",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3"})}),(0,r.jsx)("span",{children:"Reply"})]}),e.userId===P.id&&(0,r.jsxs)("button",{className:p().commentDeleteBtn,onClick:()=>Y(t),"aria-label":"Delete comment",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",className:"w-4 h-4",children:(0,r.jsx)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0"})}),(0,r.jsx)("span",{children:"Delete"})]})]}),e.replies&&e.replies.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{className:p().repliesToggle,onClick:()=>X(t),children:[(0,r.jsx)("span",{className:"".concat(p().repliesToggleIcon," ").concat(I[t]?p().open:""),children:"▷"}),"".concat(e.replies.length," ").concat(1===e.replies.length?"reply":"replies")]}),I[t]&&(0,r.jsx)("div",{className:p().replySection,children:e.replies.map(e=>(0,r.jsxs)("div",{className:p().replyItem,style:u?{background:"linear-gradient(135deg, \n                                rgba(255, 255, 255, 0.08) 0%, \n                                ".concat(d.Qx[h].gradientStart,"04 50%, \n                                ").concat(d.Qx[h].gradientEnd,"03 100%)"),border:"1px solid ".concat(d.Qx[h].gradientStart,"08"),borderRadius:"20px",boxShadow:"\n                                0 2px 12px -4px ".concat(d.Qx[h].gradientStart,"06,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.08)\n                              "),backdropFilter:"blur(8px)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",margin:"0.75rem 0",padding:"1rem"}:{},onMouseEnter:u?e=>{e.currentTarget.style.transform="translateX(4px)",e.currentTarget.style.boxShadow="\n                                0 4px 16px -4px ".concat(d.Qx[h].gradientStart,"10,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.12)\n                              ")}:void 0,onMouseLeave:u?e=>{e.currentTarget.style.transform="translateX(0)",e.currentTarget.style.boxShadow="\n                                0 2px 12px -4px ".concat(d.Qx[h].gradientStart,"06,\n                                inset 0 1px 0 rgba(255, 255, 255, 0.08)\n                              ")}:void 0,children:[(0,r.jsxs)("div",{className:p().replyHeader,children:[Z(e.userName,e.userId,!0),(0,r.jsx)("span",{className:p().replyUser,children:e.userName}),(0,r.jsx)("span",{className:p().replyDate,children:J(e.createdAt)})]}),(0,r.jsx)("div",{className:p().replyContent,children:e.content})]},e.replyId))})]}),A===t&&(0,r.jsxs)("div",{className:"".concat(p().replyForm," ").concat(e.replies&&e.replies.length>0?p().inThread:""),style:u?{background:"linear-gradient(135deg, \n                        rgba(255, 255, 255, 0.1) 0%, \n                        ".concat(d.Qx[h].gradientStart,"06 50%, \n                        ").concat(d.Qx[h].gradientEnd,"04 100%)"),border:"1px solid ".concat(d.Qx[h].gradientStart,"12"),borderRadius:"20px",boxShadow:"0 3px 16px -4px ".concat(d.Qx[h].gradientStart,"08"),backdropFilter:"blur(10px)",padding:"1.5rem",margin:"1rem 0"}:{},children:[(0,r.jsx)("textarea",{className:p().replyInput,placeholder:"Write a reply...",value:F,onChange:e=>N(e.target.value),style:u?{background:"rgba(255, 255, 255, 0.08)",border:"1px solid ".concat(d.Qx[h].gradientStart,"10"),borderRadius:"16px",backdropFilter:"blur(6px)",color:"#2d3748",padding:"1rem",fontSize:"0.95rem"}:{}}),(0,r.jsxs)("div",{className:p().replyButtons,children:[(0,r.jsx)("button",{className:p().replyCancel,onClick:()=>{E(null),N("")},style:u?{background:"rgba(255, 255, 255, 0.1)",border:"1px solid ".concat(d.Qx[h].gradientStart,"15"),borderRadius:"12px",color:d.Qx[h].accent,padding:"0.5rem 1rem",transition:"all 0.3s ease"}:{},children:"Cancel"}),(0,r.jsx)("button",{className:p().replySubmit,disabled:!F.trim()||T,onClick:()=>U(t),style:u?{background:"linear-gradient(135deg, \n                            ".concat(d.Qx[h].accent,", \n                            ").concat(d.Qx[h].gradientEnd,")"),border:"none",borderRadius:"12px",color:"white",fontWeight:"600",padding:"0.5rem 1rem",boxShadow:"0 2px 8px -2px ".concat(d.Qx[h].accent,"40"),transition:"all 0.3s ease"}:{},children:T?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.uQ,{size:14,color:"white"}),"Posting..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(g.qx,{size:14,color:"white"}),"Post Reply"]})})]})]})]},t)})})]})]})}},6616:(e,t,n)=>{"use strict";n.d(t,{A:()=>B});var r=n(5155),o=n(2115),a=n(3201),i=n(5317);let l=async function(e,t,n,r,o){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"insight";try{let s={articleId:e,userId:t,text:n,prefix:r,suffix:o,tag:l,createdAt:(0,i.serverTimestamp)(),comments:[],reactions:{},userReactions:{}};return(await (0,i.addDoc)((0,i.collection)(a.db,"highlights"),s)).id}catch(e){throw console.error("Error saving highlight:",e),e}},s=async(e,t)=>{try{let n=(0,i.query)((0,i.collection)(a.db,"highlights"),(0,i.where)("articleId","==",e));return t&&(n=(0,i.query)((0,i.collection)(a.db,"highlights"),(0,i.where)("articleId","==",e),(0,i.where)("userId","==",t))),(await (0,i.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting highlights:",e),[]}},c=async e=>{try{await (0,i.deleteDoc)((0,i.doc)(a.db,"highlights",e))}catch(e){throw console.error("Error deleting highlight:",e),e}},d=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.origin;return"".concat(n,"/articles?slug=").concat(e,"#highlight=").concat(t)},g=(0,o.createContext)(void 0),h=e=>{let{children:t,articleId:n}=e,[i,d]=(0,o.useState)([]),[h,p]=(0,o.useState)(!0),[u,m]=(0,o.useState)(null);(0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{m(e)});return()=>e()},[]),(0,o.useEffect)(()=>{(async()=>{if(n&&u){p(!0);try{let e=await s(n,u.uid);d(e)}catch(e){console.error("Error loading highlights:",e)}finally{p(!1)}}else d([]),p(!1)})()},[n,u]);let x=async(e,t,n,r,o)=>{if(!u)return alert("You must be logged in to highlight text"),null;try{let a=await l(r,u.uid,e,t,n,o),i={id:a,articleId:r,userId:u.uid,text:e,prefix:t,suffix:n,tag:o,createdAt:new Date,reactions:{},userReactions:{}};return d(e=>[...e,i]),a}catch(e){return console.error("Error saving highlight:",e),null}},f=async e=>{try{await c(e),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error removing highlight:",e)}};return(0,r.jsx)(g.Provider,{value:{highlights:i,loading:h,saveHighlight:x,removeHighlight:f,highlightElement:(e,t)=>{var n,r,o;try{if(!e.toString())return;let r=document.createElement("mark");r.className="article-highlight highlight-".concat(t);try{e.surroundContents(r)}catch(t){try{let t=e.extractContents();r.appendChild(t),e.insertNode(r)}catch(n){let t=e.cloneContents();r.appendChild(t),e.deleteContents(),e.insertNode(r)}}null==(n=window.getSelection())||n.removeAllRanges()}catch(t){console.error("Error highlighting range:",t),null==(r=window.getSelection())||r.removeAllRanges(),null==(o=window.getSelection())||o.addRange(e)}}},children:t})},p=()=>{let e=(0,o.useContext)(g);if(void 0===e)throw Error("useHighlights must be used within a HighlightProvider");return e};var u=n(4814),m=n(7650);let x=[{tag:"insight",label:"Insight",color:"#3B82F6",icon:u.TG},{tag:"question",label:"Question",color:"#F59E0B",icon:u.Ko},{tag:"quote",label:"Quote",color:"#10B981",icon:u.Tw},{tag:"important",label:"Important",color:"#EF4444",icon:u.Gg}],f=e=>{let{selection:t,onHighlight:n,onResponse:a,onShare:i,onAiAssist:l}=e,[s,c]=(0,o.useState)({top:0,left:0}),[d,g]=(0,o.useState)(!1),[h,p]=(0,o.useState)(!1),u=(0,o.useRef)(null);(0,o.useEffect)(()=>{var e,n;if(!t||t.isCollapsed){g(!1),p(!1);return}let r=t.getRangeAt(0).getBoundingClientRect(),o=window.innerWidth,a=window.innerHeight,i=(null==(e=u.current)?void 0:e.offsetWidth)||280,l=(null==(n=u.current)?void 0:n.offsetHeight)||40,s=r.left+r.width/2;s-i/2<16?s=i/2+16:s+i/2>o-16&&(s=o-i/2-16);let d=r.top-l-10+window.scrollY;if(r.top-l-10<0&&(d=r.bottom+10+window.scrollY),o<=768){let e=window.scrollY,t=window.scrollY+a;d<e+16&&(d=e+16),d+l>t-16&&(d=t-l-16)}c({top:d,left:s}),g(!0)},[t]);let f=e=>{if(t&&!t.isCollapsed){var r;let o=t.getRangeAt(0);n(t.toString(),o,e),null==(r=window.getSelection())||r.removeAllRanges(),g(!1),p(!1)}},b=()=>{p(!h)};return d?(0,m.createPortal)((0,r.jsx)("div",{ref:u,className:"highlight-toolbar",style:{position:"absolute",top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),transform:"translateX(-50%)",zIndex:1e3},children:h?(0,r.jsxs)("div",{className:"highlight-color-options",children:[(0,r.jsx)("span",{className:"highlight-color-label",children:"Choose highlight type:"}),x.map(e=>{let t=e.icon;return(0,r.jsxs)("button",{onClick:()=>f(e.tag),className:"highlight-color-btn",style:{backgroundColor:e.color},title:e.label,children:[(0,r.jsx)("span",{className:"highlight-icon",children:(0,r.jsx)(t,{size:14,color:"white"})}),(0,r.jsx)("span",{className:"highlight-label",children:e.label})]},e.tag)}),(0,r.jsx)("button",{onClick:b,className:"highlight-btn highlight-btn-cancel",children:"Cancel"})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("button",{onClick:b,className:"highlight-btn highlight-btn-main",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,r.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,r.jsx)("span",{children:"Highlight"})]}),a&&(0,r.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&a){var e;a(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),g(!1)}},className:"highlight-btn",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,r.jsx)("span",{children:"Response"})]}),i&&(0,r.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&i){var e;i(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),g(!1)}},className:"highlight-btn",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,r.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,r.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,r.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,r.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,r.jsx)("span",{children:"Share"})]}),l&&(0,r.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&l){var e;l(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),g(!1)}},className:"highlight-btn",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,r.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),(0,r.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"16"})]}),(0,r.jsx)("span",{children:"Journa AI"})]})]})}),document.body):null};var b=n(9576);let y=e=>{let t={prefix:"",suffix:""};if(!e||0===e.rangeCount)return t;let n=e.getRangeAt(0),r=n.toString(),o=n.commonAncestorContainer,a=o.nodeType===Node.TEXT_NODE?o.parentElement:o;if(!a)return t;let i=a.textContent||"",l=i.indexOf(r);if(-1===l){let e=r.replace(/\s+/g," ").trim(),t=i.replace(/\s+/g," ").indexOf(e);-1!==t&&(l=t)}if(-1!==l){let e=Math.max(0,l-50),n=Math.min(i.length,l+r.length+50),o=i.substring(e,l),a=i.substring(l+r.length,n);o=o.replace(/^\S*\s/,""),a=a.replace(/\s\S*$/,""),t.prefix=o,t.suffix=a}return t},w=(e,t)=>{if(!e||!t)return;let n=t.querySelectorAll(".article-highlight"),r=Array.from(n).map(e=>e.getAttribute("data-highlight-id")).filter(Boolean),o=e.map(e=>e.id);if(r.length===o.length&&r.every(e=>o.includes(e)))return;n.forEach(e=>{let t=e.parentNode;if(t){let n=document.createTextNode(e.textContent||"");t.replaceChild(n,e),t.normalize()}});let a=[];if(e.forEach(e=>{let n=((e,n,r)=>{let o,a,i,l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);for(;o=l.nextNode();){let t=(o.textContent||"").indexOf(e);if(-1!==t){let n=document.createRange();return n.setStart(o,t),n.setEnd(o,t+e.length),n}}let s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),c=e=>RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\s+/g,"\\s+"),"i");for(;a=s.nextNode();){let t=a.textContent||"",n=c(e),r=t.match(n);if(r&&void 0!==r.index){let e=document.createRange();return e.setStart(a,r.index),e.setEnd(a,r.index+r[0].length),e}}if(n||r){let o,a=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),i=c(n+e+r);for(;o=a.nextNode();){let t=(o.textContent||"").match(i);if(t&&void 0!==t.index){let r=t[0],a=c(n),i=r.match(a),l=i?i[0].length:0,s=document.createRange(),d=t.index+l,g=c(e),h=r.substring(l).match(g);if(h)return s.setStart(o,d),s.setEnd(o,d+h[0].length),s}}}let d=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),g=(n+e+r).replace(/\s+/g," ").trim();for(;i=d.nextNode();){let t=(i.textContent||"").replace(/\s+/g," ").indexOf(g);if(-1!==t){let r=document.createRange(),o=n.replace(/\s+/g," ").trim().length,a=t+(o>0?o+1:0);return r.setStart(i,a),r.setEnd(i,a+e.replace(/\s+/g," ").trim().length),r}}return null})(e.text,e.prefix||"",e.suffix||"");if(n)try{let t=document.createElement("mark");t.className="article-highlight highlight-".concat(e.tag||"insight"),t.dataset.highlightId=e.id;try{n.surroundContents(t)}catch(r){let e=n.extractContents();t.appendChild(e),n.insertNode(t)}console.log('✅ Applied highlight "'.concat(e.text.substring(0,30),'..." with ID: ').concat(e.id))}catch(t){console.error("Error applying highlight:",t,{text:e.text,id:e.id,tag:e.tag}),a.push(e.id)}else console.warn('❌ Could not find text for highlight: "'.concat(e.text.substring(0,30),'..." with ID: ').concat(e.id)),a.push(e.id)}),a.length>0){console.log("\uD83E\uDDF9 Found ".concat(a.length," highlights that couldn't be applied. These might be from old text formatting."));let e="failed-highlights-".concat(location.pathname),t=JSON.parse(sessionStorage.getItem(e)||"{}");a.forEach(e=>{t[e]=(t[e]||0)+1}),sessionStorage.setItem(e,JSON.stringify(t));let n=Object.entries(t).filter(e=>{let[t,n]=e;return n>=3}).map(e=>{let[t]=e;return t});n.length>0&&(console.log("\uD83D\uDDD1️  Suggesting cleanup of ".concat(n.length," persistently failed highlights")),sessionStorage.getItem("cleanup-notification-".concat(location.pathname))||(console.log("\uD83D\uDD04 Auto-cleaning broken highlights from text format change..."),setTimeout(()=>{n.forEach(async e=>{try{let t=new CustomEvent("cleanup-broken-highlight",{detail:{highlightId:e}});window.dispatchEvent(t)}catch(t){console.error("Failed to cleanup highlight:",e,t)}})},1e3),sessionStorage.setItem("cleanup-notification-".concat(location.pathname),"shown")))}},v=e=>{let{articleId:t,children:n,articleTitle:a="Article",articleSlug:i=""}=e,[l,s]=(0,o.useState)(null),{highlights:c,saveHighlight:g,removeHighlight:h,highlightElement:u}=p(),[m,x]=(0,o.useState)(null),[v,S]=(0,o.useState)(!1),[j,_]=(0,o.useState)(""),[k,C]=(0,o.useState)(!1),[A,E]=(0,o.useState)(""),[F,N]=(0,o.useState)(null),[T,M]=(0,o.useState)(!1),[I,B]=(0,o.useState)(!1),[R,z]=(0,o.useState)({top:0,left:0}),[D,L]=(0,o.useState)(!1),[W,Q]=(0,o.useState)(""),P=(0,o.useCallback)(()=>{B(!0),setTimeout(()=>{M(!1),B(!1)},150)},[]),O=(0,o.useCallback)(()=>{T||setTimeout(()=>{let e=window.getSelection();if(e&&!e.isCollapsed){let n=e.toString(),r=n.trim();if(r&&r.length>0&&n.length<1e3){var t;let n=e.getRangeAt(0).commonAncestorContainer;(n.nodeType===Node.TEXT_NODE?null==(t=n.parentElement)?void 0:t.closest(".article-highlight-container"):null==n?void 0:n.closest(".article-highlight-container"))?s(e):s(null)}else s(null)}else s(null)},100)},[T]),H=(0,o.useCallback)((e,n,r)=>{if(e&&n){let o=y(window.getSelection());g(e,o.prefix,o.suffix,t,r),u(n,r)}},[t,g,u]),U=(0,o.useCallback)(e=>{let t=e.target;if(t.classList.contains("article-highlight")){e.preventDefault(),e.stopPropagation();let n=t.dataset.highlightId,r=t.textContent||"";if(n){B(!1),N({id:n,text:r});let e=t.getBoundingClientRect();z({top:e.top-40+window.scrollY,left:e.left+e.width/2}),M(!0),s(null)}}else T&&(P(),N(null))},[T,P]),q=(0,o.useCallback)(()=>{if(F&&F.id){P();let e=F.id;if(N(null),h(e),m){let t=m.querySelector('[data-highlight-id="'.concat(e,'"]'));if(t&&t.parentNode){let e=document.createTextNode(t.textContent||"");t.parentNode.replaceChild(e,t),t.parentNode.normalize()}}}},[F,h,m,P]),Y=(0,o.useCallback)(e=>{_(e),S(!0)},[]),X=(0,o.useCallback)(e=>{Q(e),L(!0)},[]),J=(0,o.useCallback)(e=>{E(e),C(!0)},[]);(0,o.useEffect)(()=>{document.addEventListener("selectionchange",O);let e=()=>{setTimeout(O,150)};return"ontouchstart"in window&&document.addEventListener("touchend",e),()=>{document.removeEventListener("selectionchange",O),"ontouchstart"in window&&document.removeEventListener("touchend",e)}},[O]),(0,o.useEffect)(()=>{if(m)return m.addEventListener("click",U),()=>{m.removeEventListener("click",U)}},[m,U]),(0,o.useEffect)(()=>{let e=e=>{if(T){let t=e.target;t.closest(".highlight-toolbar")||t.classList.contains("article-highlight")||(P(),N(null))}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[T,P]),(0,o.useEffect)(()=>{if(m){let e=setTimeout(()=>{console.log("\uD83C\uDFA8 Applying ".concat(c.length," highlights to content")),w(c,m)},100);return()=>clearTimeout(e)}},[c,m]),(0,o.useEffect)(()=>{let e=e=>{var t;let n=null==(t=e.detail)?void 0:t.highlightId;n&&(console.log("\uD83D\uDDD1️ Cleaning up broken highlight: ".concat(n)),h(n))};return window.addEventListener("cleanup-broken-highlight",e),()=>{window.removeEventListener("cleanup-broken-highlight",e)}},[h]);let Z=(0,o.useCallback)(e=>{e&&e!==m&&x(e)},[m]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(f,{selection:l,onHighlight:H,onResponse:Y,onShare:X,onAiAssist:J}),T&&F&&(0,r.jsxs)("div",{className:"highlight-toolbar unhighlight-toolbar ".concat(I?"hiding":""),style:{position:"absolute",top:"".concat(R.top,"px"),left:"".concat(R.left,"px"),transform:I?"translateY(-10px) translateX(-50%)":"translateX(-50%)",zIndex:1e3},children:[(0,r.jsxs)("button",{onClick:q,className:"highlight-btn highlight-btn-danger",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),(0,r.jsx)("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),(0,r.jsx)("line",{x1:"12",y1:"9",x2:"18",y2:"15"})]}),(0,r.jsx)("span",{children:"Unhighlight"})]}),(0,r.jsxs)("button",{onClick:()=>{X(F.text),P()},className:"highlight-btn",children:[(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,r.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,r.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,r.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,r.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,r.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,r.jsx)("span",{children:"Share"})]}),(0,r.jsxs)("button",{onClick:()=>{Y(F.text),P()},className:"highlight-btn",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,r.jsx)("span",{children:"Response"})]})]}),(0,r.jsx)("div",{ref:Z,className:"article-highlight-container",children:n}),v&&(0,r.jsx)("div",{className:"highlight-response-modal",children:(0,r.jsxs)("div",{className:"highlight-modal-content",children:[(0,r.jsx)("button",{className:"highlight-modal-close",onClick:()=>S(!1),children:"\xd7"}),(0,r.jsx)("h3",{children:"Respond to highlighted text"}),(0,r.jsxs)("div",{className:"highlight-selected-text",children:['"',j,'"']}),(0,r.jsx)("textarea",{className:"highlight-response-input",placeholder:"Write your response..."}),(0,r.jsx)("button",{className:"highlight-response-submit",children:"Submit"})]})}),k&&(0,r.jsx)("div",{className:"highlight-ai-modal",children:(0,r.jsxs)("div",{className:"highlight-modal-content",children:[(0,r.jsx)("button",{className:"highlight-modal-close",onClick:()=>C(!1),children:"\xd7"}),(0,r.jsx)("h3",{children:"Journa AI"}),(0,r.jsxs)("div",{className:"highlight-selected-text",children:['"',A,'"']}),(0,r.jsxs)("div",{className:"highlight-ai-options",children:[(0,r.jsx)("button",{children:"Explain this"}),(0,r.jsx)("button",{children:"Fact check"}),(0,r.jsx)("button",{children:"Provide context"}),(0,r.jsx)("button",{children:"Summarize"})]}),(0,r.jsx)("div",{className:"highlight-ai-response",children:(0,r.jsx)("div",{className:"highlight-ai-loading",children:"Journa AI is thinking..."})})]})}),D&&(0,r.jsx)(b.A,{isOpen:D,onClose:()=>L(!1),highlightText:W,articleTitle:a,shareUrl:d(i,t)})]})},S=e=>{let{currentMood:t,isVisible:n,moodFeatureEnabled:a}=e,[i,l]=(0,o.useState)(!1),[s,c]=(0,o.useState)(null),[d,g]=(0,o.useState)({colorStops:[{id:"1",color:"#007AFF",x:30,y:40,isSelected:!0}],opacity:80,grain:30,mode:"auto"}),h=(0,o.useRef)(null),p=(0,o.useRef)(null),m=(0,o.useRef)(null),x=e=>{let{colorStops:t,opacity:n,grain:r}=e,o=n/100,a=r/100,i="";if(a>.1){let e=.08*a,t=Math.max(15,25-8*a);i="\n        radial-gradient(ellipse at 12% 18%, rgba(255,255,255,".concat(e,") 3px, transparent ").concat(t,"px),\n        radial-gradient(ellipse at 87% 23%, rgba(0,0,0,").concat(.7*e,") 2px, transparent ").concat(1.2*t,"px),\n        radial-gradient(ellipse at 43% 82%, rgba(255,255,255,").concat(.5*e,") 4px, transparent ").concat(.9*t,"px),\n        radial-gradient(ellipse at 71% 64%, rgba(0,0,0,").concat(.6*e,") 2.5px, transparent ").concat(1.1*t,"px),\n        radial-gradient(ellipse at 29% 57%, rgba(255,255,255,").concat(.4*e,") 3.5px, transparent ").concat(1.3*t,"px),\n        radial-gradient(ellipse at 93% 11%, rgba(0,0,0,").concat(.3*e,") 2px, transparent ").concat(.8*t,"px),\n        radial-gradient(ellipse at 6% 89%, rgba(255,255,255,").concat(.6*e,") 3px, transparent ").concat(1.4*t,"px),\n        radial-gradient(ellipse at 78% 91%, rgba(0,0,0,").concat(.4*e,") 2.5px, transparent ").concat(1.1*t,"px),\n      ")}let l="";if(1===t.length){let e=t[0];l="radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(255*o).toString(16),", transparent 70%)")}else if(2===t.length){let[e,n]=t;l="\n        radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(.7*o*255).toString(16),", transparent 50%),\n        radial-gradient(circle at ").concat(n.x,"% ").concat(n.y,"%, ").concat(n.color).concat(Math.round(.7*o*255).toString(16),", transparent 50%)\n      ")}else if(3===t.length){let[e,n,r]=t;l="\n        radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(.5*o*255).toString(16),", transparent 40%),\n        radial-gradient(circle at ").concat(n.x,"% ").concat(n.y,"%, ").concat(n.color).concat(Math.round(.5*o*255).toString(16),", transparent 40%),\n        radial-gradient(circle at ").concat(r.x,"% ").concat(r.y,"%, ").concat(r.color).concat(Math.round(.5*o*255).toString(16),", transparent 40%)\n      ")}return i?"".concat(i).concat(l):l||"transparent"},f=e=>{let{colorStops:t,opacity:n,grain:r}=e,o=Math.max(.7,n/100),a=r/100,i="";if(a>.3){let e=.04*a;i="\n        radial-gradient(ellipse at 25% 25%, rgba(255,255,255,".concat(e,") 4px, transparent 20px),\n        radial-gradient(ellipse at 75% 75%, rgba(0,0,0,").concat(.5*e,") 3px, transparent 25px),\n        radial-gradient(ellipse at 50% 15%, rgba(255,255,255,").concat(.7*e,") 3.5px, transparent 22px),\n      ")}let l="";if(1===t.length){let e=t[0];l="linear-gradient(135deg, ".concat(e.color).concat(Math.round(255*o).toString(16),", ").concat(e.color).concat(Math.round(.8*o*255).toString(16),")")}else if(2===t.length){let[e,n]=t;l="linear-gradient(135deg, ".concat(e.color).concat(Math.round(255*o).toString(16),", ").concat(n.color).concat(Math.round(255*o).toString(16),")")}else if(3===t.length){let[e,n,r]=t;l="linear-gradient(135deg, ".concat(e.color).concat(Math.round(255*o).toString(16),", ").concat(n.color).concat(Math.round(.9*o*255).toString(16),", ").concat(r.color).concat(Math.round(255*o).toString(16),")")}return i?"".concat(i).concat(l):l||"transparent"},b=e=>{if(!a)return;let t=x(e),n=f(e);document.querySelectorAll("[data-mood-element]").forEach(e=>{e.style.backgroundImage=t,e.style.transition="background-image 0.2s ease"}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.backgroundImage=t,e.style.transition="background-image 0.2s ease"}),console.log("\uD83C\uDFA8 Looking for toggle bar to update...");let r=document.querySelector('[data-toggle-bar="true"]');r?(console.log("\uD83C\uDFA8 Found toggle bar with data attribute:",r),r.style.backgroundImage=n,r.style.transition="background-image 0.2s ease",r.style.backgroundSize="cover",r.style.backgroundPosition="center"):(console.log("\uD83C\uDFA8 Toggle bar with data attribute not found, trying fallback..."),document.querySelectorAll("div").forEach(e=>{let t=e.textContent||"";t.includes("Atmosphere")&&t.includes("Enhanced features")&&t.includes("Mood Background")&&t.includes("Interactive Reflections")&&(console.log("\uD83C\uDFA8 Found toggle bar via text content:",e),e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease",e.style.backgroundSize="cover",e.style.backgroundPosition="center")})),document.querySelectorAll("[data-reflection-bar], [data-mood-bar]").forEach(e=>{e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease",e.style.backgroundSize="cover",e.style.backgroundPosition="center"}),document.querySelectorAll(".progress-bar, .status-bar, .mood-indicator").forEach(e=>{e.style.backgroundImage=n,e.style.transition="background-image 0.2s ease"}),localStorage.setItem("journaColorThemeConfig",JSON.stringify(e))},y=(e,t)=>{e.preventDefault(),c(t),g({...d,colorStops:d.colorStops.map(e=>({...e,isSelected:e.id===t}))})},w=e=>{if(!s||!h.current)return;let t=h.current.getBoundingClientRect(),n=Math.max(5,Math.min(95,(e.clientX-t.left)/t.width*100)),r=Math.max(5,Math.min(95,(e.clientY-t.top)/t.height*100)),o={...d,colorStops:d.colorStops.map(e=>e.id===s?{...e,x:n,y:r}:e)};g(o),b(o)},v=()=>{c(null)},S=e=>{if(!p.current)return;let t=p.current.getBoundingClientRect(),n=Math.max(0,Math.min(100,(e.clientX-t.left)/t.width*100)),r={...d,opacity:n};g(r),b(r)},j=e=>{if(!m.current)return;let t=m.current.getBoundingClientRect(),n=t.left+t.width/2,r=t.top+t.height/2,o=e.clientX-n,a=180/Math.PI*Math.atan2(e.clientY-r,o);(a=(a+270)%360)<0&&(a+=360);let i=Math.round(Math.max(0,Math.min(100,4.166666666666667*Math.round(a/360*100/4.166666666666667))));if(Math.abs(i-d.grain)>.5){navigator.vibrate&&navigator.vibrate(10);let e={...d,grain:i};g(e),b(e)}},_=e=>{if(!d.colorStops.find(e=>e.isSelected))return;let t={...d,colorStops:d.colorStops.map(t=>t.isSelected?{...t,color:e}:t)};g(t),b(t)};if((0,o.useEffect)(()=>{if(s){let e=e=>{"opacity"===s?S(e):"grain"===s?j(e):w(e)};return document.addEventListener("mousemove",e),document.addEventListener("mouseup",v),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",v)}}},[s,d]),(0,o.useEffect)(()=>{let e=localStorage.getItem("journaColorThemeConfig");if(e)try{let t=JSON.parse(e);g(t),b(t)}catch(e){console.error("Failed to load theme config:",e)}},[]),!n||!a)return null;let k=x(d),C=d.colorStops.find(e=>e.isSelected)||d.colorStops[0];return(0,r.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"20px":"40px",left:window.innerWidth<=768?"20px":"40px",zIndex:1e3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,r.jsx)("button",{onClick:()=>l(!i),style:{width:window.innerWidth<=768?"48px":"56px",height:window.innerWidth<=768?"48px":"56px",borderRadius:"50%",border:"none",background:k||"#007AFF",color:"white",fontSize:"20px",cursor:"pointer",boxShadow:i?"0 8px 25px rgba(0, 122, 255, 0.4), 0 0 0 2px rgba(0, 122, 255, 0.2)":"0 6px 20px rgba(0, 122, 255, 0.3)",transform:i?"scale(1.05) rotate(45deg)":"scale(1) rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},title:"Journa Color Editor",children:(0,r.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("defs",{children:(0,r.jsxs)("linearGradient",{id:"iconGradient",x1:"0%",y1:"0%",x2:"100%",y2:"100%",children:[(0,r.jsx)("stop",{offset:"0%",stopColor:"#ffffff",stopOpacity:"0.9"}),(0,r.jsx)("stop",{offset:"100%",stopColor:"#ffffff",stopOpacity:"0.7"})]})}),(0,r.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"url(#iconGradient)"}),(0,r.jsx)("circle",{cx:"16",cy:"12",r:"2.5",fill:"url(#iconGradient)"}),(0,r.jsx)("circle",{cx:"12",cy:"18",r:"2",fill:"url(#iconGradient)"}),(0,r.jsx)("path",{d:"M8 8L16 12M16 12L12 18",stroke:"url(#iconGradient)",strokeWidth:"1.5",strokeLinecap:"round"})]})}),i&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("style",{children:"\n              @keyframes gentleSlideUp {\n                from {\n                  opacity: 0;\n                  transform: translateY(20px) scale(0.98);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0) scale(1);\n                }\n              }\n            "}),(0,r.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"80px":"110px",left:window.innerWidth<=768?"20px":"40px",width:window.innerWidth<=768?"340px":"380px",maxHeight:window.innerWidth<=768?"400px":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:window.innerWidth<=768?"16px":"24px",padding:window.innerWidth<=768?"16px":"24px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",zIndex:999,animation:"gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)",overflow:"hidden"},children:[(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem"},children:[{mode:"auto",icon:u.R9,title:"Auto"},{mode:"light",icon:"☀️",title:"Light"},{mode:"dark",icon:"\uD83C\uDF19",title:"Dark"}].map(e=>{let{mode:t,icon:n,title:o}=e;return(0,r.jsx)("button",{onClick:()=>{let e={...d,mode:t};g(e),b(e)},style:{width:"48px",height:"48px",borderRadius:"12px",border:d.mode===t?"2px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:d.mode===t?"rgba(0, 122, 255, 0.1)":"rgba(0,0,0,0.05)",fontSize:"20px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:o,children:"auto"===t?(0,r.jsx)(u.R9,{size:20,color:d.mode===t?"#007AFF":"#666"}):n},t)})}),(0,r.jsx)("div",{ref:h,style:{width:"100%",height:"180px",borderRadius:"16px",background:"\n                radial-gradient(circle at 50% 50%, rgba(100, 100, 100, 0.1) 0%, transparent 70%),\n                repeating-linear-gradient(0deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),\n                repeating-linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.03) 1px, transparent 1px, transparent 8px),\n                linear-gradient(135deg, #f0f0f0, #e8e8e8)\n              ",position:"relative",cursor:"grab",marginBottom:"1.5rem",border:"1px solid rgba(0,0,0,0.1)",overflow:"hidden"},children:d.colorStops.map(e=>(0,r.jsx)("div",{onMouseDown:t=>y(t,e.id),style:{position:"absolute",top:"".concat(e.y,"%"),left:"".concat(e.x,"%"),transform:"translate(-50%, -50%)",width:e.isSelected?"24px":"20px",height:e.isSelected?"24px":"20px",borderRadius:"50%",background:e.color,border:e.isSelected?"3px solid white":"2px solid white",boxShadow:e.isSelected?"0 4px 12px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.3)",cursor:s===e.id?"grabbing":"grab",transition:s===e.id?"none":"all 0.2s ease",zIndex:e.isSelected?10:5}},e.id))}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,r.jsx)("button",{onClick:()=>{if(d.colorStops.length<=1)return;let e={...d,colorStops:d.colorStops.slice(0,-1)};g(e),b(e)},disabled:d.colorStops.length<=1,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length<=1?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length<=1?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length<=1?.5:1},children:"−"}),(0,r.jsxs)("span",{style:{fontSize:"14px",color:"#666",minWidth:"80px",textAlign:"center"},children:[d.colorStops.length,"/3 colors"]}),(0,r.jsx)("button",{onClick:()=>{if(d.colorStops.length>=3)return;let e={id:Date.now().toString(),color:"#FF6B6B",x:50+15*d.colorStops.length,y:50+10*d.colorStops.length,isSelected:!1},t={...d,colorStops:[...d.colorStops,e]};g(t),b(t)},disabled:d.colorStops.length>=3,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length>=3?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length>=3?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length>=3?.5:1},children:"+"})]}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:["#FFFFFF","#FFB3D9","#B19CD9","#FF6B6B","#FF8E53","#FFD93D","#6BCF7F","#4ECDC4","#45B7D1"].map((e,t)=>(0,r.jsx)("button",{onClick:()=>_(e),style:{width:"32px",height:"32px",borderRadius:"50%",border:C.color===e?"3px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:e,cursor:"pointer",transform:C.color===e?"scale(1.15)":"scale(1)",transition:"all 0.2s ease"}},t))}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem"},children:[(0,r.jsxs)("div",{ref:p,onMouseDown:e=>{e.preventDefault(),c("opacity"),S(e)},style:{flex:1,height:"40px",background:"rgba(0,0,0,0.05)",borderRadius:"20px",position:"relative",cursor:"pointer",display:"flex",alignItems:"center",paddingLeft:"12px",paddingRight:"12px"},children:[(0,r.jsx)("div",{style:{position:"absolute",left:"12px",right:"12px",height:"4px",background:"repeating-linear-gradient(to right, #ccc 0px, #ccc 3px, transparent 3px, transparent 6px)",borderRadius:"2px"}}),(0,r.jsx)("div",{style:{position:"absolute",left:"".concat(12+d.opacity/100*76,"%"),width:"16px",height:"16px",background:"white",borderRadius:"50%",border:"2px solid #007AFF",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",transform:"translateX(-50%)"}})]}),(0,r.jsxs)("div",{ref:m,onMouseDown:e=>{e.preventDefault(),c("grain"),j(e)},style:{width:"60px",height:"60px",borderRadius:"50%",background:"linear-gradient(145deg, #f0f0f0, #d9d9d9)",position:"relative",cursor:"grain"===s?"grabbing":"grab",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"grain"===s?"inset 0 2px 4px rgba(0,0,0,0.2)":"0 2px 4px rgba(0,0,0,0.1)",transition:"grain"===s?"none":"all 0.2s ease"},children:[[0,45,90,135,180,225,270,315].map((e,t)=>(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"2px",height:"6px",background:"rgba(0,0,0,0.3)",borderRadius:"1px",transform:"translate(-50%, -50%) rotate(".concat(e,"deg) translateY(-22px)"),transformOrigin:"center"}},t)),(0,r.jsxs)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"40px",height:"40px",borderRadius:"50%",background:"linear-gradient(145deg, #ffffff, #e8e8e8)",transform:"translate(-50%, -50%)",border:"1px solid rgba(0,0,0,0.1)",boxShadow:"grain"===s?"inset 0 1px 3px rgba(0,0,0,0.2)":"0 1px 3px rgba(0,0,0,0.1)"},children:[(0,r.jsx)("div",{style:{position:"absolute",top:"6px",left:"50%",width:"3px",height:"12px",background:"#007AFF",borderRadius:"1.5px",transform:"translateX(-50%) rotate(".concat(d.grain/100*360,"deg)"),transformOrigin:"50% 14px",transition:"grain"===s?"none":"transform 0.2s ease"}}),(0,r.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",width:"4px",height:"4px",background:"#007AFF",borderRadius:"50%",transform:"translate(-50%, -50%)"}})]}),(0,r.jsxs)("div",{style:{position:"absolute",bottom:"-20px",left:"50%",transform:"translateX(-50%)",fontSize:"10px",color:"#666",fontWeight:"500"},children:[Math.round(d.grain),"%"]})]})]})]})]})]})},j=o.memo(e=>{let{initialEnabled:t=!0,className:n="",style:i={},currentMood:l="joyful"}=e,[s,c]=(0,o.useState)(t),[d,g]=(0,o.useState)(null),[h,p]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(g(e),e){let e=localStorage.getItem("moodFeatureEnabled");if(null!==e){let t=JSON.parse(e);c(t);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;console.log("\uD83C\uDFA8 Applying initial mood state (attempt ".concat(e,"):"),t);let r=document.querySelectorAll("[data-mood-element]");if(console.log("\uD83C\uDFA8 Found mood elements on init:",r.length),0===r.length&&e<5)return void setTimeout(()=>n(e+1),200);r.forEach(e=>{e.style.transition="opacity 0.3s ease, transform 0.3s ease",t?(e.setAttribute("data-mood-active","true"),e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.transform="scale(1)",console.log("\uD83C\uDFA8 Initial show:",e.getAttribute("data-mood-element"))):(e.setAttribute("data-mood-active","false"),e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Initial hide:",e.getAttribute("data-mood-element")))}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",t||(e.style.background="rgba(255, 255, 255, 0.95)",e.style.border="1px solid rgba(0, 0, 0, 0.1)",e.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)")})};setTimeout(()=>n(),100)}else c(!0)}else c(!1)});return()=>e()},[]),d)?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{onClick:()=>{if(console.log("\uD83C\uDFA8 MoodToggle clicked - should NOT trigger parent re-render"),!d)return;p(!0),setTimeout(()=>p(!1),300);let e=!s;c(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e)),console.log("\uD83C\uDFA8 Mood feature toggled to:",e),console.log("\uD83C\uDFA8 Toggle clicked - searching for mood elements...");let t=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=document.querySelectorAll("[data-mood-element]");if(console.log("\uD83C\uDFA8 Found mood elements (attempt ".concat(n,"):"),r.length),0===r.length&&n<3)return void setTimeout(()=>t(n+1),100);r.forEach(t=>{t.style.transition="opacity 0.3s ease, transform 0.3s ease",e?(t.setAttribute("data-mood-active","true"),t.style.display="block",t.style.visibility="visible",t.style.opacity="1",t.style.transform="scale(1)",console.log("\uD83C\uDFA8 Showing mood element:",t.getAttribute("data-mood-element"))):(t.setAttribute("data-mood-active","false"),t.style.opacity="0",t.style.transform="scale(0.95)",console.log("\uD83C\uDFA8 Hiding mood element:",t.getAttribute("data-mood-element")),setTimeout(()=>{"false"===t.getAttribute("data-mood-active")&&(t.style.display="none",t.style.visibility="hidden")},300))})};t(),document.querySelectorAll("[data-mood-header]").forEach(t=>{if(t.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",e){t.style.background="",t.style.border="",t.style.boxShadow="";let e=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=e,console.log("\uD83C\uDFA8 Header mood styling restored - cleared overrides")}else t.setAttribute("data-mood-style",t.style.background),t.style.background="rgba(255, 255, 255, 0.95)",t.style.border="1px solid rgba(0, 0, 0, 0.1)",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)",console.log("\uD83C\uDFA8 Header mood styling removed")}),console.log("\uD83C\uDFA8 Mood backgrounds updated immediately. Enabled:",e)},className:n,style:{...i,transition:"all 0.3s ease",transform:h?"scale(1.1)":"scale(1)"},title:s?"Turn off mood feature":"Turn on mood feature",children:s?"ON":"OFF"}),(0,r.jsx)(S,{currentMood:l,isVisible:!!d,moodFeatureEnabled:s})]}):null}),_=o.memo(e=>{let{articleId:t,className:i="",style:l={}}=e,[s,c]=(0,o.useState)(!1),[d,g]=(0,o.useState)(null),[h,p]=(0,o.useState)(!1),[m,x]=(0,o.useState)(0),[f,b]=(0,o.useState)(""),[y,w]=(0,o.useState)(""),[v,S]=(0,o.useState)(!1),[j,_]=(0,o.useState)(!1),k=["How does this make you feel?","What questions does this raise for you?","How does this connect to your own experiences?","What would you have done differently?","What surprises you most about this?","How might this change your perspective?","What emotions are you experiencing right now?","What does this remind you of?","If you could ask the author one question, what would it be?","How does this challenge your existing beliefs?"],C=()=>k[m%k.length];(0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{g(e)});return()=>e()},[]),(0,o.useEffect)(()=>{s&&!y&&w(C())},[s,m]);let A=()=>{S(!1)},E=async()=>{if(f.trim()&&d){_(!0);try{console.log("Starting reflection submission:",{articleId:t,currentPrompt:y,currentReflection:f,reflectionCount:m});let{saveReflectionResponse:e}=await Promise.resolve().then(n.bind(n,9122));await e(t,"prompt_".concat(Date.now()),y,f,m,!0),console.log("Reflection saved successfully"),x(e=>e+1),b(""),c(!1)}catch(e){console.error("Error saving reflection:",e)}finally{_(!1)}}};return d?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("button",{"data-reflection-element":"floating-button",onClick:()=>{console.log("ReflectionToggle clicked - should NOT trigger parent re-render"),p(!0),setTimeout(()=>p(!1),300),c(!s),s||w(C())},className:i,style:{position:"fixed",bottom:window.innerWidth<=768?"20px":"40px",right:window.innerWidth<=768?"20px":"40px",width:window.innerWidth<=768?"48px":"56px",height:window.innerWidth<=768?"48px":"56px",borderRadius:"50%",background:s?"linear-gradient(135deg, #1d4ed8, #7c3aed)":"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",boxShadow:s?"0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)":"0 6px 20px rgba(59, 130, 246, 0.3)",cursor:"pointer",zIndex:1e3,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",padding:"0",margin:"0",lineHeight:"1",transform:h?"scale(1.1)":s?"scale(1.05)":"scale(1)",backdropFilter:"blur(10px)",...l},title:s?"Close reflection":"Open reflection",children:s?(0,r.jsx)(u.US,{size:14,color:"#ffffff"}):(0,r.jsx)(u.zf,{size:14,color:"#ffffff"})}),s&&(0,r.jsxs)("div",{style:{position:"fixed",bottom:window.innerWidth<=768?"80px":"110px",right:window.innerWidth<=768?"20px":"40px",left:window.innerWidth<=768?"20px":"auto",width:window.innerWidth<=768?"auto":"380px",maxWidth:window.innerWidth<=768?"none":"380px",maxHeight:window.innerWidth<=768?"400px":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:window.innerWidth<=768?"16px":"24px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",zIndex:999,animation:"gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)",padding:window.innerWidth<=768?"16px":"24px",overflow:"hidden"},children:[(0,r.jsx)("style",{children:"\n              @keyframes gentleSlideUp {\n                from {\n                  opacity: 0;\n                  transform: translateY(20px) scale(0.98);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0) scale(1);\n                }\n              }\n            "}),(0,r.jsxs)("div",{style:{marginBottom:"20px",textAlign:"center"},children:[(0,r.jsxs)("h3",{style:{margin:"0 0 12px 0",fontSize:"16px",fontWeight:"600",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,r.jsx)(u.uQ,{size:16,color:"#3b82f6"}),"Time to Reflect"]}),(0,r.jsx)("div",{style:{position:"relative"},children:v?(0,r.jsx)("input",{type:"text",value:y,onChange:e=>w(e.target.value),onBlur:A,onKeyDown:e=>{"Enter"===e.key&&A(),"Escape"===e.key&&(w(C()),S(!1))},autoFocus:!0,style:{width:"100%",padding:"8px 12px",border:"2px solid #3b82f6",borderRadius:"12px",background:"white",fontSize:"14px",textAlign:"center",outline:"none"}}):(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:"8px",flexWrap:"wrap"},children:[(0,r.jsx)("p",{onClick:()=>{S(!0)},style:{margin:0,fontSize:"14px",color:"#64748b",fontWeight:"500",cursor:"pointer",padding:"4px 8px",borderRadius:"8px",transition:"all 0.2s ease"},title:"Click to edit question",children:y}),(0,r.jsx)("button",{onClick:()=>{let e=Math.floor(Math.random()*k.length);w(k[e])},style:{background:"rgba(59, 130, 246, 0.1)",border:"none",borderRadius:"6px",padding:"4px 8px",fontSize:"12px",color:"#3b82f6",cursor:"pointer",fontWeight:"500",display:"flex",alignItems:"center",justifyContent:"center"},title:"Get different question",children:(0,r.jsx)(u.jG,{size:12,color:"#3b82f6"})})]})})]}),(0,r.jsx)("textarea",{value:f,onChange:e=>b(e.target.value),placeholder:"Share your thoughts...",style:{width:"100%",height:"120px",padding:"12px",border:"2px solid #e2e8f0",borderRadius:"12px",background:"white",fontSize:"14px",fontFamily:"inherit",resize:"vertical",outline:"none",transition:"border-color 0.2s ease",marginBottom:"16px"},onFocus:e=>{e.target.style.borderColor="#3b82f6"},onBlur:e=>{e.target.style.borderColor="#e2e8f0"}}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px"},children:[(0,r.jsx)("button",{onClick:()=>c(!1),style:{background:"transparent",border:"2px solid #e2e8f0",borderRadius:"12px",padding:"8px 16px",fontSize:"14px",color:"#64748b",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease"},children:"Cancel"}),(0,r.jsx)("button",{onClick:E,disabled:!f.trim()||j,style:{background:f.trim()?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"#e2e8f0",border:"none",borderRadius:"12px",padding:"8px 20px",fontSize:"14px",color:f.trim()?"white":"#94a3b8",cursor:f.trim()?"pointer":"not-allowed",fontWeight:"600",transition:"all 0.2s ease",opacity:j?.7:1},children:j?"Saving...":"Save Reflection"})]})]})]}):null});var k=n(326);let C=o.memo(e=>{let{className:t="",style:n={}}=e,[i,l]=(0,o.useState)(!0),[s,c]=(0,o.useState)(null),[d,g]=(0,o.useState)(!1),[h]=(0,o.useState)("reflective");return((0,o.useEffect)(()=>{let e=a.j2.onAuthStateChanged(e=>{if(c(e),e){let e=localStorage.getItem("reflectionsEnabled");if(null!==e){let t=JSON.parse(e);l(t),setTimeout(()=>{document.querySelectorAll("[data-reflection-element]").forEach(e=>{e.style.display=t?"":"none"})},100)}else l(!0)}else l(!1)});return()=>e()},[]),s)?(0,r.jsx)("button",{onClick:()=>{if(console.log("ReflectionModeToggle clicked - should NOT trigger parent re-render"),!s)return;g(!0),setTimeout(()=>g(!1),300);let e=!i;l(e),localStorage.setItem("reflectionsEnabled",JSON.stringify(e)),console.log("Reflection mode toggled to:",e),document.querySelectorAll("[data-reflection-element]").forEach(t=>{e?t.style.display="":t.style.display="none"}),window.dispatchEvent(new CustomEvent("reflectionModeToggle",{detail:{enabled:e}}))},className:t,style:{...n,transition:"all 0.3s ease",transform:d?"scale(1.1)":"scale(1)",background:i?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.2)",color:i?k.Qx[h].accent:"#F7FAFC"},title:i?"Turn off reflections":"Turn on reflections",children:i?"ON":"OFF"}):(0,r.jsx)("button",{style:{...n,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"Sign in to use reflections",children:"OFF"})});var A=n(7036),E=n.n(A);async function F(e){let t="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e),n=await fetch(t);if(!n.ok)throw Error("Failed to fetch article: ".concat(n.status," ").concat(n.statusText));return n.json()}var N=n(3241),T=n.n(N);function M(){return(0,o.useEffect)(()=>{let e=document.createElement("script");return e.textContent="\n// Simple syntax highlighting without external dependencies\nfunction highlightCode() {\n  const codeBlocks = document.querySelectorAll('pre code');\n  \n  codeBlocks.forEach(codeBlock => {\n    const pre = codeBlock.parentElement;\n    if (!pre) return;\n    \n    // Apply dark theme\n    pre.style.backgroundColor = '#1e1e1e';\n    pre.style.color = '#d4d4d4';\n    pre.style.border = '1px solid #333';\n    pre.style.borderRadius = '8px';\n    pre.style.padding = '16px';\n    pre.style.fontFamily = \"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace\";\n    pre.style.fontSize = '14px';\n    pre.style.lineHeight = '1.6';\n    pre.style.overflowX = 'auto';\n    pre.style.position = 'relative';\n    \n    const code = codeBlock.textContent || '';\n    let highlightedCode = code;\n    \n    // Simplified highlighting to avoid regex issues\n    try {\n      // Keywords\n      const keywords = ['const', 'let', 'var', 'function', 'class', 'interface', 'type', 'enum', 'import', 'export', 'from', 'as', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'default', 'try', 'catch', 'finally', 'async', 'await', 'new', 'this', 'extends', 'implements', 'private', 'public', 'protected', 'static'];\n      keywords.forEach(keyword => {\n        const regex = new RegExp('\\\\b' + keyword + '\\\\b', 'g');\n        highlightedCode = highlightedCode.replace(regex, '<span style=\"color: #569cd6; font-weight: 500;\">' + keyword + '</span>');\n      });\n      \n      // Simple string highlighting\n      highlightedCode = highlightedCode.replace(/\"([^\"]*)\"/g, '<span style=\"color: #ce9178;\">\"$1\"</span>');\n      highlightedCode = highlightedCode.replace(/'([^']*)'/g, '<span style=\"color: #ce9178;\">'$1'</span>');\n      \n      // Numbers\n      highlightedCode = highlightedCode.replace(/\\b\\d+\\.?\\d*\\b/g, '<span style=\"color: #b5cea8;\">$&</span>');\n      \n      // Comments\n      highlightedCode = highlightedCode.replace(///.*$/gm, '<span style=\"color: #6a9955; font-style: italic;\">$&</span>');\n    } catch (e) {\n      console.warn('Syntax highlighting failed:', e);\n      // Keep original code if highlighting fails\n    }\n    \n    codeBlock.innerHTML = highlightedCode;\n    \n    // Add language indicator if available\n    let language = 'code';\n    const classNames = codeBlock.className.split(' ');\n    for (const className of classNames) {\n      if (className.startsWith('language-')) {\n        language = className.replace('language-', '');\n        break;\n      }\n    }\n    \n    if (pre.hasAttribute('data-language')) {\n      language = pre.getAttribute('data-language');\n    }\n    \n    // Add language badge\n    const badge = document.createElement('div');\n    badge.textContent = language.toUpperCase();\n    badge.style.position = 'absolute';\n    badge.style.top = '8px';\n    badge.style.right = '12px';\n    badge.style.background = 'rgba(255, 255, 255, 0.1)';\n    badge.style.color = '#a0a0a0';\n    badge.style.padding = '2px 8px';\n    badge.style.borderRadius = '4px';\n    badge.style.fontSize = '12px';\n    badge.style.fontWeight = '500';\n    badge.style.letterSpacing = '0.5px';\n    pre.appendChild(badge);\n  });\n}\n\n// Run when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', highlightCode);\n} else {\n  highlightCode();\n}\n\n// Also run on dynamic content changes\nconst observer = new MutationObserver(() => {\n  setTimeout(highlightCode, 100);\n});\n\nobserver.observe(document.body, {\n  childList: true,\n  subtree: true\n});\n",document.head.appendChild(e),()=>{try{document.head.removeChild(e)}catch(e){}}},[]),null}n(8042),n(5802),n(7846),n(1280),n(8496),n(941),n(3523),n(4495),n(1177),n(1990),n(3686),n(642),n(7867),n(3337),n(3435),n(1055),n(2103),n(255),n(9829),n(656);var I=n(7041);let B=e=>{let{articleId:t,initialHtml:n,isAuthenticated:a=!1,articleTitle:i="Article",articleSlug:l=""}=e,[s,c]=(0,o.useState)(null),[d,g]=(0,o.useState)(!n),[p,m]=(0,o.useState)(""),[x,f]=(0,o.useState)("reflective"),b=(0,o.useRef)(null);(0,o.useEffect)(()=>{b.current&&(n||s)&&setTimeout(()=>{b.current&&b.current.querySelectorAll("pre code").forEach(e=>{let t=e.parentElement,n="javascript";for(let t of e.className.split(" "))if(t.startsWith("language-")){n=t.replace("language-","");break}if(t.hasAttribute("data-language")&&(n=t.getAttribute("data-language")),T().languages[n])try{let r=e.textContent||"";e.innerHTML=T().highlight(r,T().languages[n],n),t.setAttribute("data-language",n),t.style.position="relative"}catch(e){console.warn("Syntax highlighting failed for language:",n,e)}})},100)},[n,s]),(0,o.useEffect)(()=>{let e=y();if(e){let t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();t&&f((0,I.H)(t))}},[n,s]),(0,o.useEffect)(()=>{n||s||(async()=>{try{g(!0);let e=await F(t);if(!e)return void m("Article not found");let n="",r=("string"==typeof e.content?e.content:e.content.map(e=>"<p>".concat(e.text,"</p>")).join("\n")).replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");c({title:e.title,body:r})}catch(e){console.error("Error loading article:",e),m("Failed to load article")}finally{g(!1)}})()},[t,s,n]);let y=()=>n?n.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):(null==s?void 0:s.body)||"";return d?(0,r.jsxs)("div",{className:E().loadingContainer,children:[(0,r.jsx)("div",{className:E().loadingIndicator}),(0,r.jsx)("p",{children:"Loading article..."})]}):p?(0,r.jsx)("div",{className:E().errorContainer,children:(0,r.jsx)("p",{className:E().errorMessage,children:p})}):(0,r.jsxs)(h,{articleId:t,children:[(0,r.jsx)(M,{}),(0,r.jsxs)("article",{className:E().articleContainer,children:[(0,r.jsxs)("div",{"data-toggle-bar":"true",style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"1rem",margin:"1rem 0",padding:"1rem",backgroundImage:a?"linear-gradient(270deg, ".concat(k.Qx[x].gradientStart,", ").concat(k.Qx[x].gradientEnd,")"):"linear-gradient(270deg, #9CA3AF, #6B7280)",backgroundSize:"200% 200%",animation:"slideGradient 8s ease infinite alternate",borderRadius:"20px",border:"1px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",fontSize:"0.875rem"},children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.875rem",opacity:.9},children:a?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.cL,{size:16,color:"#F7FAFC"}),"Atmosphere adapted"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.JD,{size:16,color:"#F7FAFC"}),"Sign in for enhanced features"]})}),a&&(0,r.jsxs)("span",{style:{color:"#F7FAFC",fontWeight:"600",fontSize:"0.875rem"},children:[(0,r.jsx)(u.gI,{size:16,color:"#F7FAFC"}),"Enhanced features active"]})]}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Mood Background"}),(0,r.jsx)(j,{style:{padding:"0.4rem 0.8rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),(0,r.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Interactive Reflections"}),(0,r.jsx)(C,{style:{padding:"0.4rem 0.8rem",border:"none",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})]}),(0,r.jsxs)(v,{articleId:t,articleTitle:i,articleSlug:l,onShare:e=>{if(navigator.share)navigator.share({title:(null==s?void 0:s.title)||"Shared highlight",text:'"'.concat(e,'" - from article ').concat(t),url:window.location.href}).catch(e=>console.error("Error sharing:",e));else{let n='"'.concat(e,'" - from article ').concat(t," ").concat(window.location.href);navigator.clipboard.writeText(n).then(()=>alert("Highlight copied to clipboard!")).catch(e=>console.error("Error copying to clipboard:",e))}},children:[(0,r.jsx)("div",{className:E().articleContent,children:(0,r.jsx)("div",{ref:b,dangerouslySetInnerHTML:{__html:y()}})}),(0,r.jsx)(_,{articleId:t})]})]})]})}},7036:e=>{e.exports={articleContainer:"ArticleWithHighlights_articleContainer__r1hgP",articleContent:"ArticleWithHighlights_articleContent__qrFhS",loadingContainer:"ArticleWithHighlights_loadingContainer__6cqbO",loadingIndicator:"ArticleWithHighlights_loadingIndicator__ymNyj",spin:"ArticleWithHighlights_spin__Olepl",errorContainer:"ArticleWithHighlights_errorContainer__njqpS",errorMessage:"ArticleWithHighlights_errorMessage__D4C7O"}},7041:(e,t,n)=>{"use strict";n.d(t,{H:()=>a});var r=n(7347),o=n.n(r);function a(e){let t=new(o())().analyze(e),n=e.toLowerCase(),r=["angry","furious","rage","mad","hate","disgusted","outraged","pissed","frustrated","livid","infuriated","enraged","trump","politician","corrupt","stupid","idiot","terrible","awful","worst","disgusting","pathetic"].filter(e=>n.includes(e)).length,a=["happy","joy","excited","amazing","wonderful","fantastic","great","awesome","brilliant","excellent","perfect","beautiful","love","celebrate","triumph","success","victory","delighted","cheerful","blissful"].filter(e=>n.includes(e)).length,i=["calm","peaceful","serene","tranquil","gentle","soothing","quiet","meditation","zen","harmony","balance","nature","garden","sunset","ocean","mindful","breathe","stillness"].filter(e=>n.includes(e)).length,l=["energy","power","strong","dynamic","intense","passionate","vibrant","bold","fierce","electric","explosive","powerful","charged","pumped","motivated","driven"].filter(e=>n.includes(e)).length,s=["sad","depressed","melancholy","grief","sorrow","tragic","heartbreak","crying","tears","lonely","despair","hopeless","miserable","devastated","broken"].filter(e=>n.includes(e)).length;return r>=2||r>=1&&t.score<-2?"angry":a>=2||a>=1&&t.score>3?"joyful":i>=2||i>=1&&t.score>0?"peaceful":l>=2||l>=1&&Math.abs(t.score)>2?"energetic":s>=2||s>=1&&t.score<-1?"sad":t.score>2?"joyful":t.score<-3?"angry":t.score<-1?"sad":"reflective"}},8501:e=>{e.exports={articlePageContainer:"ArticlePage_articlePageContainer__S9vO3",pageHeader:"ArticlePage_pageHeader__LpJc9",headerContainer:"ArticlePage_headerContainer__2_FTv",logoLink:"ArticlePage_logoLink__fMNNv",headerLogo:"ArticlePage_headerLogo__QZCOB",headerActions:"ArticlePage_headerActions__gK7Eo",profileMenu:"ArticlePage_profileMenu__LJeQ0",profileCircle:"ArticlePage_profileCircle__mpTwC",profileDropdown:"ArticlePage_profileDropdown__PnV9R",dropdownItem:"ArticlePage_dropdownItem__Lac2v",authButtons:"ArticlePage_authButtons__R_ANg",loginButton:"ArticlePage_loginButton__kpUQh",signupButton:"ArticlePage_signupButton__EvVWG",pageContainer:"ArticlePage_pageContainer__7QNUg",relatedTagsSection:"ArticlePage_relatedTagsSection__SvZ8y",relatedTagsHeading:"ArticlePage_relatedTagsHeading__Ys9Op",relatedTagsList:"ArticlePage_relatedTagsList__Xn3ds",relatedTag:"ArticlePage_relatedTag__DEwLe",writeButton:"ArticlePage_writeButton__yZp3x",articleHeader:"ArticlePage_articleHeader__LJolV",articleTitle:"ArticlePage_articleTitle__euOmw",articleMeta:"ArticlePage_articleMeta__LXXWl",authorInfo:"ArticlePage_authorInfo__nnMSs",authorAvatar:"ArticlePage_authorAvatar__1S1bM",authorDetails:"ArticlePage_authorDetails__65w4B",authorNameLink:"ArticlePage_authorNameLink__c6fCN",authorName:"ArticlePage_authorName__o2DdL",articleDetails:"ArticlePage_articleDetails__mK6k_",articleActions:"ArticlePage_articleActions__IZLcw",editButton:"ArticlePage_editButton__Yl62q",tagContainer:"ArticlePage_tagContainer__kI5Py",tag:"ArticlePage_tag__F5Z0e",likeButton:"ArticlePage_likeButton__V0q84",liked:"ArticlePage_liked__Mzzkj",likeIcon:"ArticlePage_likeIcon__zOA_O",commentsContainer:"ArticlePage_commentsContainer__rpCTJ",loadingContainer:"ArticlePage_loadingContainer__v7RVf",loadingIndicator:"ArticlePage_loadingIndicator__E2bt3",spin:"ArticlePage_spin__yRZnI",errorContainer:"ArticlePage_errorContainer__pxRgD",errorMessage:"ArticlePage_errorMessage__quACi",editingHeader:"ArticlePage_editingHeader__nzcMi",cancelButton:"ArticlePage_cancelButton__V2ihM"}},9576:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var r=n(5155),o=n(9137),a=n.n(o),i=n(2115),l=n(4814),s=n(7650);let c=e=>{let{isOpen:t,onClose:n,highlightText:o,articleTitle:c,shareUrl:d}=e,[g,h]=(0,i.useState)(!1);(0,i.useEffect)(()=>{if(g){let e=setTimeout(()=>h(!1),3e3);return()=>clearTimeout(e)}},[g]),(0,i.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]);let p=async()=>{try{await navigator.clipboard.writeText(d),h(!0)}catch(e){console.error("Failed to copy link:",e)}},u=async()=>{if(navigator.share)try{await navigator.share({title:'Highlight from "'.concat(c,'"'),text:'"'.concat(o,'" - from "').concat(c,'"'),url:d}),n()}catch(e){"AbortError"!==e.name&&console.error("Error sharing:",e)}};return t?(0,s.createPortal)((0,r.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem"},onClick:n,className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"2rem",maxWidth:"500px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",position:"relative",animation:"modalSlideIn 0.3s ease-out"},onClick:e=>e.stopPropagation(),className:"jsx-8795408d21c696e",children:[(0,r.jsx)("button",{onClick:n,style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#6B7280",padding:"0.25rem",borderRadius:"0.375rem",transition:"color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.color="#374151",onMouseOut:e=>e.currentTarget.style.color="#6B7280",className:"jsx-8795408d21c696e",children:"\xd7"}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600",color:"#1F2937"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)(l.uQ,{size:20,color:"#3b82f6"}),"Share Highlight"]}),(0,r.jsxs)("p",{style:{margin:0,color:"#6B7280",fontSize:"0.875rem"},className:"jsx-8795408d21c696e",children:['Share this highlight from "',c,'"']})]}),(0,r.jsxs)("div",{style:{backgroundColor:"#F9FAFB",border:"2px solid #E5E7EB",borderRadius:"0.75rem",padding:"1.25rem",marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsxs)("div",{style:{fontSize:"1rem",lineHeight:"1.6",color:"#374151",fontStyle:"italic",marginBottom:"0.75rem"},className:"jsx-8795408d21c696e",children:['"',o,'"']}),(0,r.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6B7280",fontWeight:"500"},className:"jsx-8795408d21c696e",children:['— from "',c,'"']})]}),(0,r.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},className:"jsx-8795408d21c696e",children:"Share Link"}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},className:"jsx-8795408d21c696e",children:[(0,r.jsx)("input",{type:"text",value:d,readOnly:!0,style:{flex:1,padding:"0.75rem",border:"1px solid #D1D5DB",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"#F9FAFB",fontFamily:"monospace"},className:"jsx-8795408d21c696e"}),(0,r.jsx)("button",{onClick:p,style:{padding:"0.75rem 1rem",backgroundColor:g?"#10B981":"#3B82F6",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},className:"jsx-8795408d21c696e",children:g?"✓ Copied!":"\uD83D\uDCCB Copy"})]})]}),(0,r.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},className:"jsx-8795408d21c696e",children:["undefined"!=typeof navigator&&"share"in navigator&&(0,r.jsx)("button",{onClick:u,style:{padding:"0.75rem 1.5rem",backgroundColor:"#6366F1",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease",display:"flex",alignItems:"center",gap:"0.5rem"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#5B21B6",onMouseOut:e=>e.currentTarget.style.backgroundColor="#6366F1",className:"jsx-8795408d21c696e",children:"\uD83D\uDCE4 Share"}),(0,r.jsx)("button",{onClick:n,style:{padding:"0.75rem 1.5rem",backgroundColor:"#F3F4F6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#E5E7EB",onMouseOut:e=>e.currentTarget.style.backgroundColor="#F3F4F6",className:"jsx-8795408d21c696e",children:"Close"})]})]}),(0,r.jsx)(a(),{id:"8795408d21c696e",children:"@-webkit-keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-moz-keyframes modalSlideIn{from{opacity:0;-moz-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-moz-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-o-keyframes modalSlideIn{from{opacity:0;-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);-moz-transform:translatey(-20px)scale(.95);-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);-moz-transform:translatey(0)scale(1);-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}"})]}),document.body):null}}}]);