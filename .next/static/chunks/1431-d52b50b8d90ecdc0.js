(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1431],{239:(e,t,n)=>{var o={"./en/index":8021};function r(e){return n(i(e))}function i(e){if(!n.o(o,e)){var t=Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}r.keys=function(){return Object.keys(o)},r.resolve=i,e.exports=r,r.id=239},326:(e,t,n)=>{"use strict";n.d(t,{Qx:()=>o});let o={joyful:{gradientStart:"#fde047",gradientEnd:"#fb923c",accent:"#f59e0b"},angry:{gradientStart:"#f87171",gradientEnd:"#dc2626",accent:"#ef4444"},energetic:{gradientStart:"#34d399",gradientEnd:"#059669",accent:"#10b981"},peaceful:{gradientStart:"#60a5fa",gradientEnd:"#2563eb",accent:"#3b82f6"},reflective:{gradientStart:"#a78bfa",gradientEnd:"#7c3aed",accent:"#8b5cf6"},sad:{gradientStart:"#94a3b8",gradientEnd:"#475569",accent:"#64748b"},calm:{gradientStart:"#67e8f9",gradientEnd:"#0891b2",accent:"#06b6d4"}}},1780:(e,t,n)=>{"use strict";n.d(t,{J0:()=>o.useState,Kr:()=>o.useMemo,NT:()=>o.useContext,li:()=>o.useRef});var o=n(2115)},3112:(e,t,n)=>{"use strict";n.d(t,{Bi:()=>o.useId,I5:()=>o.useInsertionEffect,NT:()=>o.useContext,li:()=>o.useRef});var o=n(2115)},4570:(e,t,n)=>{"use strict";n.d(t,{Bi:()=>o.useId,Kr:()=>o.useMemo});var o=n(2115)},4655:e=>{e.exports={articleContainer:"ArticleWithHighlights_articleContainer__r1hgP",articleContent:"ArticleWithHighlights_articleContent__qrFhS",loadingContainer:"ArticleWithHighlights_loadingContainer__6cqbO",loadingIndicator:"ArticleWithHighlights_loadingIndicator__ymNyj",spin:"ArticleWithHighlights_spin__Olepl",errorContainer:"ArticleWithHighlights_errorContainer__njqpS",errorMessage:"ArticleWithHighlights_errorMessage__D4C7O"}},5343:(e,t,n)=>{"use strict";n.d(t,{vJ:()=>o.useEffect});var o=n(2115)},5377:e=>{e.exports={commentsSection:"comment_commentsSection__KC0fK",commentsTitle:"comment_commentsTitle__krlPh",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",shimmer:"comment_shimmer__yFSun",commentAvatar:"comment_commentAvatar__uav6Q",commentInput:"comment_commentInput__4DHa1",commentActions:"comment_commentActions___Wpzi",submitButton:"comment_submitButton___27p_",cancelButton:"comment_cancelButton__bKB6k",commentsList:"comment_commentsList__ZRMbc",comment:"comment_comment__wY_Vl",reply:"comment_reply__FQnLh",commentHeader:"comment_commentHeader__3oOD6",commentMeta:"comment_commentMeta__IeyNI",commentAuthor:"comment_commentAuthor__O8AzJ",commentTime:"comment_commentTime__mdqOX",menuButton:"comment_menuButton__zs7Uj",dropdownMenu:"comment_dropdownMenu__4olIU",slideDown:"comment_slideDown__vZmHC",menuItem:"comment_menuItem__uUgeP",commentText:"comment_commentText__3BakE",commentFooter:"comment_commentFooter__fo7oM",likeButton:"comment_likeButton__whcG5",replyButton:"comment_replyButton__WKPlq",liked:"comment_liked__2yWZ9",replyForm:"comment_replyForm__aYyum",replyInputContainer:"comment_replyInputContainer__QKEbE",replyInput:"comment_replyInput__8t_ho",replyActions:"comment_replyActions__fH3sM",repliesContainer:"comment_repliesContainer__VLXBk",editForm:"comment_editForm__VRYuZ",editInput:"comment_editInput__HC1qb",editActions:"comment_editActions__WwgmC",saveButton:"comment_saveButton__OpyI5",loginPromptContainer:"comment_loginPromptContainer__X4aZr",loginButton:"comment_loginButton__4encR",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6"}},5402:(e,t,n)=>{"use strict";n.d(t,{q6:()=>o.createContext});var o=n(2115)},6016:(e,t,n)=>{"use strict";n.d(t,{A:()=>h});var o=n(5155),r=n(2115),i=n(5695),a=n(5112),l=n(6597),s=n(3201),c=n(5377),d=n.n(c),m=n(4814),u=n(8607);n(7041);let h=r.memo(e=>{let{articleId:t,className:n=""}=e,c=(0,i.useRouter)(),[h,g]=(0,r.useState)([]),[p,x]=(0,r.useState)(""),[f,b]=(0,r.useState)(null),[y,_]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[S,j]=(0,r.useState)(null),[C,k]=(0,r.useState)(""),[N,A]=(0,r.useState)(null),[R,E]=(0,r.useState)(""),[F,T]=(0,r.useState)(new Set),[I,B]=(0,r.useState)(!1),[M,L]=(0,r.useState)(0),z=(0,r.useMemo)(()=>({isMobile:M<=768,isTablet:M>768&&M<=1024,isSmallPhone:M<=480,bottomSafeArea:M<=768?120:40}),[M]);(0,r.useEffect)(()=>{let e,t=()=>L(window.innerWidth);t();let n=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(e)}},[]),(0,r.useEffect)(()=>{let e=(0,l.onAuthStateChanged)(s.j2,e=>{b(e),_(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{if(!t)return;let e=(0,a.collection)(s.db,"articles",t,"comments"),n=(0,a.query)(e,(0,a.orderBy)("createdAt","desc")),o=(0,a.onSnapshot)(n,e=>{let t=[];e.forEach(e=>{let n=e.data();t.push({id:e.id,...n})}),g(P(t))});return()=>o()},[t]);let P=(0,r.useCallback)(e=>{let t=e.filter(e=>!e.parentId),n=e.filter(e=>e.parentId);return t.map(e=>({...e,replies:n.filter(t=>t.parentId===e.id).sort((e,t)=>{var n,o;return(null==(n=e.createdAt)?void 0:n.toDate())-(null==(o=t.createdAt)?void 0:o.toDate())})}))},[]),D=(0,r.useMemo)(()=>"calm",[!1,p,C,R]),W=(0,r.useCallback)(async e=>{if(e.preventDefault(),p.trim()&&f&&!v){w(!0);try{let e=(0,a.collection)(s.db,"articles",t,"comments");await (0,a.addDoc)(e,{text:p.trim(),authorId:f.uid,authorName:f.displayName||"Anonymous",authorEmail:f.email||"",createdAt:new Date,likes:[],mood:void 0}),x(""),B(!1)}catch(e){console.error("Error adding comment:",e)}finally{w(!1)}}},[p,f,v,t,D,!1]),H=(0,r.useCallback)(async e=>{if(C.trim()&&f&&!v){w(!0);try{let n=(0,a.collection)(s.db,"articles",t,"comments");await (0,a.addDoc)(n,{text:C.trim(),authorId:f.uid,authorName:f.displayName||"Anonymous",authorEmail:f.email||"",createdAt:new Date,likes:[],parentId:e,mood:void 0}),k(""),j(null)}catch(e){console.error("Error adding reply:",e)}finally{w(!1)}}},[C,f,v,t,!1]),O=(0,r.useCallback)(async(e,n)=>{if(f)try{let o=(0,a.doc)(s.db,"articles",t,"comments",e),r=n.includes(f.uid)?n.filter(e=>e!==f.uid):[...n,f.uid];await (0,a.updateDoc)(o,{likes:r})}catch(e){console.error("Error updating like:",e)}},[f,t]),U=(0,r.useCallback)(async e=>{if(R.trim()&&f&&!v){w(!0);try{let n=(0,a.doc)(s.db,"articles",t,"comments",e);await (0,a.updateDoc)(n,{text:R.trim(),mood:void 0,editedAt:new Date}),A(null),E("")}catch(e){console.error("Error editing comment:",e)}finally{w(!1)}}},[R,f,v,t,!1]),q=(0,r.useCallback)(async e=>{if(f&&!v&&confirm("Are you sure you want to delete this comment?")){w(!0);try{let n=(0,a.doc)(s.db,"articles",t,"comments",e);await (0,a.deleteDoc)(n);let o=(0,a.query)((0,a.collection)(s.db,"articles",t,"comments"),(0,a.where)("parentId","==",e)),r=(await (0,a.getDocs)(o)).docs.map(e=>(0,a.deleteDoc)((0,a.doc)(s.db,"articles",t,"comments",e.id)));await Promise.all(r),T(t=>{let n=new Set(t);return n.delete(e),n})}catch(e){console.error("Error deleting comment:",e)}finally{w(!1)}}},[f,v,t]),J=(0,r.useCallback)(e=>{if(!e)return"Just now";let t=e.toDate?e.toDate():new Date(e),n=Math.floor((new Date().getTime()-t.getTime())/6e4);return n<1?"Just now":n<60?"".concat(n,"m ago"):n<1440?"".concat(Math.floor(n/60),"h ago"):"".concat(Math.floor(n/1440),"d ago")},[]),Y=(0,r.useMemo)(()=>({marginBottom:z.isMobile?"max(".concat(z.bottomSafeArea+40,"px, calc(").concat(z.bottomSafeArea,"px + env(safe-area-inset-bottom)))"):"2rem",paddingBottom:z.isMobile?"20px":"0"}),[z]),X=(0,r.useCallback)(function(e){var t,n,r;let i=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(0,o.jsxs)("div",{className:"".concat(d().comment," ").concat(i?d().reply:""),children:[(0,o.jsxs)("div",{className:d().commentHeader,children:[(0,o.jsx)("div",{className:d().commentAvatar,children:(0,u.d)(e.authorName,e.authorId)}),(0,o.jsxs)("div",{className:d().commentMeta,children:[(0,o.jsx)("span",{className:d().commentAuthor,children:e.authorName}),(0,o.jsx)("span",{className:d().commentTime,children:J(e.createdAt)})]}),(null==f?void 0:f.uid)===e.authorId&&(0,o.jsxs)("div",{className:d().commentActions,children:[(0,o.jsx)("button",{onClick:()=>{let t=new Set(F);F.has(e.id)?t.delete(e.id):t.add(e.id),T(t)},className:d().menuButton,"aria-label":"Comment options",children:(0,o.jsx)(m.Mg,{size:16,color:"#64748b"})}),F.has(e.id)&&(0,o.jsxs)("div",{className:d().dropdownMenu,children:[(0,o.jsxs)("button",{onClick:()=>{A(e.id),E(e.text),T(new Set)},className:d().menuItem,children:[(0,o.jsx)(m.qU,{size:14,color:"#3b82f6"}),"Edit"]}),(0,o.jsxs)("button",{onClick:()=>q(e.id),className:d().menuItem,disabled:v,children:[(0,o.jsx)(m.uc,{size:14,color:"#ef4444"}),"Delete"]})]})]})]}),N===e.id?(0,o.jsxs)("div",{className:d().editForm,children:[(0,o.jsx)("textarea",{value:R,onChange:e=>E(e.target.value),className:"".concat(d().editInput," mobile-optimized-input"),"data-mobile":"true",rows:3,autoFocus:!0}),(0,o.jsxs)("div",{className:d().editActions,children:[(0,o.jsx)("button",{onClick:()=>{A(null),E("")},className:d().cancelButton,disabled:v,children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>U(e.id),className:d().saveButton,disabled:!R.trim()||v,children:v?"Saving...":"Save"})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("p",{className:d().commentText,children:e.text}),(0,o.jsxs)("div",{className:d().commentFooter,children:[(0,o.jsxs)("button",{onClick:()=>O(e.id,e.likes||[]),className:"".concat(d().likeButton," ").concat((null==(t=e.likes)?void 0:t.includes(null==f?void 0:f.uid))?d().liked:""),disabled:!y,children:[(0,o.jsx)(m.C3,{size:14,color:(null==(n=e.likes)?void 0:n.includes(null==f?void 0:f.uid))?"#ef4444":"#64748b"}),(null==(r=e.likes)?void 0:r.length)?e.likes.length:""]}),!i&&(0,o.jsxs)("button",{onClick:()=>j(e.id),className:d().replyButton,disabled:!y,children:[(0,o.jsx)(m.Sb,{size:14,color:"#64748b"}),"Reply"]})]})]}),S===e.id&&(0,o.jsxs)("div",{className:d().replyForm,children:[(0,o.jsxs)("div",{className:d().replyInputContainer,children:[(0,o.jsx)("div",{className:d().commentAvatar,children:(0,u.d)((null==f?void 0:f.displayName)||"User",null==f?void 0:f.uid)}),(0,o.jsx)("textarea",{value:C,onChange:e=>k(e.target.value),placeholder:"Write a reply...",className:"".concat(d().replyInput," mobile-optimized-input"),"data-mobile":"true",rows:2,autoFocus:!0})]}),(0,o.jsxs)("div",{className:d().replyActions,children:[(0,o.jsx)("button",{onClick:()=>{j(null),k("")},className:d().cancelButton,disabled:v,children:"Cancel"}),(0,o.jsx)("button",{onClick:()=>H(e.id),className:d().submitButton,disabled:!C.trim()||v,children:v?"Replying...":"Reply"})]})]}),e.replies&&e.replies.length>0&&(0,o.jsx)("div",{className:d().repliesContainer,children:e.replies.map(e=>X(e,!0))})]},e.id)},[f,F,N,R,S,C,v,y,J,O,q,U,H]);return(0,o.jsxs)("div",{className:"".concat(d().commentsSection," ").concat(n," comment-section"),style:Y,children:[(0,o.jsxs)("h3",{className:d().commentsTitle,children:["Comments (",h.length,")"]}),(0,o.jsx)("form",{className:d().commentForm,onSubmit:W,children:y?(0,o.jsxs)("div",{className:d().commentInputContainer,children:[(0,o.jsx)("div",{className:d().commentAvatar,children:(0,u.d)(f.displayName||f.name,f.uid||f.id)}),(0,o.jsx)("textarea",{className:d().commentInput,placeholder:"Share your thoughts...",value:p,onChange:e=>x(e.target.value),onFocus:()=>B(!0),onBlur:()=>B(!1),rows:4}),(0,o.jsxs)("div",{className:d().commentActions,children:[(0,o.jsx)("button",{type:"button",onClick:()=>x(""),className:d().cancelButton,disabled:v,children:"Cancel"}),(0,o.jsx)("button",{type:"submit",className:d().submitButton,disabled:!p.trim()||v,children:(0,o.jsx)("span",{children:v?"Posting...":"Post Comment"})})]})]}):(0,o.jsxs)("div",{className:d().loginPromptContainer,children:[(0,o.jsx)("h4",{children:"Join the conversation"}),(0,o.jsx)("p",{children:"Please log in to share your thoughts and engage with the community."}),(0,o.jsx)("button",{type:"button",onClick:()=>c.push("/login"),className:d().loginButton,children:"Sign In"})]})}),(0,o.jsx)("div",{className:d().commentsList,children:0===h.length?(0,o.jsxs)("div",{className:d().noComments,children:[(0,o.jsx)("h4",{children:"No comments yet"}),(0,o.jsx)("p",{children:"Be the first to share your thoughts!"})]}):h.map(e=>X(e))})]})})},6648:(e,t,n)=>{"use strict";n.d(t,{d5:()=>o.createPortal});var o=n(7650)},7023:e=>{e.exports={reflectionRoomContainer:"ReflectionRoom_reflectionRoomContainer__6TmAa",backdrop:"ReflectionRoom_backdrop__KGxTG",sidebar:"ReflectionRoom_sidebar__dbvRa",mobileModal:"ReflectionRoom_mobileModal__7pRP5",header:"ReflectionRoom_header__0Ynj_",headerTitle:"ReflectionRoom_headerTitle__sMhoT",closeButton:"ReflectionRoom_closeButton__pqCgf",topicSection:"ReflectionRoom_topicSection__Iywnd",topicLabel:"ReflectionRoom_topicLabel__rhBKQ",topicText:"ReflectionRoom_topicText__tZ6jm",messagesContainer:"ReflectionRoom_messagesContainer__flbBi",messagesList:"ReflectionRoom_messagesList__XdeUo",message:"ReflectionRoom_message__IFqbO",ownMessage:"ReflectionRoom_ownMessage__21F3j",otherMessage:"ReflectionRoom_otherMessage__Azd_Z",messageHeader:"ReflectionRoom_messageHeader__8CyNx",messageHeaderRight:"ReflectionRoom_messageHeaderRight__bkPS2",userName:"ReflectionRoom_userName__B2m8R",messageTime:"ReflectionRoom_messageTime__HmW9V",messageContent:"ReflectionRoom_messageContent__TEe9D",authorMessage:"ReflectionRoom_authorMessage__ywPrb",authorName:"ReflectionRoom_authorName__wHiMA",authorBadge:"ReflectionRoom_authorBadge__uIGSy",messageForm:"ReflectionRoom_messageForm__IStCS",inputContainer:"ReflectionRoom_inputContainer__jICbm",messageInput:"ReflectionRoom_messageInput__xbHQv",sendButton:"ReflectionRoom_sendButton__Op965",characterCount:"ReflectionRoom_characterCount__Pgn4b",authPrompt:"ReflectionRoom_authPrompt__06gaE",loadingState:"ReflectionRoom_loadingState__mCkLq",errorState:"ReflectionRoom_errorState__lLBS3",emptyState:"ReflectionRoom_emptyState__O3Cs7",sendingSpinner:"ReflectionRoom_sendingSpinner__As_2t",spin:"ReflectionRoom_spin__9rYOC",loadingSpinner:"ReflectionRoom_loadingSpinner__dqZv4",emptyIcon:"ReflectionRoom_emptyIcon__jEtSv",reflectionSearchBar:"ReflectionRoom_reflectionSearchBar__pUXJI",reflectionSearchWrapper:"ReflectionRoom_reflectionSearchWrapper__CbCn1",focused:"ReflectionRoom_focused__LOk9v","holographic-shine":"ReflectionRoom_holographic-shine__YGlYP",reflectionIcon:"ReflectionRoom_reflectionIcon__UzCmu",reflectionText:"ReflectionRoom_reflectionText__vB9qw",reflectionLabel:"ReflectionRoom_reflectionLabel__7f_Nj",reflectionTopic:"ReflectionRoom_reflectionTopic__eWDD4",reflectionJoin:"ReflectionRoom_reflectionJoin__U6Usf",reflectionUnread:"ReflectionRoom_reflectionUnread__a6Wc7",reflectionJoinText:"ReflectionRoom_reflectionJoinText__4Z582",reflectionArrow:"ReflectionRoom_reflectionArrow__ST2X_",deleteButton:"ReflectionRoom_deleteButton___BxTC",deleteSpinner:"ReflectionRoom_deleteSpinner__rLa7d",messageDeleting:"ReflectionRoom_messageDeleting__z62yB"}},7041:(e,t,n)=>{"use strict";n.d(t,{H:()=>i});var o=n(7347),r=n.n(o);function i(e){let t=new(r())().analyze(e),n=e.toLowerCase(),o=["angry","furious","rage","mad","hate","disgusted","outraged","pissed","frustrated","livid","infuriated","enraged","trump","politician","corrupt","stupid","idiot","terrible","awful","worst","disgusting","pathetic"].filter(e=>n.includes(e)).length,i=["happy","joy","excited","amazing","wonderful","fantastic","great","awesome","brilliant","excellent","perfect","beautiful","love","celebrate","triumph","success","victory","delighted","cheerful","blissful"].filter(e=>n.includes(e)).length,a=["calm","peaceful","serene","tranquil","gentle","soothing","quiet","meditation","zen","harmony","balance","nature","garden","sunset","ocean","mindful","breathe","stillness"].filter(e=>n.includes(e)).length,l=["energy","power","strong","dynamic","intense","passionate","vibrant","bold","fierce","electric","explosive","powerful","charged","pumped","motivated","driven"].filter(e=>n.includes(e)).length,s=["sad","depressed","melancholy","grief","sorrow","tragic","heartbreak","crying","tears","lonely","despair","hopeless","miserable","devastated","broken"].filter(e=>n.includes(e)).length;return o>=2||o>=1&&t.score<-2?"angry":i>=2||i>=1&&t.score>3?"joyful":a>=2||a>=1&&t.score>0?"peaceful":l>=2||l>=1&&Math.abs(t.score)>2?"energetic":s>=2||s>=1&&t.score<-1?"sad":t.score>2?"joyful":t.score<-3?"angry":t.score<-1?"sad":"reflective"}},8501:e=>{e.exports={articlePageContainer:"ArticlePage_articlePageContainer__S9vO3",pageHeader:"ArticlePage_pageHeader__LpJc9",headerContainer:"ArticlePage_headerContainer__2_FTv",logoLink:"ArticlePage_logoLink__fMNNv",headerLogo:"ArticlePage_headerLogo__QZCOB",headerActions:"ArticlePage_headerActions__gK7Eo",profileMenu:"ArticlePage_profileMenu__LJeQ0",profileCircle:"ArticlePage_profileCircle__mpTwC",profileDropdown:"ArticlePage_profileDropdown__PnV9R",dropdownItem:"ArticlePage_dropdownItem__Lac2v",authButtons:"ArticlePage_authButtons__R_ANg",loginButton:"ArticlePage_loginButton__kpUQh",signupButton:"ArticlePage_signupButton__EvVWG",pageContainer:"ArticlePage_pageContainer__7QNUg",relatedTagsSection:"ArticlePage_relatedTagsSection__SvZ8y",relatedTagsHeading:"ArticlePage_relatedTagsHeading__Ys9Op",relatedTagsList:"ArticlePage_relatedTagsList__Xn3ds",relatedTag:"ArticlePage_relatedTag__DEwLe",writeButton:"ArticlePage_writeButton__yZp3x",articleHeader:"ArticlePage_articleHeader__LJolV",articleHeaderWithReaders:"ArticlePage_articleHeaderWithReaders__Ni9rZ",titleSection:"ArticlePage_titleSection__fYdJv",readersSection:"ArticlePage_readersSection__SRec1",articleTitle:"ArticlePage_articleTitle__euOmw",articleMeta:"ArticlePage_articleMeta__LXXWl",authorInfo:"ArticlePage_authorInfo__nnMSs",authorAvatar:"ArticlePage_authorAvatar__1S1bM",authorDetails:"ArticlePage_authorDetails__65w4B",authorNameLink:"ArticlePage_authorNameLink__c6fCN",authorName:"ArticlePage_authorName__o2DdL",articleDetails:"ArticlePage_articleDetails__mK6k_",articleActions:"ArticlePage_articleActions__IZLcw",editButton:"ArticlePage_editButton__Yl62q",tagContainer:"ArticlePage_tagContainer__kI5Py",tag:"ArticlePage_tag__F5Z0e",likeButton:"ArticlePage_likeButton__V0q84",liked:"ArticlePage_liked__Mzzkj",likeIcon:"ArticlePage_likeIcon__zOA_O",commentsContainer:"ArticlePage_commentsContainer__rpCTJ",loadingContainer:"ArticlePage_loadingContainer__v7RVf",loadingIndicator:"ArticlePage_loadingIndicator__E2bt3",spin:"ArticlePage_spin__yRZnI",errorContainer:"ArticlePage_errorContainer__pxRgD",errorMessage:"ArticlePage_errorMessage__quACi",editingHeader:"ArticlePage_editingHeader__nzcMi",cancelButton:"ArticlePage_cancelButton__V2ihM",articleContent:"ArticlePage_articleContent__NWe57",backLink:"ArticlePage_backLink__Cfs_B",moodControls:"ArticlePage_moodControls__iU3JZ",moodToggleButton:"ArticlePage_moodToggleButton__U3y0U",shareButton:"ArticlePage_shareButton__IgaGg"}},8593:(e,t,n)=>{"use strict";n.d(t,{NT:()=>o.useContext,Rf:()=>o.forwardRef});var o=n(2115)},8607:(e,t,n)=>{"use strict";n.d(t,{I:()=>i,d:()=>r});var o=n(2115);let r=function(e,t){var n;let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=(null==e||null==(n=e.charAt(0))?void 0:n.toUpperCase())||"A",a=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444","#8b5cf6","#06b6d4","#84cc16"],l=t?Math.abs(t.charCodeAt(0)%a.length):0,s=a[l];return o.createElement("div",{style:{backgroundColor:s,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:r?"0.8rem":"1rem",width:r?"32px":"40px",height:r?"32px":"40px",borderRadius:"50%",flexShrink:0}},i)},i=(e,t)=>{var n,o;return((null==e||null==(n=e.charAt(0))?void 0:n.toUpperCase())||"")+((null==t||null==(o=t.charAt(0))?void 0:o.toUpperCase())||"")||"U"}},8660:(e,t,n)=>{"use strict";n.d(t,{NT:()=>o.useContext,uA:()=>o.Component});var o=n(2115)},9547:(e,t,n)=>{"use strict";n.d(t,{A:()=>J});var o=n(5155),r=n(2115),i=n(3201),a=n(5112);let l=async function(e,t,n,o,r){let l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"insight";try{let s={articleId:e,userId:t,text:n,prefix:o,suffix:r,tag:l,createdAt:(0,a.serverTimestamp)(),comments:[],reactions:{},userReactions:{}};return(await (0,a.addDoc)((0,a.collection)(i.db,"highlights"),s)).id}catch(e){throw console.error("Error saving highlight:",e),e}},s=async(e,t)=>{try{let n=(0,a.query)((0,a.collection)(i.db,"highlights"),(0,a.where)("articleId","==",e));return t&&(n=(0,a.query)((0,a.collection)(i.db,"highlights"),(0,a.where)("articleId","==",e),(0,a.where)("userId","==",t))),(await (0,a.getDocs)(n)).docs.map(e=>({id:e.id,...e.data()}))}catch(e){return console.error("Error getting highlights:",e),[]}},c=async e=>{try{await (0,a.deleteDoc)((0,a.doc)(i.db,"highlights",e))}catch(e){throw console.error("Error deleting highlight:",e),e}},d=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window.location.origin;return"".concat(n,"/articles?slug=").concat(e,"#highlight=").concat(t)},m=(0,r.createContext)(void 0),u=e=>{let{children:t,articleId:n}=e,[a,d]=(0,r.useState)([]),[u,h]=(0,r.useState)(!0),[g,p]=(0,r.useState)(null);(0,r.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{p(e)});return()=>e()},[]),(0,r.useEffect)(()=>{(async()=>{if(n&&g){h(!0);try{let e=await s(n,g.uid);d(e)}catch(e){console.error("Error loading highlights:",e)}finally{h(!1)}}else d([]),h(!1)})()},[n,g]);let x=async(e,t,n,o,r)=>{if(!g)return alert("You must be logged in to highlight text"),null;try{let i=await l(o,g.uid,e,t,n,r),a={id:i,articleId:o,userId:g.uid,text:e,prefix:t,suffix:n,tag:r,createdAt:new Date,reactions:{},userReactions:{}};return d(e=>[...e,a]),i}catch(e){return console.error("Error saving highlight:",e),null}},f=async e=>{try{await c(e),d(t=>t.filter(t=>t.id!==e))}catch(e){console.error("Error removing highlight:",e)}};return(0,o.jsx)(m.Provider,{value:{highlights:a,loading:u,saveHighlight:x,removeHighlight:f,highlightElement:(e,t)=>{var n,o,r;try{if(!e.toString())return;let o=document.createElement("mark");o.className="article-highlight highlight-".concat(t);try{e.surroundContents(o)}catch(t){try{let t=e.extractContents();o.appendChild(t),e.insertNode(o)}catch(n){let t=e.cloneContents();o.appendChild(t),e.deleteContents(),e.insertNode(o)}}null==(n=window.getSelection())||n.removeAllRanges()}catch(t){console.error("Error highlighting range:",t),null==(o=window.getSelection())||o.removeAllRanges(),null==(r=window.getSelection())||r.addRange(e)}}},children:t})},h=()=>{let e=(0,r.useContext)(m);if(void 0===e)throw Error("useHighlights must be used within a HighlightProvider");return e};var g=n(4814),p=n(6648);let x=[{tag:"insight",label:"Insight",color:"#3B82F6",icon:g.TG},{tag:"question",label:"Question",color:"#F59E0B",icon:g.Ko},{tag:"quote",label:"Quote",color:"#10B981",icon:g.Tw},{tag:"important",label:"Important",color:"#EF4444",icon:g.Gg}],f=e=>{let{selection:t,onHighlight:n,onResponse:i,onShare:a,onAiAssist:l}=e,[s,c]=(0,r.useState)({top:0,left:0}),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),g=(0,r.useRef)(null);(0,r.useEffect)(()=>{var e,n;if(!t||t.isCollapsed){m(!1),h(!1);return}let o=t.getRangeAt(0).getBoundingClientRect(),r=window.innerWidth,i=window.innerHeight,a=(null==(e=g.current)?void 0:e.offsetWidth)||280,l=(null==(n=g.current)?void 0:n.offsetHeight)||40,s=o.left+o.width/2;s-a/2<16?s=a/2+16:s+a/2>r-16&&(s=r-a/2-16);let d=o.top-l-10+window.scrollY;if(o.top-l-10<0&&(d=o.bottom+10+window.scrollY),r<=768){let e=window.scrollY,t=window.scrollY+i;d<e+16&&(d=e+16),d+l>t-16&&(d=t-l-16)}c({top:d,left:s}),m(!0)},[t]);let f=e=>{if(t&&!t.isCollapsed){var o;let r=t.getRangeAt(0);n(t.toString(),r,e),null==(o=window.getSelection())||o.removeAllRanges(),m(!1),h(!1)}},b=()=>{h(!u)};return d?(0,p.d5)((0,o.jsx)("div",{ref:g,className:"highlight-toolbar",style:{position:"absolute",top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),transform:"translateX(-50%)",zIndex:1e3},children:u?(0,o.jsxs)("div",{className:"highlight-color-options",children:[(0,o.jsx)("span",{className:"highlight-color-label",children:"Choose highlight type:"}),x.map(e=>{let t=e.icon;return(0,o.jsxs)("button",{onClick:()=>f(e.tag),className:"highlight-color-btn",style:{backgroundColor:e.color},title:e.label,children:[(0,o.jsx)("span",{className:"highlight-icon",children:(0,o.jsx)(t,{size:14,color:"white"})}),(0,o.jsx)("span",{className:"highlight-label",children:e.label})]},e.tag)}),(0,o.jsx)("button",{onClick:b,className:"highlight-btn highlight-btn-cancel",children:"Cancel"})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{onClick:b,className:"highlight-btn highlight-btn-main",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"}),(0,o.jsx)("path",{d:"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"})]}),(0,o.jsx)("span",{children:"Highlight"})]}),i&&(0,o.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&i){var e;i(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),m(!1)}},className:"highlight-btn",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,o.jsx)("span",{children:"Response"})]}),a&&(0,o.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&a){var e;a(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),m(!1)}},className:"highlight-btn",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,o.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,o.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,o.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,o.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,o.jsx)("span",{children:"Share"})]}),l&&(0,o.jsxs)("button",{onClick:()=>{if(t&&!t.isCollapsed&&l){var e;l(t.toString()),null==(e=window.getSelection())||e.removeAllRanges(),m(!1)}},className:"highlight-btn",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("rect",{x:"3",y:"3",width:"18",height:"18",rx:"2",ry:"2"}),(0,o.jsx)("line",{x1:"8",y1:"12",x2:"16",y2:"12"}),(0,o.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"16"})]}),(0,o.jsx)("span",{children:"Journa AI"})]})]})}),document.body):null};var b=n(9576);let y=e=>{let t={prefix:"",suffix:""};if(!e||0===e.rangeCount)return t;let n=e.getRangeAt(0),o=n.toString(),r=n.commonAncestorContainer,i=r.nodeType===Node.TEXT_NODE?r.parentElement:r;if(!i)return t;let a=i.textContent||"",l=a.indexOf(o);if(-1===l){let e=o.replace(/\s+/g," ").trim(),t=a.replace(/\s+/g," ").indexOf(e);-1!==t&&(l=t)}if(-1!==l){let e=Math.max(0,l-50),n=Math.min(a.length,l+o.length+50),r=a.substring(e,l),i=a.substring(l+o.length,n);r=r.replace(/^\S*\s/,""),i=i.replace(/\s\S*$/,""),t.prefix=r,t.suffix=i}return t},_=(e,t)=>{if(!e||!t)return;let n=t.querySelectorAll(".article-highlight"),o=Array.from(n).map(e=>e.getAttribute("data-highlight-id")).filter(Boolean),r=e.map(e=>e.id);if(o.length===r.length&&o.every(e=>r.includes(e)))return;n.forEach(e=>{let t=e.parentNode;if(t){let n=document.createTextNode(e.textContent||"");t.replaceChild(n,e),t.normalize()}});let i=[];if(e.forEach(e=>{let n=((e,n,o)=>{let r,i,a,l=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null);for(;r=l.nextNode();){let t=(r.textContent||"").indexOf(e);if(-1!==t){let n=document.createRange();return n.setStart(r,t),n.setEnd(r,t+e.length),n}}let s=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),c=e=>RegExp(e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/\s+/g,"\\s+"),"i");for(;i=s.nextNode();){let t=i.textContent||"",n=c(e),o=t.match(n);if(o&&void 0!==o.index){let e=document.createRange();return e.setStart(i,o.index),e.setEnd(i,o.index+o[0].length),e}}if(n||o){let r,i=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),a=c(n+e+o);for(;r=i.nextNode();){let t=(r.textContent||"").match(a);if(t&&void 0!==t.index){let o=t[0],i=c(n),a=o.match(i),l=a?a[0].length:0,s=document.createRange(),d=t.index+l,m=c(e),u=o.substring(l).match(m);if(u)return s.setStart(r,d),s.setEnd(r,d+u[0].length),s}}}let d=document.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),m=(n+e+o).replace(/\s+/g," ").trim();for(;a=d.nextNode();){let t=(a.textContent||"").replace(/\s+/g," ").indexOf(m);if(-1!==t){let o=document.createRange(),r=n.replace(/\s+/g," ").trim().length,i=t+(r>0?r+1:0);return o.setStart(a,i),o.setEnd(a,i+e.replace(/\s+/g," ").trim().length),o}}return null})(e.text,e.prefix||"",e.suffix||"");if(n)try{let t=document.createElement("mark");t.className="article-highlight highlight-".concat(e.tag||"insight"),t.dataset.highlightId=e.id;try{n.surroundContents(t)}catch(o){let e=n.extractContents();t.appendChild(e),n.insertNode(t)}}catch(t){console.error("Error applying highlight:",t,{text:e.text,id:e.id,tag:e.tag}),i.push(e.id)}else console.warn('❌ Could not find text for highlight: "'.concat(e.text.substring(0,30),'..." with ID: ').concat(e.id)),i.push(e.id)}),i.length>0){let e="failed-highlights-".concat(location.pathname),t=JSON.parse(sessionStorage.getItem(e)||"{}");i.forEach(e=>{t[e]=(t[e]||0)+1}),sessionStorage.setItem(e,JSON.stringify(t));let n=Object.entries(t).filter(e=>{let[t,n]=e;return n>=3}).map(e=>{let[t]=e;return t});n.length>0&&(sessionStorage.getItem("cleanup-notification-".concat(location.pathname))||(setTimeout(()=>{n.forEach(async e=>{try{let t=new CustomEvent("cleanup-broken-highlight",{detail:{highlightId:e}});window.dispatchEvent(t)}catch(t){console.error("Failed to cleanup highlight:",e,t)}})},1e3),sessionStorage.setItem("cleanup-notification-".concat(location.pathname),"shown")))}},v=e=>{let{articleId:t,children:n,articleTitle:i="Article",articleSlug:a=""}=e,[l,s]=(0,r.useState)(null),{highlights:c,saveHighlight:m,removeHighlight:u,highlightElement:g}=h(),[p,x]=(0,r.useState)(null),[v,w]=(0,r.useState)(!1),[S,j]=(0,r.useState)(""),[C,k]=(0,r.useState)(!1),[N,A]=(0,r.useState)(""),[R,E]=(0,r.useState)(null),[F,T]=(0,r.useState)(!1),[I,B]=(0,r.useState)(!1),[M,L]=(0,r.useState)({top:0,left:0}),[z,P]=(0,r.useState)(!1),[D,W]=(0,r.useState)(""),H=(0,r.useCallback)(()=>{B(!0),setTimeout(()=>{T(!1),B(!1)},150)},[]),O=(0,r.useCallback)(()=>{if(F)return;let e=window.getSelection();if(e&&!e.isCollapsed){let n=e.toString(),o=n.trim();if(o&&o.length>0&&n.length<1e3){var t;let n=e.getRangeAt(0).commonAncestorContainer;(n.nodeType===Node.TEXT_NODE?null==(t=n.parentElement)?void 0:t.closest(".article-highlight-container"):null==n?void 0:n.closest(".article-highlight-container"))?s(e):s(null)}else s(null)}else s(null)},[F]),U=(0,r.useCallback)((e,n,o)=>{if(e&&n){let r=y(window.getSelection());m(e,r.prefix,r.suffix,t,o),g(n,o)}},[t,m,g]),q=(0,r.useCallback)(e=>{let t=e.target;if(t.classList.contains("article-highlight")){e.preventDefault(),e.stopPropagation();let n=t.dataset.highlightId,o=t.textContent||"";if(n){B(!1),E({id:n,text:o});let e=t.getBoundingClientRect();L({top:e.top-40+window.scrollY,left:e.left+e.width/2}),T(!0),s(null)}}else F&&(H(),E(null))},[F,H]),J=(0,r.useCallback)(()=>{if(R&&R.id){H();let e=R.id;if(E(null),u(e),p){let t=p.querySelector('[data-highlight-id="'.concat(e,'"]'));if(t&&t.parentNode){let e=document.createTextNode(t.textContent||"");t.parentNode.replaceChild(e,t),t.parentNode.normalize()}}}},[R,u,p,H]),Y=(0,r.useCallback)(e=>{j(e),w(!0)},[]),X=(0,r.useCallback)(e=>{W(e),P(!0)},[]),K=(0,r.useCallback)(e=>{A(e),k(!0)},[]);(0,r.useEffect)(()=>{document.addEventListener("selectionchange",O);let e=()=>{setTimeout(O,150)};return"ontouchstart"in window&&document.addEventListener("touchend",e),()=>{document.removeEventListener("selectionchange",O),"ontouchstart"in window&&document.removeEventListener("touchend",e)}},[O]),(0,r.useEffect)(()=>{if(p)return p.addEventListener("click",q),()=>{p.removeEventListener("click",q)}},[p,q]),(0,r.useEffect)(()=>{let e=e=>{if(F){let t=e.target;t.closest(".highlight-toolbar")||t.classList.contains("article-highlight")||(H(),E(null))}};return document.addEventListener("click",e),()=>{document.removeEventListener("click",e)}},[F,H]),(0,r.useEffect)(()=>{if(p){let e=setTimeout(()=>{_(c,p)},100);return()=>clearTimeout(e)}},[c,p]),(0,r.useEffect)(()=>{let e=e=>{var t;let n=null==(t=e.detail)?void 0:t.highlightId;n&&u(n)};return window.addEventListener("cleanup-broken-highlight",e),()=>{window.removeEventListener("cleanup-broken-highlight",e)}},[u]);let Q=(0,r.useCallback)(e=>{e&&e!==p&&x(e)},[p]);return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(f,{selection:l,onHighlight:U,onResponse:Y,onShare:X,onAiAssist:K}),F&&R&&(0,o.jsxs)("div",{className:"highlight-toolbar unhighlight-toolbar ".concat(I?"hiding":""),style:{position:"absolute",top:"".concat(M.top,"px"),left:"".concat(M.left,"px"),transform:I?"translateY(-10px) translateX(-50%)":"translateX(-50%)",zIndex:1e3},children:[(0,o.jsxs)("button",{onClick:J,className:"highlight-btn highlight-btn-danger",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z"}),(0,o.jsx)("line",{x1:"18",y1:"9",x2:"12",y2:"15"}),(0,o.jsx)("line",{x1:"12",y1:"9",x2:"18",y2:"15"})]}),(0,o.jsx)("span",{children:"Unhighlight"})]}),(0,o.jsxs)("button",{onClick:()=>{X(R.text),H()},className:"highlight-btn",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"18",cy:"5",r:"3"}),(0,o.jsx)("circle",{cx:"6",cy:"12",r:"3"}),(0,o.jsx)("circle",{cx:"18",cy:"19",r:"3"}),(0,o.jsx)("line",{x1:"8.59",y1:"13.51",x2:"15.42",y2:"17.49"}),(0,o.jsx)("line",{x1:"15.41",y1:"6.51",x2:"8.59",y2:"10.49"})]}),(0,o.jsx)("span",{children:"Share"})]}),(0,o.jsxs)("button",{onClick:()=>{Y(R.text),H()},className:"highlight-btn",children:[(0,o.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"})}),(0,o.jsx)("span",{children:"Response"})]})]}),(0,o.jsx)("div",{ref:Q,className:"article-highlight-container",children:n}),v&&(0,o.jsx)("div",{className:"highlight-response-modal",children:(0,o.jsxs)("div",{className:"highlight-modal-content",children:[(0,o.jsx)("button",{className:"highlight-modal-close",onClick:()=>w(!1),children:"\xd7"}),(0,o.jsx)("h3",{children:"Respond to highlighted text"}),(0,o.jsxs)("div",{className:"highlight-selected-text",children:['"',S,'"']}),(0,o.jsx)("textarea",{className:"highlight-response-input",placeholder:"Write your response..."}),(0,o.jsx)("button",{className:"highlight-response-submit",children:"Submit"})]})}),C&&(0,o.jsx)("div",{className:"highlight-ai-modal",children:(0,o.jsxs)("div",{className:"highlight-modal-content",children:[(0,o.jsx)("button",{className:"highlight-modal-close",onClick:()=>k(!1),children:"\xd7"}),(0,o.jsx)("h3",{children:"Journa AI"}),(0,o.jsxs)("div",{className:"highlight-selected-text",children:['"',N,'"']}),(0,o.jsxs)("div",{className:"highlight-ai-options",children:[(0,o.jsx)("button",{children:"Explain this"}),(0,o.jsx)("button",{children:"Fact check"}),(0,o.jsx)("button",{children:"Provide context"}),(0,o.jsx)("button",{children:"Summarize"})]}),(0,o.jsx)("div",{className:"highlight-ai-response",children:(0,o.jsx)("div",{className:"highlight-ai-loading",children:"Journa AI is thinking..."})})]})}),z&&(0,o.jsx)(b.A,{isOpen:z,onClose:()=>P(!1),highlightText:D,articleTitle:i,shareUrl:d(a,t)})]})},w=e=>{let{currentMood:t,isVisible:n,moodFeatureEnabled:i}=e,[a,l]=(0,r.useState)(!1),[s,c]=(0,r.useState)(null),[d,m]=(0,r.useState)({colorStops:[{id:"1",color:"#007AFF",x:30,y:40,isSelected:!0}],opacity:80,grain:30,mode:"auto"}),u=(0,r.useRef)(null);(0,r.useRef)(null),(0,r.useRef)(null);let h=(0,r.useRef)(),p=e=>{let{colorStops:t,opacity:n,grain:o}=e,r=n/100,i=o/100,a="";if(i>.1){let e=.08*i,t=Math.max(15,25-8*i);a="\n        radial-gradient(ellipse at 12% 18%, rgba(255,255,255,".concat(e,") 3px, transparent ").concat(t,"px),\n        radial-gradient(ellipse at 87% 23%, rgba(0,0,0,").concat(.7*e,") 2px, transparent ").concat(1.2*t,"px),\n        radial-gradient(ellipse at 43% 82%, rgba(255,255,255,").concat(.5*e,") 4px, transparent ").concat(.9*t,"px),\n      ")}let l="";if(1===t.length){let e=t[0];l="radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(255*r).toString(16),", transparent 70%)")}else if(2===t.length){let[e,n]=t;l="\n        radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(.7*r*255).toString(16),", transparent 50%),\n        radial-gradient(circle at ").concat(n.x,"% ").concat(n.y,"%, ").concat(n.color).concat(Math.round(.7*r*255).toString(16),", transparent 50%)\n      ")}else if(3===t.length){let[e,n,o]=t;l="\n        radial-gradient(circle at ".concat(e.x,"% ").concat(e.y,"%, ").concat(e.color).concat(Math.round(.5*r*255).toString(16),", transparent 40%),\n        radial-gradient(circle at ").concat(n.x,"% ").concat(n.y,"%, ").concat(n.color).concat(Math.round(.5*r*255).toString(16),", transparent 40%),\n        radial-gradient(circle at ").concat(o.x,"% ").concat(o.y,"%, ").concat(o.color).concat(Math.round(.5*r*255).toString(16),", transparent 40%)\n      ")}return a?"".concat(a).concat(l):l||"transparent"},x=(0,r.useMemo)(()=>{let e=0;return t=>{let n=Date.now();if(n-e<100||(e=n,!i))return;let o=p(t);requestAnimationFrame(()=>{document.querySelectorAll("[data-mood-element]").forEach(e=>{e&&(e.style.backgroundImage=o,e.style.transition="background-image 0.2s ease")}),clearTimeout(h.current),h.current=setTimeout(()=>{localStorage.setItem("journaColorThemeConfig",JSON.stringify(t))},500)})}},[i,p]),f=(e,t)=>{e.preventDefault(),c(t),m({...d,colorStops:d.colorStops.map(e=>({...e,isSelected:e.id===t}))})},b=e=>{let t,n;if(!s||!u.current)return;let o=u.current.getBoundingClientRect();e instanceof MouseEvent?(t=e.clientX,n=e.clientY):(t=e.touches[0].clientX,n=e.touches[0].clientY);let r=Math.max(0,Math.min(100,(t-o.left)/o.width*100)),i=Math.max(0,Math.min(100,(n-o.top)/o.height*100)),a={...d,colorStops:d.colorStops.map(e=>e.id===s?{...e,x:r,y:i}:e)};m(a),x(a)},y=()=>{c(null)},_=e=>{if(!d.colorStops.find(e=>e.isSelected))return;let t={...d,colorStops:d.colorStops.map(t=>t.isSelected?{...t,color:e}:t)};m(t),x(t)};if((0,r.useEffect)(()=>{if(s)return document.addEventListener("mousemove",b),document.addEventListener("mouseup",y),document.addEventListener("touchmove",b,{passive:!1}),document.addEventListener("touchend",y),()=>{document.removeEventListener("mousemove",b),document.removeEventListener("mouseup",y),document.removeEventListener("touchmove",b),document.removeEventListener("touchend",y)}},[s,d]),(0,r.useEffect)(()=>{let e=localStorage.getItem("journaColorThemeConfig");if(e)try{let t=JSON.parse(e);m(t),x(t)}catch(e){console.error("Failed to load theme config:",e)}},[]),(0,r.useEffect)(()=>()=>{h.current&&clearTimeout(h.current)},[]),!n||!i)return null;let v=p(d),w=d.colorStops.find(e=>e.isSelected)||d.colorStops[0];return(0,o.jsxs)("div",{style:{position:"fixed",bottom:"40px",left:"40px",zIndex:1001,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)"},children:[(0,o.jsx)("button",{onClick:()=>l(!a),style:{width:"56px",height:"56px",borderRadius:"50%",border:"none",background:v||"#007AFF",color:"white",fontSize:"20px",cursor:"pointer",boxShadow:a?"0 8px 25px rgba(0, 122, 255, 0.4), 0 0 0 2px rgba(0, 122, 255, 0.2)":"0 6px 20px rgba(0, 122, 255, 0.3)",transform:a?"scale(1.05) rotate(45deg)":"scale(1) rotate(0deg)",transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",backdropFilter:"blur(10px)"},title:"Journa Color Editor",children:(0,o.jsxs)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,o.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"white"}),(0,o.jsx)("circle",{cx:"16",cy:"12",r:"2.5",fill:"white"}),(0,o.jsx)("circle",{cx:"12",cy:"18",r:"2",fill:"white"})]})}),a&&(0,o.jsxs)("div",{style:{position:"fixed",bottom:"110px",left:"40px",width:"380px",maxHeight:"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",borderRadius:"24px",padding:"24px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",zIndex:999,overflow:"hidden"},children:[(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"1rem",marginBottom:"1.5rem"},children:[{mode:"auto",icon:g.R9,title:"Auto"},{mode:"light",icon:"☀️",title:"Light"},{mode:"dark",icon:"\uD83C\uDF19",title:"Dark"}].map(e=>{let{mode:t,icon:n,title:r}=e;return(0,o.jsx)("button",{onClick:()=>{let e={...d,mode:t};m(e),x(e)},style:{width:"48px",height:"48px",borderRadius:"12px",border:d.mode===t?"2px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:d.mode===t?"rgba(0, 122, 255, 0.1)":"rgba(0,0,0,0.05)",fontSize:"20px",cursor:"pointer",transition:"all 0.2s ease",display:"flex",alignItems:"center",justifyContent:"center"},title:r,children:"auto"===t?(0,o.jsx)(g.R9,{size:20,color:d.mode===t?"#007AFF":"#666"}):n},t)})}),(0,o.jsx)("div",{ref:u,style:{width:"100%",height:"180px",borderRadius:"16px",background:"linear-gradient(135deg, #f0f0f0, #e8e8e8)",position:"relative",cursor:"grab",marginBottom:"1.5rem",border:"1px solid rgba(0,0,0,0.1)",overflow:"hidden"},children:d.colorStops.map(e=>(0,o.jsx)("div",{onMouseDown:t=>f(t,e.id),onTouchStart:t=>f(t,e.id),style:{position:"absolute",top:"".concat(e.y,"%"),left:"".concat(e.x,"%"),transform:"translate(-50%, -50%)",width:e.isSelected?"24px":"20px",height:e.isSelected?"24px":"20px",borderRadius:"50%",background:e.color,border:e.isSelected?"3px solid white":"2px solid white",boxShadow:e.isSelected?"0 4px 12px rgba(0,0,0,0.4)":"0 2px 8px rgba(0,0,0,0.3)",cursor:s===e.id?"grabbing":"grab",transition:s===e.id?"none":"all 0.2s ease",zIndex:e.isSelected?10:5}},e.id))}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"1rem",marginBottom:"1.5rem"},children:[(0,o.jsx)("button",{onClick:()=>{if(d.colorStops.length<=1)return;let e={...d,colorStops:d.colorStops.slice(0,-1)};m(e),x(e)},disabled:d.colorStops.length<=1,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length<=1?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length<=1?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length<=1?.5:1},children:"-"}),(0,o.jsxs)("span",{style:{fontSize:"14px",color:"#666",minWidth:"80px",textAlign:"center"},children:[d.colorStops.length,"/3 colors"]}),(0,o.jsx)("button",{onClick:()=>{if(d.colorStops.length>=3)return;let e={id:Date.now().toString(),color:"#FF6B6B",x:50+15*d.colorStops.length,y:50+10*d.colorStops.length,isSelected:!1},t={...d,colorStops:[...d.colorStops,e]};m(t),x(t)},disabled:d.colorStops.length>=3,style:{width:"36px",height:"36px",borderRadius:"8px",border:"1px solid rgba(0,0,0,0.2)",background:d.colorStops.length>=3?"rgba(0,0,0,0.05)":"white",fontSize:"18px",cursor:d.colorStops.length>=3?"not-allowed":"pointer",display:"flex",alignItems:"center",justifyContent:"center",opacity:d.colorStops.length>=3?.5:1},children:"+"})]}),(0,o.jsx)("div",{style:{display:"flex",justifyContent:"center",gap:"0.5rem",marginBottom:"1.5rem",flexWrap:"wrap"},children:["#FFFFFF","#FFB3D9","#B19CD9","#FF6B6B","#FF8E53","#FFD93D","#6BCF7F","#4ECDC4","#45B7D1"].map((e,t)=>(0,o.jsx)("button",{onClick:()=>_(e),style:{width:"32px",height:"32px",borderRadius:"50%",border:w.color===e?"3px solid #007AFF":"2px solid rgba(0,0,0,0.1)",background:e,cursor:"pointer",transform:w.color===e?"scale(1.15)":"scale(1)",transition:"all 0.2s ease"}},t))})]})]})},S=r.memo(e=>{let{initialEnabled:t=!0,className:n="",style:a={},currentMood:l="joyful"}=e,[s,c]=(0,r.useState)(t),[d,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{if(m(e),e){let e=localStorage.getItem("moodFeatureEnabled");if(null!==e){let t=JSON.parse(e);c(t);let n=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=document.querySelectorAll("[data-mood-element]");if(0===o.length&&e<5)return void setTimeout(()=>n(e+1),200);o.forEach(e=>{e.style.transition="opacity 0.3s ease, transform 0.3s ease",t?(e.setAttribute("data-mood-active","true"),e.style.display="block",e.style.visibility="visible",e.style.opacity="1",e.style.transform="scale(1)"):(e.setAttribute("data-mood-active","false"),e.style.display="none",e.style.visibility="hidden",e.style.opacity="0",e.style.transform="scale(0.95)")}),document.querySelectorAll("[data-mood-header]").forEach(e=>{e.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",t||(e.style.background="rgba(255, 255, 255, 0.95)",e.style.border="1px solid rgba(0, 0, 0, 0.1)",e.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)")})};setTimeout(()=>n(),100)}else c(!0)}else c(!1)});return()=>e()},[]),d)?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{onClick:()=>{if(!d)return;h(!0),setTimeout(()=>h(!1),300);let e=!s;c(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e));let t=function(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=document.querySelectorAll("[data-mood-element]");if(0===o.length&&n<3)return void setTimeout(()=>t(n+1),100);o.forEach(t=>{t.style.transition="opacity 0.3s ease, transform 0.3s ease",e?(t.setAttribute("data-mood-active","true"),t.style.display="block",t.style.visibility="visible",t.style.opacity="1",t.style.transform="scale(1)"):(t.setAttribute("data-mood-active","false"),t.style.opacity="0",t.style.transform="scale(0.95)",setTimeout(()=>{"false"===t.getAttribute("data-mood-active")&&(t.style.display="none",t.style.visibility="hidden")},300))})};t(),document.querySelectorAll("[data-mood-header]").forEach(t=>{if(t.style.transition="background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease",e){t.style.background="",t.style.border="",t.style.boxShadow="";let e=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=e}else t.setAttribute("data-mood-style",t.style.background),t.style.background="rgba(255, 255, 255, 0.95)",t.style.border="1px solid rgba(0, 0, 0, 0.1)",t.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.1)"})},className:n,style:{...a,transition:"all 0.3s ease",transform:u?"scale(1.1)":"scale(1)"},title:s?"Turn off mood feature":"Turn on mood feature",children:s?"ON":"OFF"}),(0,o.jsx)(w,{currentMood:l,isVisible:!!d,moodFeatureEnabled:s})]}):null}),j=r.memo(e=>{let{articleId:t,className:a,style:l}=e,[s,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(""),[p,x]=(0,r.useState)(""),[f,b]=(0,r.useState)(!1),[y,_]=(0,r.useState)(!1),[v,w]=(0,r.useState)(!1),[S,j]=(0,r.useState)({width:0,height:0}),C=(0,r.useMemo)(()=>{let e=S.width;return{isMobile:e<=768,isTablet:e>768&&e<=1024,isDesktop:e>1024,isSmallPhone:e<=480,isLandscape:e>S.height,isIPad11:e>=820&&e<=1024,bottomSafeArea:Math.max(100,e<=768?120:80),sideMargin:e<=480?16:e<=768?20:40}},[S]);(0,r.useEffect)(()=>{let e,t=()=>{j({width:window.innerWidth,height:window.innerHeight})};t();let n=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(e)}},[]),(0,r.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{c(e)});return()=>e()},[]);let k=(0,r.useMemo)(()=>["How does this make you feel?","What questions does this raise for you?","How does this relate to your own experience?","What would you do differently?","What surprised you most about this?","What's your main takeaway from this?","How might this change your perspective?"],[]),N=(0,r.useCallback)(()=>{let e=Math.floor(Math.random()*k.length);return k[e]},[k]);(0,r.useEffect)(()=>{u||h(N())},[u,N]);let A=(0,r.useCallback)(()=>{w(!0),m(e=>!e),setTimeout(()=>w(!1),300),d&&(b(!1),x(""))},[d]),R=(0,r.useCallback)(()=>{b(!1),u.trim()||h(N())},[u,N]),E=(0,r.useCallback)(async()=>{if(p.trim()&&!y&&s){_(!0);try{let{saveReflectionResponse:e}=await n.e(9122).then(n.bind(n,9122));await e(t,"custom_".concat(Date.now()),u,p.trim(),0,!0),x(""),m(!1)}catch(e){console.error("Error saving reflection:",e)}finally{_(!1)}}},[p,y,s,t,u]),F=(0,r.useMemo)(()=>({position:"fixed",bottom:C.isMobile?"max(".concat(C.bottomSafeArea+20,"px, calc(").concat(C.bottomSafeArea,"px + env(safe-area-inset-bottom)))"):"40px",right:"".concat(C.sideMargin,"px"),width:C.isSmallPhone?"48px":C.isMobile?"52px":"56px",height:C.isSmallPhone?"48px":C.isMobile?"52px":"56px",borderRadius:"50%",background:d?"linear-gradient(135deg, #1d4ed8, #7c3aed)":"linear-gradient(135deg, #3b82f6, #8b5cf6)",border:"none",boxShadow:d?"0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)":"0 6px 20px rgba(59, 130, 246, 0.3)",cursor:"pointer",zIndex:1002,transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",display:"flex",alignItems:"center",justifyContent:"center",transform:v?"scale(1.1)":d?"scale(1.05)":"scale(1)",backdropFilter:"blur(10px)",WebkitBackdropFilter:"blur(10px)",contain:"layout style paint",willChange:v?"transform":"auto",...l}),[C,d,v,l]),T=(0,r.useMemo)(()=>({position:"fixed",bottom:C.isMobile?"max(".concat(C.bottomSafeArea+80,"px, calc(").concat(C.bottomSafeArea+60,"px + env(safe-area-inset-bottom)))"):"110px",right:C.isMobile?"".concat(C.sideMargin,"px"):"40px",left:C.isMobile?"".concat(C.sideMargin,"px"):"auto",width:C.isMobile?"auto":"380px",maxWidth:C.isMobile?"none":"380px",maxHeight:C.isLandscape&&C.isMobile?"60vh":C.isMobile?"50vh":"500px",background:"rgba(255, 255, 255, 0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderRadius:C.isSmallPhone?"16px":C.isMobile?"18px":"24px",boxShadow:"0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)",border:"1px solid rgba(255, 255, 255, 0.3)",zIndex:1001,padding:C.isSmallPhone?"16px":C.isMobile?"18px":"24px",overflow:"hidden auto",contain:"layout style paint",transform:"translateZ(0)"}),[C]);return s?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{"data-reflection-element":"floating-button",onClick:A,className:"reflection-component hw-accelerated ".concat(a||""),style:F,title:d?"Close reflection":"Open reflection","aria-label":d?"Close reflection panel":"Open reflection panel",children:(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%"},children:d?(0,o.jsx)(g.US,{size:C.isSmallPhone?12:14,color:"#ffffff"}):(0,o.jsx)(g.zf,{size:C.isSmallPhone?12:14,color:"#ffffff"})})}),d&&(0,o.jsxs)("div",{className:"reflection-component floating-panel hw-accelerated",style:T,role:"dialog","aria-labelledby":"reflection-title","aria-modal":"true",children:[(0,o.jsx)("style",{children:"\n              @keyframes gentleSlideUp {\n                from {\n                  opacity: 0;\n                  transform: translateY(20px) scale(0.98);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0) scale(1);\n                }\n              }\n              \n              .reflection-panel-enter {\n                animation: gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n              }\n            "}),(0,o.jsxs)("div",{style:{marginBottom:"20px",textAlign:"center"},children:[(0,o.jsxs)("h3",{id:"reflection-title",style:{margin:"0 0 12px 0",fontSize:C.isSmallPhone?"14px":"16px",fontWeight:"600",background:"linear-gradient(135deg, #3b82f6, #8b5cf6)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",backgroundClip:"text",display:"flex",alignItems:"center",justifyContent:"center",gap:"8px"},children:[(0,o.jsx)(g.uQ,{size:C.isSmallPhone?14:16,color:"#3b82f6"}),"Time to Reflect"]}),(0,o.jsx)("div",{style:{position:"relative"},children:f?(0,o.jsx)("input",{type:"text",value:u,onChange:e=>h(e.target.value),onBlur:R,onKeyDown:e=>{"Enter"===e.key&&R(),"Escape"===e.key&&(h(N()),b(!1))},autoFocus:!0,className:"mobile-optimized-input",style:{width:"100%",padding:"8px 12px",border:"2px solid #3b82f6",borderRadius:"12px",background:"white",fontSize:C.isSmallPhone?"13px":"14px",textAlign:"center",outline:"none"}}):(0,o.jsx)("button",{onClick:()=>b(!0),style:{background:"transparent",border:"2px solid transparent",borderRadius:"12px",padding:"8px 12px",fontSize:C.isSmallPhone?"13px":"14px",color:"#3b82f6",cursor:"pointer",transition:"all 0.2s ease",fontWeight:"500",textAlign:"center",width:"100%"},onMouseEnter:e=>{e.currentTarget.style.borderColor="#e2e8f0",e.currentTarget.style.background="#f8fafc"},onMouseLeave:e=>{e.currentTarget.style.borderColor="transparent",e.currentTarget.style.background="transparent"},title:"Click to edit prompt",children:u})})]}),(0,o.jsx)("textarea",{value:p,onChange:e=>x(e.target.value),placeholder:"Share your thoughts...",className:"mobile-optimized-input reflection-input","data-mobile":"true",style:{width:"100%",height:C.isSmallPhone?"100px":"120px",padding:"12px",border:"2px solid #e2e8f0",borderRadius:"12px",background:"white",fontSize:C.isSmallPhone?"15px":"16px",fontFamily:"inherit",resize:"vertical",outline:"none",transition:"border-color 0.2s ease",marginBottom:"16px"},onFocus:e=>{e.target.style.borderColor="#3b82f6",C.isMobile&&setTimeout(()=>{e.target.scrollIntoView({behavior:"smooth",block:"center"})},100)},onBlur:e=>{e.target.style.borderColor="#e2e8f0"}}),(0,o.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:"12px",flexDirection:C.isSmallPhone?"column":"row"},children:[(0,o.jsx)("button",{onClick:()=>m(!1),style:{background:"transparent",border:"2px solid #e2e8f0",borderRadius:"12px",padding:C.isSmallPhone?"12px 20px":"8px 16px",fontSize:C.isSmallPhone?"15px":"14px",color:"#64748b",cursor:"pointer",fontWeight:"500",transition:"all 0.2s ease",width:C.isSmallPhone?"100%":"auto",minHeight:"44px"},children:"Cancel"}),(0,o.jsx)("button",{onClick:E,disabled:!p.trim()||y,style:{background:p.trim()?"linear-gradient(135deg, #3b82f6, #8b5cf6)":"#e2e8f0",border:"none",borderRadius:"12px",padding:C.isSmallPhone?"12px 20px":"8px 20px",fontSize:C.isSmallPhone?"15px":"14px",color:p.trim()?"white":"#94a3b8",cursor:p.trim()?"pointer":"not-allowed",fontWeight:"600",transition:"all 0.2s ease",opacity:y?.7:1,width:C.isSmallPhone?"100%":"auto",minHeight:"44px"},children:y?"Saving...":"Save Reflection"})]})]})]}):null});var C=n(326);let k=r.memo(e=>{let{className:t="",style:n={}}=e,[a,l]=(0,r.useState)(!0),[s,c]=(0,r.useState)(null),[d,m]=(0,r.useState)(!1),[u]=(0,r.useState)("reflective");return((0,r.useEffect)(()=>{let e=i.j2.onAuthStateChanged(e=>{if(c(e),e){let e=localStorage.getItem("reflectionsEnabled");if(null!==e){let t=JSON.parse(e);l(t),setTimeout(()=>{document.querySelectorAll("[data-reflection-element]").forEach(e=>{e.style.display=t?"":"none"})},100)}else l(!0)}else l(!1)});return()=>e()},[]),s)?(0,o.jsx)("button",{onClick:()=>{if(!s)return;m(!0),setTimeout(()=>m(!1),300);let e=!a;l(e),localStorage.setItem("reflectionsEnabled",JSON.stringify(e)),document.querySelectorAll("[data-reflection-element]").forEach(t=>{e?t.style.display="":t.style.display="none"}),window.dispatchEvent(new CustomEvent("reflectionModeToggle",{detail:{enabled:e}}))},className:t,style:{...n,transition:"all 0.3s ease",transform:d?"scale(1.1)":"scale(1)",background:a?"rgba(255, 255, 255, 0.9)":"rgba(255, 255, 255, 0.2)",color:a?C.Qx[u].accent:"#F7FAFC"},title:a?"Turn off reflections":"Turn on reflections",children:a?"ON":"OFF"}):(0,o.jsx)("button",{style:{...n,opacity:.6,cursor:"not-allowed"},disabled:!0,title:"Sign in to use reflections",children:"OFF"})});var N=n(4655),A=n.n(N);async function R(e){let t="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e),n=await fetch(t);if(!n.ok)throw Error("Failed to fetch article: ".concat(n.status," ").concat(n.statusText));return n.json()}var E=n(3241),F=n.n(E);n(8042),n(5802),n(7846),n(1280),n(8496),n(941),n(3523),n(4495),n(1177),n(1990),n(3686),n(642),n(7867),n(3337),n(3435),n(1055),n(2103),n(255),n(9829),n(656);var T=n(5343);function I(){return(0,T.vJ)(()=>{let e=document.createElement("script");return e.textContent="\n// Simple syntax highlighting without external dependencies\nfunction highlightCode() {\n  const codeBlocks = document.querySelectorAll('pre code');\n  \n  codeBlocks.forEach(codeBlock => {\n    const pre = codeBlock.parentElement;\n    if (!pre) return;\n    \n    // Apply dark theme\n    pre.style.backgroundColor = '#1e1e1e';\n    pre.style.color = '#d4d4d4';\n    pre.style.border = '1px solid #333';\n    pre.style.borderRadius = '8px';\n    pre.style.padding = '16px';\n    pre.style.fontFamily = \"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace\";\n    pre.style.fontSize = '14px';\n    pre.style.lineHeight = '1.6';\n    pre.style.overflowX = 'auto';\n    pre.style.position = 'relative';\n    \n    const code = codeBlock.textContent || '';\n    let highlightedCode = code;\n    \n    // Simplified highlighting to avoid regex issues\n    try {\n      // Keywords\n      const keywords = ['const', 'let', 'var', 'function', 'class', 'interface', 'type', 'enum', 'import', 'export', 'from', 'as', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'default', 'try', 'catch', 'finally', 'async', 'await', 'new', 'this', 'extends', 'implements', 'private', 'public', 'protected', 'static'];\n      keywords.forEach(keyword => {\n        const regex = new RegExp('\\\\b' + keyword + '\\\\b', 'g');\n        highlightedCode = highlightedCode.replace(regex, '<span style=\"color: #569cd6; font-weight: 500;\">' + keyword + '</span>');\n      });\n      \n      // Simple string highlighting\n      highlightedCode = highlightedCode.replace(/\"([^\"]*)\"/g, '<span style=\"color: #ce9178;\">\"$1\"</span>');\n      highlightedCode = highlightedCode.replace(/'([^']*)'/g, '<span style=\"color: #ce9178;\">'$1'</span>');\n      \n      // Numbers\n      highlightedCode = highlightedCode.replace(/\\b\\d+\\.?\\d*\\b/g, '<span style=\"color: #b5cea8;\">$&</span>');\n      \n      // Comments\n      highlightedCode = highlightedCode.replace(///.*$/gm, '<span style=\"color: #6a9955; font-style: italic;\">$&</span>');\n    } catch (e) {\n      console.warn('Syntax highlighting failed:', e);\n      // Keep original code if highlighting fails\n    }\n    \n    codeBlock.innerHTML = highlightedCode;\n    \n    // Add language indicator if available\n    let language = 'code';\n    const classNames = codeBlock.className.split(' ');\n    for (const className of classNames) {\n      if (className.startsWith('language-')) {\n        language = className.replace('language-', '');\n        break;\n      }\n    }\n    \n    if (pre.hasAttribute('data-language')) {\n      language = pre.getAttribute('data-language');\n    }\n    \n    // Add language badge\n    const badge = document.createElement('div');\n    badge.textContent = language.toUpperCase();\n    badge.style.position = 'absolute';\n    badge.style.top = '8px';\n    badge.style.right = '12px';\n    badge.style.background = 'rgba(255, 255, 255, 0.1)';\n    badge.style.color = '#a0a0a0';\n    badge.style.padding = '2px 8px';\n    badge.style.borderRadius = '4px';\n    badge.style.fontSize = '12px';\n    badge.style.fontWeight = '500';\n    badge.style.letterSpacing = '0.5px';\n    pre.appendChild(badge);\n  });\n}\n\n// Run when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', highlightCode);\n} else {\n  highlightCode();\n}\n\n// Also run on dynamic content changes\nconst observer = new MutationObserver(() => {\n  setTimeout(highlightCode, 100);\n});\n\nobserver.observe(document.body, {\n  childList: true,\n  subtree: true\n});\n",document.head.appendChild(e),()=>{try{document.head.removeChild(e)}catch(e){}}},[]),null}var B=n(7041),M=n(6597),L=n(6408),z=n(7023),P=n.n(z);let D=e=>{let{topic:t,unreadCount:n,isOpen:r,onClick:i}=e,a=t.length>60?"".concat(t.substring(0,60),"..."):t;return(0,o.jsx)(L.P.div,{className:P().reflectionSearchBar,initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},whileHover:{scale:1.02},whileTap:{scale:.98},onClick:i,children:(0,o.jsxs)("div",{className:"".concat(P().reflectionSearchWrapper," ").concat(r?P().focused:""),children:[(0,o.jsx)("div",{className:P().reflectionIcon,children:(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"}),(0,o.jsx)("path",{d:"M8 10h8"}),(0,o.jsx)("path",{d:"M8 14h6"})]})}),(0,o.jsxs)("div",{className:P().reflectionText,children:[(0,o.jsx)("span",{className:P().reflectionLabel,children:"Reflect on:"}),(0,o.jsxs)("span",{className:P().reflectionTopic,children:['"',a,'"']})]}),(0,o.jsxs)("div",{className:P().reflectionJoin,children:[n>0&&(0,o.jsx)("div",{className:P().reflectionUnread,children:n}),(0,o.jsx)("span",{className:P().reflectionJoinText,children:"Join discussion"}),(0,o.jsx)("svg",{className:P().reflectionArrow,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,o.jsx)("path",{d:"M9 18l6-6-6-6"})})]})]})})};var W=n(760),H=n(4744);let O=e=>{let[t,n]=(0,r.useState)([]),[o,l]=(0,r.useState)(""),[s,c]=(0,r.useState)(!0),[d,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(0),g=i.j2.currentUser,p=(0,r.useCallback)(async()=>{try{let t=(0,a.doc)(i.db,"reflections",e,"metadata","main"),n=await (0,a.getDoc)(t);if(n.exists()){let e=n.data();l(e.topic)}}catch(e){console.error("Error loading reflection metadata:",e),m("Failed to load discussion topic")}},[e]);(0,r.useEffect)(()=>{if(!e)return;c(!0);let t=(0,a.collection)(i.db,"reflections",e,"messages"),o=(0,a.query)(t,(0,a.orderBy)("createdAt","asc")),r=(0,a.onSnapshot)(o,e=>{let t=[],o=0;e.forEach(e=>{let n=e.data(),r={id:e.id,userId:n.userId,userName:n.userName,content:n.content,createdAt:n.createdAt,read:n.read||!1};t.push(r),!r.read&&r.userId!==(null==g?void 0:g.uid)&&o++}),n(t),h(o),c(!1),m(null)},e=>{console.error("Error listening to messages:",e),m("Failed to load messages"),c(!1)});return p(),()=>r()},[e,null==g?void 0:g.uid,p]);let x=(0,r.useCallback)(async t=>{if(g&&t.trim())try{var n;let o=await (0,H.VM)(g.uid),r=o?"".concat(o.firstName," ").concat(o.lastName):g.displayName||(null==(n=g.email)?void 0:n.split("@")[0])||"Anonymous",l=(0,a.collection)(i.db,"reflections",e,"messages");await (0,a.addDoc)(l,{userId:g.uid,userName:r,content:t.trim(),createdAt:(0,a.serverTimestamp)(),read:!1})}catch(e){throw console.error("Error sending message:",e),e}},[g,e]),f=(0,r.useCallback)(async()=>{if(g)try{let t=(0,a.collection)(i.db,"reflections",e,"messages"),n=(await (0,a.getDocs)(t)).docs.filter(e=>{let t=e.data();return!t.read&&t.userId!==g.uid}).map(e=>(0,a.setDoc)(e.ref,{read:!0},{merge:!0}));await Promise.all(n)}catch(e){console.error("Error marking messages as read:",e)}},[g,e]),b=(0,r.useCallback)(async t=>{if(g)try{let n=(0,a.doc)(i.db,"reflections",e,"metadata","main");await (0,a.setDoc)(n,{topic:t,createdAt:(0,a.serverTimestamp)(),authorId:g.uid}),l(t)}catch(e){throw console.error("Error creating reflection room:",e),e}},[g,e]),y=(0,r.useCallback)(async t=>{if(g)try{let n=(0,a.doc)(i.db,"reflections",e,"messages",t),o=await (0,a.getDoc)(n);if(!o.exists())throw Error("Message not found");if(o.data().userId!==g.uid)throw Error("You can only delete your own messages");await (0,a.deleteDoc)(n)}catch(e){throw console.error("Error deleting message:",e),e}},[g,e]),_=(0,r.useCallback)(async()=>{if(g)try{let t=(0,a.collection)(i.db,"reflections",e,"messages"),n=(await (0,a.getDocs)(t)).docs.map(e=>(0,a.deleteDoc)(e.ref));await Promise.all(n)}catch(e){throw console.error("Error clearing messages:",e),e}},[g,e]),v=(0,r.useCallback)(async t=>{if(g)try{let n=(0,a.doc)(i.db,"reflections",e,"metadata","main"),o=await (0,a.getDoc)(n);if(!o.exists())throw Error("Reflection room not found");let r=o.data();if(r.authorId!==g.uid)throw Error("Only the author can update the topic");await _(),await (0,a.setDoc)(n,{...r,topic:t,updatedAt:(0,a.serverTimestamp)()}),l(t)}catch(e){throw console.error("Error updating reflection topic:",e),e}},[g,e,_]);return{messages:t,topic:o,loading:s,error:d,unreadCount:u,sendMessage:x,deleteMessage:y,clearAllMessages:_,updateReflectionTopic:v,markAllAsRead:f,createReflectionRoom:b}},U=e=>{let{articleId:t,isOpen:n,onClose:a,isMobile:l,authorId:s}=e,[c,d]=(0,r.useState)(""),[m,u]=(0,r.useState)(!1),[h,p]=(0,r.useState)(null),x=(0,r.useRef)(null),f=(0,r.useRef)(null),{messages:b,topic:y,loading:_,error:v,sendMessage:w,deleteMessage:S,unreadCount:j,markAllAsRead:C}=O(t),k=i.j2.currentUser,N=(0,r.useMemo)(()=>({closed:{x:"100%",opacity:0},open:{x:0,opacity:1}}),[]),A=(0,r.useMemo)(()=>({closed:{y:"100%",opacity:0},open:{y:0,opacity:1}}),[]),R=(0,r.useMemo)(()=>({type:"tween",duration:.3,ease:[.4,0,.2,1]}),[]);(0,r.useEffect)(()=>{let e=setTimeout(()=>{var e;null==(e=x.current)||e.scrollIntoView({behavior:"smooth",block:"end"})},100);return()=>clearTimeout(e)},[b.length]),(0,r.useEffect)(()=>{if(n&&j>0){let e=setTimeout(()=>{C()},500);return()=>clearTimeout(e)}},[n,j,C]);let E=(0,r.useCallback)(()=>{f.current&&(f.current.style.height="auto",f.current.style.height="".concat(f.current.scrollHeight,"px"))},[]);(0,r.useEffect)(()=>{E()},[c,E]);let F=(0,r.useCallback)(async e=>{if(e.preventDefault(),c.trim()&&!m&&k){u(!0);try{await w(c.trim()),d("")}catch(e){console.error("Error sending message:",e)}finally{u(!1)}}},[c,m,k,w]),T=(0,r.useCallback)(e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),F(e))},[F]),I=(0,r.useCallback)(e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e);return(new Date().getTime()-t.getTime())/36e5<24?t.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}):t.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit",hour12:!0})},[]),B=(0,r.useCallback)(async e=>{if(k&&!h){p(e);try{await S(e)}catch(e){console.error("Error deleting message:",e)}finally{p(null)}}},[k,S,h]),M=(0,r.useMemo)(()=>b.map(e=>{let t=e.userId===(null==k?void 0:k.uid),n=e.userId===s,r=h===e.id;return(0,o.jsxs)("div",{className:"".concat(P().message," ").concat(t?P().ownMessage:P().otherMessage," ").concat(n?P().authorMessage:""," ").concat(r?P().messageDeleting:""),children:[(0,o.jsxs)("div",{className:P().messageHeader,children:[(0,o.jsxs)("span",{className:"".concat(P().userName," ").concat(n?P().authorName:""),children:[e.userName,n&&(0,o.jsx)("span",{className:P().authorBadge,children:"Author"})]}),(0,o.jsxs)("div",{className:P().messageHeaderRight,children:[(0,o.jsx)("span",{className:P().messageTime,children:I(e.createdAt)}),t&&(0,o.jsx)("button",{className:P().deleteButton,onClick:()=>B(e.id),disabled:r,"aria-label":"Delete message",title:"Delete message",children:r?(0,o.jsx)("div",{className:P().deleteSpinner}):(0,o.jsx)(g.uc,{size:14})})]})]}),(0,o.jsx)("div",{className:P().messageContent,children:e.content})]},e.id)}),[b,null==k?void 0:k.uid,s,I,h,B]);return(0,o.jsx)(W.N,{mode:"wait",children:n&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(L.P.div,{className:P().backdrop,initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},onClick:a}),(0,o.jsxs)(L.P.div,{className:"".concat(P().sidebar," ").concat(l?P().mobileModal:""),variants:l?A:N,initial:"closed",animate:"open",exit:"closed",transition:R,children:[(0,o.jsxs)("div",{className:P().header,children:[(0,o.jsxs)("div",{className:P().headerTitle,children:[(0,o.jsx)("h3",{children:"Reflection Room"}),(0,o.jsx)("button",{className:P().closeButton,onClick:a,"aria-label":"Close reflection room",children:(0,o.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M18 6L6 18M6 6L18 18",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),y&&(0,o.jsxs)("div",{className:P().topicSection,children:[(0,o.jsx)("div",{className:P().topicLabel,children:"Discussion Topic"}),(0,o.jsx)("div",{className:P().topicText,children:y})]})]}),(0,o.jsx)("div",{className:P().messagesContainer,children:_?(0,o.jsxs)("div",{className:P().loadingState,children:[(0,o.jsx)("div",{className:P().loadingSpinner}),(0,o.jsx)("p",{children:"Loading messages..."})]}):v?(0,o.jsx)("div",{className:P().errorState,children:(0,o.jsxs)("p",{children:["Error loading messages: ",v]})}):0===b.length?(0,o.jsxs)("div",{className:P().emptyState,children:[(0,o.jsx)("div",{className:P().emptyIcon,children:"\uD83D\uDCAD"}),(0,o.jsx)("p",{children:"No messages yet. Be the first to share your thoughts!"})]}):(0,o.jsxs)("div",{className:P().messagesList,children:[M,(0,o.jsx)("div",{ref:x})]})}),k&&(0,o.jsxs)("form",{onSubmit:F,className:P().messageForm,children:[(0,o.jsxs)("div",{className:P().inputContainer,children:[(0,o.jsx)("textarea",{ref:f,value:c,onChange:e=>d(e.target.value),onKeyDown:T,placeholder:"Share your thoughts...",className:P().messageInput,rows:1,maxLength:1e3,disabled:m}),(0,o.jsx)("button",{type:"submit",className:P().sendButton,disabled:!c.trim()||m,children:m?(0,o.jsx)("div",{className:P().sendingSpinner}):(0,o.jsx)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,o.jsx)("path",{d:"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})]}),(0,o.jsxs)("div",{className:P().characterCount,children:[c.length,"/1000"]})]}),!k&&(0,o.jsx)("div",{className:P().authPrompt,children:(0,o.jsx)("p",{children:"Please sign in to join the conversation"})})]})]})})},q=r.memo(e=>{let{articleId:t,hasReflectionRoom:n,authorId:a}=e,[l,s]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(!1),{topic:h,unreadCount:g}=O(t),p=(0,r.useCallback)(()=>{s(e=>!e)},[]),x=(0,r.useCallback)(()=>{s(!1)},[]);(0,r.useEffect)(()=>{let e=(0,M.onAuthStateChanged)(i.j2,e=>{u(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{let e,t=()=>{d(window.innerWidth<=768)};t();let n=()=>{clearTimeout(e),e=setTimeout(t,100)};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n),clearTimeout(e)}},[]);let f=(0,r.useMemo)(()=>h||"Join the discussion",[h]);return n&&m?(0,o.jsxs)("div",{className:P().reflectionRoomContainer,children:[(0,o.jsx)(D,{topic:f,unreadCount:g,isOpen:l,onClick:p}),(0,o.jsx)(U,{articleId:t,isOpen:l,onClose:x,isMobile:c,authorId:a})]}):null},(e,t)=>e.articleId===t.articleId&&e.hasReflectionRoom===t.hasReflectionRoom&&e.authorId===t.authorId),J=e=>{let{articleId:t,initialHtml:n,isAuthenticated:i=!1,articleTitle:a="Article",articleSlug:l="",hasReflectionRoom:s=!1,authorId:c,moodFeatureEnabled:d,onToggleMoodFeature:m,mood:h}=e,[p,x]=(0,r.useState)(null),[f,b]=(0,r.useState)(!n),[y,_]=(0,r.useState)(""),[w,N]=(0,r.useState)("reflective"),E=h||w,T=(0,r.useRef)(null);(0,r.useEffect)(()=>{T.current&&(n||p)&&setTimeout(()=>{T.current&&T.current.querySelectorAll("pre code").forEach(e=>{let t=e.parentElement,n="javascript";for(let t of e.className.split(" "))if(t.startsWith("language-")){n=t.replace("language-","");break}if(t.hasAttribute("data-language")&&(n=t.getAttribute("data-language")),F().languages[n])try{let o=e.textContent||"";e.innerHTML=F().highlight(o,F().languages[n],n),t.setAttribute("data-language",n),t.style.position="relative"}catch(e){console.warn("Syntax highlighting failed for language:",n,e)}})},100)},[n,p]),(0,r.useEffect)(()=>{let e=M();if(e){let t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();t&&!h&&N((0,B.H)(t))}},[n,p]),(0,r.useEffect)(()=>{n||p||(async()=>{try{b(!0);let e=await R(t);if(!e)return void _("Article not found");let n="",o=("string"==typeof e.content?e.content:e.content.map(e=>"<p>".concat(e.text,"</p>")).join("\n")).replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");x({title:e.title,body:o})}catch(e){console.error("Error loading article:",e),_("Failed to load article")}finally{b(!1)}})()},[t,p,n]);let M=()=>n?n.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):(null==p?void 0:p.body)||"";return f?(0,o.jsxs)("div",{className:A().loadingContainer,children:[(0,o.jsx)("div",{className:A().loadingIndicator}),(0,o.jsx)("p",{children:"Loading article..."})]}):y?(0,o.jsx)("div",{className:A().errorContainer,children:(0,o.jsx)("p",{className:A().errorMessage,children:y})}):(0,o.jsxs)(u,{articleId:t,children:[(0,o.jsx)(I,{}),(0,o.jsxs)("article",{className:A().articleContainer,children:[s&&i&&(0,o.jsx)(q,{articleId:t,hasReflectionRoom:s,authorId:c}),(0,o.jsx)("div",{"data-toggle-bar":"true",style:{display:"flex",justifyContent:window.innerWidth<=768?"center":"space-between",alignItems:"center",gap:window.innerWidth<=768?"0.5rem":"1rem",margin:window.innerWidth<=768?"0.5rem 0":"1rem 0",padding:window.innerWidth<=768?"0.5rem 0.75rem":"1rem",backgroundImage:i?"linear-gradient(270deg, ".concat(C.Qx[E].gradientStart,", ").concat(C.Qx[E].gradientEnd,")"):"linear-gradient(270deg, #9CA3AF, #6B7280)",backgroundSize:"200% 200%",animation:"slideGradient 8s ease infinite alternate",borderRadius:window.innerWidth<=768?"12px":"20px",border:"1px solid rgba(255, 255, 255, 0.5)",boxShadow:"0 8px 32px rgba(0, 0, 0, 0.1)",fontSize:window.innerWidth<=768?"0.75rem":"0.875rem",flexWrap:window.innerWidth<=768?"wrap":"nowrap"},children:window.innerWidth<=768?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.65rem"},children:"\uD83C\uDFA8 Mood"}),(0,o.jsx)(S,{style:{padding:"0.25rem 0.5rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"12px",fontSize:"0.6rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)",minHeight:"24px",minWidth:"32px"}})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.25rem"},children:[(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.65rem"},children:"✨ Reflect"}),(0,o.jsx)(k,{style:{padding:"0.25rem 0.5rem",border:"none",borderRadius:"12px",fontSize:"0.6rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)",minHeight:"24px",minWidth:"32px"}})]}),i&&(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.6rem",opacity:.7,width:"100%",textAlign:"center",marginTop:"0.25rem"},children:"Enhanced active"})]}):window.innerWidth<=1024?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.8rem",opacity:.9},children:i?"\uD83C\uDFA8 Enhanced mode":"\uD83D\uDD12 Sign in for features"})}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.4rem"},children:[(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.7rem"},children:"Mood"}),(0,o.jsx)(S,{style:{padding:"0.35rem 0.7rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"16px",fontSize:"0.65rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.7rem"},children:"Reflect"}),(0,o.jsx)(k,{style:{padding:"0.35rem 0.7rem",border:"none",borderRadius:"16px",fontSize:"0.65rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"1rem"},children:[(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.875rem",opacity:.9},children:i?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.cL,{size:16,color:"#F7FAFC"}),"Atmosphere adapted"]}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(g.JD,{size:16,color:"#F7FAFC"}),"Sign in for enhanced features"]})}),i&&(0,o.jsxs)("span",{style:{color:"#F7FAFC",fontWeight:"600",fontSize:"0.875rem"},children:[(0,o.jsx)(g.gI,{size:16,color:"#F7FAFC"}),"Enhanced features active"]})]}),(0,o.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Mood Background"}),(0,o.jsx)(S,{style:{padding:"0.4rem 0.8rem",border:"none",background:"rgba(255, 255, 255, 0.2)",color:"#F7FAFC",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}}),(0,o.jsx)("span",{style:{color:"#F7FAFC",fontWeight:"500",fontSize:"0.75rem"},children:"Interactive Reflections"}),(0,o.jsx)(k,{style:{padding:"0.4rem 0.8rem",border:"none",borderRadius:"20px",fontSize:"0.7rem",fontWeight:"600",cursor:"pointer",transition:"all 0.3s ease",boxShadow:"0 1px 4px rgba(0, 0, 0, 0.1)",backdropFilter:"blur(10px)"}})]})]})}),(0,o.jsxs)(v,{articleId:t,articleTitle:a,articleSlug:l,children:[(0,o.jsx)("div",{className:A().articleContent,children:(0,o.jsx)("div",{ref:T,dangerouslySetInnerHTML:{__html:M()}})}),(0,o.jsx)(j,{articleId:t})]})]})]})}},9576:(e,t,n)=>{"use strict";n.d(t,{A:()=>c});var o=n(5155),r=n(9137),i=n.n(r),a=n(2115),l=n(4814),s=n(6648);let c=e=>{let{isOpen:t,onClose:n,highlightText:r,articleTitle:c,shareUrl:d}=e,[m,u]=(0,a.useState)(!1);(0,a.useEffect)(()=>{if(m){let e=setTimeout(()=>u(!1),3e3);return()=>clearTimeout(e)}},[m]),(0,a.useEffect)(()=>{let e=e=>{"Escape"===e.key&&n()};return t&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[t,n]);let h=async()=>{try{await navigator.clipboard.writeText(d),u(!0)}catch(e){console.error("Failed to copy link:",e)}},g=async()=>{if(navigator.share)try{await navigator.share({title:'Highlight from "'.concat(c,'"'),text:'"'.concat(r,'" - from "').concat(c,'"'),url:d}),n()}catch(e){"AbortError"!==e.name&&console.error("Error sharing:",e)}};return t?(0,s.d5)((0,o.jsxs)("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e4,padding:"1rem"},onClick:n,className:"jsx-8795408d21c696e",children:[(0,o.jsxs)("div",{style:{backgroundColor:"white",borderRadius:"1rem",padding:"2rem",maxWidth:"500px",width:"100%",boxShadow:"0 25px 50px -12px rgba(0, 0, 0, 0.25)",position:"relative",animation:"modalSlideIn 0.3s ease-out"},onClick:e=>e.stopPropagation(),className:"jsx-8795408d21c696e",children:[(0,o.jsx)("button",{onClick:n,style:{position:"absolute",top:"1rem",right:"1rem",background:"none",border:"none",fontSize:"1.5rem",cursor:"pointer",color:"#6B7280",padding:"0.25rem",borderRadius:"0.375rem",transition:"color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.color="#374151",onMouseOut:e=>e.currentTarget.style.color="#6B7280",className:"jsx-8795408d21c696e",children:"\xd7"}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,o.jsxs)("h3",{style:{margin:"0 0 0.5rem 0",fontSize:"1.25rem",fontWeight:"600",color:"#1F2937"},className:"jsx-8795408d21c696e",children:[(0,o.jsx)(l.uQ,{size:20,color:"#3b82f6"}),"Share Highlight"]}),(0,o.jsxs)("p",{style:{margin:0,color:"#6B7280",fontSize:"0.875rem"},className:"jsx-8795408d21c696e",children:['Share this highlight from "',c,'"']})]}),(0,o.jsxs)("div",{style:{backgroundColor:"#F9FAFB",border:"2px solid #E5E7EB",borderRadius:"0.75rem",padding:"1.25rem",marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,o.jsxs)("div",{style:{fontSize:"1rem",lineHeight:"1.6",color:"#374151",fontStyle:"italic",marginBottom:"0.75rem"},className:"jsx-8795408d21c696e",children:['"',r,'"']}),(0,o.jsxs)("div",{style:{fontSize:"0.875rem",color:"#6B7280",fontWeight:"500"},className:"jsx-8795408d21c696e",children:['— from "',c,'"']})]}),(0,o.jsxs)("div",{style:{marginBottom:"1.5rem"},className:"jsx-8795408d21c696e",children:[(0,o.jsx)("label",{style:{display:"block",fontSize:"0.875rem",fontWeight:"500",color:"#374151",marginBottom:"0.5rem"},className:"jsx-8795408d21c696e",children:"Share Link"}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.5rem"},className:"jsx-8795408d21c696e",children:[(0,o.jsx)("input",{type:"text",value:d,readOnly:!0,style:{flex:1,padding:"0.75rem",border:"1px solid #D1D5DB",borderRadius:"0.5rem",fontSize:"0.875rem",backgroundColor:"#F9FAFB",fontFamily:"monospace"},className:"jsx-8795408d21c696e"}),(0,o.jsx)("button",{onClick:h,style:{padding:"0.75rem 1rem",backgroundColor:m?"#10B981":"#3B82F6",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"all 0.2s ease",whiteSpace:"nowrap"},className:"jsx-8795408d21c696e",children:m?"✓ Copied!":"\uD83D\uDCCB Copy"})]})]}),(0,o.jsxs)("div",{style:{display:"flex",gap:"0.75rem",justifyContent:"flex-end"},className:"jsx-8795408d21c696e",children:["undefined"!=typeof navigator&&"share"in navigator&&(0,o.jsx)("button",{onClick:g,style:{padding:"0.75rem 1.5rem",backgroundColor:"#6366F1",color:"white",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease",display:"flex",alignItems:"center",gap:"0.5rem"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#5B21B6",onMouseOut:e=>e.currentTarget.style.backgroundColor="#6366F1",className:"jsx-8795408d21c696e",children:"\uD83D\uDCE4 Share"}),(0,o.jsx)("button",{onClick:n,style:{padding:"0.75rem 1.5rem",backgroundColor:"#F3F4F6",color:"#374151",border:"none",borderRadius:"0.5rem",fontSize:"0.875rem",fontWeight:"500",cursor:"pointer",transition:"background-color 0.2s ease"},onMouseOver:e=>e.currentTarget.style.backgroundColor="#E5E7EB",onMouseOut:e=>e.currentTarget.style.backgroundColor="#F3F4F6",className:"jsx-8795408d21c696e",children:"Close"})]})]}),(0,o.jsx)(i(),{id:"8795408d21c696e",children:"@-webkit-keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-moz-keyframes modalSlideIn{from{opacity:0;-moz-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-moz-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@-o-keyframes modalSlideIn{from{opacity:0;-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}@keyframes modalSlideIn{from{opacity:0;-webkit-transform:translatey(-20px)scale(.95);-moz-transform:translatey(-20px)scale(.95);-o-transform:translatey(-20px)scale(.95);transform:translatey(-20px)scale(.95)}to{opacity:1;-webkit-transform:translatey(0)scale(1);-moz-transform:translatey(0)scale(1);-o-transform:translatey(0)scale(1);transform:translatey(0)scale(1)}}"})]}),document.body):null}}}]);