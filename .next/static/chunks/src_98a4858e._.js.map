{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/clientApp.ts"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Firebase configuration from environment variables\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n    measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID\n};\n///\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n// Initialize Analytics only in browser environment\nlet analytics;\nif (typeof window !== 'undefined') {\n    try {\n        analytics = getAnalytics(app);\n    } catch (error) {\n        // Analytics initialization skipped in development\n    }\n}\n\n// Initialize Firebase Authentication\nconst auth = getAuth(app);\n\n// Initialize Firestore\nconst db = getFirestore(app);\n\n// Configure custom auth actions URL\nif (typeof window !== 'undefined') {\n    const actionCodeSettings = {\n        url: `${window.location.origin}/reset-password`,\n        handleCodeInApp: true,\n    };\n\n    // We need to update this in the forgot-password component when sending the reset email\n}\n\n// // Connect to Auth Emulator in development\n// if (process.env.NODE_ENV === 'development') {\n//     // connectAuthEmulator(auth, \"http://localhost:9099\", { disableWarnings: true });\n// }\n\n/////\n\nexport { app, analytics, auth, db };"],"names":[],"mappings":"AAAA,uDAAuD;;;;;;;AAU3C;AATZ;AACA;AACA;AACA;;;;;AACA,4DAA4D;AAC5D,iEAAiE;AAEjE,oDAAoD;AACpD,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACjB;AACA,GAAG;AAEH,sBAAsB;AACtB,MAAM,MAAM,CAAA,GAAA,uLAAA,CAAA,gBAAa,AAAD,EAAE;AAE1B,mDAAmD;AACnD,IAAI;AACJ,wCAAmC;IAC/B,IAAI;QACA,YAAY,CAAA,GAAA,6KAAA,CAAA,eAAY,AAAD,EAAE;IAC7B,EAAE,OAAO,OAAO;IACZ,kDAAkD;IACtD;AACJ;AAEA,qCAAqC;AACrC,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AAErB,uBAAuB;AACvB,MAAM,KAAK,CAAA,GAAA,sKAAA,CAAA,eAAY,AAAD,EAAE;AAExB,oCAAoC;AACpC,wCAAmC;IAC/B,MAAM,qBAAqB;QACvB,KAAK,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC;QAC/C,iBAAiB;IACrB;AAEA,uFAAuF;AAC3F","debugId":null}},
    {"offset": {"line": 69, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/externalArticleService.ts"],"sourcesContent":["import {\n    collection,\n    doc,\n    setDoc,\n    getDoc,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    serverTimestamp\n} from 'firebase/firestore';\nimport { db } from '@/firebase/clientApp';\n\nexport interface ExternalArticleSocial {\n    id?: string;\n    externalId: string; // The Guardian article ID or NewsAPI URL\n    source: 'guardian' | 'newsapi';\n    title: string;\n    url: string;\n    likes: string[];\n    createdAt: any;\n    lastActivity: any;\n}\n\nexport class ExternalArticleService {\n\n    // Get or create social data for an external article\n    static async getOrCreateSocialData(\n        externalId: string,\n        source: 'guardian' | 'newsapi',\n        title: string,\n        url: string\n    ): Promise<ExternalArticleSocial> {\n        try {\n            // Encode the external ID to ensure it's safe for Firestore document IDs\n            const encodedExternalId = encodeURIComponent(externalId);\n            const socialId = `${source}-${encodedExternalId}`;\n            const socialRef = doc(db, 'external_articles', socialId);\n            const socialDoc = await getDoc(socialRef);\n\n            if (socialDoc.exists()) {\n                return { id: socialId, ...socialDoc.data() } as ExternalArticleSocial;\n            } else {\n                // Create new social data entry\n                const newSocialData: Omit<ExternalArticleSocial, 'id'> = {\n                    externalId,\n                    source,\n                    title,\n                    url,\n                    likes: [],\n                    createdAt: serverTimestamp(),\n                    lastActivity: serverTimestamp()\n                };\n\n                await setDoc(socialRef, newSocialData);\n                return { id: socialId, ...newSocialData };\n            }\n        } catch (error) {\n            console.error('Error getting or creating social data:', error);\n            throw error;\n        }\n    }\n\n    // Like or unlike an external article\n    static async toggleLike(\n        externalId: string,\n        source: 'guardian' | 'newsapi',\n        userId: string,\n        title: string,\n        url: string\n    ): Promise<{ isLiked: boolean; totalLikes: number }> {\n        try {\n            // Encode the external ID to ensure it's safe for Firestore document IDs\n            const encodedExternalId = encodeURIComponent(externalId);\n            const socialId = `${source}-${encodedExternalId}`;\n            const socialRef = doc(db, 'external_articles', socialId);\n\n            // Ensure social data exists\n            await this.getOrCreateSocialData(externalId, source, title, url);\n\n            const socialDoc = await getDoc(socialRef);\n            const socialData = socialDoc.data() as ExternalArticleSocial;\n\n            const currentLikes = socialData.likes || [];\n            const isCurrentlyLiked = currentLikes.includes(userId);\n\n            if (isCurrentlyLiked) {\n                // Unlike\n                await updateDoc(socialRef, {\n                    likes: arrayRemove(userId),\n                    lastActivity: serverTimestamp()\n                });\n                return { isLiked: false, totalLikes: currentLikes.length - 1 };\n            } else {\n                // Like\n                await updateDoc(socialRef, {\n                    likes: arrayUnion(userId),\n                    lastActivity: serverTimestamp()\n                });\n                return { isLiked: true, totalLikes: currentLikes.length + 1 };\n            }\n        } catch (error) {\n            console.error('Error toggling like:', error);\n            throw error;\n        }\n    }\n\n    // Get social data for an external article\n    static async getSocialData(externalId: string, source: 'guardian' | 'newsapi'): Promise<ExternalArticleSocial | null> {\n        try {\n            // Encode the external ID to ensure it's safe for Firestore document IDs\n            const encodedExternalId = encodeURIComponent(externalId);\n            const socialId = `${source}-${encodedExternalId}`;\n            const socialRef = doc(db, 'external_articles', socialId);\n            const socialDoc = await getDoc(socialRef);\n\n            if (socialDoc.exists()) {\n                return { id: socialId, ...socialDoc.data() } as ExternalArticleSocial;\n            }\n            return null;\n        } catch (error) {\n            console.error('Error getting social data:', error);\n            return null;\n        }\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 181, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/highlightService.ts"],"sourcesContent":["import { db } from '@/firebase/clientApp';\nimport {\n    collection,\n    doc,\n    addDoc,\n    getDocs,\n    query,\n    where,\n    deleteDoc,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    serverTimestamp\n} from 'firebase/firestore';\n\nexport type HighlightTag = 'insight' | 'question' | 'quote' | 'important';\n\nexport interface Highlight {\n    id: string;\n    articleId: string;\n    userId: string;\n    text: string;\n    prefix: string;\n    suffix: string;\n    tag: HighlightTag;\n    createdAt: any; // Firestore timestamp\n    comments?: Comment[];\n    reactions?: { [emoji: string]: number };\n    userReactions?: { [userId: string]: string }; // Track which user reacted with what emoji\n}\n\ninterface Comment {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport const saveHighlight = async (\n    articleId: string,\n    userId: string,\n    text: string,\n    prefix: string,\n    suffix: string,\n    tag: HighlightTag = 'insight'\n): Promise<string> => {\n    try {\n        const highlightData = {\n            articleId,\n            userId,\n            text,\n            prefix,\n            suffix,\n            tag,\n            createdAt: serverTimestamp(),\n            comments: [],\n            reactions: {},\n            userReactions: {}\n        };\n\n        const docRef = await addDoc(collection(db, 'highlights'), highlightData);\n        return docRef.id;\n    } catch (error) {\n        console.error('Error saving highlight:', error);\n        throw error;\n    }\n};\n\nexport const getArticleHighlights = async (articleId: string, userId?: string): Promise<Highlight[]> => {\n    try {\n        let q = query(\n            collection(db, 'highlights'),\n            where('articleId', '==', articleId)\n        );\n\n        // If userId is provided, filter by user to make highlights private\n        if (userId) {\n            q = query(\n                collection(db, 'highlights'),\n                where('articleId', '==', articleId),\n                where('userId', '==', userId)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting highlights:', error);\n        return [];\n    }\n};\n\nexport const getUserHighlights = async (userId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('userId', '==', userId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting user highlights:', error);\n        return [];\n    }\n};\n\nexport const deleteHighlight = async (highlightId: string): Promise<void> => {\n    try {\n        await deleteDoc(doc(db, 'highlights', highlightId));\n    } catch (error) {\n        console.error('Error deleting highlight:', error);\n        throw error;\n    }\n};\n\nexport const addCommentToHighlight = async (\n    highlightId: string,\n    userId: string,\n    content: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        const comment = {\n            userId,\n            content,\n            createdAt: new Date().toISOString(),\n        };\n\n        await updateDoc(highlightRef, {\n            comments: arrayUnion(comment)\n        });\n    } catch (error) {\n        console.error('Error adding comment to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeCommentFromHighlight = async (\n    highlightId: string,\n    comment: Comment\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            comments: arrayRemove(comment)\n        });\n    } catch (error) {\n        console.error('Error removing comment from highlight:', error);\n        throw error;\n    }\n};\n\nexport const addReactionToHighlight = async (\n    highlightId: string,\n    userId: string,\n    emoji: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        // Note: This is a simplified approach. In production, you'd want to use a transaction\n        // to ensure consistency when multiple users react simultaneously\n        await updateDoc(highlightRef, {\n            [`reactions.${emoji}`]: (await import('firebase/firestore')).increment(1),\n            [`userReactions.${userId}`]: emoji\n        });\n    } catch (error) {\n        console.error('Error adding reaction to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeReactionFromHighlight = async (\n    highlightId: string,\n    userId: string,\n    emoji: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            [`reactions.${emoji}`]: (await import('firebase/firestore')).increment(-1),\n            [`userReactions.${userId}`]: null\n        });\n    } catch (error) {\n        console.error('Error removing reaction from highlight:', error);\n        throw error;\n    }\n};\n\nexport const generateHighlightShareUrl = (\n    articleSlug: string,\n    highlightId: string,\n    baseUrl: string = typeof window !== 'undefined' ? window.location.origin : ''\n): string => {\n    return `${baseUrl}/articles?slug=${articleSlug}#highlight=${highlightId}`;\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 320, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/context/HighlightContext.tsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { \n  Highlight, \n  HighlightTag,\n  getArticleHighlights, \n  saveHighlight, \n  deleteHighlight \n} from '@/services/highlightService';\n\ninterface HighlightContextType {\n  highlights: Highlight[];\n  loading: boolean;\n  saveHighlight: (text: string, prefix: string, suffix: string, articleId: string, tag: HighlightTag) => Promise<string | null>;\n  removeHighlight: (highlightId: string) => Promise<void>;\n  highlightElement: (range: Range, tag: HighlightTag) => void;\n}\n\nconst HighlightContext = createContext<HighlightContextType | undefined>(undefined);\n\ninterface HighlightProviderProps {\n  children: ReactNode;\n  articleId: string;\n}\n\nexport const HighlightProvider: React.FC<HighlightProviderProps> = ({ children, articleId }) => {\n  const [highlights, setHighlights] = useState<Highlight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Load highlights for the current article (user-specific)\n  useEffect(() => {\n    const loadHighlights = async () => {\n      if (articleId && currentUser) {\n        setLoading(true);\n        try {\n          // Pass user ID to get only current user's highlights\n          const userHighlights = await getArticleHighlights(articleId, currentUser.uid);\n          setHighlights(userHighlights);\n        } catch (error) {\n          console.error('Error loading highlights:', error);\n        } finally {\n          setLoading(false);\n        }\n      } else {\n        // If no user is logged in, clear highlights\n        setHighlights([]);\n        setLoading(false);\n      }\n    };\n\n    loadHighlights();\n  }, [articleId, currentUser]);\n\n  // Save a new highlight\n  const handleSaveHighlight = async (\n    text: string, \n    prefix: string, \n    suffix: string, \n    articleId: string,\n    tag: HighlightTag\n  ): Promise<string | null> => {\n    if (!currentUser) {\n      alert('You must be logged in to highlight text');\n      return null;\n    }\n\n    try {\n      const highlightId = await saveHighlight(\n        articleId,\n        currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        tag\n      );\n\n      // Add the new highlight to state\n      const newHighlight: Highlight = {\n        id: highlightId,\n        articleId,\n        userId: currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        tag,\n        createdAt: new Date(),\n        reactions: {},\n        userReactions: {}\n      };\n\n      setHighlights(prev => [...prev, newHighlight]);\n      return highlightId;\n    } catch (error) {\n      console.error('Error saving highlight:', error);\n      return null;\n    }\n  };\n\n  // Remove a highlight\n  const handleRemoveHighlight = async (highlightId: string): Promise<void> => {\n    try {\n      await deleteHighlight(highlightId);\n      setHighlights(prev => prev.filter(h => h.id !== highlightId));\n    } catch (error) {\n      console.error('Error removing highlight:', error);\n    }\n  };\n\n  // Apply highlight styling to a DOM element with improved range handling\n  const highlightElement = (range: Range, tag: HighlightTag): void => {\n    try {\n      // Get the exact selected text without trimming to preserve formatting\n      const selectedText = range.toString();\n      if (!selectedText) return;\n      \n      // Use the original range without modification to preserve exact selection\n      const highlightMark = document.createElement('mark');\n      highlightMark.className = `article-highlight highlight-${tag}`;\n    \n      // Use a safer approach that preserves text structure\n    try {\n        // Try surrounding contents first\n      range.surroundContents(highlightMark);\n      } catch (error) {\n        // If that fails, try extracting and inserting\n        try {\n          const contents = range.extractContents();\n          highlightMark.appendChild(contents);\n          range.insertNode(highlightMark);\n        } catch (innerError) {\n          // Last resort: clone contents to avoid moving elements\n          const contents = range.cloneContents();\n          highlightMark.appendChild(contents);\n          range.deleteContents();\n          range.insertNode(highlightMark);\n        }\n      }\n      \n      // Clear the selection to prevent UI confusion\n      window.getSelection()?.removeAllRanges();\n      \n    } catch (error) {\n      console.error('Error highlighting range:', error);\n      // Restore selection if highlight fails\n      window.getSelection()?.removeAllRanges();\n      window.getSelection()?.addRange(range);\n    }\n  };\n\n  const contextValue: HighlightContextType = {\n    highlights,\n    loading,\n    saveHighlight: handleSaveHighlight,\n    removeHighlight: handleRemoveHighlight,\n    highlightElement,\n  };\n\n  return (\n    <HighlightContext.Provider value={contextValue}>\n      {children}\n    </HighlightContext.Provider>\n  );\n};\n\nexport const useHighlights = (): HighlightContextType => {\n  const context = useContext(HighlightContext);\n  if (context === undefined) {\n    throw new Error('useHighlights must be used within a HighlightProvider');\n  }\n  return context;\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 495, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/icons/CustomIcons.tsx"],"sourcesContent":["import React from 'react';\n\ninterface IconProps {\n  size?: number;\n  color?: string;\n  className?: string;\n}\n\nexport const NotificationIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\" \n      fill={color}\n    />\n    <path \n      d=\"M13.73 21a2 2 0 0 1-3.46 0\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\nexport const ThoughtIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    />\n  </svg>\n);\n\nexport const SparkleIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8L12 2z\" \n      fill={color}\n    />\n    <path \n      d=\"M8 3l1 3 3 1-3 1-1 3-1-3-3-1 3-1 1-3z\" \n      fill={color}\n      opacity=\"0.6\"\n    />\n  </svg>\n);\n\nexport const CommentIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    />\n  </svg>\n);\n\nexport const ThumbsUpIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M14 9V5a3 3 0 0 0-3-3l-4 9v11h11.28a2 2 0 0 0 2-1.7l1.38-9a2 2 0 0 0-2-2.3zM7 22H4a2 2 0 0 1-2-2v-7a2 2 0 0 1 2-2h3\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    />\n  </svg>\n);\n\nexport const HeartIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z\" \n      fill={color}\n    />\n  </svg>\n);\n\nexport const ThinkingIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"12\" cy=\"17\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const BulbIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M9 21h6m-6 0v-1a3 3 0 0 1 3-3h0a3 3 0 0 1 3 3v1m-6 0h6m-1-9a4 4 0 1 1-8 0 4 4 0 0 1 8 0z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    />\n  </svg>\n);\n\nexport const StarIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <polygon \n      points=\"12,2 15.09,8.26 22,9.27 17,14.14 18.18,21.02 12,17.77 5.82,21.02 7,14.14 2,9.27 8.91,8.26\" \n      fill={color}\n    />\n  </svg>\n);\n\nexport const WarningIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n      fill=\"none\"\n    />\n    <line x1=\"12\" y1=\"9\" x2=\"12\" y2=\"13\" stroke={color} strokeWidth=\"2\"/>\n    <circle cx=\"12\" cy=\"17\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const SendIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <line x1=\"22\" y1=\"2\" x2=\"11\" y2=\"13\" stroke={color} strokeWidth=\"2\"/>\n    <polygon points=\"22,2 15,22 11,13 2,9\" fill={color}/>\n  </svg>\n);\n\nexport const ShareIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"18\" cy=\"5\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"6\" cy=\"12\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"18\" cy=\"19\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\" stroke={color} strokeWidth=\"2\"/>\n    <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\" stroke={color} strokeWidth=\"2\"/>\n  </svg>\n);\n\nexport const LockIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"11\" rx=\"2\" ry=\"2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n  </svg>\n);\n\nexport const InspirationIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.77 5.82 22l1.18-7.86-5-4.87 6.91-1.01L12 2z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      fill=\"none\"\n    />\n    <circle cx=\"12\" cy=\"12\" r=\"3\" fill={color} opacity=\"0.3\"/>\n  </svg>\n);\n\nexport const PaletteIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"13.5\" cy=\"6.5\" r=\".5\" fill={color}/>\n    <circle cx=\"17.5\" cy=\"10.5\" r=\".5\" fill={color}/>\n    <circle cx=\"8.5\" cy=\"7.5\" r=\".5\" fill={color}/>\n    <circle cx=\"6.5\" cy=\"12.5\" r=\".5\" fill={color}/>\n    <path \n      d=\"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      fill=\"none\"\n    />\n  </svg>\n);\n\nexport const LoadingIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n    style={{ animation: 'spin 1s linear infinite' }}\n  >\n    <circle \n      cx=\"12\" \n      cy=\"12\" \n      r=\"10\" \n      stroke={color} \n      strokeWidth=\"2\" \n      strokeDasharray=\"60\"\n      strokeDashoffset=\"20\"\n      fill=\"none\"\n      strokeLinecap=\"round\"\n    />\n    <style jsx>{`\n      @keyframes spin {\n        from { transform: rotate(0deg); }\n        to { transform: rotate(360deg); }\n      }\n    `}</style>\n  </svg>\n);\n\nexport const ReflectionIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M19 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      fill=\"none\"\n    />\n    <path \n      d=\"M7 12h10m-5-4v8\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n    />\n    <circle cx=\"12\" cy=\"8\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const AutoIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M12 2v6.5l4.5-4.5M12 22v-6.5l-4.5 4.5M22 12h-6.5l4.5-4.5M2 12h6.5L4 7.5\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n    <circle cx=\"12\" cy=\"12\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n  </svg>\n);\n\nexport const DiceIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"8\" cy=\"8\" r=\"1\" fill={color}/>\n    <circle cx=\"12\" cy=\"12\" r=\"1\" fill={color}/>\n    <circle cx=\"16\" cy=\"16\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const LockClosedIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <rect x=\"3\" y=\"11\" width=\"18\" height=\"10\" rx=\"2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M7 11V7a5 5 0 0 1 10 0v4\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"12\" cy=\"16\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const UserIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path d=\"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"12\" cy=\"7\" r=\"4\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n  </svg>\n);\n\nexport const SettingsIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M12 1v6m0 10v6m11-7h-6m-10 0H1m15.5-3.5L19 9.5m-14 5L7.5 12M16.5 7.5L19 5m-14 14l2.5-2.5\" stroke={color} strokeWidth=\"2\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nexport const ComputerIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <rect x=\"2\" y=\"3\" width=\"20\" height=\"14\" rx=\"2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <line x1=\"8\" y1=\"21\" x2=\"16\" y2=\"21\" stroke={color} strokeWidth=\"2\"/>\n    <line x1=\"12\" y1=\"17\" x2=\"12\" y2=\"21\" stroke={color} strokeWidth=\"2\"/>\n  </svg>\n);\n\nexport const TheaterIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path d=\"M2 12c3-5 7-8 10-8s7 3 10 8c-3 5-7 8-10 8s-7-3-10-8z\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"12\" cy=\"12\" r=\"3\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M8 2l1.5 4L12 2l2.5 4L16 2\" stroke={color} strokeWidth=\"2\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nexport const RocketIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path d=\"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M12 15l-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n  </svg>\n);\n\nexport const EnhancedIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path d=\"M12 2l3.09 6.26L22 9.27l-5 4.87L18.18 22 12 18.77 5.82 22l1.18-7.86-5-4.87 6.91-1.01L12 2z\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M12 8v8m-4-4h8\" stroke={color} strokeWidth=\"1.5\" strokeLinecap=\"round\"/>\n  </svg>\n);\n\nexport const AtmosphereIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"10\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M8 12c0-2.21 1.79-4 4-4s4 1.79 4 4\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M10 16c0-1.1.9-2 2-2s2 .9 2 2\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <circle cx=\"12\" cy=\"8\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const WriteIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n    <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" stroke={color} strokeWidth=\"2\" fill=\"none\"/>\n  </svg>\n);\n\nexport const CloseIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\" stroke={color} strokeWidth=\"2\"/>\n    <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\" stroke={color} strokeWidth=\"2\"/>\n  </svg>\n);\n\nexport const ReplyIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M9 17l-4-4 4-4M5 13h11a4 4 0 0 1 0 8h-1\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n);\n\nexport const DotsVerticalIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <circle cx=\"12\" cy=\"12\" r=\"1\" fill={color}/>\n    <circle cx=\"12\" cy=\"5\" r=\"1\" fill={color}/>\n    <circle cx=\"12\" cy=\"19\" r=\"1\" fill={color}/>\n  </svg>\n);\n\nexport const TrashIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M3 6h18M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2m3 0v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6h14z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n    <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\" stroke={color} strokeWidth=\"2\"/>\n    <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\" stroke={color} strokeWidth=\"2\"/>\n  </svg>\n);\n\nexport const EditIcon: React.FC<IconProps> = ({ size = 20, color = 'currentColor', className }) => (\n  <svg \n    width={size} \n    height={size} \n    viewBox=\"0 0 24 24\" \n    fill=\"none\" \n    xmlns=\"http://www.w3.org/2000/svg\"\n    className={className}\n  >\n    <path \n      d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n    <path \n      d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\" \n      stroke={color}\n      strokeWidth=\"2\"\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    />\n  </svg>\n); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1912, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/HighlightToolbar.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\nimport { HighlightTag } from '@/services/highlightService';\nimport { BulbIcon, ThinkingIcon, CommentIcon, StarIcon } from './icons/CustomIcons';\n\ninterface HighlightToolbarProps {\n  selection: Selection | null;\n  onHighlight: (selectedText: string, range: Range, tag: HighlightTag) => void;\n  onResponse?: (selectedText: string) => void;\n  onShare?: (selectedText: string) => void;\n  onAiAssist?: (selectedText: string) => void;\n}\n\nconst highlightTags: { tag: HighlightTag; label: string; color: string; icon: React.FC<any> }[] = [\n  { tag: 'insight', label: 'Insight', color: '#3B82F6', icon: BulbIcon },\n  { tag: 'question', label: 'Question', color: '#F59E0B', icon: ThinkingIcon },\n  { tag: 'quote', label: 'Quote', color: '#10B981', icon: CommentIcon },\n  { tag: 'important', label: 'Important', color: '#EF4444', icon: StarIcon }\n];\n\nconst HighlightToolbar: React.FC<HighlightToolbarProps> = ({ \n  selection, \n  onHighlight, \n  onResponse, \n  onShare, \n  onAiAssist \n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const [isVisible, setIsVisible] = useState(false);\n  const [showColorOptions, setShowColorOptions] = useState(false);\n  const toolbarRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // Don't show toolbar if no selection or empty selection\n    if (!selection || selection.isCollapsed) {\n      setIsVisible(false);\n      setShowColorOptions(false);\n      return;\n    }\n\n    // Get the selection's bounding rectangle\n    const range = selection.getRangeAt(0);\n    const rect = range.getBoundingClientRect();\n\n    // Get viewport and toolbar dimensions\n    const windowWidth = window.innerWidth;\n    const windowHeight = window.innerHeight;\n    const toolbarWidth = toolbarRef.current?.offsetWidth || 280;\n    const toolbarHeight = toolbarRef.current?.offsetHeight || 40;\n    \n    // Calculate horizontal position (keep within viewport)\n    let left = rect.left + rect.width / 2;\n    const margin = 16; // Margin from screen edges\n    \n    // Ensure toolbar doesn't go off screen horizontally\n    if (left - toolbarWidth / 2 < margin) {\n      left = toolbarWidth / 2 + margin;\n    } else if (left + toolbarWidth / 2 > windowWidth - margin) {\n      left = windowWidth - toolbarWidth / 2 - margin;\n    }\n    \n    // Calculate vertical position\n    let top = rect.top - toolbarHeight - 10 + window.scrollY;\n    \n    // If toolbar would be above viewport, place it below selection\n    if (rect.top - toolbarHeight - 10 < 0) {\n      top = rect.bottom + 10 + window.scrollY;\n    }\n    \n    // Additional mobile-specific adjustments\n    const isMobile = windowWidth <= 768;\n    if (isMobile) {\n      // On mobile, ensure toolbar is always visible\n      const viewportTop = window.scrollY;\n      const viewportBottom = window.scrollY + windowHeight;\n      \n      // If toolbar would be above viewport\n      if (top < viewportTop + margin) {\n        top = viewportTop + margin;\n      }\n      \n      // If toolbar would be below viewport\n      if (top + toolbarHeight > viewportBottom - margin) {\n        top = viewportBottom - toolbarHeight - margin;\n      }\n    }\n\n    setPosition({ top, left });\n    \n    // Show the toolbar\n    setIsVisible(true);\n  }, [selection]);\n\n  // Handle highlighting action with tag\n  const handleHighlight = (tag: HighlightTag) => {\n    if (selection && !selection.isCollapsed) {\n      const range = selection.getRangeAt(0);\n      const selectedText = selection.toString();\n      onHighlight(selectedText, range, tag);\n      // Clear selection after highlighting\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n      setShowColorOptions(false);\n    }\n  };\n\n  // Toggle color options\n  const toggleColorOptions = () => {\n    setShowColorOptions(!showColorOptions);\n  };\n\n  // Handle response action\n  const handleResponse = () => {\n    if (selection && !selection.isCollapsed && onResponse) {\n      const selectedText = selection.toString();\n      onResponse(selectedText);\n      // Clear selection after response\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle share action\n  const handleShare = () => {\n    if (selection && !selection.isCollapsed && onShare) {\n      const selectedText = selection.toString();\n      onShare(selectedText);\n      // Clear selection after share\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle AI assist action\n  const handleAiAssist = () => {\n    if (selection && !selection.isCollapsed && onAiAssist) {\n      const selectedText = selection.toString();\n      onAiAssist(selectedText);\n      // Clear selection after AI assist\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Only render if there's a valid selection and in browser\n  if (!isVisible || typeof window === 'undefined') {\n    return null;\n  }\n\n  // Use portal to render outside of article container\n  return createPortal(\n    <div \n      ref={toolbarRef}\n      className=\"highlight-toolbar\"\n      style={{\n        position: 'absolute',\n        top: `${position.top}px`,\n        left: `${position.left}px`,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n      }}\n    >\n      {!showColorOptions ? (\n        <>\n          <button onClick={toggleColorOptions} className=\"highlight-btn highlight-btn-main\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n              <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\n            </svg>\n            <span>Highlight</span>\n          </button>\n          \n          {onResponse && (\n            <button onClick={handleResponse} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n              </svg>\n              <span>Response</span>\n            </button>\n          )}\n          \n          {onShare && (\n            <button onClick={handleShare} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n                <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n                <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n                <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n                <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n              </svg>\n              <span>Share</span>\n            </button>\n          )}\n          \n          {onAiAssist && (\n            <button onClick={handleAiAssist} className=\"highlight-btn\">\n              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n                <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n                <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line>\n                <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line>\n              </svg>\n              <span>Journa AI</span>\n            </button>\n          )}\n        </>\n      ) : (\n        <div className=\"highlight-color-options\">\n          <span className=\"highlight-color-label\">Choose highlight type:</span>\n          {highlightTags.map((tagInfo) => {\n            const IconComponent = tagInfo.icon;\n            return (\n              <button\n                key={tagInfo.tag}\n                onClick={() => handleHighlight(tagInfo.tag)}\n                className=\"highlight-color-btn\"\n                style={{ backgroundColor: tagInfo.color }}\n                title={tagInfo.label}\n              >\n                <span className=\"highlight-icon\">\n                  <IconComponent size={14} color=\"white\" />\n                </span>\n                <span className=\"highlight-label\">{tagInfo.label}</span>\n              </button>\n            );\n          })}\n          <button onClick={toggleColorOptions} className=\"highlight-btn highlight-btn-cancel\">\n            Cancel\n          </button>\n        </div>\n      )}\n    </div>,\n    document.body\n  );\n};\n\nexport default HighlightToolbar; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2399, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ShareModal.tsx"],"sourcesContent":["'use client';\n\nimport React, { useEffect, useState } from 'react';\nimport { SparkleIcon } from './icons/CustomIcons';\n// import styles from './ShareModal.module.css'; // Unused\nimport { createPortal } from 'react-dom';\n\ninterface ShareModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  highlightText: string;\n  articleTitle: string;\n  shareUrl: string;\n}\n\nconst ShareModal: React.FC<ShareModalProps> = ({\n  isOpen,\n  onClose,\n  highlightText,\n  articleTitle,\n  shareUrl\n}) => {\n  const [copied, setCopied] = useState(false);\n\n  useEffect(() => {\n    if (copied) {\n      const timer = setTimeout(() => setCopied(false), 3000);\n      return () => clearTimeout(timer);\n    }\n  }, [copied]);\n\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') onClose();\n    };\n    \n    if (isOpen) {\n      document.addEventListener('keydown', handleEscape);\n      document.body.style.overflow = 'hidden';\n    }\n    \n    return () => {\n      document.removeEventListener('keydown', handleEscape);\n      document.body.style.overflow = 'unset';\n    };\n  }, [isOpen, onClose]);\n\n  const handleCopyLink = async () => {\n    try {\n      await navigator.clipboard.writeText(shareUrl);\n      setCopied(true);\n    } catch (error) {\n      console.error('Failed to copy link:', error);\n    }\n  };\n\n  const handleNativeShare = async () => {\n    if (navigator.share) {\n      try {\n        await navigator.share({\n          title: `Highlight from \"${articleTitle}\"`,\n          text: `\"${highlightText}\" - from \"${articleTitle}\"`,\n          url: shareUrl,\n        });\n        onClose();\n             } catch (error: any) {\n         if (error.name !== 'AbortError') {\n           console.error('Error sharing:', error);\n         }\n       }\n    }\n  };\n\n  // const shareText = `\"${highlightText}\" - from \"${articleTitle}\"`; // Unused\n\n  if (!isOpen) return null;\n\n  return createPortal(\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: 'rgba(0, 0, 0, 0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 10000,\n        padding: '1rem'\n      }}\n      onClick={onClose}\n    >\n      <div\n        style={{\n          backgroundColor: 'white',\n          borderRadius: '1rem',\n          padding: '2rem',\n          maxWidth: '500px',\n          width: '100%',\n          boxShadow: '0 25px 50px -12px rgba(0, 0, 0, 0.25)',\n          position: 'relative',\n          animation: 'modalSlideIn 0.3s ease-out'\n        }}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Close button */}\n        <button\n          onClick={onClose}\n          style={{\n            position: 'absolute',\n            top: '1rem',\n            right: '1rem',\n            background: 'none',\n            border: 'none',\n            fontSize: '1.5rem',\n            cursor: 'pointer',\n            color: '#6B7280',\n            padding: '0.25rem',\n            borderRadius: '0.375rem',\n            transition: 'color 0.2s ease'\n          }}\n          onMouseOver={(e) => e.currentTarget.style.color = '#374151'}\n          onMouseOut={(e) => e.currentTarget.style.color = '#6B7280'}\n        >\n          ×\n        </button>\n\n        {/* Header */}\n        <div style={{ marginBottom: '1.5rem' }}>\n          <h3 style={{\n            margin: '0 0 0.5rem 0',\n            fontSize: '1.25rem',\n            fontWeight: '600',\n            color: '#1F2937'\n          }}>\n            <SparkleIcon size={20} color=\"#3b82f6\" />\n            Share Highlight\n          </h3>\n          <p style={{\n            margin: 0,\n            color: '#6B7280',\n            fontSize: '0.875rem'\n          }}>\n            Share this highlight from \"{articleTitle}\"\n          </p>\n        </div>\n\n        {/* Preview */}\n        <div style={{\n          backgroundColor: '#F9FAFB',\n          border: '2px solid #E5E7EB',\n          borderRadius: '0.75rem',\n          padding: '1.25rem',\n          marginBottom: '1.5rem'\n        }}>\n          <div style={{\n            fontSize: '1rem',\n            lineHeight: '1.6',\n            color: '#374151',\n            fontStyle: 'italic',\n            marginBottom: '0.75rem'\n          }}>\n            \"{highlightText}\"\n          </div>\n          <div style={{\n            fontSize: '0.875rem',\n            color: '#6B7280',\n            fontWeight: '500'\n          }}>\n            — from \"{articleTitle}\"\n          </div>\n        </div>\n\n        {/* Share URL */}\n        <div style={{ marginBottom: '1.5rem' }}>\n          <label style={{\n            display: 'block',\n            fontSize: '0.875rem',\n            fontWeight: '500',\n            color: '#374151',\n            marginBottom: '0.5rem'\n          }}>\n            Share Link\n          </label>\n          <div style={{\n            display: 'flex',\n            gap: '0.5rem'\n          }}>\n            <input\n              type=\"text\"\n              value={shareUrl}\n              readOnly\n              style={{\n                flex: 1,\n                padding: '0.75rem',\n                border: '1px solid #D1D5DB',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                backgroundColor: '#F9FAFB',\n                fontFamily: 'monospace'\n              }}\n            />\n            <button\n              onClick={handleCopyLink}\n              style={{\n                padding: '0.75rem 1rem',\n                backgroundColor: copied ? '#10B981' : '#3B82F6',\n                color: 'white',\n                border: 'none',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                fontWeight: '500',\n                cursor: 'pointer',\n                transition: 'all 0.2s ease',\n                whiteSpace: 'nowrap'\n              }}\n            >\n              {copied ? '✓ Copied!' : '📋 Copy'}\n            </button>\n          </div>\n        </div>\n\n        {/* Action buttons */}\n        <div style={{\n          display: 'flex',\n          gap: '0.75rem',\n          justifyContent: 'flex-end'\n        }}>\n                     {typeof window !== 'undefined' && typeof navigator !== 'undefined' && 'share' in navigator && (\n            <button\n              onClick={handleNativeShare}\n              style={{\n                padding: '0.75rem 1.5rem',\n                backgroundColor: '#6366F1',\n                color: 'white',\n                border: 'none',\n                borderRadius: '0.5rem',\n                fontSize: '0.875rem',\n                fontWeight: '500',\n                cursor: 'pointer',\n                transition: 'background-color 0.2s ease',\n                display: 'flex',\n                alignItems: 'center',\n                gap: '0.5rem'\n              }}\n              onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#5B21B6'}\n              onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#6366F1'}\n            >\n              📤 Share\n            </button>\n          )}\n          \n          <button\n            onClick={onClose}\n            style={{\n              padding: '0.75rem 1.5rem',\n              backgroundColor: '#F3F4F6',\n              color: '#374151',\n              border: 'none',\n              borderRadius: '0.5rem',\n              fontSize: '0.875rem',\n              fontWeight: '500',\n              cursor: 'pointer',\n              transition: 'background-color 0.2s ease'\n            }}\n            onMouseOver={(e) => e.currentTarget.style.backgroundColor = '#E5E7EB'}\n            onMouseOut={(e) => e.currentTarget.style.backgroundColor = '#F3F4F6'}\n          >\n            Close\n          </button>\n        </div>\n      </div>\n\n      <style jsx>{`\n        @keyframes modalSlideIn {\n          from {\n            opacity: 0;\n            transform: translateY(-20px) scale(0.95);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0) scale(1);\n          }\n        }\n      `}</style>\n    </div>,\n    document.body\n  );\n};\n\nexport default ShareModal; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2813, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleHighlights.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport HighlightToolbar from './HighlightToolbar';\nimport { useHighlights } from '@/context/HighlightContext';\nimport { HighlightTag, generateHighlightShareUrl } from '@/services/highlightService';\n// import { Highlight } from '@/services/highlightService'; // Unused type import\nimport ShareModal from './ShareModal';\n\ninterface ArticleHighlightsProps {\n  articleId: string;\n  children: React.ReactNode;\n  articleTitle?: string;\n  articleSlug?: string;\n  // onShare?: (text: string) => void; // Optional share handler - currently unused\n}\n\n// Get context for a selection with improved handling that preserves formatting\nconst getSelectionContext = (selection: Selection): { prefix: string; suffix: string } => {\n  const result = { prefix: '', suffix: '' };\n  \n  if (!selection || selection.rangeCount === 0) return result;\n  \n  const range = selection.getRangeAt(0);\n  const selectedText = range.toString();\n  \n  // Get the full text content of the container\n  const container = range.commonAncestorContainer;\n  const containerElement = container.nodeType === Node.TEXT_NODE ? container.parentElement : container;\n  \n  if (!containerElement) return result;\n  \n  // Get all text content from the container preserving original formatting\n  const fullText = containerElement.textContent || '';\n  \n  // Find the position of our selected text in the full text (exact match first)\n  let startIndex = fullText.indexOf(selectedText);\n  \n  // If exact match fails, try with normalized spaces as fallback\n  if (startIndex === -1) {\n    const normalizedSelectedText = selectedText.replace(/\\s+/g, ' ').trim();\n    const normalizedFullText = fullText.replace(/\\s+/g, ' ');\n    const normalizedStartIndex = normalizedFullText.indexOf(normalizedSelectedText);\n    \n    if (normalizedStartIndex !== -1) {\n      // Map back to original text position - this is approximate\n      startIndex = normalizedStartIndex;\n    }\n  }\n  \n  if (startIndex !== -1) {\n    // Get context with word boundaries to avoid partial word issues\n    const contextLength = 50;\n    const prefixStart = Math.max(0, startIndex - contextLength);\n    const suffixEnd = Math.min(fullText.length, startIndex + selectedText.length + contextLength);\n    \n    // Extract prefix and suffix preserving original formatting\n    let prefix = fullText.substring(prefixStart, startIndex);\n    let suffix = fullText.substring(startIndex + selectedText.length, suffixEnd);\n    \n    // Only trim word boundaries, not all whitespace\n    prefix = prefix.replace(/^\\S*\\s/, ''); // Remove partial word at start\n    suffix = suffix.replace(/\\s\\S*$/, ''); // Remove partial word at end\n    \n    result.prefix = prefix;\n    result.suffix = suffix;\n  }\n  \n  return result;\n};\n\n// Apply highlights to existing content in the DOM\nconst applyHighlightsToContent = (highlights: any[], articleContent: HTMLElement): void => {\n  if (!highlights || !articleContent) return;\n  \n  // Check if highlights are already applied correctly\n  const existingHighlights = articleContent.querySelectorAll('.article-highlight');\n  const existingHighlightIds = Array.from(existingHighlights).map(el => el.getAttribute('data-highlight-id')).filter(Boolean);\n  const newHighlightIds = highlights.map(h => h.id);\n  \n  // If the same highlights are already applied, don't re-apply\n  if (existingHighlightIds.length === newHighlightIds.length && \n      existingHighlightIds.every(id => newHighlightIds.includes(id))) {\n    return;\n  }\n  \n  // First clear existing highlights to prevent duplicates\n  existingHighlights.forEach(el => {\n    const parent = el.parentNode;\n    if (parent) {\n      // Replace the highlight with its text content\n      const textNode = document.createTextNode(el.textContent || '');\n      parent.replaceChild(textNode, el);\n      // Normalize to merge adjacent text nodes\n      parent.normalize();\n    }\n  });\n  \n  // Track highlights that couldn't be applied for cleanup\n  const failedHighlights: string[] = [];\n  \n  // Then apply all highlights from the database\n  highlights.forEach(highlight => {\n    // Enhanced function to find text in the DOM with better formatting preservation\n    const findTextInDOM = (text: string, prefix: string, suffix: string): Range | null => {\n      \n      // Strategy 1: Try exact text match first (preserves all formatting)\n      const walker = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      let node;\n      while (node = walker.nextNode()) {\n        const content = node.textContent || '';\n        const index = content.indexOf(text);\n        \n        if (index !== -1) {\n          const range = document.createRange();\n          range.setStart(node, index);\n          range.setEnd(node, index + text.length);\n          return range;\n        }\n      }\n      \n      // Strategy 2: Try with relaxed whitespace matching for poetry/formatted text\n      const walker2 = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      // Create a more flexible pattern that accounts for different whitespace\n      const createFlexiblePattern = (str: string): RegExp => {\n        // Escape special regex characters but keep spaces flexible\n        const escaped = str.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&');\n        // Replace any sequence of whitespace with flexible whitespace matcher\n        const flexible = escaped.replace(/\\s+/g, '\\\\s+');\n        return new RegExp(flexible, 'i');\n      };\n      \n      let node2;\n      while (node2 = walker2.nextNode()) {\n        const content = node2.textContent || '';\n        const flexiblePattern = createFlexiblePattern(text);\n        const match = content.match(flexiblePattern);\n        \n        if (match && match.index !== undefined) {\n          const range = document.createRange();\n          range.setStart(node2, match.index);\n          range.setEnd(node2, match.index + match[0].length);\n          return range;\n        }\n      }\n      \n      // Strategy 3: Try with context if above strategies fail\n      if (prefix || suffix) {\n        const walker3 = document.createTreeWalker(\n          articleContent,\n          NodeFilter.SHOW_TEXT,\n          null\n        );\n        \n        // Create context pattern with flexible whitespace\n        const contextText = prefix + text + suffix;\n        const contextPattern = createFlexiblePattern(contextText);\n        \n        let node3;\n        while (node3 = walker3.nextNode()) {\n          const content = node3.textContent || '';\n          const match = content.match(contextPattern);\n          \n          if (match && match.index !== undefined) {\n            // Find the actual text within the context match\n            const fullMatch = match[0];\n            const prefixPattern = createFlexiblePattern(prefix);\n            const prefixMatch = fullMatch.match(prefixPattern);\n            const prefixLength = prefixMatch ? prefixMatch[0].length : 0;\n            \n            const range = document.createRange();\n            const textStart = match.index + prefixLength;\n            const textPattern = createFlexiblePattern(text);\n            const textInContext = fullMatch.substring(prefixLength);\n            const textMatch = textInContext.match(textPattern);\n            \n            if (textMatch) {\n              range.setStart(node3, textStart);\n              range.setEnd(node3, textStart + textMatch[0].length);\n              return range;\n            }\n          }\n        }\n      }\n      \n      // Strategy 4: Last resort - normalized search (original behavior as fallback)\n      const walker4 = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      const contextPattern = (prefix + text + suffix).replace(/\\s+/g, ' ').trim();\n      \n      let node4;\n      while (node4 = walker4.nextNode()) {\n        const content = node4.textContent || '';\n        const normalizedContent = content.replace(/\\s+/g, ' ');\n        const index = normalizedContent.indexOf(contextPattern);\n        \n        if (index !== -1) {\n          const range = document.createRange();\n          const prefixLength = prefix.replace(/\\s+/g, ' ').trim().length;\n          const startIndex = index + (prefixLength > 0 ? prefixLength + 1 : 0);\n          range.setStart(node4, startIndex);\n          range.setEnd(node4, startIndex + text.replace(/\\s+/g, ' ').trim().length);\n          return range;\n        }\n      }\n      \n      return null;\n    };\n    \n    // Try to find and highlight the text\n    const range = findTextInDOM(highlight.text, highlight.prefix || '', highlight.suffix || '');\n    if (range) {\n      try {\n        // Create highlight mark\n        const mark = document.createElement('mark');\n        mark.className = `article-highlight highlight-${highlight.tag || 'insight'}`;\n        mark.dataset.highlightId = highlight.id;\n        \n        // Apply highlight with better error handling\n        try {\n        range.surroundContents(mark);\n        } catch (surroundError) {\n          // Fallback approach\n          const contents = range.extractContents();\n          mark.appendChild(contents);\n          range.insertNode(mark);\n        }\n        \n        console.log(`✅ Applied highlight \"${highlight.text.substring(0, 30)}...\" with ID: ${highlight.id}`);\n      } catch (error) {\n        console.error('Error applying highlight:', error, {\n          text: highlight.text,\n          id: highlight.id,\n          tag: highlight.tag\n        });\n        failedHighlights.push(highlight.id);\n      }\n    } else {\n      console.warn(`❌ Could not find text for highlight: \"${highlight.text.substring(0, 30)}...\" with ID: ${highlight.id}`);\n      failedHighlights.push(highlight.id);\n    }\n  });\n  \n  // Clean up failed highlights after a few attempts\n  if (failedHighlights.length > 0) {\n    console.log(`🧹 Found ${failedHighlights.length} highlights that couldn't be applied. These might be from old text formatting.`);\n    \n    // Store failed highlights in sessionStorage to track across re-renders\n    const storageKey = `failed-highlights-${location.pathname}`;\n    const existingFailed = JSON.parse(sessionStorage.getItem(storageKey) || '{}');\n    \n    failedHighlights.forEach(id => {\n      existingFailed[id] = (existingFailed[id] || 0) + 1;\n    });\n    \n    sessionStorage.setItem(storageKey, JSON.stringify(existingFailed));\n    \n    // If a highlight has failed 3+ times, suggest cleanup\n    const persistentlyFailed = Object.entries(existingFailed)\n      .filter(([_, count]) => (count as number) >= 3)\n      .map(([id]) => id);\n    \n    if (persistentlyFailed.length > 0) {\n      console.log(`🗑️  Suggesting cleanup of ${persistentlyFailed.length} persistently failed highlights`);\n      \n      // Show a one-time cleanup notification\n      const notificationShown = sessionStorage.getItem(`cleanup-notification-${location.pathname}`);\n      if (!notificationShown) {\n        // Automatically clean up broken highlights from text format change\n        console.log('🔄 Auto-cleaning broken highlights from text format change...');\n        setTimeout(() => {\n          persistentlyFailed.forEach(async (id) => {\n            try {\n              // We need access to removeHighlight function, so let's emit a custom event\n              const cleanupEvent = new CustomEvent('cleanup-broken-highlight', { \n                detail: { highlightId: id } \n              });\n              window.dispatchEvent(cleanupEvent);\n            } catch (error) {\n              console.error('Failed to cleanup highlight:', id, error);\n            }\n          });\n        }, 1000);\n        \n        sessionStorage.setItem(`cleanup-notification-${location.pathname}`, 'shown');\n      }\n    }\n  }\n};\n\nconst ArticleHighlights: React.FC<ArticleHighlightsProps> = ({ articleId, children, articleTitle = 'Article', articleSlug = '' }) => {\n  const [selection, setSelection] = useState<Selection | null>(null);\n  const { highlights, saveHighlight, removeHighlight, highlightElement } = useHighlights();\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\n  const [showResponseModal, setShowResponseModal] = useState(false);\n  const [selectedTextForResponse, setSelectedTextForResponse] = useState('');\n  const [showAiModal, setShowAiModal] = useState(false);\n  const [selectedTextForAi, setSelectedTextForAi] = useState('');\n  const [activeHighlight, setActiveHighlight] = useState<{ id: string, text: string } | null>(null);\n  const [showUnhighlightToolbar, setShowUnhighlightToolbar] = useState(false);\n  const [isHidingToolbar, setIsHidingToolbar] = useState(false);\n  const [unhighlightPosition, setUnhighlightPosition] = useState({ top: 0, left: 0 });\n  const [showShareModal, setShowShareModal] = useState(false);\n  const [shareHighlightText, setShareHighlightText] = useState('');\n  \n  // Function to hide toolbar with animation\n  const hideToolbarWithAnimation = useCallback(() => {\n    setIsHidingToolbar(true);\n    // After animation completes, actually hide the toolbar\n    setTimeout(() => {\n      setShowUnhighlightToolbar(false);\n      setIsHidingToolbar(false);\n    }, 150); // Match this with CSS transition duration\n  }, []);\n  \n  // Handle text selection with simple debouncing\n  const handleSelection = useCallback(() => {\n    // If unhighlight toolbar is active, don't process regular selections\n    if (showUnhighlightToolbar) return;\n    \n    const currentSelection = window.getSelection();\n    if (currentSelection && !currentSelection.isCollapsed) {\n      const selectedText = currentSelection.toString();\n      const trimmedText = selectedText.trim();\n      \n      // Filter out selections that are too long (likely accidental)\n      if (trimmedText && trimmedText.length > 0 && selectedText.length < 1000) {\n        // Check if selection is within our article content\n        const range = currentSelection.getRangeAt(0);\n        const container = range.commonAncestorContainer;\n        const articleContainer = container.nodeType === Node.TEXT_NODE \n          ? container.parentElement?.closest('.article-highlight-container')\n          : (container as Element)?.closest('.article-highlight-container');\n        \n        if (articleContainer) {\n          setSelection(currentSelection);\n        } else {\n          setSelection(null);\n        }\n      } else {\n        setSelection(null);\n      }\n    } else {\n      setSelection(null);\n    }\n  }, [showUnhighlightToolbar]);\n  \n  // Handle highlight button click\n  const handleHighlight = useCallback((selectedText: string, range: Range, tag: HighlightTag) => {\n    if (selectedText && range) {\n      // Get context for the selection\n      const context = getSelectionContext(window.getSelection()!);\n      \n      // Save highlight to database with tag (preserve original formatting)\n      saveHighlight(\n        selectedText, // Don't trim - preserve exact formatting including line breaks\n        context.prefix,\n        context.suffix,\n        articleId,\n        tag\n      );\n      \n      // Apply highlight visually with tag-based styling\n      highlightElement(range, tag);\n    }\n  }, [articleId, saveHighlight, highlightElement]);\n  \n  // Handle highlight click to show unhighlight option\n  const handleHighlightClick = useCallback((e: MouseEvent) => {\n    // Check if click is on a highlight\n    const target = e.target as HTMLElement;\n    if (target.classList.contains('article-highlight')) {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // Get highlight info\n      const highlightId = target.dataset.highlightId;\n      const highlightText = target.textContent || '';\n      \n      if (highlightId) {\n        // Reset hiding state if it was set\n        setIsHidingToolbar(false);\n        \n        // Set active highlight\n        setActiveHighlight({ id: highlightId, text: highlightText });\n        \n        // Position unhighlight toolbar near the highlight\n        const rect = target.getBoundingClientRect();\n        setUnhighlightPosition({\n          top: rect.top - 40 + window.scrollY, // Position above the highlight\n          left: rect.left + rect.width / 2\n        });\n        \n        // Show unhighlight toolbar\n        setShowUnhighlightToolbar(true);\n        \n        // Hide regular selection toolbar if visible\n        setSelection(null);\n      }\n    } else {\n      // If clicking elsewhere, hide unhighlight toolbar with animation\n      if (showUnhighlightToolbar) {\n        hideToolbarWithAnimation();\n        setActiveHighlight(null);\n      }\n    }\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Handle unhighlight action\n  const handleUnhighlight = useCallback(() => {\n    if (activeHighlight && activeHighlight.id) {\n      // Start the hiding animation\n      hideToolbarWithAnimation();\n      \n      // Store the ID before resetting the active highlight\n      const highlightId = activeHighlight.id;\n      \n      // Reset active highlight state\n      setActiveHighlight(null);\n      \n      // Remove highlight from database\n      removeHighlight(highlightId);\n      \n      // Find and remove highlight from DOM\n      if (contentRef) {\n        const highlightEl = contentRef.querySelector(`[data-highlight-id=\"${highlightId}\"]`);\n        if (highlightEl && highlightEl.parentNode) {\n          const textNode = document.createTextNode(highlightEl.textContent || '');\n          highlightEl.parentNode.replaceChild(textNode, highlightEl);\n          highlightEl.parentNode.normalize();\n        }\n      }\n    }\n  }, [activeHighlight, removeHighlight, contentRef, hideToolbarWithAnimation]);\n  \n  // Handle response button click\n  const handleResponse = useCallback((selectedText: string) => {\n    setSelectedTextForResponse(selectedText);\n    setShowResponseModal(true);\n  }, []);\n\n  // Handle share button click\n  const handleShare = useCallback((selectedText: string) => {\n    setShareHighlightText(selectedText);\n    setShowShareModal(true);\n  }, []);\n\n  // Handle AI assist button click\n  const handleAiAssist = useCallback((selectedText: string) => {\n    setSelectedTextForAi(selectedText);\n    setShowAiModal(true);\n  }, []);\n  \n  // Set up selection event listener\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelection);\n    \n    // Additional mobile touch handling\n    const handleTouchEnd = () => {\n      // Small delay to ensure selection is finalized\n      setTimeout(handleSelection, 150);\n    };\n    \n    // Only add touch handlers on mobile devices\n    if ('ontouchstart' in window) {\n      document.addEventListener('touchend', handleTouchEnd);\n    }\n    \n    return () => {\n      document.removeEventListener('selectionchange', handleSelection);\n      if ('ontouchstart' in window) {\n        document.removeEventListener('touchend', handleTouchEnd);\n      }\n    };\n  }, [handleSelection]);\n  \n  // Set up click listener for highlights\n  useEffect(() => {\n    if (contentRef) {\n      contentRef.addEventListener('click', handleHighlightClick as EventListener);\n      \n      return () => {\n        contentRef.removeEventListener('click', handleHighlightClick as EventListener);\n      };\n    }\n  }, [contentRef, handleHighlightClick]);\n  \n  // Add click listener to document to hide unhighlight toolbar when clicking outside\n  useEffect(() => {\n    const handleDocumentClick = (e: MouseEvent) => {\n      if (showUnhighlightToolbar) {\n        const target = e.target as HTMLElement;\n        if (!target.closest('.highlight-toolbar') && \n            !target.classList.contains('article-highlight')) {\n          hideToolbarWithAnimation();\n          setActiveHighlight(null);\n        }\n      }\n    };\n    \n    document.addEventListener('click', handleDocumentClick);\n    \n    return () => {\n      document.removeEventListener('click', handleDocumentClick);\n    };\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Apply highlights from database when they change\n  useEffect(() => {\n    if (contentRef) {\n      // Always try to apply highlights, even if array is empty (for cleanup)\n      const timeoutId = setTimeout(() => {\n        console.log(`🎨 Applying ${highlights.length} highlights to content`);\n      applyHighlightsToContent(highlights, contentRef);\n      }, 100); // Increased delay for better stability\n      \n      return () => clearTimeout(timeoutId);\n    }\n  }, [highlights, contentRef]);\n  \n  // Listen for cleanup events\n  useEffect(() => {\n    const handleCleanupEvent = (event: CustomEvent) => {\n      const highlightId = event.detail?.highlightId;\n      if (highlightId) {\n        console.log(`🗑️ Cleaning up broken highlight: ${highlightId}`);\n        removeHighlight(highlightId);\n      }\n    };\n    \n    window.addEventListener('cleanup-broken-highlight', handleCleanupEvent as EventListener);\n    \n    return () => {\n      window.removeEventListener('cleanup-broken-highlight', handleCleanupEvent as EventListener);\n    };\n  }, [removeHighlight]);\n  \n  // Get ref to content element\n  const setRef = useCallback((node: HTMLElement | null) => {\n    if (node && node !== contentRef) {\n      setContentRef(node);\n    }\n  }, [contentRef]);\n  \n  return (\n    <>\n      {/* Toolbar for highlighting */}\n      <HighlightToolbar \n        selection={selection} \n        onHighlight={handleHighlight} \n        onResponse={handleResponse}\n        onShare={handleShare}\n        onAiAssist={handleAiAssist}\n      />\n      \n      {/* Unhighlight toolbar */}\n      {showUnhighlightToolbar && activeHighlight && (\n        <div \n          className={`highlight-toolbar unhighlight-toolbar ${isHidingToolbar ? 'hiding' : ''}`}\n          style={{\n            position: 'absolute',\n            top: `${unhighlightPosition.top}px`,\n            left: `${unhighlightPosition.left}px`,\n            transform: isHidingToolbar ? 'translateY(-10px) translateX(-50%)' : 'translateX(-50%)',\n            zIndex: 1000,\n          }}\n        >\n          <button onClick={handleUnhighlight} className=\"highlight-btn highlight-btn-danger\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z\"></path>\n              <line x1=\"18\" y1=\"9\" x2=\"12\" y2=\"15\"></line>\n              <line x1=\"12\" y1=\"9\" x2=\"18\" y2=\"15\"></line>\n            </svg>\n            <span>Unhighlight</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleShare(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n              <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n              <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n              <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n              <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n            </svg>\n            <span>Share</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleResponse(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n            </svg>\n            <span>Response</span>\n          </button>\n        </div>\n      )}\n      \n      {/* Content with ref for highlight application */}\n      <div ref={setRef} className=\"article-highlight-container\">\n        {children}\n      </div>\n      \n      {/* Response Modal - placeholder for implementation */}\n      {showResponseModal && (\n        <div className=\"highlight-response-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowResponseModal(false)}\n            >\n              ×\n            </button>\n            <h3>Respond to highlighted text</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForResponse}\"</div>\n            <textarea \n              className=\"highlight-response-input\" \n              placeholder=\"Write your response...\"\n            ></textarea>\n            <button className=\"highlight-response-submit\">Submit</button>\n          </div>\n        </div>\n      )}\n      \n      {/* Journa AI Modal - placeholder for implementation */}\n      {showAiModal && (\n        <div className=\"highlight-ai-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowAiModal(false)}\n            >\n              ×\n            </button>\n            <h3>Journa AI</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForAi}\"</div>\n            <div className=\"highlight-ai-options\">\n              <button>Explain this</button>\n              <button>Fact check</button>\n              <button>Provide context</button>\n              <button>Summarize</button>\n            </div>\n            <div className=\"highlight-ai-response\">\n              {/* AI response would appear here */}\n              <div className=\"highlight-ai-loading\">Journa AI is thinking...</div>\n            </div>\n          </div>\n        </div>\n      )}\n      \n      {/* Share Modal */}\n      {showShareModal && (\n        <ShareModal\n          isOpen={showShareModal}\n          onClose={() => setShowShareModal(false)}\n          highlightText={shareHighlightText}\n          articleTitle={articleTitle}\n          shareUrl={generateHighlightShareUrl(articleSlug, articleId)}\n        />\n      )}\n    </>\n  );\n};\n\nexport default ArticleHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3757, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/GradientPanel.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useRef, useMemo } from 'react';\nimport { moodThemes } from '@/utils/moodThemes';\nimport { AutoIcon } from './icons/CustomIcons';\n\ninterface GradientPanelProps {\n  currentMood: keyof typeof moodThemes;\n  isVisible: boolean;\n  moodFeatureEnabled: boolean;\n}\n\ninterface ColorStop {\n  id: string;\n  color: string;\n  x: number; // 0-100\n  y: number; // 0-100\n  isSelected: boolean;\n}\n\ninterface ThemeConfig {\n  colorStops: ColorStop[];\n  opacity: number; // 0-100\n  grain: number; // 0-100\n  mode: 'auto' | 'light' | 'dark';\n}\n\nconst GradientPanel: React.FC<GradientPanelProps> = ({\n  currentMood,\n  isVisible,\n  moodFeatureEnabled\n}) => {\n  const [isExpanded, setIsExpanded] = useState(false);\n  const [isDragging, setIsDragging] = useState<string | null>(null);\n  const [themeConfig, setThemeConfig] = useState<ThemeConfig>({\n    colorStops: [\n      { id: '1', color: '#007AFF', x: 30, y: 40, isSelected: true }\n    ],\n    opacity: 80,\n    grain: 30,\n    mode: 'auto'\n  });\n\n  const canvasRef = useRef<HTMLDivElement>(null);\n  const opacitySliderRef = useRef<HTMLDivElement>(null);\n  const grainSliderRef = useRef<HTMLDivElement>(null);\n  const saveTimeout = useRef<NodeJS.Timeout>();\n\n  // Generate Journa Color-style gradient from color stops with grain effect\n  const generateJournaColorGradient = (config: ThemeConfig) => {\n    const { colorStops, opacity, grain } = config;\n    const alpha = opacity / 100;\n    \n    // Generate smooth film grain overlay based on grain value\n    const grainIntensity = grain / 100;\n    let grainPattern = '';\n    \n    if (grainIntensity > 0.1) {\n      const grainOpacity = grainIntensity * 0.08;\n      const grainBlur = Math.max(15, 25 - (grainIntensity * 8));\n      \n      grainPattern = `\n        radial-gradient(ellipse at 12% 18%, rgba(255,255,255,${grainOpacity}) 3px, transparent ${grainBlur}px),\n        radial-gradient(ellipse at 87% 23%, rgba(0,0,0,${grainOpacity * 0.7}) 2px, transparent ${grainBlur * 1.2}px),\n        radial-gradient(ellipse at 43% 82%, rgba(255,255,255,${grainOpacity * 0.5}) 4px, transparent ${grainBlur * 0.9}px),\n      `;\n    }\n    \n    let baseGradient = '';\n    \n    if (colorStops.length === 1) {\n      const stop = colorStops[0];\n      baseGradient = `radial-gradient(circle at ${stop.x}% ${stop.y}%, ${stop.color}${Math.round(alpha * 255).toString(16)}, transparent 70%)`;\n    } else if (colorStops.length === 2) {\n      const [stop1, stop2] = colorStops;\n      baseGradient = `\n        radial-gradient(circle at ${stop1.x}% ${stop1.y}%, ${stop1.color}${Math.round(alpha * 0.7 * 255).toString(16)}, transparent 50%),\n        radial-gradient(circle at ${stop2.x}% ${stop2.y}%, ${stop2.color}${Math.round(alpha * 0.7 * 255).toString(16)}, transparent 50%)\n      `;\n    } else if (colorStops.length === 3) {\n      const [stop1, stop2, stop3] = colorStops;\n      baseGradient = `\n        radial-gradient(circle at ${stop1.x}% ${stop1.y}%, ${stop1.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%),\n        radial-gradient(circle at ${stop2.x}% ${stop2.y}%, ${stop2.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%),\n        radial-gradient(circle at ${stop3.x}% ${stop3.y}%, ${stop3.color}${Math.round(alpha * 0.5 * 255).toString(16)}, transparent 40%)\n      `;\n    }\n    \n    return grainPattern ? `${grainPattern}${baseGradient}` : baseGradient || 'transparent';\n  };\n\n  // Throttled real-time update function\n  const updateThemeRealTime = useMemo(() => {\n    let lastUpdate = 0;\n    return (config: ThemeConfig) => {\n      const now = Date.now();\n      if (now - lastUpdate < 100) return;\n      lastUpdate = now;\n      \n      if (!moodFeatureEnabled) return;\n      \n      const gradientCSS = generateJournaColorGradient(config);\n      \n      requestAnimationFrame(() => {\n        const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n        \n        moodElements.forEach(element => {\n          if (element) {\n            element.style.backgroundImage = gradientCSS;\n            element.style.transition = 'background-image 0.2s ease';\n          }\n        });\n\n        clearTimeout(saveTimeout.current);\n        saveTimeout.current = setTimeout(() => {\n          localStorage.setItem('journaColorThemeConfig', JSON.stringify(config));\n        }, 500);\n      });\n    };\n  }, [moodFeatureEnabled, generateJournaColorGradient]);\n\n  // Handle color stop dragging\n  const handleColorStopStart = (e: React.MouseEvent | React.TouchEvent, stopId: string) => {\n    e.preventDefault();\n    setIsDragging(stopId);\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop => ({\n        ...stop,\n        isSelected: stop.id === stopId\n      }))\n    };\n    setThemeConfig(newConfig);\n  };\n\n  const handlePointerMove = (e: MouseEvent | TouchEvent) => {\n    if (!isDragging || !canvasRef.current) return;\n    \n    const rect = canvasRef.current.getBoundingClientRect();\n    let clientX: number, clientY: number;\n    \n    if (e instanceof MouseEvent) {\n      clientX = e.clientX;\n      clientY = e.clientY;\n    } else {\n      clientX = e.touches[0].clientX;\n      clientY = e.touches[0].clientY;\n    }\n    \n    const x = Math.max(0, Math.min(100, ((clientX - rect.left) / rect.width) * 100));\n    const y = Math.max(0, Math.min(100, ((clientY - rect.top) / rect.height) * 100));\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop =>\n        stop.id === isDragging ? { ...stop, x, y } : stop\n      )\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  const handlePointerEnd = () => {\n    setIsDragging(null);\n  };\n\n  // Add color stop\n  const addColorStop = () => {\n    if (themeConfig.colorStops.length >= 3) return;\n    \n    const newStop: ColorStop = {\n      id: Date.now().toString(),\n      color: '#FF6B6B',\n      x: 50 + (themeConfig.colorStops.length * 15),\n      y: 50 + (themeConfig.colorStops.length * 10),\n      isSelected: false\n    };\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: [...themeConfig.colorStops, newStop]\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Remove color stop\n  const removeColorStop = () => {\n    if (themeConfig.colorStops.length <= 1) return;\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.slice(0, -1)\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Change selected color\n  const changeSelectedColor = (color: string) => {\n    const selectedStop = themeConfig.colorStops.find(stop => stop.isSelected);\n    if (!selectedStop) return;\n    \n    const newConfig = {\n      ...themeConfig,\n      colorStops: themeConfig.colorStops.map(stop => \n        stop.isSelected ? { ...stop, color } : stop\n      )\n    };\n    \n    setThemeConfig(newConfig);\n    updateThemeRealTime(newConfig);\n  };\n\n  // Event listeners\n  useEffect(() => {\n    if (isDragging) {\n      document.addEventListener('mousemove', handlePointerMove as EventListener);\n      document.addEventListener('mouseup', handlePointerEnd);\n      document.addEventListener('touchmove', handlePointerMove as EventListener, { passive: false });\n      document.addEventListener('touchend', handlePointerEnd);\n      \n      return () => {\n        document.removeEventListener('mousemove', handlePointerMove as EventListener);\n        document.removeEventListener('mouseup', handlePointerEnd);\n        document.removeEventListener('touchmove', handlePointerMove as EventListener);\n        document.removeEventListener('touchend', handlePointerEnd);\n      };\n    }\n  }, [isDragging, themeConfig]);\n\n  // Load saved configuration\n  useEffect(() => {\n    const saved = localStorage.getItem('journaColorThemeConfig');\n    if (saved) {\n      try {\n        const config = JSON.parse(saved);\n        setThemeConfig(config);\n        updateThemeRealTime(config);\n      } catch (e) {\n        console.error('Failed to load theme config:', e);\n      }\n    }\n  }, []);\n\n  // Cleanup timeout on unmount\n  useEffect(() => {\n    return () => {\n      if (saveTimeout.current) {\n        clearTimeout(saveTimeout.current);\n      }\n    };\n  }, []);\n\n  if (!isVisible || !moodFeatureEnabled) return null;\n\n  const currentGradient = generateJournaColorGradient(themeConfig);\n  const selectedStop = themeConfig.colorStops.find(stop => stop.isSelected) || themeConfig.colorStops[0];\n  \n  const presetColors = [\n    '#FFFFFF', '#FFB3D9', '#B19CD9', '#FF6B6B', \n    '#FF8E53', '#FFD93D', '#6BCF7F', '#4ECDC4', '#45B7D1'\n  ];\n\n  return (\n    <div style={{\n      position: 'fixed',\n      bottom: '40px',\n      left: '40px',\n      zIndex: 1001,\n      transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)'\n    }}>\n      {/* Floating toggle button */}\n      <button\n        onClick={() => setIsExpanded(!isExpanded)}\n        style={{\n          width: '56px',\n          height: '56px',\n          borderRadius: '50%',\n          border: 'none',\n          background: currentGradient || '#007AFF',\n          color: 'white',\n          fontSize: '20px',\n          cursor: 'pointer',\n          boxShadow: isExpanded\n            ? '0 8px 25px rgba(0, 122, 255, 0.4), 0 0 0 2px rgba(0, 122, 255, 0.2)'\n            : '0 6px 20px rgba(0, 122, 255, 0.3)',\n          transform: isExpanded ? 'scale(1.05) rotate(45deg)' : 'scale(1) rotate(0deg)',\n          transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          backdropFilter: 'blur(10px)'\n        }}\n        title=\"Journa Color Editor\"\n      >\n        <svg \n          width=\"24\" \n          height=\"24\" \n          viewBox=\"0 0 24 24\" \n          fill=\"none\" \n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <circle cx=\"8\" cy=\"8\" r=\"3\" fill=\"white\"/>\n          <circle cx=\"16\" cy=\"12\" r=\"2.5\" fill=\"white\"/>\n          <circle cx=\"12\" cy=\"18\" r=\"2\" fill=\"white\"/>\n        </svg>\n      </button>\n\n      {/* Expanded panel */}\n      {isExpanded && (\n        <div style={{\n          position: 'fixed',\n          bottom: '110px',\n          left: '40px',\n          width: '380px',\n          maxHeight: '500px',\n          background: 'rgba(255, 255, 255, 0.95)',\n          backdropFilter: 'blur(20px)',\n          borderRadius: '24px',\n          padding: '24px',\n          border: '1px solid rgba(255, 255, 255, 0.3)',\n          boxShadow: '0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)',\n          zIndex: 999,\n          overflow: 'hidden'\n        }}>\n          {/* Theme mode toggles */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '1rem',\n            marginBottom: '1.5rem'\n          }}>\n            {[\n              { mode: 'auto' as const, icon: AutoIcon, title: 'Auto' },\n              { mode: 'light' as const, icon: '☀️', title: 'Light' },\n              { mode: 'dark' as const, icon: '🌙', title: 'Dark' }\n            ].map(({ mode, icon, title }) => (\n              <button\n                key={mode}\n                onClick={() => {\n                  const newConfig = { ...themeConfig, mode };\n                  setThemeConfig(newConfig);\n                  updateThemeRealTime(newConfig);\n                }}\n                style={{\n                  width: '48px',\n                  height: '48px',\n                  borderRadius: '12px',\n                  border: themeConfig.mode === mode ? '2px solid #007AFF' : '2px solid rgba(0,0,0,0.1)',\n                  background: themeConfig.mode === mode ? 'rgba(0, 122, 255, 0.1)' : 'rgba(0,0,0,0.05)',\n                  fontSize: '20px',\n                  cursor: 'pointer',\n                  transition: 'all 0.2s ease',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n                title={title}\n              >\n                {mode === 'auto' ? <AutoIcon size={20} color={themeConfig.mode === mode ? '#007AFF' : '#666'} /> : icon}\n              </button>\n            ))}\n          </div>\n\n          {/* Interactive color canvas */}\n          <div \n            ref={canvasRef}\n            style={{\n              width: '100%',\n              height: '180px',\n              borderRadius: '16px',\n              background: 'linear-gradient(135deg, #f0f0f0, #e8e8e8)',\n              position: 'relative',\n              cursor: 'grab',\n              marginBottom: '1.5rem',\n              border: '1px solid rgba(0,0,0,0.1)',\n              overflow: 'hidden'\n            }}\n          >\n            {/* Draggable color stops */}\n            {themeConfig.colorStops.map((stop) => (\n              <div\n                key={stop.id}\n                onMouseDown={(e) => handleColorStopStart(e, stop.id)}\n                onTouchStart={(e) => handleColorStopStart(e, stop.id)}\n                style={{\n                  position: 'absolute',\n                  top: `${stop.y}%`,\n                  left: `${stop.x}%`,\n                  transform: 'translate(-50%, -50%)',\n                  width: stop.isSelected ? '24px' : '20px',\n                  height: stop.isSelected ? '24px' : '20px',\n                  borderRadius: '50%',\n                  background: stop.color,\n                  border: stop.isSelected ? '3px solid white' : '2px solid white',\n                  boxShadow: stop.isSelected ? '0 4px 12px rgba(0,0,0,0.4)' : '0 2px 8px rgba(0,0,0,0.3)',\n                  cursor: isDragging === stop.id ? 'grabbing' : 'grab',\n                  transition: isDragging === stop.id ? 'none' : 'all 0.2s ease',\n                  zIndex: stop.isSelected ? 10 : 5\n                }}\n              />\n            ))}\n          </div>\n\n          {/* Add/Remove controls */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            alignItems: 'center',\n            gap: '1rem',\n            marginBottom: '1.5rem'\n          }}>\n            <button\n              onClick={removeColorStop}\n              disabled={themeConfig.colorStops.length <= 1}\n              style={{\n                width: '36px',\n                height: '36px',\n                borderRadius: '8px',\n                border: '1px solid rgba(0,0,0,0.2)',\n                background: themeConfig.colorStops.length <= 1 ? 'rgba(0,0,0,0.05)' : 'white',\n                fontSize: '18px',\n                cursor: themeConfig.colorStops.length <= 1 ? 'not-allowed' : 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                opacity: themeConfig.colorStops.length <= 1 ? 0.5 : 1\n              }}\n            >\n              -\n            </button>\n            \n            <span style={{\n              fontSize: '14px', \n              color: '#666',\n              minWidth: '80px',\n              textAlign: 'center'\n            }}>\n              {themeConfig.colorStops.length}/3 colors\n            </span>\n            \n            <button\n              onClick={addColorStop}\n              disabled={themeConfig.colorStops.length >= 3}\n              style={{\n                width: '36px',\n                height: '36px',\n                borderRadius: '8px',\n                border: '1px solid rgba(0,0,0,0.2)',\n                background: themeConfig.colorStops.length >= 3 ? 'rgba(0,0,0,0.05)' : 'white',\n                fontSize: '18px',\n                cursor: themeConfig.colorStops.length >= 3 ? 'not-allowed' : 'pointer',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                opacity: themeConfig.colorStops.length >= 3 ? 0.5 : 1\n              }}\n            >\n              +\n            </button>\n          </div>\n\n          {/* Color preset row */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '0.5rem',\n            marginBottom: '1.5rem',\n            flexWrap: 'wrap'\n          }}>\n            {presetColors.map((color, index) => (\n              <button\n                key={index}\n                onClick={() => changeSelectedColor(color)}\n                style={{\n                  width: '32px',\n                  height: '32px',\n                  borderRadius: '50%',\n                  border: selectedStop.color === color ? '3px solid #007AFF' : '2px solid rgba(0,0,0,0.1)',\n                  background: color,\n                  cursor: 'pointer',\n                  transform: selectedStop.color === color ? 'scale(1.15)' : 'scale(1)',\n                  transition: 'all 0.2s ease'\n                }}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default GradientPanel; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4343, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/MoodToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport GradientPanel from './GradientPanel';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface MoodToggleProps {\n  initialEnabled?: boolean;\n  className?: string;\n  style?: React.CSSProperties;\n  currentMood?: keyof typeof moodThemes;\n}\n\nconst MoodToggle: React.FC<MoodToggleProps> = ({ \n  initialEnabled = true, \n  className = '',\n  style = {},\n  currentMood = 'joyful'\n}) => {\n  const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(initialEnabled);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      \n              if (user) {\n          // Load user's mood preference from localStorage\n          const savedPreference = localStorage.getItem('moodFeatureEnabled');\n          if (savedPreference !== null) {\n            const enabled = JSON.parse(savedPreference);\n            setMoodFeatureEnabled(enabled);\n            \n            // Apply initial state to DOM with multiple attempts to ensure it works\n            const applyInitialState = (attempt = 1) => {\n              console.log(`🎨 Applying initial mood state (attempt ${attempt}):`, enabled);\n              const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n              console.log('🎨 Found mood elements on init:', moodElements.length);\n              \n              if (moodElements.length === 0 && attempt < 5) {\n                // Elements not ready yet, try again\n                setTimeout(() => applyInitialState(attempt + 1), 200);\n                return;\n              }\n              \n                    moodElements.forEach(element => {\n        // Ensure elements have proper transitions\n        element.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n        \n        if (enabled) {\n          // Show elements with data attributes\n          element.setAttribute('data-mood-active', 'true');\n          element.style.display = 'block';\n          element.style.visibility = 'visible';\n          element.style.opacity = '1';\n          element.style.transform = 'scale(1)';\n          console.log('🎨 Initial show:', element.getAttribute('data-mood-element'));\n        } else {\n          // Hide elements with data attributes\n          element.setAttribute('data-mood-active', 'false');\n          element.style.display = 'none';\n          element.style.visibility = 'hidden';\n          element.style.opacity = '0';\n          element.style.transform = 'scale(0.95)';\n          console.log('🎨 Initial hide:', element.getAttribute('data-mood-element'));\n        }\n      });\n              \n              // Also apply to headers\n              const moodHeaders = document.querySelectorAll('[data-mood-header]') as NodeListOf<HTMLElement>;\n              moodHeaders.forEach(element => {\n                element.style.transition = 'background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease';\n                if (!enabled) {\n                  element.style.background = 'rgba(255, 255, 255, 0.95)';\n                  element.style.border = '1px solid rgba(0, 0, 0, 0.1)';\n                  element.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';\n                }\n              });\n            };\n            \n            // Start applying initial state\n            setTimeout(() => applyInitialState(), 100);\n          } else {\n            setMoodFeatureEnabled(true);\n          }\n        } else {\n          setMoodFeatureEnabled(false);\n        }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleToggle = () => {\n    console.log('🎨 MoodToggle clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) return;\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    const newEnabled = !moodFeatureEnabled;\n    setMoodFeatureEnabled(newEnabled);\n    localStorage.setItem('moodFeatureEnabled', JSON.stringify(newEnabled));\n    \n    console.log('🎨 Mood feature toggled to:', newEnabled);\n    \n    // 🚫 REMOVED: No more React state updates that cause re-renders and lose highlights!\n    \n    // Force IMMEDIATE visual updates for mood backgrounds - no waiting for events\n    console.log('🎨 Toggle clicked - searching for mood elements...');\n    \n    const findAndUpdateElements = (attempt = 1) => {\n      const moodElements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n      console.log(`🎨 Found mood elements (attempt ${attempt}):`, moodElements.length);\n      \n      if (moodElements.length === 0 && attempt < 3) {\n        // Try again if elements not found\n        setTimeout(() => findAndUpdateElements(attempt + 1), 100);\n        return;\n      }\n      \n      moodElements.forEach(element => {\n        // Add smooth transitions\n        element.style.transition = 'opacity 0.3s ease, transform 0.3s ease';\n        \n        if (newEnabled) {\n          // Show elements - use data attributes and CSS properties\n          element.setAttribute('data-mood-active', 'true');\n          element.style.display = 'block';\n          element.style.visibility = 'visible';\n          element.style.opacity = '1';\n          element.style.transform = 'scale(1)';\n          console.log('🎨 Showing mood element:', element.getAttribute('data-mood-element'));\n        } else {\n          // Hide elements\n          element.setAttribute('data-mood-active', 'false');\n          element.style.opacity = '0';\n          element.style.transform = 'scale(0.95)';\n          console.log('🎨 Hiding mood element:', element.getAttribute('data-mood-element'));\n          \n          // Hide after animation completes\n          setTimeout(() => {\n            if (element.getAttribute('data-mood-active') === 'false') {\n              element.style.display = 'none';\n              element.style.visibility = 'hidden';\n            }\n          }, 300);\n        }\n      });\n    };\n    \n    // Start the search and update process\n    findAndUpdateElements();\n    \n    // Also update any mood-controlled headers/panels with smooth transitions\n    const moodHeaders = document.querySelectorAll('[data-mood-header]') as NodeListOf<HTMLElement>;\n    moodHeaders.forEach(element => {\n      // Add smooth transition for header changes\n      element.style.transition = 'background 0.4s ease, border 0.4s ease, box-shadow 0.4s ease';\n      \n      if (newEnabled) {\n        // When enabling, clear any overrides to restore original mood styling\n        element.style.background = '';\n        element.style.border = '';\n        element.style.boxShadow = '';\n        \n        // Force a complete refresh by temporarily hiding and showing\n        const originalDisplay = element.style.display;\n        element.style.display = 'none';\n        element.offsetHeight; // Force reflow\n        element.style.display = originalDisplay;\n        \n        console.log('🎨 Header mood styling restored - cleared overrides');\n      } else {\n        // Save current mood styling and apply neutral background\n        element.setAttribute('data-mood-style', element.style.background);\n        element.style.background = 'rgba(255, 255, 255, 0.95)';\n        element.style.border = '1px solid rgba(0, 0, 0, 0.1)';\n        element.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';\n        console.log('🎨 Header mood styling removed');\n      }\n    });\n    \n    console.log('🎨 Mood backgrounds updated immediately. Enabled:', newEnabled);\n  };\n\n  if (!currentUser) {\n    return null; // Don't show toggle for unauthenticated users\n  }\n\n  return (\n    <>\n      <button\n        onClick={handleToggle}\n        className={className}\n        style={{\n          ...style,\n          transition: 'all 0.3s ease',\n          transform: isAnimating ? 'scale(1.1)' : 'scale(1)',\n        }}\n        title={moodFeatureEnabled ? \"Turn off mood feature\" : \"Turn on mood feature\"}\n      >\n        {moodFeatureEnabled ? 'ON' : 'OFF'}\n      </button>\n\n      {/* Real-time gradient panel */}\n      <GradientPanel\n        currentMood={currentMood}\n        isVisible={!!currentUser}\n        moodFeatureEnabled={moodFeatureEnabled}\n      />\n    </>\n  );\n};\n\nexport default React.memo(MoodToggle); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4564, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { SparkleIcon, DiceIcon, WriteIcon, CloseIcon } from './icons/CustomIcons';\n\ninterface ReflectionToggleProps {\n  articleId: string;\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst ReflectionToggle: React.FC<ReflectionToggleProps> = ({ \n  articleId, \n  className, \n  style \n}) => {\n  const [user, setUser] = useState<User | null>(null);\n  const [showReflectionPanel, setShowReflectionPanel] = useState(false);\n  const [currentPrompt, setCurrentPrompt] = useState('');\n  const [currentReflection, setCurrentReflection] = useState('');\n  const [isEditingPrompt, setIsEditingPrompt] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [windowDimensions, setWindowDimensions] = useState({ width: 0, height: 0 });\n\n  // Device detection with proper responsive breakpoints\n  const deviceInfo = useMemo(() => {\n    const width = windowDimensions.width;\n    const height = windowDimensions.height;\n    \n    return {\n      isMobile: width <= 768,\n      isTablet: width > 768 && width <= 1024,\n      isDesktop: width > 1024,\n      isSmallPhone: width <= 480,\n      isLandscape: width > height,\n      isIPad11: width >= 820 && width <= 1024,\n      // Safe area calculations\n      bottomSafeArea: Math.max(100, width <= 768 ? 120 : 80),\n      sideMargin: width <= 480 ? 16 : width <= 768 ? 20 : 40\n    };\n  }, [windowDimensions]);\n\n  // Optimized window resize handler with debouncing\n  useEffect(() => {\n    const updateDimensions = () => {\n      setWindowDimensions({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    };\n\n    // Initial set\n    updateDimensions();\n\n    let timeoutId: NodeJS.Timeout;\n    const debouncedResize = () => {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(updateDimensions, 100);\n    };\n\n    window.addEventListener('resize', debouncedResize);\n    return () => {\n      window.removeEventListener('resize', debouncedResize);\n      clearTimeout(timeoutId);\n    };\n  }, []);\n\n  // Authentication state management\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged((user) => {\n      setUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Default prompts with better variety\n  const defaultPrompts = useMemo(() => [\n    \"How does this make you feel?\",\n    \"What questions does this raise for you?\",\n    \"How does this relate to your own experience?\",\n    \"What would you do differently?\",\n    \"What surprised you most about this?\",\n    \"What's your main takeaway from this?\",\n    \"How might this change your perspective?\"\n  ], []);\n\n  const getDefaultPrompt = useCallback(() => {\n    const randomIndex = Math.floor(Math.random() * defaultPrompts.length);\n    return defaultPrompts[randomIndex];\n  }, [defaultPrompts]);\n\n  // Initialize prompt\n  useEffect(() => {\n    if (!currentPrompt) {\n      setCurrentPrompt(getDefaultPrompt());\n    }\n  }, [currentPrompt, getDefaultPrompt]);\n\n  // Optimized toggle handler\n  const toggleReflectionPanel = useCallback(() => {\n    setIsAnimating(true);\n    setShowReflectionPanel(prev => !prev);\n    \n    setTimeout(() => setIsAnimating(false), 300);\n    \n    // Close editing mode when panel closes\n    if (showReflectionPanel) {\n      setIsEditingPrompt(false);\n      setCurrentReflection('');\n    }\n  }, [showReflectionPanel]);\n\n  // Prompt editing handlers\n  const handlePromptSave = useCallback(() => {\n    setIsEditingPrompt(false);\n    if (!currentPrompt.trim()) {\n      setCurrentPrompt(getDefaultPrompt());\n    }\n  }, [currentPrompt, getDefaultPrompt]);\n\n  // Reflection submission with proper error handling\n  const handleReflectionSubmit = useCallback(async () => {\n    if (!currentReflection.trim() || isSubmitting || !user) return;\n\n    setIsSubmitting(true);\n    try {\n      // Import dynamically to reduce bundle size\n      const { saveReflectionResponse } = await import('@/services/reflectionService');\n      \n      await saveReflectionResponse(\n        articleId,\n        `custom_${Date.now()}`,\n        currentPrompt,\n        currentReflection.trim(),\n        0, // Position\n        true // Private\n      );\n      \n      // Success feedback\n      setCurrentReflection('');\n      setShowReflectionPanel(false);\n      \n      // Optional: Show success toast\n      console.log('Reflection saved successfully');\n      \n    } catch (error) {\n      console.error('Error saving reflection:', error);\n      // Optional: Show error toast\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [currentReflection, isSubmitting, user, articleId, currentPrompt]);\n\n  // Memoized styles for performance\n  const buttonStyles = useMemo(() => ({\n    position: 'fixed' as const,\n    bottom: deviceInfo.isMobile ? \n      `max(${deviceInfo.bottomSafeArea + 20}px, calc(${deviceInfo.bottomSafeArea}px + env(safe-area-inset-bottom)))` : \n      '40px',\n    right: `${deviceInfo.sideMargin}px`,\n    width: deviceInfo.isSmallPhone ? '48px' : deviceInfo.isMobile ? '52px' : '56px',\n    height: deviceInfo.isSmallPhone ? '48px' : deviceInfo.isMobile ? '52px' : '56px',\n    borderRadius: '50%',\n    background: showReflectionPanel \n      ? 'linear-gradient(135deg, #1d4ed8, #7c3aed)' \n      : 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n    border: 'none',\n    boxShadow: showReflectionPanel\n      ? '0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)'\n      : '0 6px 20px rgba(59, 130, 246, 0.3)',\n    cursor: 'pointer',\n    zIndex: 1002, // Above bottom nav and other elements\n    transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n    transform: isAnimating ? 'scale(1.1)' : showReflectionPanel ? 'scale(1.05)' : 'scale(1)',\n    backdropFilter: 'blur(10px)',\n    WebkitBackdropFilter: 'blur(10px)',\n    contain: 'layout style paint', // Performance optimization\n    willChange: isAnimating ? 'transform' : 'auto',\n    ...style,\n  }), [deviceInfo, showReflectionPanel, isAnimating, style]);\n\n  const panelStyles = useMemo(() => ({\n    position: 'fixed' as const,\n    bottom: deviceInfo.isMobile ? \n      `max(${deviceInfo.bottomSafeArea + 80}px, calc(${deviceInfo.bottomSafeArea + 60}px + env(safe-area-inset-bottom)))` : \n      '110px',\n    right: deviceInfo.isMobile ? `${deviceInfo.sideMargin}px` : '40px',\n    left: deviceInfo.isMobile ? `${deviceInfo.sideMargin}px` : 'auto',\n    width: deviceInfo.isMobile ? 'auto' : '380px',\n    maxWidth: deviceInfo.isMobile ? 'none' : '380px',\n    maxHeight: deviceInfo.isLandscape && deviceInfo.isMobile ? '60vh' : \n               deviceInfo.isMobile ? '50vh' : '500px',\n    background: 'rgba(255, 255, 255, 0.95)',\n    backdropFilter: 'blur(20px)',\n    WebkitBackdropFilter: 'blur(20px)',\n    borderRadius: deviceInfo.isSmallPhone ? '16px' : deviceInfo.isMobile ? '18px' : '24px',\n    boxShadow: '0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)',\n    border: '1px solid rgba(255, 255, 255, 0.3)',\n    zIndex: 1001,\n    padding: deviceInfo.isSmallPhone ? '16px' : deviceInfo.isMobile ? '18px' : '24px',\n    overflow: 'hidden auto',\n    contain: 'layout style paint',\n    transform: 'translateZ(0)', // GPU acceleration\n  }), [deviceInfo]);\n\n  // Don't render if no user\n  if (!user) return null;\n\n  return (\n    <>\n      {/* Floating Reflection Button */}\n      <button\n        data-reflection-element=\"floating-button\"\n        onClick={toggleReflectionPanel}\n        className={`reflection-component hw-accelerated ${className || ''}`}\n        style={buttonStyles}\n        title={showReflectionPanel ? \"Close reflection\" : \"Open reflection\"}\n        aria-label={showReflectionPanel ? \"Close reflection panel\" : \"Open reflection panel\"}\n      >\n        <div style={{\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          width: '100%',\n          height: '100%'\n        }}>\n          {showReflectionPanel ? \n            <CloseIcon size={deviceInfo.isSmallPhone ? 12 : 14} color=\"#ffffff\" /> : \n            <WriteIcon size={deviceInfo.isSmallPhone ? 12 : 14} color=\"#ffffff\" />\n          }\n        </div>\n      </button>\n\n      {/* Reflection Panel */}\n      {showReflectionPanel && (\n        <div \n          className=\"reflection-component floating-panel hw-accelerated\"\n          style={panelStyles}\n          role=\"dialog\"\n          aria-labelledby=\"reflection-title\"\n          aria-modal=\"true\"\n        >\n          <style>\n            {`\n              @keyframes gentleSlideUp {\n                from {\n                  opacity: 0;\n                  transform: translateY(20px) scale(0.98);\n                }\n                to {\n                  opacity: 1;\n                  transform: translateY(0) scale(1);\n                }\n              }\n              \n              .reflection-panel-enter {\n                animation: gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n              }\n            `}\n          </style>\n          \n          {/* Header */}\n          <div style={{ marginBottom: '20px', textAlign: 'center' }}>\n            <h3 \n              id=\"reflection-title\"\n              style={{\n                margin: '0 0 12px 0',\n                fontSize: deviceInfo.isSmallPhone ? '14px' : '16px',\n                fontWeight: '600',\n                background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n                WebkitBackgroundClip: 'text',\n                WebkitTextFillColor: 'transparent',\n                backgroundClip: 'text',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                gap: '8px'\n              }}\n            >\n              <SparkleIcon size={deviceInfo.isSmallPhone ? 14 : 16} color=\"#3b82f6\" />\n              Time to Reflect\n            </h3>\n            \n            {/* Editable Prompt */}\n            <div style={{ position: 'relative' }}>\n              {isEditingPrompt ? (\n                <input\n                  type=\"text\"\n                  value={currentPrompt}\n                  onChange={(e) => setCurrentPrompt(e.target.value)}\n                  onBlur={handlePromptSave}\n                  onKeyDown={(e) => {\n                    if (e.key === 'Enter') handlePromptSave();\n                    if (e.key === 'Escape') {\n                      setCurrentPrompt(getDefaultPrompt());\n                      setIsEditingPrompt(false);\n                    }\n                  }}\n                  autoFocus\n                  className=\"mobile-optimized-input\"\n                  style={{\n                    width: '100%',\n                    padding: '8px 12px',\n                    border: '2px solid #3b82f6',\n                    borderRadius: '12px',\n                    background: 'white',\n                    fontSize: deviceInfo.isSmallPhone ? '13px' : '14px',\n                    textAlign: 'center',\n                    outline: 'none'\n                  }}\n                />\n              ) : (\n                <button\n                  onClick={() => setIsEditingPrompt(true)}\n                  style={{\n                    background: 'transparent',\n                    border: '2px solid transparent',\n                    borderRadius: '12px',\n                    padding: '8px 12px',\n                    fontSize: deviceInfo.isSmallPhone ? '13px' : '14px',\n                    color: '#3b82f6',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease',\n                    fontWeight: '500',\n                    textAlign: 'center',\n                    width: '100%'\n                  }}\n                  onMouseEnter={(e) => {\n                    e.currentTarget.style.borderColor = '#e2e8f0';\n                    e.currentTarget.style.background = '#f8fafc';\n                  }}\n                  onMouseLeave={(e) => {\n                    e.currentTarget.style.borderColor = 'transparent';\n                    e.currentTarget.style.background = 'transparent';\n                  }}\n                  title=\"Click to edit prompt\"\n                >\n                  {currentPrompt}\n                </button>\n              )}\n            </div>\n          </div>\n\n          {/* Reflection Input */}\n          <textarea\n            value={currentReflection}\n            onChange={(e) => setCurrentReflection(e.target.value)}\n            placeholder=\"Share your thoughts...\"\n            className=\"mobile-optimized-input reflection-input\"\n            data-mobile=\"true\"\n            style={{\n              width: '100%',\n              height: deviceInfo.isSmallPhone ? '100px' : '120px',\n              padding: '12px',\n              border: '2px solid #e2e8f0',\n              borderRadius: '12px',\n              background: 'white',\n              fontSize: deviceInfo.isSmallPhone ? '15px' : '16px', // Prevent zoom on mobile\n              fontFamily: 'inherit',\n              resize: 'vertical',\n              outline: 'none',\n              transition: 'border-color 0.2s ease',\n              marginBottom: '16px'\n            }}\n            onFocus={(e) => {\n              e.target.style.borderColor = '#3b82f6';\n              // Ensure the input is visible on mobile\n              if (deviceInfo.isMobile) {\n                setTimeout(() => {\n                  e.target.scrollIntoView({ \n                    behavior: 'smooth', \n                    block: 'center' \n                  });\n                }, 100);\n              }\n            }}\n            onBlur={(e) => {\n              e.target.style.borderColor = '#e2e8f0';\n            }}\n          />\n\n          {/* Action Buttons */}\n          <div style={{\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center',\n            gap: '12px',\n            flexDirection: deviceInfo.isSmallPhone ? 'column' : 'row'\n          }}>\n            <button\n              onClick={() => setShowReflectionPanel(false)}\n              style={{\n                background: 'transparent',\n                border: '2px solid #e2e8f0',\n                borderRadius: '12px',\n                padding: deviceInfo.isSmallPhone ? '12px 20px' : '8px 16px',\n                fontSize: deviceInfo.isSmallPhone ? '15px' : '14px',\n                color: '#64748b',\n                cursor: 'pointer',\n                fontWeight: '500',\n                transition: 'all 0.2s ease',\n                width: deviceInfo.isSmallPhone ? '100%' : 'auto',\n                minHeight: '44px' // Touch-friendly\n              }}\n            >\n              Cancel\n            </button>\n            \n            <button\n              onClick={handleReflectionSubmit}\n              disabled={!currentReflection.trim() || isSubmitting}\n              style={{\n                background: currentReflection.trim() \n                  ? 'linear-gradient(135deg, #3b82f6, #8b5cf6)' \n                  : '#e2e8f0',\n                border: 'none',\n                borderRadius: '12px',\n                padding: deviceInfo.isSmallPhone ? '12px 20px' : '8px 20px',\n                fontSize: deviceInfo.isSmallPhone ? '15px' : '14px',\n                color: currentReflection.trim() ? 'white' : '#94a3b8',\n                cursor: currentReflection.trim() ? 'pointer' : 'not-allowed',\n                fontWeight: '600',\n                transition: 'all 0.2s ease',\n                opacity: isSubmitting ? 0.7 : 1,\n                width: deviceInfo.isSmallPhone ? '100%' : 'auto',\n                minHeight: '44px' // Touch-friendly\n              }}\n            >\n              {isSubmitting ? 'Saving...' : 'Save Reflection'}\n            </button>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default React.memo(ReflectionToggle); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5104, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/moodThemes.ts"],"sourcesContent":["export const moodThemes = {\n    joyful: {\n        gradientStart: '#fde047',  // yellow-300\n        gradientEnd: '#fb923c',    // orange-400\n        accent: '#f59e0b',          // amber-500\n    },\n    angry: {\n        gradientStart: '#f87171',  // red-400\n        gradientEnd: '#dc2626',    // red-600\n        accent: '#ef4444',          // red-500\n    },\n    energetic: {\n        gradientStart: '#34d399',  // emerald-400\n        gradientEnd: '#059669',    // emerald-600\n        accent: '#10b981',          // emerald-500\n    },\n    peaceful: {\n        gradientStart: '#60a5fa',  // blue-400\n        gradientEnd: '#2563eb',    // blue-600\n        accent: '#3b82f6',          // blue-500\n    },\n    reflective: {\n        gradientStart: '#a78bfa',  // violet-400\n        gradientEnd: '#7c3aed',    // violet-600\n        accent: '#8b5cf6',          // violet-500\n    },\n    sad: {\n        gradientStart: '#94a3b8',  // slate-400\n        gradientEnd: '#475569',    // slate-600\n        accent: '#64748b',          // slate-500\n    },\n    calm: {\n        gradientStart: '#67e8f9',  // cyan-300\n        gradientEnd: '#0891b2',    // cyan-600\n        accent: '#06b6d4',          // cyan-500\n    }\n};\n\nexport const gradientTypes = {\n    linear: 'linear',\n    radial: 'radial',\n    conic: 'conic',\n    waves: 'waves',\n    dots: 'dots',\n    mesh: 'mesh'\n} as const;\n\nexport type GradientType = keyof typeof gradientTypes;\n\nexport const generateGradientStyle = (\n    mood: keyof typeof moodThemes,\n    gradientType: GradientType,\n    opacity: number = 0.4\n) => {\n    const theme = moodThemes[mood];\n    const opacityHex = Math.round(opacity * 255).toString(16).padStart(2, '0');\n\n    switch (gradientType) {\n        case 'linear':\n            return `linear-gradient(45deg, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex})`;\n\n        case 'radial':\n            return `radial-gradient(circle at 50% 50%, ${theme.gradientStart}${opacityHex} 0%, ${theme.gradientEnd}${opacityHex} 100%)`;\n\n        case 'conic':\n            return `conic-gradient(from 0deg at 50% 50%, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex}, ${theme.accent}${opacityHex}, ${theme.gradientStart}${opacityHex})`;\n\n        case 'waves':\n            return `\n        radial-gradient(ellipse 200% 100% at 50% 0%, ${theme.gradientStart}${opacityHex}, transparent 50%), \n        radial-gradient(ellipse 200% 100% at 50% 100%, ${theme.gradientEnd}${opacityHex}, transparent 50%)\n      `;\n\n        case 'dots':\n            return `\n        radial-gradient(circle at 20% 20%, ${theme.gradientStart}${opacityHex} 8px, transparent 8px),\n        radial-gradient(circle at 80% 80%, ${theme.gradientEnd}${opacityHex} 8px, transparent 8px),\n        radial-gradient(circle at 40% 60%, ${theme.accent}${Math.round(opacity * 0.6 * 255).toString(16).padStart(2, '0')} 4px, transparent 4px)\n      `;\n\n        case 'mesh':\n            return `\n        radial-gradient(circle at 20% 20%, ${theme.gradientStart}${opacityHex}, transparent 50%), \n        radial-gradient(circle at 80% 60%, ${theme.gradientEnd}${opacityHex}, transparent 50%),\n        radial-gradient(circle at 40% 90%, ${theme.accent}${Math.round(opacity * 0.8 * 255).toString(16).padStart(2, '0')}, transparent 50%),\n        radial-gradient(circle at 70% 30%, ${theme.gradientStart}${Math.round(opacity * 0.6 * 255).toString(16).padStart(2, '0')}, transparent 50%)\n      `;\n\n        default:\n            return `linear-gradient(45deg, ${theme.gradientStart}${opacityHex}, ${theme.gradientEnd}${opacityHex})`;\n    }\n};\n\n// Real-time gradient updater utility\nexport const updateAllGradients = (mood: keyof typeof moodThemes, gradientType: GradientType) => {\n    const elements = document.querySelectorAll('[data-mood-element]') as NodeListOf<HTMLElement>;\n\n    elements.forEach(element => {\n        const elementType = element.getAttribute('data-mood-element');\n        element.style.backgroundImage = generateGradientStyle(mood, gradientType, 0.4);\n        element.style.transition = 'background-image 0.5s cubic-bezier(0.4, 0, 0.2, 1)';\n    });\n}; "],"names":[],"mappings":";;;;;;AAAO,MAAM,aAAa;IACtB,QAAQ;QACJ,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,OAAO;QACH,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,WAAW;QACP,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,UAAU;QACN,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,YAAY;QACR,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,KAAK;QACD,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;IACA,MAAM;QACF,eAAe;QACf,aAAa;QACb,QAAQ;IACZ;AACJ;AAEO,MAAM,gBAAgB;IACzB,QAAQ;IACR,QAAQ;IACR,OAAO;IACP,OAAO;IACP,MAAM;IACN,MAAM;AACV;AAIO,MAAM,wBAAwB,CACjC,MACA,cACA,UAAkB,GAAG;IAErB,MAAM,QAAQ,UAAU,CAAC,KAAK;IAC9B,MAAM,aAAa,KAAK,KAAK,CAAC,UAAU,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG;IAEtE,OAAQ;QACJ,KAAK;YACD,OAAO,CAAC,uBAAuB,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,CAAC,CAAC;QAE3G,KAAK;YACD,OAAO,CAAC,mCAAmC,EAAE,MAAM,aAAa,GAAG,WAAW,KAAK,EAAE,MAAM,WAAW,GAAG,WAAW,MAAM,CAAC;QAE/H,KAAK;YACD,OAAO,CAAC,qCAAqC,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,EAAE,EAAE,MAAM,MAAM,GAAG,WAAW,EAAE,EAAE,MAAM,aAAa,GAAG,WAAW,CAAC,CAAC;QAE5L,KAAK;YACD,OAAO,CAAC;qDACiC,EAAE,MAAM,aAAa,GAAG,WAAW;uDACjC,EAAE,MAAM,WAAW,GAAG,WAAW;MAClF,CAAC;QAEC,KAAK;YACD,OAAO,CAAC;2CACuB,EAAE,MAAM,aAAa,GAAG,WAAW;2CACnC,EAAE,MAAM,WAAW,GAAG,WAAW;2CACjC,EAAE,MAAM,MAAM,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;MACpH,CAAC;QAEC,KAAK;YACD,OAAO,CAAC;2CACuB,EAAE,MAAM,aAAa,GAAG,WAAW;2CACnC,EAAE,MAAM,WAAW,GAAG,WAAW;2CACjC,EAAE,MAAM,MAAM,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;2CAC/E,EAAE,MAAM,aAAa,GAAG,KAAK,KAAK,CAAC,UAAU,MAAM,KAAK,QAAQ,CAAC,IAAI,QAAQ,CAAC,GAAG,KAAK;MAC3H,CAAC;QAEC;YACI,OAAO,CAAC,uBAAuB,EAAE,MAAM,aAAa,GAAG,WAAW,EAAE,EAAE,MAAM,WAAW,GAAG,WAAW,CAAC,CAAC;IAC/G;AACJ;AAGO,MAAM,qBAAqB,CAAC,MAA+B;IAC9D,MAAM,WAAW,SAAS,gBAAgB,CAAC;IAE3C,SAAS,OAAO,CAAC,CAAA;QACb,MAAM,cAAc,QAAQ,YAAY,CAAC;QACzC,QAAQ,KAAK,CAAC,eAAe,GAAG,sBAAsB,MAAM,cAAc;QAC1E,QAAQ,KAAK,CAAC,UAAU,GAAG;IAC/B;AACJ","debugId":null}},
    {"offset": {"line": 5204, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionModeToggle.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface ReflectionModeToggleProps {\n  className?: string;\n  style?: React.CSSProperties;\n}\n\nconst ReflectionModeToggle: React.FC<ReflectionModeToggleProps> = ({ \n  className = '',\n  style = {}\n}) => {\n  const [reflectionsEnabled, setReflectionsEnabled] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [mood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective');\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      \n      if (user) {\n        // Load user's reflection preference from localStorage\n        const savedPreference = localStorage.getItem('reflectionsEnabled');\n        if (savedPreference !== null) {\n          const enabled = JSON.parse(savedPreference);\n          setReflectionsEnabled(enabled);\n          // Apply initial state to DOM\n          setTimeout(() => {\n            const reflectionElements = document.querySelectorAll('[data-reflection-element]') as NodeListOf<HTMLElement>;\n            reflectionElements.forEach(element => {\n              element.style.display = enabled ? '' : 'none';\n            });\n          }, 100);\n        } else {\n          setReflectionsEnabled(true);\n        }\n      } else {\n        setReflectionsEnabled(false);\n      }\n    });\n    return () => unsubscribe();\n  }, []);\n\n  const handleToggle = () => {\n    console.log('ReflectionModeToggle clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) return;\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    const newEnabled = !reflectionsEnabled;\n    setReflectionsEnabled(newEnabled);\n    localStorage.setItem('reflectionsEnabled', JSON.stringify(newEnabled));\n    \n    console.log('Reflection mode toggled to:', newEnabled);\n    \n    // Force immediate DOM updates for reflection components\n    const reflectionElements = document.querySelectorAll('[data-reflection-element]') as NodeListOf<HTMLElement>;\n    reflectionElements.forEach(element => {\n      if (newEnabled) {\n        element.style.display = '';\n      } else {\n        element.style.display = 'none';\n      }\n    });\n    \n    // Dispatch custom event to notify other components without causing re-renders\n    window.dispatchEvent(new CustomEvent('reflectionModeToggle', { \n      detail: { enabled: newEnabled } \n    }));\n  };\n\n  if (!currentUser) {\n    return (\n      <button\n        style={{\n          ...style,\n          opacity: 0.6,\n          cursor: 'not-allowed'\n        }}\n        disabled\n        title=\"Sign in to use reflections\"\n      >\n        OFF\n      </button>\n    );\n  }\n\n  return (\n    <button\n      onClick={handleToggle}\n      className={className}\n      style={{\n        ...style,\n        transition: 'all 0.3s ease',\n        transform: isAnimating ? 'scale(1.1)' : 'scale(1)',\n        background: reflectionsEnabled \n          ? 'rgba(255, 255, 255, 0.9)' \n          : 'rgba(255, 255, 255, 0.2)',\n        color: reflectionsEnabled ? moodThemes[mood].accent : '#F7FAFC',\n      }}\n      title={reflectionsEnabled ? \"Turn off reflections\" : \"Turn on reflections\"}\n    >\n      {reflectionsEnabled ? 'ON' : 'OFF'}\n    </button>\n  );\n};\n\nexport default React.memo(ReflectionModeToggle); "],"names":[],"mappings":";;;;AAEA;AACA;AAEA;;;AALA;;;;AAYA,MAAM,uBAA4D,CAAC,EACjE,YAAY,EAAE,EACd,QAAQ,CAAC,CAAC,EACX;;IACC,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAC5D,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC/C,MAAM,CAAC,KAAK,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAwE;IAE9F,gCAAgC;IAChC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;0CAAE;YACR,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,kBAAkB;8DAAC,CAAA;oBAC1C,eAAe;oBAEf,IAAI,MAAM;wBACR,sDAAsD;wBACtD,MAAM,kBAAkB,aAAa,OAAO,CAAC;wBAC7C,IAAI,oBAAoB,MAAM;4BAC5B,MAAM,UAAU,KAAK,KAAK,CAAC;4BAC3B,sBAAsB;4BACtB,6BAA6B;4BAC7B;8EAAW;oCACT,MAAM,qBAAqB,SAAS,gBAAgB,CAAC;oCACrD,mBAAmB,OAAO;sFAAC,CAAA;4CACzB,QAAQ,KAAK,CAAC,OAAO,GAAG,UAAU,KAAK;wCACzC;;gCACF;6EAAG;wBACL,OAAO;4BACL,sBAAsB;wBACxB;oBACF,OAAO;wBACL,sBAAsB;oBACxB;gBACF;;YACA;kDAAO,IAAM;;QACf;yCAAG,EAAE;IAEL,MAAM,eAAe;QACnB,QAAQ,GAAG,CAAC;QAEZ,IAAI,CAAC,aAAa;QAElB,mCAAmC;QACnC,eAAe;QACf,WAAW,IAAM,eAAe,QAAQ;QAExC,MAAM,aAAa,CAAC;QACpB,sBAAsB;QACtB,aAAa,OAAO,CAAC,sBAAsB,KAAK,SAAS,CAAC;QAE1D,QAAQ,GAAG,CAAC,+BAA+B;QAE3C,wDAAwD;QACxD,MAAM,qBAAqB,SAAS,gBAAgB,CAAC;QACrD,mBAAmB,OAAO,CAAC,CAAA;YACzB,IAAI,YAAY;gBACd,QAAQ,KAAK,CAAC,OAAO,GAAG;YAC1B,OAAO;gBACL,QAAQ,KAAK,CAAC,OAAO,GAAG;YAC1B;QACF;QAEA,8EAA8E;QAC9E,OAAO,aAAa,CAAC,IAAI,YAAY,wBAAwB;YAC3D,QAAQ;gBAAE,SAAS;YAAW;QAChC;IACF;IAEA,IAAI,CAAC,aAAa;QAChB,qBACE,6LAAC;YACC,OAAO;gBACL,GAAG,KAAK;gBACR,SAAS;gBACT,QAAQ;YACV;YACA,QAAQ;YACR,OAAM;sBACP;;;;;;IAIL;IAEA,qBACE,6LAAC;QACC,SAAS;QACT,WAAW;QACX,OAAO;YACL,GAAG,KAAK;YACR,YAAY;YACZ,WAAW,cAAc,eAAe;YACxC,YAAY,qBACR,6BACA;YACJ,OAAO,qBAAqB,6HAAA,CAAA,aAAU,CAAC,KAAK,CAAC,MAAM,GAAG;QACxD;QACA,OAAO,qBAAqB,yBAAyB;kBAEpD,qBAAqB,OAAO;;;;;;AAGnC;GAtGM;KAAA;2DAwGS,6JAAA,CAAA,UAAK,CAAC,IAAI,CAAC","debugId":null}},
    {"offset": {"line": 5333, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleWithHighlights.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleContainer\": \"ArticleWithHighlights-module__TI8ibW__articleContainer\",\n  \"articleContent\": \"ArticleWithHighlights-module__TI8ibW__articleContent\",\n  \"errorContainer\": \"ArticleWithHighlights-module__TI8ibW__errorContainer\",\n  \"errorMessage\": \"ArticleWithHighlights-module__TI8ibW__errorMessage\",\n  \"loadingContainer\": \"ArticleWithHighlights-module__TI8ibW__loadingContainer\",\n  \"loadingIndicator\": \"ArticleWithHighlights-module__TI8ibW__loadingIndicator\",\n  \"spin\": \"ArticleWithHighlights-module__TI8ibW__spin\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 5348, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/articleService.ts"],"sourcesContent":["// src/services/articleService.ts\n// // or wherever your interface lives\n\nexport async function getArticle(slug: string): Promise<Article> {\n    // 1. Read your base URL (make sure .env.local has NEXT_PUBLIC_API_BASE_URL)\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL\n        || 'http://127.0.0.1:5001'\n\n    // 2. Construct the correct Flask endpoint\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}`\n\n    // 3. Fetch it\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch article: ${res.status} ${res.statusText}`)\n    }\n\n    // 4. Parse JSON and return\n    return res.json()\n}\n\n// Get article comments\nexport async function getArticleComments(slug: string): Promise<ArticleComment[]> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comments`\n\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch comments: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a new comment\nexport async function postComment(slug: string, userId: string, content: string): Promise<ArticleComment> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a reply to a comment\nexport async function postReply(slug: string, commentId: string, userId: string, content: string): Promise<CommentReply> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a comment\nexport async function likeComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a reply\nexport async function likeReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a comment\nexport async function deleteComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a reply\nexport async function deleteReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\nexport interface Article {\n    _id: string;\n    id?: string;           // optional for your samples\n    slug: string;\n    title: string;\n    content: string | ParagraphContent[];\n    author?: string;\n    authorId: string;\n    publishedDate?: string;\n    tags: string[];\n    likes: number | string[];\n    viewCount?: number;\n    readTime?: number;\n    comments?: ArticleComment[];\n    coverImageUrl?: string;\n    createdAt?: string;\n    updatedAt?: string;\n    reposts?: string[];\n}\n\ninterface ParagraphContent {\n    paragraphId: string;\n    text: string;\n    likes: string[];\n    comments: CommentContent[];\n}\n\ninterface CommentContent {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport interface ArticleComment {\n    commentId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5484, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/syntaxHighlighter.js"],"sourcesContent":["import Prism from 'prismjs';\n\n// Import language support\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/components/prism-typescript';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-tsx';\nimport 'prismjs/components/prism-css';\nimport 'prismjs/components/prism-scss';\nimport 'prismjs/components/prism-json';\nimport 'prismjs/components/prism-python';\nimport 'prismjs/components/prism-java';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-cpp';\nimport 'prismjs/components/prism-csharp';\nimport 'prismjs/components/prism-php';\nimport 'prismjs/components/prism-ruby';\nimport 'prismjs/components/prism-go';\nimport 'prismjs/components/prism-rust';\nimport 'prismjs/components/prism-sql';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-markdown';\n\n/**\n * Apply syntax highlighting to all code blocks in a container\n * @param {HTMLElement} container - The container element to search for code blocks\n */\nexport function highlightCodeBlocks(container) {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const codeBlocks = container.querySelectorAll('pre code');\n\n    codeBlocks.forEach(codeBlock => {\n        const pre = codeBlock.parentElement;\n\n        // Get language from class name or data attribute\n        let language = 'javascript'; // default\n\n        // Check for language-* class on the code element\n        const classNames = codeBlock.className.split(' ');\n        for (const className of classNames) {\n            if (className.startsWith('language-')) {\n                language = className.replace('language-', '');\n                break;\n            }\n        }\n\n        // Check for data-language on the pre element\n        if (pre.hasAttribute('data-language')) {\n            language = pre.getAttribute('data-language');\n        }\n\n        // Apply syntax highlighting if language is supported\n        if (Prism.languages[language]) {\n            try {\n                const code = codeBlock.textContent || '';\n                const highlightedCode = Prism.highlight(code, Prism.languages[language], language);\n                codeBlock.innerHTML = highlightedCode;\n\n                // Add language indicator\n                pre.setAttribute('data-language', language);\n                pre.style.position = 'relative';\n\n            } catch (error) {\n                console.warn('Syntax highlighting failed for language:', language, error);\n            }\n        }\n    });\n}\n\n/**\n * Auto-detect and highlight code blocks when the DOM is ready\n */\nexport function autoHighlightCodeBlocks() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const highlightOnLoad = () => {\n        const containers = [\n            document.querySelector('.article-content'),\n            document.querySelector('.paragraph-text'),\n            document.querySelector('.paragraph-block'),\n            document.body\n        ].filter(Boolean);\n\n        containers.forEach(container => {\n            if (container) {\n                highlightCodeBlocks(container);\n            }\n        });\n    };\n\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', highlightOnLoad);\n    } else {\n        highlightOnLoad();\n    }\n}\n\n/**\n * Highlight code blocks after dynamic content is loaded\n * Call this after AJAX content updates\n */\nexport function highlightDynamicContent() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    // Wait a bit for DOM to settle\n    setTimeout(() => {\n        autoHighlightCodeBlocks();\n    }, 100);\n} "],"names":[],"mappings":";;;;;AAAA;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AAMO,SAAS,oBAAoB,SAAS;IACzC,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,MAAM,aAAa,UAAU,gBAAgB,CAAC;IAE9C,WAAW,OAAO,CAAC,CAAA;QACf,MAAM,MAAM,UAAU,aAAa;QAEnC,iDAAiD;QACjD,IAAI,WAAW,cAAc,UAAU;QAEvC,iDAAiD;QACjD,MAAM,aAAa,UAAU,SAAS,CAAC,KAAK,CAAC;QAC7C,KAAK,MAAM,aAAa,WAAY;YAChC,IAAI,UAAU,UAAU,CAAC,cAAc;gBACnC,WAAW,UAAU,OAAO,CAAC,aAAa;gBAC1C;YACJ;QACJ;QAEA,6CAA6C;QAC7C,IAAI,IAAI,YAAY,CAAC,kBAAkB;YACnC,WAAW,IAAI,YAAY,CAAC;QAChC;QAEA,qDAAqD;QACrD,IAAI,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;YAC3B,IAAI;gBACA,MAAM,OAAO,UAAU,WAAW,IAAI;gBACtC,MAAM,kBAAkB,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,MAAM,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;gBACzE,UAAU,SAAS,GAAG;gBAEtB,yBAAyB;gBACzB,IAAI,YAAY,CAAC,iBAAiB;gBAClC,IAAI,KAAK,CAAC,QAAQ,GAAG;YAEzB,EAAE,OAAO,OAAO;gBACZ,QAAQ,IAAI,CAAC,4CAA4C,UAAU;YACvE;QACJ;IACJ;AACJ;AAKO,SAAS;IACZ,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,MAAM,kBAAkB;QACpB,MAAM,aAAa;YACf,SAAS,aAAa,CAAC;YACvB,SAAS,aAAa,CAAC;YACvB,SAAS,aAAa,CAAC;YACvB,SAAS,IAAI;SAChB,CAAC,MAAM,CAAC;QAET,WAAW,OAAO,CAAC,CAAA;YACf,IAAI,WAAW;gBACX,oBAAoB;YACxB;QACJ;IACJ;IAEA,IAAI,SAAS,UAAU,KAAK,WAAW;QACnC,SAAS,gBAAgB,CAAC,oBAAoB;IAClD,OAAO;QACH;IACJ;AACJ;AAMO,SAAS;IACZ,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,+BAA+B;IAC/B,WAAW;QACP;IACJ,GAAG;AACP","debugId":null}},
    {"offset": {"line": 5609, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ClientSideHighlighter.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react';\n\nconst CLIENT_SIDE_HIGHLIGHTER_SCRIPT = `\n// Simple syntax highlighting without external dependencies\nfunction highlightCode() {\n  const codeBlocks = document.querySelectorAll('pre code');\n  \n  codeBlocks.forEach(codeBlock => {\n    const pre = codeBlock.parentElement;\n    if (!pre) return;\n    \n    // Apply dark theme\n    pre.style.backgroundColor = '#1e1e1e';\n    pre.style.color = '#d4d4d4';\n    pre.style.border = '1px solid #333';\n    pre.style.borderRadius = '8px';\n    pre.style.padding = '16px';\n    pre.style.fontFamily = \"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace\";\n    pre.style.fontSize = '14px';\n    pre.style.lineHeight = '1.6';\n    pre.style.overflowX = 'auto';\n    pre.style.position = 'relative';\n    \n    const code = codeBlock.textContent || '';\n    let highlightedCode = code;\n    \n    // Simplified highlighting to avoid regex issues\n    try {\n      // Keywords\n      const keywords = ['const', 'let', 'var', 'function', 'class', 'interface', 'type', 'enum', 'import', 'export', 'from', 'as', 'return', 'if', 'else', 'for', 'while', 'switch', 'case', 'break', 'default', 'try', 'catch', 'finally', 'async', 'await', 'new', 'this', 'extends', 'implements', 'private', 'public', 'protected', 'static'];\n      keywords.forEach(keyword => {\n        const regex = new RegExp('\\\\\\\\b' + keyword + '\\\\\\\\b', 'g');\n        highlightedCode = highlightedCode.replace(regex, '<span style=\"color: #569cd6; font-weight: 500;\">' + keyword + '</span>');\n      });\n      \n      // Simple string highlighting\n      highlightedCode = highlightedCode.replace(/\"([^\"]*)\"/g, '<span style=\"color: #ce9178;\">\"$1\"</span>');\n      highlightedCode = highlightedCode.replace(/'([^']*)'/g, '<span style=\"color: #ce9178;\">\\'$1\\'</span>');\n      \n      // Numbers\n      highlightedCode = highlightedCode.replace(/\\\\b\\\\d+\\\\.?\\\\d*\\\\b/g, '<span style=\"color: #b5cea8;\">$&</span>');\n      \n      // Comments\n      highlightedCode = highlightedCode.replace(/\\/\\/.*$/gm, '<span style=\"color: #6a9955; font-style: italic;\">$&</span>');\n    } catch (e) {\n      console.warn('Syntax highlighting failed:', e);\n      // Keep original code if highlighting fails\n    }\n    \n    codeBlock.innerHTML = highlightedCode;\n    \n    // Add language indicator if available\n    let language = 'code';\n    const classNames = codeBlock.className.split(' ');\n    for (const className of classNames) {\n      if (className.startsWith('language-')) {\n        language = className.replace('language-', '');\n        break;\n      }\n    }\n    \n    if (pre.hasAttribute('data-language')) {\n      language = pre.getAttribute('data-language');\n    }\n    \n    // Add language badge\n    const badge = document.createElement('div');\n    badge.textContent = language.toUpperCase();\n    badge.style.position = 'absolute';\n    badge.style.top = '8px';\n    badge.style.right = '12px';\n    badge.style.background = 'rgba(255, 255, 255, 0.1)';\n    badge.style.color = '#a0a0a0';\n    badge.style.padding = '2px 8px';\n    badge.style.borderRadius = '4px';\n    badge.style.fontSize = '12px';\n    badge.style.fontWeight = '500';\n    badge.style.letterSpacing = '0.5px';\n    pre.appendChild(badge);\n  });\n}\n\n// Run when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', highlightCode);\n} else {\n  highlightCode();\n}\n\n// Also run on dynamic content changes\nconst observer = new MutationObserver(() => {\n  setTimeout(highlightCode, 100);\n});\n\nobserver.observe(document.body, {\n  childList: true,\n  subtree: true\n});\n`;\n\nexport default function ClientSideHighlighter() {\n  useEffect(() => {\n    // Create and inject the script\n    const script = document.createElement('script');\n    script.textContent = CLIENT_SIDE_HIGHLIGHTER_SCRIPT;\n    document.head.appendChild(script);\n\n    return () => {\n      // Cleanup if needed\n      try {\n        document.head.removeChild(script);\n      } catch (_e) {\n        // Script might already be removed\n      }\n    };\n  }, []);\n\n  return null; // This component doesn't render anything\n} "],"names":[],"mappings":";;;AAEA;;AAFA;;AAIA,MAAM,iCAAiC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgGxC,CAAC;AAEc,SAAS;;IACtB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;2CAAE;YACR,+BAA+B;YAC/B,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,OAAO,WAAW,GAAG;YACrB,SAAS,IAAI,CAAC,WAAW,CAAC;YAE1B;mDAAO;oBACL,oBAAoB;oBACpB,IAAI;wBACF,SAAS,IAAI,CAAC,WAAW,CAAC;oBAC5B,EAAE,OAAO,IAAI;oBACX,kCAAkC;oBACpC;gBACF;;QACF;0CAAG,EAAE;IAEL,OAAO,MAAM,yCAAyC;AACxD;GAlBwB;KAAA","debugId":null}},
    {"offset": {"line": 5748, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/getMoodFromText.ts"],"sourcesContent":["import Sentiment from 'sentiment';\n\nexport function getMoodFromText(text: string): 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic' {\n    const sentiment = new Sentiment();\n    const result = sentiment.analyze(text);\n    const lowerText = text.toLowerCase();\n\n    // Define emotion keywords\n    const angryWords = ['angry', 'furious', 'rage', 'mad', 'hate', 'disgusted', 'outraged', 'pissed', 'frustrated', 'livid', 'infuriated', 'enraged', 'trump', 'politician', 'corrupt', 'stupid', 'idiot', 'terrible', 'awful', 'worst', 'disgusting', 'pathetic'];\n    const joyfulWords = ['happy', 'joy', 'excited', 'amazing', 'wonderful', 'fantastic', 'great', 'awesome', 'brilliant', 'excellent', 'perfect', 'beautiful', 'love', 'celebrate', 'triumph', 'success', 'victory', 'delighted', 'cheerful', 'blissful'];\n    const peacefulWords = ['calm', 'peaceful', 'serene', 'tranquil', 'gentle', 'soothing', 'quiet', 'meditation', 'zen', 'harmony', 'balance', 'nature', 'garden', 'sunset', 'ocean', 'mindful', 'breathe', 'stillness'];\n    const energeticWords = ['energy', 'power', 'strong', 'dynamic', 'intense', 'passionate', 'vibrant', 'bold', 'fierce', 'electric', 'explosive', 'powerful', 'charged', 'pumped', 'motivated', 'driven'];\n    const sadWords = ['sad', 'depressed', 'melancholy', 'grief', 'sorrow', 'tragic', 'heartbreak', 'crying', 'tears', 'lonely', 'despair', 'hopeless', 'miserable', 'devastated', 'broken'];\n\n    // Count keyword matches\n    const angryCount = angryWords.filter(word => lowerText.includes(word)).length;\n    const joyfulCount = joyfulWords.filter(word => lowerText.includes(word)).length;\n    const peacefulCount = peacefulWords.filter(word => lowerText.includes(word)).length;\n    const energeticCount = energeticWords.filter(word => lowerText.includes(word)).length;\n    const sadCount = sadWords.filter(word => lowerText.includes(word)).length;\n\n    // Determine mood based on keyword frequency and sentiment\n    if (angryCount >= 2 || (angryCount >= 1 && result.score < -2)) return 'angry';\n    if (joyfulCount >= 2 || (joyfulCount >= 1 && result.score > 3)) return 'joyful';\n    if (peacefulCount >= 2 || (peacefulCount >= 1 && result.score > 0)) return 'peaceful';\n    if (energeticCount >= 2 || (energeticCount >= 1 && Math.abs(result.score) > 2)) return 'energetic';\n    if (sadCount >= 2 || (sadCount >= 1 && result.score < -1)) return 'sad';\n\n    // Fallback to sentiment score\n    if (result.score > 2) return 'joyful';\n    if (result.score < -3) return 'angry';\n    if (result.score < -1) return 'sad';\n    return 'reflective';\n} "],"names":[],"mappings":";;;AAAA;;AAEO,SAAS,gBAAgB,IAAY;IACxC,MAAM,YAAY,IAAI,4IAAA,CAAA,UAAS;IAC/B,MAAM,SAAS,UAAU,OAAO,CAAC;IACjC,MAAM,YAAY,KAAK,WAAW;IAElC,0BAA0B;IAC1B,MAAM,aAAa;QAAC;QAAS;QAAW;QAAQ;QAAO;QAAQ;QAAa;QAAY;QAAU;QAAc;QAAS;QAAc;QAAW;QAAS;QAAc;QAAW;QAAU;QAAS;QAAY;QAAS;QAAS;QAAc;KAAW;IAC9P,MAAM,cAAc;QAAC;QAAS;QAAO;QAAW;QAAW;QAAa;QAAa;QAAS;QAAW;QAAa;QAAa;QAAW;QAAa;QAAQ;QAAa;QAAW;QAAW;QAAW;QAAa;QAAY;KAAW;IACrP,MAAM,gBAAgB;QAAC;QAAQ;QAAY;QAAU;QAAY;QAAU;QAAY;QAAS;QAAc;QAAO;QAAW;QAAW;QAAU;QAAU;QAAU;QAAS;QAAW;QAAW;KAAY;IACpN,MAAM,iBAAiB;QAAC;QAAU;QAAS;QAAU;QAAW;QAAW;QAAc;QAAW;QAAQ;QAAU;QAAY;QAAa;QAAY;QAAW;QAAU;QAAa;KAAS;IACtM,MAAM,WAAW;QAAC;QAAO;QAAa;QAAc;QAAS;QAAU;QAAU;QAAc;QAAU;QAAS;QAAU;QAAW;QAAY;QAAa;QAAc;KAAS;IAEvL,wBAAwB;IACxB,MAAM,aAAa,WAAW,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAC7E,MAAM,cAAc,YAAY,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAC/E,MAAM,gBAAgB,cAAc,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IACnF,MAAM,iBAAiB,eAAe,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IACrF,MAAM,WAAW,SAAS,MAAM,CAAC,CAAA,OAAQ,UAAU,QAAQ,CAAC,OAAO,MAAM;IAEzE,0DAA0D;IAC1D,IAAI,cAAc,KAAM,cAAc,KAAK,OAAO,KAAK,GAAG,CAAC,GAAI,OAAO;IACtE,IAAI,eAAe,KAAM,eAAe,KAAK,OAAO,KAAK,GAAG,GAAI,OAAO;IACvE,IAAI,iBAAiB,KAAM,iBAAiB,KAAK,OAAO,KAAK,GAAG,GAAI,OAAO;IAC3E,IAAI,kBAAkB,KAAM,kBAAkB,KAAK,KAAK,GAAG,CAAC,OAAO,KAAK,IAAI,GAAI,OAAO;IACvF,IAAI,YAAY,KAAM,YAAY,KAAK,OAAO,KAAK,GAAG,CAAC,GAAI,OAAO;IAElE,8BAA8B;IAC9B,IAAI,OAAO,KAAK,GAAG,GAAG,OAAO;IAC7B,IAAI,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;IAC9B,IAAI,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;IAC9B,OAAO;AACX","debugId":null}},
    {"offset": {"line": 5885, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/ReflectionRoom/ReflectionRoom.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"authPrompt\": \"ReflectionRoom-module__auS-8q__authPrompt\",\n  \"authorBadge\": \"ReflectionRoom-module__auS-8q__authorBadge\",\n  \"authorMessage\": \"ReflectionRoom-module__auS-8q__authorMessage\",\n  \"authorName\": \"ReflectionRoom-module__auS-8q__authorName\",\n  \"backdrop\": \"ReflectionRoom-module__auS-8q__backdrop\",\n  \"characterCount\": \"ReflectionRoom-module__auS-8q__characterCount\",\n  \"closeButton\": \"ReflectionRoom-module__auS-8q__closeButton\",\n  \"deleteButton\": \"ReflectionRoom-module__auS-8q__deleteButton\",\n  \"deleteSpinner\": \"ReflectionRoom-module__auS-8q__deleteSpinner\",\n  \"emptyIcon\": \"ReflectionRoom-module__auS-8q__emptyIcon\",\n  \"emptyState\": \"ReflectionRoom-module__auS-8q__emptyState\",\n  \"errorState\": \"ReflectionRoom-module__auS-8q__errorState\",\n  \"focused\": \"ReflectionRoom-module__auS-8q__focused\",\n  \"header\": \"ReflectionRoom-module__auS-8q__header\",\n  \"headerTitle\": \"ReflectionRoom-module__auS-8q__headerTitle\",\n  \"holographic-shine\": \"ReflectionRoom-module__auS-8q__holographic-shine\",\n  \"inputContainer\": \"ReflectionRoom-module__auS-8q__inputContainer\",\n  \"loadingSpinner\": \"ReflectionRoom-module__auS-8q__loadingSpinner\",\n  \"loadingState\": \"ReflectionRoom-module__auS-8q__loadingState\",\n  \"message\": \"ReflectionRoom-module__auS-8q__message\",\n  \"messageContent\": \"ReflectionRoom-module__auS-8q__messageContent\",\n  \"messageDeleting\": \"ReflectionRoom-module__auS-8q__messageDeleting\",\n  \"messageForm\": \"ReflectionRoom-module__auS-8q__messageForm\",\n  \"messageHeader\": \"ReflectionRoom-module__auS-8q__messageHeader\",\n  \"messageHeaderRight\": \"ReflectionRoom-module__auS-8q__messageHeaderRight\",\n  \"messageInput\": \"ReflectionRoom-module__auS-8q__messageInput\",\n  \"messageTime\": \"ReflectionRoom-module__auS-8q__messageTime\",\n  \"messagesContainer\": \"ReflectionRoom-module__auS-8q__messagesContainer\",\n  \"messagesList\": \"ReflectionRoom-module__auS-8q__messagesList\",\n  \"mobileModal\": \"ReflectionRoom-module__auS-8q__mobileModal\",\n  \"otherMessage\": \"ReflectionRoom-module__auS-8q__otherMessage\",\n  \"ownMessage\": \"ReflectionRoom-module__auS-8q__ownMessage\",\n  \"reflectionArrow\": \"ReflectionRoom-module__auS-8q__reflectionArrow\",\n  \"reflectionIcon\": \"ReflectionRoom-module__auS-8q__reflectionIcon\",\n  \"reflectionJoin\": \"ReflectionRoom-module__auS-8q__reflectionJoin\",\n  \"reflectionJoinText\": \"ReflectionRoom-module__auS-8q__reflectionJoinText\",\n  \"reflectionLabel\": \"ReflectionRoom-module__auS-8q__reflectionLabel\",\n  \"reflectionRoomContainer\": \"ReflectionRoom-module__auS-8q__reflectionRoomContainer\",\n  \"reflectionSearchBar\": \"ReflectionRoom-module__auS-8q__reflectionSearchBar\",\n  \"reflectionSearchWrapper\": \"ReflectionRoom-module__auS-8q__reflectionSearchWrapper\",\n  \"reflectionText\": \"ReflectionRoom-module__auS-8q__reflectionText\",\n  \"reflectionTopic\": \"ReflectionRoom-module__auS-8q__reflectionTopic\",\n  \"reflectionUnread\": \"ReflectionRoom-module__auS-8q__reflectionUnread\",\n  \"sendButton\": \"ReflectionRoom-module__auS-8q__sendButton\",\n  \"sendingSpinner\": \"ReflectionRoom-module__auS-8q__sendingSpinner\",\n  \"sidebar\": \"ReflectionRoom-module__auS-8q__sidebar\",\n  \"spin\": \"ReflectionRoom-module__auS-8q__spin\",\n  \"topicLabel\": \"ReflectionRoom-module__auS-8q__topicLabel\",\n  \"topicSection\": \"ReflectionRoom-module__auS-8q__topicSection\",\n  \"topicText\": \"ReflectionRoom-module__auS-8q__topicText\",\n  \"userName\": \"ReflectionRoom-module__auS-8q__userName\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 5944, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionRoom/ReflectionRoomButton.tsx"],"sourcesContent":["'use client'\n\nimport React from 'react';\nimport { motion } from 'framer-motion';\nimport styles from './ReflectionRoom.module.css';\n\ninterface ReflectionRoomButtonProps {\n  topic: string;\n  unreadCount: number;\n  isOpen: boolean;\n  onClick: () => void;\n}\n\nconst ReflectionRoomButton: React.FC<ReflectionRoomButtonProps> = ({\n  topic,\n  unreadCount,\n  isOpen,\n  onClick\n}) => {\n  const truncatedTopic = topic.length > 60 ? `${topic.substring(0, 60)}...` : topic;\n\n  return (\n    <motion.div\n      className={styles.reflectionSearchBar}\n      initial={{ opacity: 0, y: 20 }}\n      animate={{ opacity: 1, y: 0 }}\n      transition={{ duration: 0.4 }}\n      whileHover={{ scale: 1.02 }}\n      whileTap={{ scale: 0.98 }}\n      onClick={onClick}\n    >\n      <div className={`${styles.reflectionSearchWrapper} ${isOpen ? styles.focused : ''}`}>\n        {/* Chat Icon */}\n        <div className={styles.reflectionIcon}>\n          <svg \n            xmlns=\"http://www.w3.org/2000/svg\" \n            viewBox=\"0 0 24 24\" \n            fill=\"none\" \n            stroke=\"currentColor\" \n            strokeWidth=\"2\" \n            strokeLinecap=\"round\" \n            strokeLinejoin=\"round\"\n          >\n            <path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/>\n            <path d=\"M8 10h8\"/>\n            <path d=\"M8 14h6\"/>\n          </svg>\n        </div>\n\n        {/* Topic Display */}\n        <div className={styles.reflectionText}>\n          <span className={styles.reflectionLabel}>Reflect on:</span>\n          <span className={styles.reflectionTopic}>\"{truncatedTopic}\"</span>\n        </div>\n\n        {/* Join Indicator */}\n        <div className={styles.reflectionJoin}>\n          {unreadCount > 0 && (\n            <div className={styles.reflectionUnread}>\n              {unreadCount}\n            </div>\n          )}\n          <span className={styles.reflectionJoinText}>Join discussion</span>\n          <svg \n            className={styles.reflectionArrow}\n            xmlns=\"http://www.w3.org/2000/svg\" \n            viewBox=\"0 0 24 24\" \n            fill=\"none\" \n            stroke=\"currentColor\" \n            strokeWidth=\"2\" \n            strokeLinecap=\"round\" \n            strokeLinejoin=\"round\"\n          >\n            <path d=\"M9 18l6-6-6-6\"/>\n          </svg>\n        </div>\n      </div>\n    </motion.div>\n  );\n};\n\nexport default ReflectionRoomButton; "],"names":[],"mappings":";;;;AAGA;AACA;AAJA;;;;AAaA,MAAM,uBAA4D,CAAC,EACjE,KAAK,EACL,WAAW,EACX,MAAM,EACN,OAAO,EACR;IACC,MAAM,iBAAiB,MAAM,MAAM,GAAG,KAAK,GAAG,MAAM,SAAS,CAAC,GAAG,IAAI,GAAG,CAAC,GAAG;IAE5E,qBACE,6LAAC,6LAAA,CAAA,SAAM,CAAC,GAAG;QACT,WAAW,oKAAA,CAAA,UAAM,CAAC,mBAAmB;QACrC,SAAS;YAAE,SAAS;YAAG,GAAG;QAAG;QAC7B,SAAS;YAAE,SAAS;YAAG,GAAG;QAAE;QAC5B,YAAY;YAAE,UAAU;QAAI;QAC5B,YAAY;YAAE,OAAO;QAAK;QAC1B,UAAU;YAAE,OAAO;QAAK;QACxB,SAAS;kBAET,cAAA,6LAAC;YAAI,WAAW,GAAG,oKAAA,CAAA,UAAM,CAAC,uBAAuB,CAAC,CAAC,EAAE,SAAS,oKAAA,CAAA,UAAM,CAAC,OAAO,GAAG,IAAI;;8BAEjF,6LAAC;oBAAI,WAAW,oKAAA,CAAA,UAAM,CAAC,cAAc;8BACnC,cAAA,6LAAC;wBACC,OAAM;wBACN,SAAQ;wBACR,MAAK;wBACL,QAAO;wBACP,aAAY;wBACZ,eAAc;wBACd,gBAAe;;0CAEf,6LAAC;gCAAK,GAAE;;;;;;0CACR,6LAAC;gCAAK,GAAE;;;;;;0CACR,6LAAC;gCAAK,GAAE;;;;;;;;;;;;;;;;;8BAKZ,6LAAC;oBAAI,WAAW,oKAAA,CAAA,UAAM,CAAC,cAAc;;sCACnC,6LAAC;4BAAK,WAAW,oKAAA,CAAA,UAAM,CAAC,eAAe;sCAAE;;;;;;sCACzC,6LAAC;4BAAK,WAAW,oKAAA,CAAA,UAAM,CAAC,eAAe;;gCAAE;gCAAE;gCAAe;;;;;;;;;;;;;8BAI5D,6LAAC;oBAAI,WAAW,oKAAA,CAAA,UAAM,CAAC,cAAc;;wBAClC,cAAc,mBACb,6LAAC;4BAAI,WAAW,oKAAA,CAAA,UAAM,CAAC,gBAAgB;sCACpC;;;;;;sCAGL,6LAAC;4BAAK,WAAW,oKAAA,CAAA,UAAM,CAAC,kBAAkB;sCAAE;;;;;;sCAC5C,6LAAC;4BACC,WAAW,oKAAA,CAAA,UAAM,CAAC,eAAe;4BACjC,OAAM;4BACN,SAAQ;4BACR,MAAK;4BACL,QAAO;4BACP,aAAY;4BACZ,eAAc;4BACd,gBAAe;sCAEf,cAAA,6LAAC;gCAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMpB;KAlEM;uCAoES","debugId":null}},
    {"offset": {"line": 6122, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/notifications.ts"],"sourcesContent":["import {\n    collection,\n    addDoc,\n    getDocs,\n    getDoc,\n    doc,\n    query,\n    orderBy,\n    Timestamp,\n    where,\n    updateDoc,\n    deleteDoc,\n    limit\n} from 'firebase/firestore';\nimport { db, auth } from './clientApp';\n\n// Notification interface matching Firestore structure\nexport interface Notification {\n    id?: string;\n    userId: string;\n    type: 'comment' | 'reply' | 'like' | 'follow';\n    read: boolean;\n    sourceId: string; // ID of the article/comment\n    sourceType: 'article' | 'comment' | 'user';\n    message: string;\n    fromUser: {\n        id: string;\n        name: string;\n        username?: string; // Add username field for profile links\n    };\n    createdAt: Timestamp;\n    articleSlug?: string; // Optional slug to link directly to the article\n    articleTitle?: string; // Optional article title for context\n}\n\n/**\n * Create a new notification when someone comments on a user's post\n */\nexport async function createCommentNotification(\n    ownerId: string,\n    articleId: string,\n    articleSlug: string,\n    articleTitle: string,\n    commentId: string,\n    commentText: string\n) {\n    try {\n        // Skip if the owner is the commenter (don't notify yourself)\n        const currentUser = auth.currentUser;\n        if (!currentUser || currentUser.uid === ownerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: ownerId, // Who will receive the notification\n            type: 'comment',\n            read: false,\n            sourceId: commentId,\n            sourceType: 'comment',\n            message: `${currentUser.displayName || 'Someone'} commented on your article: \"${commentText.substring(0, 50)}${commentText.length > 50 ? '...' : ''}\"`,\n            fromUser: {\n                id: currentUser.uid,\n                name: currentUser.displayName || 'Anonymous'\n            },\n            createdAt: Timestamp.now(),\n            articleSlug,\n            articleTitle\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating notification:', error);\n        return null;\n    }\n}\n\n/**\n * Create a new notification when someone follows a user\n */\nexport async function createFollowNotification(\n    targetUserId: string,\n    followerName: string,\n    followerId: string,\n    followerUsername: string\n) {\n    try {\n        // Skip if user is following themselves (shouldn't happen due to checks in followUser)\n        if (targetUserId === followerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: targetUserId, // Who will receive the notification\n            type: 'follow',\n            read: false,\n            sourceId: followerId,\n            sourceType: 'user',\n            message: `${followerName} (@${followerUsername}) started following you`,\n            fromUser: {\n                id: followerId,\n                name: followerName,\n                username: followerUsername\n            },\n            createdAt: Timestamp.now()\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating follow notification:', error);\n        return null;\n    }\n}\n\n/**\n * Get all notifications for the current user\n */\nexport async function getUserNotifications(unreadOnly = false) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        // Create base query\n        const notificationsRef = collection(db, 'notifications');\n        let q;\n\n        if (unreadOnly) {\n            // Only fetch unread notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                where('read', '==', false),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        } else {\n            // Fetch all notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n\n        const notifications: Notification[] = [];\n        querySnapshot.forEach((doc) => {\n            notifications.push({\n                id: doc.id,\n                ...doc.data() as Omit<Notification, 'id'>\n            });\n        });\n\n        return notifications;\n    } catch (error) {\n        console.error('Error fetching notifications:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark a notification as read\n */\nexport async function markNotificationAsRead(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Update the read status\n        await updateDoc(notificationRef, {\n            read: true\n        });\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error marking notification as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark all notifications as read for the current user\n */\nexport async function markAllNotificationsAsRead() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n\n        // Create an array of promises to update each notification\n        const updatePromises = querySnapshot.docs.map(doc =>\n            updateDoc(doc.ref, { read: true })\n        );\n\n        // Execute all updates in parallel\n        await Promise.all(updatePromises);\n\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error('Error marking all notifications as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Delete the notification\n        await deleteDoc(notificationRef);\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error deleting notification:', error);\n        throw error;\n    }\n}\n\n/**\n * Get the count of unread notifications\n */\nexport async function getUnreadNotificationsCount() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            return 0;\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.size;\n    } catch (error) {\n        console.error('Error counting unread notifications:', error);\n        return 0;\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6333, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/userService.ts"],"sourcesContent":["import {\n    doc,\n    setDoc,\n    getDoc,\n    query,\n    collection,\n    where,\n    getDocs,\n    serverTimestamp,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    increment,\n    limit,\n    deleteDoc\n} from 'firebase/firestore';\nimport { updateProfile, deleteUser as deleteFirebaseAuthUser } from 'firebase/auth';\nimport { auth, db } from '../firebase/clientApp';\nimport { createFollowNotification } from '../firebase/notifications';\n\nexport interface UserProfile {\n    uid: string;\n    firstName: string;\n    lastName: string;\n    username: string;\n    email: string;\n    bio?: string;\n    createdAt: any;\n    following?: string[];\n    followers?: string[];\n    followersCount?: number;\n    followingCount?: number;\n    interests?: string[];\n}\n\n/**\n * Checks if a username is already taken\n * @param username The username to check\n * @returns A promise that resolves to a boolean indicating if the username is taken\n */\nexport async function isUsernameTaken(username: string): Promise<boolean> {\n    try {\n        const usernameQuery = query(\n            collection(db, 'users'),\n            where('username', '==', username.toLowerCase())\n        );\n\n        const querySnapshot = await getDocs(usernameQuery);\n        return !querySnapshot.empty;\n    } catch (error) {\n        console.error('Error checking username:', error);\n        throw error;\n    }\n}\n\n/**\n * Creates a user profile in Firestore\n * @param uid User's Firebase Auth UID\n * @param profile User profile data\n */\nexport async function createUserProfile(uid: string, profile: Omit<UserProfile, 'uid' | 'createdAt'>): Promise<void> {\n    try {\n        // First check if this user ID already has a profile\n        const existingUserProfile = await getUserProfile(uid);\n        if (existingUserProfile) {\n            console.log('User profile already exists, updating instead of creating');\n\n            // Update existing profile\n            const userRef = doc(db, 'users', uid);\n            await updateDoc(userRef, {\n                firstName: profile.firstName,\n                lastName: profile.lastName,\n                username: profile.username.toLowerCase(),\n                email: profile.email.toLowerCase(),\n                bio: profile.bio || existingUserProfile.bio || ''\n            });\n\n            // Update the user's display name in Firebase Auth\n            if (auth.currentUser) {\n                await updateProfile(auth.currentUser, {\n                    displayName: profile.username\n                });\n            }\n\n            return;\n        }\n\n        // Check if email already exists in another profile\n        const emailQuery = query(\n            collection(db, 'users'),\n            where('email', '==', profile.email.toLowerCase())\n        );\n\n        const emailQuerySnapshot = await getDocs(emailQuery);\n        if (!emailQuerySnapshot.empty) {\n            throw new Error('Email is already associated with another account');\n        }\n\n        // Check if the username is already taken\n        const usernameTaken = await isUsernameTaken(profile.username);\n        if (usernameTaken) {\n            throw new Error('Username is already taken');\n        }\n\n        const userRef = doc(db, 'users', uid);\n\n        // Create the user profile\n        await setDoc(userRef, {\n            uid,\n            firstName: profile.firstName,\n            lastName: profile.lastName,\n            username: profile.username.toLowerCase(),\n            email: profile.email.toLowerCase(),\n            bio: profile.bio || '',\n            createdAt: serverTimestamp()\n        });\n\n        // Update the user's display name in Firebase Auth\n        if (auth.currentUser) {\n            await updateProfile(auth.currentUser, {\n                displayName: profile.username\n            });\n        }\n    } catch (error) {\n        console.error('Error creating user profile:', error);\n        throw error;\n    }\n}\n\n/**\n * Gets a user's profile from Firestore\n * @param uid User's Firebase Auth UID\n * @returns A promise that resolves to the user's profile or null if not found\n */\nexport async function getUserProfile(uid: string): Promise<UserProfile | null> {\n    try {\n        const userRef = doc(db, 'users', uid);\n        const userDoc = await getDoc(userRef);\n\n        if (userDoc.exists()) {\n            return userDoc.data() as UserProfile;\n        }\n\n        return null;\n    } catch (error) {\n        console.error('Error fetching user profile:', error);\n        throw error;\n    }\n}\n\n/**\n * Gets a user's profile from Firestore based on their email\n * @param email User's email address\n * @returns A promise that resolves to the user's profile or null if not found\n */\nexport async function getUserProfileByEmail(email: string): Promise<UserProfile | null> {\n    if (!email) return null;\n    try {\n        const emailQuery = query(\n            collection(db, 'users'),\n            where('email', '==', email.toLowerCase()),\n            limit(1)\n        );\n        const querySnapshot = await getDocs(emailQuery);\n        if (!querySnapshot.empty) {\n            // Should only be one user with a unique email\n            return querySnapshot.docs[0].data() as UserProfile;\n        }\n        return null;\n    } catch (error) {\n        console.error('Error fetching user profile by email:', error);\n        throw error; // Re-throw to be handled by the caller\n    }\n}\n\n/**\n * Updates a user's bio\n * @param uid User's Firebase Auth UID\n * @param bio User's new bio\n * @returns A promise that resolves when the bio is updated\n */\nexport async function updateUserBio(uid: string, bio: string): Promise<void> {\n    try {\n        const userRef = doc(db, 'users', uid);\n        await updateDoc(userRef, {\n            bio\n        });\n    } catch (error) {\n        console.error('Error updating user bio:', error);\n        throw error;\n    }\n}\n\n/**\n * Updates a user's selected interests\n * @param uid User's Firebase Auth UID\n * @param interests Array of selected interests\n * @returns A promise that resolves when the interests are updated\n */\nexport async function updateUserInterests(uid: string, interests: string[]): Promise<void> {\n    try {\n        const userRef = doc(db, 'users', uid);\n        await updateDoc(userRef, {\n            interests\n        });\n        console.log(`Interests updated for user ${uid}:`, interests);\n    } catch (error) {\n        console.error('Error updating user interests:', error);\n        throw error;\n    }\n}\n\n/**\n * Search for users by username or name\n * @param searchTerm The search term to find users\n * @returns Array of matching users\n */\nexport async function searchUsers(searchTerm: string): Promise<UserProfile[]> {\n    try {\n        if (!searchTerm || searchTerm.trim().length < 2) {\n            return [];\n        }\n\n        const searchTermLower = searchTerm.toLowerCase().trim();\n\n        // Create a query to find users whose username contains the search term\n        const usersRef = collection(db, 'users');\n        const usersSnapshot = await getDocs(usersRef);\n\n        // Filter users locally since Firestore doesn't support contains or regexp queries directly\n        const matchingUsers = usersSnapshot.docs\n            .map(doc => {\n                // Get all data from the document and ensure it has the correct UserProfile shape\n                const userData = doc.data() as UserProfile;\n                return userData;\n            })\n            .filter(user => {\n                const usernameLower = user.username.toLowerCase();\n                const firstNameLower = user.firstName.toLowerCase();\n                const lastNameLower = user.lastName.toLowerCase();\n                const fullNameLower = `${firstNameLower} ${lastNameLower}`;\n\n                return usernameLower.includes(searchTermLower) ||\n                    firstNameLower.includes(searchTermLower) ||\n                    lastNameLower.includes(searchTermLower) ||\n                    fullNameLower.includes(searchTermLower);\n            });\n\n        return matchingUsers;\n    } catch (error) {\n        console.error('Error searching users:', error);\n        return [];\n    }\n}\n\n/**\n * Follows a user\n * @param followerUid UID of the user who wants to follow\n * @param followingUid UID of the user to be followed\n * @returns A promise that resolves when the follow relationship is created\n */\nexport async function followUser(followerUid: string, followingUid: string): Promise<void> {\n    try {\n        // Don't allow users to follow themselves\n        if (followerUid === followingUid) {\n            throw new Error('You cannot follow yourself');\n        }\n\n        // Update the follower's following list\n        const followerRef = doc(db, 'users', followerUid);\n        await updateDoc(followerRef, {\n            following: arrayUnion(followingUid),\n            followingCount: increment(1)\n        });\n\n        // Update the following's followers list\n        const followingRef = doc(db, 'users', followingUid);\n        await updateDoc(followingRef, {\n            followers: arrayUnion(followerUid),\n            followersCount: increment(1)\n        });\n\n        // Get the follower's profile to use their name for the notification\n        const followerDoc = await getDoc(followerRef);\n        if (followerDoc.exists()) {\n            const followerData = followerDoc.data() as UserProfile;\n            // Create a notification for the user being followed\n            await createFollowNotification(\n                followingUid,\n                `${followerData.firstName} ${followerData.lastName}`,\n                followerUid,\n                followerData.username\n            );\n        }\n    } catch (error) {\n        console.error('Error following user:', error);\n        throw error;\n    }\n}\n\n/**\n * Unfollows a user\n * @param followerUid UID of the user who wants to unfollow\n * @param followingUid UID of the user to be unfollowed\n * @returns A promise that resolves when the follow relationship is removed\n */\nexport async function unfollowUser(followerUid: string, followingUid: string): Promise<void> {\n    try {\n        // Update the follower's following list\n        const followerRef = doc(db, 'users', followerUid);\n        await updateDoc(followerRef, {\n            following: arrayRemove(followingUid),\n            followingCount: increment(-1)\n        });\n\n        // Update the following's followers list\n        const followingRef = doc(db, 'users', followingUid);\n        await updateDoc(followingRef, {\n            followers: arrayRemove(followerUid),\n            followersCount: increment(-1)\n        });\n    } catch (error) {\n        console.error('Error unfollowing user:', error);\n        throw error;\n    }\n}\n\n/**\n * Checks if a user is following another user\n * @param followerUid UID of the potential follower\n * @param followingUid UID of the user who might be followed\n * @returns Promise resolving to a boolean indicating if follower follows following\n */\nexport async function isFollowing(followerUid: string, followingUid: string): Promise<boolean> {\n    try {\n        const followerRef = doc(db, 'users', followerUid);\n        const followerDoc = await getDoc(followerRef);\n\n        if (!followerDoc.exists()) {\n            return false;\n        }\n\n        const userData = followerDoc.data() as UserProfile;\n        return userData.following?.includes(followingUid) || false;\n    } catch (error) {\n        console.error('Error checking follow status:', error);\n        throw error;\n    }\n}\n\n/**\n * Gets a list of users that a user is following\n * @param uid User's Firebase Auth UID\n * @param maxLimit Maximum number of results to return\n * @returns Promise resolving to an array of user profiles\n */\nexport async function getFollowing(uid: string, maxLimit = 50): Promise<UserProfile[]> {\n    try {\n        // First get the user to access their following list\n        const userRef = doc(db, 'users', uid);\n        const userDoc = await getDoc(userRef);\n\n        if (!userDoc.exists()) {\n            return [];\n        }\n\n        const userData = userDoc.data() as UserProfile;\n        const followingList = userData.following || [];\n\n        if (followingList.length === 0) {\n            return [];\n        }\n\n        // Fetch each following user's profile\n        const followingUsers: UserProfile[] = [];\n        const batchLimit = Math.min(followingList.length, maxLimit);\n\n        for (let i = 0; i < batchLimit; i++) {\n            const followingId = followingList[i];\n            const followingUserRef = doc(db, 'users', followingId);\n            const followingUserDoc = await getDoc(followingUserRef);\n\n            if (followingUserDoc.exists()) {\n                followingUsers.push(followingUserDoc.data() as UserProfile);\n            }\n        }\n\n        return followingUsers;\n    } catch (error) {\n        console.error('Error getting following list:', error);\n        throw error;\n    }\n}\n\n/**\n * Gets a list of users following a user\n * @param uid User's Firebase Auth UID\n * @param maxLimit Maximum number of results to return\n * @returns Promise resolving to an array of user profiles\n */\nexport async function getFollowers(uid: string, maxLimit = 50): Promise<UserProfile[]> {\n    try {\n        // First get the user to access their followers list\n        const userRef = doc(db, 'users', uid);\n        const userDoc = await getDoc(userRef);\n\n        if (!userDoc.exists()) {\n            return [];\n        }\n\n        const userData = userDoc.data() as UserProfile;\n        const followersList = userData.followers || [];\n\n        if (followersList.length === 0) {\n            return [];\n        }\n\n        // Fetch each follower's profile\n        const followers: UserProfile[] = [];\n        const batchLimit = Math.min(followersList.length, maxLimit);\n\n        for (let i = 0; i < batchLimit; i++) {\n            const followerId = followersList[i];\n            const followerUserRef = doc(db, 'users', followerId);\n            const followerUserDoc = await getDoc(followerUserRef);\n\n            if (followerUserDoc.exists()) {\n                followers.push(followerUserDoc.data() as UserProfile);\n            }\n        }\n\n        return followers;\n    } catch (error) {\n        console.error('Error getting followers list:', error);\n        throw error;\n    }\n}\n\n/**\n * Deletes a user's account from Firebase Authentication and their profile from Firestore.\n * IMPORTANT: Deleting a user from Firebase Auth requires recent sign-in. \n * If this operation fails due to 'auth/requires-recent-login', \n * the client-side must handle re-authentication before retrying.\n * @param uid User's Firebase Auth UID\n * @returns A promise that resolves when the account and profile are deleted.\n */\nexport async function deleteUserAccount(uid: string): Promise<void> {\n    try {\n        // 1. Delete user profile from Firestore\n        const userProfileRef = doc(db, 'users', uid);\n        await deleteDoc(userProfileRef);\n        console.log(`User profile for UID ${uid} deleted from Firestore.`);\n\n        // 2. Delete user from Firebase Authentication\n        // This requires the current user to be the one being deleted.\n        // And the user must have signed in recently.\n        const currentUser = auth.currentUser;\n        if (currentUser && currentUser.uid === uid) {\n            await deleteFirebaseAuthUser(currentUser);\n            console.log(`User account for UID ${uid} deleted from Firebase Authentication.`);\n        } else if (!currentUser) {\n            console.error('No current user authenticated. Cannot delete Firebase Auth user.');\n            throw new Error('Authentication required to delete account.');\n        } else {\n            // This case (currentUser.uid !== uid) should ideally not happen if the function\n            // is called correctly from the client for the logged-in user.\n            console.error('Current authenticated user does not match UID to be deleted.');\n            throw new Error('Mismatch between authenticated user and account to be deleted.');\n        }\n\n    } catch (error: any) {\n        console.error('Error deleting user account:', error);\n        // Specific check for re-authentication requirement\n        if (error.code === 'auth/requires-recent-login') {\n            throw new Error('This operation is sensitive and requires recent authentication. Please sign out and sign back in, then try again.');\n        }\n        throw new Error('Failed to delete user account. ' + error.message);\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6664, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionRoom/useReflectionRoom.ts"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useCallback } from 'react';\nimport {\n    collection,\n    doc,\n    addDoc,\n    getDocs,\n    getDoc,\n    setDoc,\n    deleteDoc,\n    onSnapshot,\n    orderBy,\n    query,\n    serverTimestamp,\n    Timestamp\n} from 'firebase/firestore';\nimport { auth, db } from '@/firebase/clientApp';\nimport { getUserProfile } from '@/services/userService';\n\nexport interface ReflectionMessage {\n    id: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    read: boolean;\n}\n\nexport interface ReflectionMetadata {\n    topic: string;\n    createdAt: Timestamp;\n    authorId: string;\n}\n\nexport const useReflectionRoom = (articleId: string) => {\n    const [messages, setMessages] = useState<ReflectionMessage[]>([]);\n    const [topic, setTopic] = useState<string>('');\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState<string | null>(null);\n    const [unreadCount, setUnreadCount] = useState(0);\n\n    const currentUser = auth.currentUser;\n\n    // Load metadata (topic)\n    const loadMetadata = useCallback(async () => {\n        try {\n            const metadataRef = doc(db, 'reflections', articleId, 'metadata', 'main');\n            const metadataSnap = await getDoc(metadataRef);\n\n            if (metadataSnap.exists()) {\n                const data = metadataSnap.data() as ReflectionMetadata;\n                setTopic(data.topic);\n            }\n        } catch (error) {\n            console.error('Error loading reflection metadata:', error);\n            setError('Failed to load discussion topic');\n        }\n    }, [articleId]);\n\n    // Set up real-time listener for messages\n    useEffect(() => {\n        if (!articleId) return;\n\n        setLoading(true);\n\n        const messagesRef = collection(db, 'reflections', articleId, 'messages');\n        const q = query(messagesRef, orderBy('createdAt', 'asc'));\n\n        const unsubscribe = onSnapshot(q,\n            (snapshot) => {\n                const messagesData: ReflectionMessage[] = [];\n                let unreadCounter = 0;\n\n                snapshot.forEach((doc) => {\n                    const data = doc.data();\n                    const message: ReflectionMessage = {\n                        id: doc.id,\n                        userId: data.userId,\n                        userName: data.userName,\n                        content: data.content,\n                        createdAt: data.createdAt,\n                        read: data.read || false\n                    };\n\n                    messagesData.push(message);\n\n                    // Count unread messages not from current user\n                    if (!message.read && message.userId !== currentUser?.uid) {\n                        unreadCounter++;\n                    }\n                });\n\n                setMessages(messagesData);\n                setUnreadCount(unreadCounter);\n                setLoading(false);\n                setError(null);\n            },\n            (error) => {\n                console.error('Error listening to messages:', error);\n                setError('Failed to load messages');\n                setLoading(false);\n            }\n        );\n\n        // Load metadata\n        loadMetadata();\n\n        return () => unsubscribe();\n    }, [articleId, currentUser?.uid, loadMetadata]);\n\n    // Send a new message\n    const sendMessage = useCallback(async (content: string) => {\n        if (!currentUser || !content.trim()) return;\n\n        try {\n            // Get user profile for display name\n            const userProfile = await getUserProfile(currentUser.uid);\n            const userName = userProfile ?\n                `${userProfile.firstName} ${userProfile.lastName}` :\n                currentUser.displayName || currentUser.email?.split('@')[0] || 'Anonymous';\n\n            const messagesRef = collection(db, 'reflections', articleId, 'messages');\n\n            await addDoc(messagesRef, {\n                userId: currentUser.uid,\n                userName: userName,\n                content: content.trim(),\n                createdAt: serverTimestamp(),\n                read: false\n            });\n        } catch (error) {\n            console.error('Error sending message:', error);\n            throw error;\n        }\n    }, [currentUser, articleId]);\n\n    // Mark all messages as read\n    const markAllAsRead = useCallback(async () => {\n        if (!currentUser) return;\n\n        try {\n            const messagesRef = collection(db, 'reflections', articleId, 'messages');\n            const snapshot = await getDocs(messagesRef);\n\n            const updatePromises = snapshot.docs\n                .filter(doc => {\n                    const data = doc.data();\n                    return !data.read && data.userId !== currentUser.uid;\n                })\n                .map(doc =>\n                    setDoc(doc.ref, { read: true }, { merge: true })\n                );\n\n            await Promise.all(updatePromises);\n        } catch (error) {\n            console.error('Error marking messages as read:', error);\n        }\n    }, [currentUser, articleId]);\n\n    // Create initial metadata for new reflection room\n    const createReflectionRoom = useCallback(async (discussionTopic: string) => {\n        if (!currentUser) return;\n\n        try {\n            const metadataRef = doc(db, 'reflections', articleId, 'metadata', 'main');\n            await setDoc(metadataRef, {\n                topic: discussionTopic,\n                createdAt: serverTimestamp(),\n                authorId: currentUser.uid\n            });\n\n            setTopic(discussionTopic);\n        } catch (error) {\n            console.error('Error creating reflection room:', error);\n            throw error;\n        }\n    }, [currentUser, articleId]);\n\n    // Delete a message (only the message author can delete)\n    const deleteMessage = useCallback(async (messageId: string) => {\n        if (!currentUser) return;\n\n        try {\n            const messageRef = doc(db, 'reflections', articleId, 'messages', messageId);\n\n            // First verify the message belongs to the current user\n            const messageSnap = await getDoc(messageRef);\n            if (!messageSnap.exists()) {\n                throw new Error('Message not found');\n            }\n\n            const messageData = messageSnap.data();\n            if (messageData.userId !== currentUser.uid) {\n                throw new Error('You can only delete your own messages');\n            }\n\n            // Delete the message\n            await deleteDoc(messageRef);\n        } catch (error) {\n            console.error('Error deleting message:', error);\n            throw error;\n        }\n    }, [currentUser, articleId]);\n\n    // Clear all messages in the reflection room (for topic changes)\n    const clearAllMessages = useCallback(async () => {\n        if (!currentUser) return;\n\n        try {\n            const messagesRef = collection(db, 'reflections', articleId, 'messages');\n            const snapshot = await getDocs(messagesRef);\n\n            // Delete all messages\n            const deletePromises = snapshot.docs.map(doc => deleteDoc(doc.ref));\n            await Promise.all(deletePromises);\n        } catch (error) {\n            console.error('Error clearing messages:', error);\n            throw error;\n        }\n    }, [currentUser, articleId]);\n\n    // Update reflection room topic and clear chat\n    const updateReflectionTopic = useCallback(async (newTopic: string) => {\n        if (!currentUser) return;\n\n        try {\n            // First verify the user is the author of the reflection room\n            const metadataRef = doc(db, 'reflections', articleId, 'metadata', 'main');\n            const metadataSnap = await getDoc(metadataRef);\n\n            if (!metadataSnap.exists()) {\n                throw new Error('Reflection room not found');\n            }\n\n            const metadata = metadataSnap.data();\n            if (metadata.authorId !== currentUser.uid) {\n                throw new Error('Only the author can update the topic');\n            }\n\n            // Clear all messages first\n            await clearAllMessages();\n\n            // Update the topic\n            await setDoc(metadataRef, {\n                ...metadata,\n                topic: newTopic,\n                updatedAt: serverTimestamp()\n            });\n\n            setTopic(newTopic);\n        } catch (error) {\n            console.error('Error updating reflection topic:', error);\n            throw error;\n        }\n    }, [currentUser, articleId, clearAllMessages]);\n\n    return {\n        messages,\n        topic,\n        loading,\n        error,\n        unreadCount,\n        sendMessage,\n        deleteMessage,\n        clearAllMessages,\n        updateReflectionTopic,\n        markAllAsRead,\n        createReflectionRoom\n    };\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6934, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionRoom/ReflectionRoomSidebar.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useRef, useEffect, useCallback, useMemo } from 'react';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { auth } from '@/firebase/clientApp';\nimport { useReflectionRoom, ReflectionMessage } from './useReflectionRoom';\nimport { TrashIcon } from '@/components/icons/CustomIcons';\nimport styles from './ReflectionRoom.module.css';\n\ninterface ReflectionRoomSidebarProps {\n  articleId: string;\n  isOpen: boolean;\n  onClose: () => void;\n  isMobile: boolean;\n  authorId?: string;\n}\n\nconst ReflectionRoomSidebar: React.FC<ReflectionRoomSidebarProps> = ({\n  articleId,\n  isOpen,\n  onClose,\n  isMobile,\n  authorId\n}) => {\n  const [newMessage, setNewMessage] = useState('');\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [deletingMessageId, setDeletingMessageId] = useState<string | null>(null);\n  const messagesEndRef = useRef<HTMLDivElement>(null);\n  const textareaRef = useRef<HTMLTextAreaElement>(null);\n  \n  const {\n    messages,\n    topic,\n    loading,\n    error,\n    sendMessage,\n    deleteMessage,\n    unreadCount,\n    markAllAsRead\n  } = useReflectionRoom(articleId);\n\n  const currentUser = auth.currentUser;\n\n  // Memoize animation variants to prevent recreation\n  const sidebarVariants = useMemo(() => ({\n    closed: {\n      x: '100%',\n      opacity: 0,\n    },\n    open: {\n      x: 0,\n      opacity: 1,\n    }\n  }), []);\n\n  const mobileVariants = useMemo(() => ({\n    closed: {\n      y: '100%',\n      opacity: 0,\n    },\n    open: {\n      y: 0,\n      opacity: 1,\n    }\n  }), []);\n\n  // Optimize transition settings\n  const transitionSettings = useMemo(() => ({\n    type: \"tween\" as const,\n    duration: 0.3,\n    ease: [0.4, 0, 0.2, 1] as [number, number, number, number]\n  }), []);\n\n  // Auto-scroll to bottom when new messages arrive (debounced)\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      messagesEndRef.current?.scrollIntoView({ \n        behavior: 'smooth',\n        block: 'end'\n      });\n    }, 100);\n\n    return () => clearTimeout(timeoutId);\n  }, [messages.length]); // Only depend on message count, not full messages array\n\n  // Mark messages as read when sidebar is opened\n  useEffect(() => {\n    if (isOpen && unreadCount > 0) {\n      const timeoutId = setTimeout(() => {\n        markAllAsRead();\n      }, 500); // Delay to avoid marking as read too quickly\n\n      return () => clearTimeout(timeoutId);\n    }\n  }, [isOpen, unreadCount, markAllAsRead]);\n\n  // Auto-resize textarea (optimized)\n  const handleTextareaResize = useCallback(() => {\n    if (textareaRef.current) {\n      textareaRef.current.style.height = 'auto';\n      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`;\n    }\n  }, []);\n\n  useEffect(() => {\n    handleTextareaResize();\n  }, [newMessage, handleTextareaResize]);\n\n  const handleSubmit = useCallback(async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!newMessage.trim() || isSubmitting || !currentUser) return;\n\n    setIsSubmitting(true);\n    try {\n      await sendMessage(newMessage.trim());\n      setNewMessage('');\n    } catch (error) {\n      console.error('Error sending message:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [newMessage, isSubmitting, currentUser, sendMessage]);\n\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSubmit(e as any);\n    }\n  }, [handleSubmit]);\n\n  const formatMessageTime = useCallback((timestamp: any) => {\n    if (!timestamp) return '';\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    const now = new Date();\n    const diffInHours = (now.getTime() - date.getTime()) / (1000 * 60 * 60);\n    \n    if (diffInHours < 24) {\n      return date.toLocaleTimeString('en-US', { \n        hour: 'numeric', \n        minute: '2-digit',\n        hour12: true \n      });\n    } else {\n      return date.toLocaleDateString('en-US', { \n        month: 'short', \n        day: 'numeric',\n        hour: 'numeric',\n        minute: '2-digit',\n        hour12: true\n      });\n    }\n  }, []);\n\n  const handleDeleteMessage = useCallback(async (messageId: string) => {\n    if (!currentUser || deletingMessageId) return;\n\n    setDeletingMessageId(messageId);\n    try {\n      await deleteMessage(messageId);\n    } catch (error) {\n      console.error('Error deleting message:', error);\n      // You could add a toast notification here for better UX\n    } finally {\n      setDeletingMessageId(null);\n    }\n  }, [currentUser, deleteMessage, deletingMessageId]);\n\n  // Memoize message rendering to prevent unnecessary re-renders\n  const renderedMessages = useMemo(() => {\n    return messages.map((message: ReflectionMessage) => {\n      const isOwnMessage = message.userId === currentUser?.uid;\n      const isAuthorMessage = message.userId === authorId;\n      const isDeleting = deletingMessageId === message.id;\n      \n      return (\n        <div\n          key={message.id}\n          className={`${styles.message} ${\n            isOwnMessage ? styles.ownMessage : styles.otherMessage\n          } ${isAuthorMessage ? styles.authorMessage : ''} ${\n            isDeleting ? styles.messageDeleting : ''\n          }`}\n        >\n          <div className={styles.messageHeader}>\n            <span className={`${styles.userName} ${isAuthorMessage ? styles.authorName : ''}`}>\n              {message.userName}\n              {isAuthorMessage && (\n                <span className={styles.authorBadge}>Author</span>\n              )}\n            </span>\n            <div className={styles.messageHeaderRight}>\n              <span className={styles.messageTime}>\n                {formatMessageTime(message.createdAt)}\n              </span>\n              {isOwnMessage && (\n                <button\n                  className={styles.deleteButton}\n                  onClick={() => handleDeleteMessage(message.id)}\n                  disabled={isDeleting}\n                  aria-label=\"Delete message\"\n                  title=\"Delete message\"\n                >\n                  {isDeleting ? (\n                    <div className={styles.deleteSpinner}></div>\n                  ) : (\n                    <TrashIcon size={14} />\n                  )}\n                </button>\n              )}\n            </div>\n          </div>\n          <div className={styles.messageContent}>\n            {message.content}\n          </div>\n        </div>\n      );\n    });\n  }, [messages, currentUser?.uid, authorId, formatMessageTime, deletingMessageId, handleDeleteMessage]);\n\n  return (\n    <AnimatePresence mode=\"wait\">\n      {isOpen && (\n        <>\n          {/* Backdrop */}\n          <motion.div\n            className={styles.backdrop}\n            initial={{ opacity: 0 }}\n            animate={{ opacity: 1 }}\n            exit={{ opacity: 0 }}\n            transition={{ duration: 0.2 }}\n            onClick={onClose}\n          />\n          \n          {/* Sidebar */}\n          <motion.div\n            className={`${styles.sidebar} ${isMobile ? styles.mobileModal : ''}`}\n            variants={isMobile ? mobileVariants : sidebarVariants}\n            initial=\"closed\"\n            animate=\"open\"\n            exit=\"closed\"\n            transition={transitionSettings}\n          >\n            {/* Header */}\n            <div className={styles.header}>\n              <div className={styles.headerTitle}>\n                <h3>Reflection Room</h3>\n                <button \n                  className={styles.closeButton}\n                  onClick={onClose}\n                  aria-label=\"Close reflection room\"\n                >\n                  <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                    <path d=\"M18 6L6 18M6 6L18 18\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                  </svg>\n                </button>\n              </div>\n              \n              {/* Discussion Topic */}\n              {topic && (\n                <div className={styles.topicSection}>\n                  <div className={styles.topicLabel}>Discussion Topic</div>\n                  <div className={styles.topicText}>{topic}</div>\n                </div>\n              )}\n            </div>\n\n            {/* Messages */}\n            <div className={styles.messagesContainer}>\n              {loading ? (\n                <div className={styles.loadingState}>\n                  <div className={styles.loadingSpinner}></div>\n                  <p>Loading messages...</p>\n                </div>\n              ) : error ? (\n                <div className={styles.errorState}>\n                  <p>Error loading messages: {error}</p>\n                </div>\n              ) : messages.length === 0 ? (\n                <div className={styles.emptyState}>\n                  <div className={styles.emptyIcon}>💭</div>\n                  <p>No messages yet. Be the first to share your thoughts!</p>\n                </div>\n              ) : (\n                <div className={styles.messagesList}>\n                  {renderedMessages}\n                  <div ref={messagesEndRef} />\n                </div>\n              )}\n            </div>\n\n            {/* Message Input */}\n            {currentUser && (\n              <form onSubmit={handleSubmit} className={styles.messageForm}>\n                <div className={styles.inputContainer}>\n                  <textarea\n                    ref={textareaRef}\n                    value={newMessage}\n                    onChange={(e) => setNewMessage(e.target.value)}\n                    onKeyDown={handleKeyDown}\n                    placeholder=\"Share your thoughts...\"\n                    className={styles.messageInput}\n                    rows={1}\n                    maxLength={1000}\n                    disabled={isSubmitting}\n                  />\n                  <button\n                    type=\"submit\"\n                    className={styles.sendButton}\n                    disabled={!newMessage.trim() || isSubmitting}\n                  >\n                    {isSubmitting ? (\n                      <div className={styles.sendingSpinner}></div>\n                    ) : (\n                      <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n                        <path d=\"M22 2L11 13M22 2L15 22L11 13M22 2L2 9L11 13\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\n                      </svg>\n                    )}\n                  </button>\n                </div>\n                <div className={styles.characterCount}>\n                  {newMessage.length}/1000\n                </div>\n              </form>\n            )}\n            \n            {!currentUser && (\n              <div className={styles.authPrompt}>\n                <p>Please sign in to join the conversation</p>\n              </div>\n            )}\n          </motion.div>\n        </>\n      )}\n    </AnimatePresence>\n  );\n};\n\nexport default ReflectionRoomSidebar; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7558, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionRoom/ReflectionRoom.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport ReflectionRoomButton from './ReflectionRoomButton';\nimport ReflectionRoomSidebar from './ReflectionRoomSidebar';\nimport { useReflectionRoom } from './useReflectionRoom';\nimport styles from './ReflectionRoom.module.css';\n\ninterface ReflectionRoomProps {\n  articleId: string;\n  hasReflectionRoom: boolean;\n  authorId?: string;\n}\n\nconst ReflectionRoom: React.FC<ReflectionRoomProps> = ({ \n  articleId, \n  hasReflectionRoom,\n  authorId\n}) => {\n  const [isOpen, setIsOpen] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  \n  const { topic, unreadCount } = useReflectionRoom(articleId);\n\n  // Memoize callbacks to prevent unnecessary re-renders\n  const toggleOpen = useCallback(() => {\n    setIsOpen(prev => !prev);\n  }, []);\n\n  const closeRoom = useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  // Authentication state management\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setIsAuthenticated(!!user);\n    });\n\n    return () => unsubscribe();\n  }, []);\n\n  // Mobile detection with debouncing\n  useEffect(() => {\n    const checkMobile = () => {\n      setIsMobile(window.innerWidth <= 768);\n    };\n\n    checkMobile();\n\n    let timeoutId: NodeJS.Timeout;\n    const handleResize = () => {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(checkMobile, 100); // Debounce resize events\n    };\n\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      clearTimeout(timeoutId);\n    };\n  }, []);\n\n  // Memoize the topic fallback to prevent unnecessary renders\n  const displayTopic = useMemo(() => {\n    return topic || 'Join the discussion';\n  }, [topic]);\n\n  // Early return if feature is not enabled or user is not authenticated\n  if (!hasReflectionRoom || !isAuthenticated) {\n    return null;\n  }\n\n  return (\n    <div className={styles.reflectionRoomContainer}>\n      <ReflectionRoomButton \n        topic={displayTopic}\n        unreadCount={unreadCount}\n        isOpen={isOpen}\n        onClick={toggleOpen}\n      />\n\n      <ReflectionRoomSidebar\n        articleId={articleId}\n        isOpen={isOpen}\n        onClose={closeRoom}\n        isMobile={isMobile}\n        authorId={authorId}\n      />\n    </div>\n  );\n};\n\n// Memoize the component to prevent unnecessary re-renders\nexport default React.memo(ReflectionRoom, (prevProps, nextProps) => {\n  return (\n    prevProps.articleId === nextProps.articleId &&\n    prevProps.hasReflectionRoom === nextProps.hasReflectionRoom &&\n    prevProps.authorId === nextProps.authorId\n  );\n}); "],"names":[],"mappings":";;;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AARA;;;;;;;;AAgBA,MAAM,iBAAgD,CAAC,EACrD,SAAS,EACT,iBAAiB,EACjB,QAAQ,EACT;;IACC,MAAM,CAAC,QAAQ,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACrC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACzC,MAAM,CAAC,iBAAiB,mBAAmB,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvD,MAAM,EAAE,KAAK,EAAE,WAAW,EAAE,GAAG,CAAA,GAAA,2JAAA,CAAA,oBAAiB,AAAD,EAAE;IAEjD,sDAAsD;IACtD,MAAM,aAAa,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;kDAAE;YAC7B;0DAAU,CAAA,OAAQ,CAAC;;QACrB;iDAAG,EAAE;IAEL,MAAM,YAAY,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;iDAAE;YAC5B,UAAU;QACZ;gDAAG,EAAE;IAEL,kCAAkC;IAClC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM,cAAc,CAAA,GAAA,wNAAA,CAAA,qBAAkB,AAAD,EAAE,+HAAA,CAAA,OAAI;wDAAE,CAAC;oBAC5C,mBAAmB,CAAC,CAAC;gBACvB;;YAEA;4CAAO,IAAM;;QACf;mCAAG,EAAE;IAEL,mCAAmC;IACnC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;oCAAE;YACR,MAAM;wDAAc;oBAClB,YAAY,OAAO,UAAU,IAAI;gBACnC;;YAEA;YAEA,IAAI;YACJ,MAAM;yDAAe;oBACnB,aAAa;oBACb,YAAY,WAAW,aAAa,MAAM,yBAAyB;gBACrE;;YAEA,OAAO,gBAAgB,CAAC,UAAU;YAClC;4CAAO;oBACL,OAAO,mBAAmB,CAAC,UAAU;oBACrC,aAAa;gBACf;;QACF;mCAAG,EAAE;IAEL,4DAA4D;IAC5D,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;gDAAE;YAC3B,OAAO,SAAS;QAClB;+CAAG;QAAC;KAAM;IAEV,sEAAsE;IACtE,IAAI,CAAC,qBAAqB,CAAC,iBAAiB;QAC1C,OAAO;IACT;IAEA,qBACE,6LAAC;QAAI,WAAW,oKAAA,CAAA,UAAM,CAAC,uBAAuB;;0BAC5C,6LAAC,+JAAA,CAAA,UAAoB;gBACnB,OAAO;gBACP,aAAa;gBACb,QAAQ;gBACR,SAAS;;;;;;0BAGX,6LAAC,gKAAA,CAAA,UAAqB;gBACpB,WAAW;gBACX,QAAQ;gBACR,SAAS;gBACT,UAAU;gBACV,UAAU;;;;;;;;;;;;AAIlB;GA9EM;;QAS2B,2JAAA,CAAA,oBAAiB;;;KAT5C;2DAiFS,6JAAA,CAAA,UAAK,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW;IACpD,OACE,UAAU,SAAS,KAAK,UAAU,SAAS,IAC3C,UAAU,iBAAiB,KAAK,UAAU,iBAAiB,IAC3D,UAAU,QAAQ,KAAK,UAAU,QAAQ;AAE7C","debugId":null}},
    {"offset": {"line": 7700, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ReflectionRoom/index.ts"],"sourcesContent":["export { default as ReflectionRoom } from './ReflectionRoom';\nexport { default as ReflectionRoomButton } from './ReflectionRoomButton';\nexport { default as ReflectionRoomSidebar } from './ReflectionRoomSidebar';\nexport { useReflectionRoom } from './useReflectionRoom';\nexport type { ReflectionMessage, ReflectionMetadata } from './useReflectionRoom'; "],"names":[],"mappings":";AAAA;AACA;AACA;AACA","debugId":null}},
    {"offset": {"line": 7740, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleWithHighlights.tsx"],"sourcesContent":["'use client'\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { HighlightProvider } from '@/context/HighlightContext';\nimport { AtmosphereIcon, LockClosedIcon, EnhancedIcon } from './icons/CustomIcons';\nimport ArticleHighlights from './ArticleHighlights';\nimport MoodToggle from './MoodToggle';\nimport ReflectionToggle from './ReflectionToggle';\nimport ReflectionModeToggle from './ReflectionModeToggle';\nimport styles from '@/styles/ArticleWithHighlights.module.css';\nimport { getArticle } from '@/services/articleService';\nimport { highlightCodeBlocks } from '@/utils/syntaxHighlighter';\nimport ClientSideHighlighter from './ClientSideHighlighter';\nimport { getMoodFromText } from '@/utils/getMoodFromText';\nimport { moodThemes } from '@/utils/moodThemes';\nimport { ReflectionRoom } from './ReflectionRoom';\n\ninterface ArticleWithHighlightsProps {\n  articleId: string;\n  initialHtml?: string;\n  isAuthenticated?: boolean;\n  articleTitle?: string;\n  articleSlug?: string;\n  hasReflectionRoom?: boolean;\n  authorId?: string;\n  moodFeatureEnabled?: boolean;\n  onToggleMoodFeature?: (enabled: boolean) => void;\n  mood?: 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic';\n}\n\nconst ArticleWithHighlights: React.FC<ArticleWithHighlightsProps> = ({\n  articleId,\n  initialHtml,\n  isAuthenticated = false,\n  articleTitle = 'Article',\n  articleSlug = '',\n  hasReflectionRoom = false,\n  authorId,\n  moodFeatureEnabled,\n  onToggleMoodFeature,\n  mood: externalMood\n}) => {\n  // const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(true); // Unused\n  const [article, setArticle] = useState<{ title: string; body: string } | null>(null);\n  const [isLoading, setIsLoading] = useState(!initialHtml);\n  const [error, setError] = useState('');\n  const [internalMood, setInternalMood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective');\n  \n  // Use external mood if provided, otherwise use internal mood\n  const mood = externalMood || internalMood;\n  const articleContainerRef = useRef<HTMLDivElement>(null);\n\n\n\n  // Apply syntax highlighting when content loads\n  useEffect(() => {\n    if (articleContainerRef.current && (initialHtml || article)) {\n      // Small delay to ensure DOM is updated\n      setTimeout(() => {\n        if (articleContainerRef.current) {\n          highlightCodeBlocks(articleContainerRef.current);\n        }\n      }, 100);\n    }\n  }, [initialHtml, article]);\n\n  // Analyze mood when content is available\n  useEffect(() => {\n    const content = getContentToDisplay();\n    if (content) {\n      // Extract text from HTML for sentiment analysis\n      const textContent = content.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\n      if (textContent && !externalMood) {\n        // Only set internal mood if no external mood is provided\n        const detectedMood = getMoodFromText(textContent);\n        setInternalMood(detectedMood);\n      }\n    }\n  }, [initialHtml, article]);\n\n  const handleShare = (text: string) => {\n    if (navigator.share) {\n      navigator.share({\n        title: article?.title || 'Shared highlight',\n        text: `\"${text}\" - from article ${articleId}`,\n        url: window.location.href\n      }).catch(error => console.error('Error sharing:', error));\n    } else {\n      const shareText = `\"${text}\" - from article ${articleId} ${window.location.href}`;\n      navigator.clipboard.writeText(shareText)\n        .then(() => alert('Highlight copied to clipboard!'))\n        .catch(error => console.error('Error copying to clipboard:', error));\n    }\n  };\n\n\n\n  // Load the article if needed\n  useEffect(() => {\n    if (initialHtml || article) return;\n\n    const fetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        const articleData = await getArticle(articleId);\n\n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n\n        let content = '';\n        if (typeof articleData.content === 'string') {\n          content = articleData.content;\n        } else {\n          content = articleData.content.map(p => `<p>${p.text}</p>`).join('\\n');\n        }\n\n        const cleanHtml = content\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n\n        setArticle({\n          title: articleData.title,\n          body: cleanHtml\n        });\n\n      } catch (error) {\n        console.error('Error loading article:', error);\n        setError('Failed to load article');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchArticle();\n  }, [articleId, article, initialHtml]);\n\n  // Get the content to display\n  const getContentToDisplay = () => {\n    if (initialHtml) {\n      return initialHtml\n        .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n        .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n    }\n    return article?.body || '';\n  };\n\n  if (isLoading) {\n    return (\n      <div className={styles.loadingContainer}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <p className={styles.errorMessage}>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <HighlightProvider articleId={articleId}>\n      <ClientSideHighlighter />\n      <article className={styles.articleContainer}>\n        {/* Reflection Room - Above the toggle bar */}\n        {hasReflectionRoom && isAuthenticated && (\n          <ReflectionRoom\n            articleId={articleId}\n            hasReflectionRoom={hasReflectionRoom}\n            authorId={authorId}\n          />\n        )}\n\n        {/* Reflection Settings - Responsive Design */}\n        <div \n          data-toggle-bar=\"true\"\n          style={{ \n            display: 'flex', \n            justifyContent: typeof window !== 'undefined' && window.innerWidth <= 768 \n              ? 'center' : 'space-between', \n            alignItems: 'center', \n            gap: typeof window !== 'undefined' && window.innerWidth <= 768 ? '0.5rem' : '1rem', \n            margin: typeof window !== 'undefined' && window.innerWidth <= 768 ? '0.5rem 0' : '1rem 0',\n            padding: typeof window !== 'undefined' && window.innerWidth <= 768 ? '0.5rem 0.75rem' : '1rem',\n            backgroundImage: isAuthenticated \n              ? `linear-gradient(270deg, ${moodThemes[mood].gradientStart}, ${moodThemes[mood].gradientEnd})`\n              : 'linear-gradient(270deg, #9CA3AF, #6B7280)',\n            backgroundSize: '200% 200%',\n            animation: 'slideGradient 8s ease infinite alternate',\n            borderRadius: typeof window !== 'undefined' && window.innerWidth <= 768 ? '12px' : '20px',\n            border: '1px solid rgba(255, 255, 255, 0.5)',\n            boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)',\n            fontSize: typeof window !== 'undefined' && window.innerWidth <= 768 ? '0.75rem' : '0.875rem',\n            flexWrap: typeof window !== 'undefined' && window.innerWidth <= 768 ? 'wrap' : 'nowrap'\n          }}>\n          {/* Check screen size for different layouts */}\n          {typeof window !== 'undefined' && window.innerWidth <= 768 ? (\n            // Mobile Layout - Minimal and compact\n            <>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.65rem' }}>\n                  🎨 Mood\n                </span>\n                <MoodToggle\n                  style={{\n                    padding: '0.25rem 0.5rem',\n                    border: 'none',\n                    background: 'rgba(255, 255, 255, 0.2)',\n                    color: '#F7FAFC',\n                    borderRadius: '12px',\n                    fontSize: '0.6rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                    minHeight: '24px',\n                    minWidth: '32px'\n                  }}\n                />\n              </div>\n              \n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.25rem' }}>\n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.65rem' }}>\n                  ✨ Reflect\n                </span>\n                <ReflectionModeToggle\n                  style={{\n                    padding: '0.25rem 0.5rem',\n                    border: 'none',\n                    borderRadius: '12px',\n                    fontSize: '0.6rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 3px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                    minHeight: '24px',\n                    minWidth: '32px'\n                  }}\n                />\n              </div>\n              \n              {isAuthenticated && (\n                <span style={{ \n                  color: '#F7FAFC', \n                  fontWeight: '500', \n                  fontSize: '0.6rem',\n                  opacity: 0.7,\n                  width: '100%',\n                  textAlign: 'center',\n                  marginTop: '0.25rem'\n                }}>\n                  Enhanced active\n                </span>\n              )}\n            </>\n          ) : typeof window !== 'undefined' && window.innerWidth <= 1024 ? (\n            // Tablet Layout - Medium\n            <>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.75rem' }}>\n                <span style={{ \n                  color: '#F7FAFC',\n                  fontWeight: '500',\n                  fontSize: '0.8rem',\n                  opacity: 0.9\n                }}>\n                  {isAuthenticated ? '🎨 Enhanced mode' : '🔒 Sign in for features'}\n                </span>\n              </div>\n              \n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.4rem' }}>\n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.7rem' }}>\n                  Mood\n                </span>\n                <MoodToggle\n                  style={{\n                    padding: '0.35rem 0.7rem',\n                    border: 'none',\n                    background: 'rgba(255, 255, 255, 0.2)',\n                    color: '#F7FAFC',\n                    borderRadius: '16px',\n                    fontSize: '0.65rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                  }}\n                />\n                \n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.7rem' }}>\n                  Reflect\n                </span>\n                <ReflectionModeToggle\n                  style={{\n                    padding: '0.35rem 0.7rem',\n                    border: 'none',\n                    borderRadius: '16px',\n                    fontSize: '0.65rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                  }}\n                />\n              </div>\n            </>\n          ) : (\n            // Desktop Layout - Full\n            <>\n              <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n                <span style={{ \n                  color: '#F7FAFC',\n                  fontWeight: '500',\n                  fontSize: '0.875rem',\n                  opacity: 0.9\n                }}>\n                  {isAuthenticated ? (\n                    <>\n                      <AtmosphereIcon size={16} color=\"#F7FAFC\" />\n                      Atmosphere adapted\n                    </>\n                  ) : (\n                    <>\n                      <LockClosedIcon size={16} color=\"#F7FAFC\" />\n                      Sign in for enhanced features\n                    </>\n                  )}\n                </span>\n                {isAuthenticated && (\n                  <span style={{ \n                    color: '#F7FAFC',\n                    fontWeight: '600',\n                    fontSize: '0.875rem'\n                  }}>\n                    <EnhancedIcon size={16} color=\"#F7FAFC\" />\n                    Enhanced features active\n                  </span>\n                )}\n              </div>\n              \n              <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.75rem' }}>\n                  Mood Background\n                </span>\n                <MoodToggle\n                  style={{\n                    padding: '0.4rem 0.8rem',\n                    border: 'none',\n                    background: 'rgba(255, 255, 255, 0.2)',\n                    color: '#F7FAFC',\n                    borderRadius: '20px',\n                    fontSize: '0.7rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                  }}\n                />\n                \n                <span style={{ color: '#F7FAFC', fontWeight: '500', fontSize: '0.75rem' }}>\n                  Interactive Reflections\n                </span>\n                <ReflectionModeToggle\n                  style={{\n                    padding: '0.4rem 0.8rem',\n                    border: 'none',\n                    borderRadius: '20px',\n                    fontSize: '0.7rem',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.3s ease',\n                    boxShadow: '0 1px 4px rgba(0, 0, 0, 0.1)',\n                    backdropFilter: 'blur(10px)',\n                  }}\n                />\n              </div>\n            </>\n          )}\n        </div>\n\n        <ArticleHighlights \n          articleId={articleId} \n          articleTitle={articleTitle}\n          articleSlug={articleSlug}\n        >\n          <div className={styles.articleContent}>\n            {/* Original article content with preserved formatting */}\n            <div \n              ref={articleContainerRef}\n              dangerouslySetInnerHTML={{ __html: getContentToDisplay() }}\n            />\n          </div>\n          \n          {/* Isolated Reflection Component */}\n          <ReflectionToggle articleId={articleId} />\n\n\n        </ArticleHighlights>\n      </article>\n    </HighlightProvider>\n  );\n};\n\nexport default ArticleWithHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8390, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleContent.tsx"],"sourcesContent":["\"use client\"\n\nimport React from 'react';\nimport ArticleWithHighlights from './ArticleWithHighlights';\n\ninterface ArticleContentProps {\n  articleId: string;\n  articleHtml: string | null;\n  isAuthenticated: boolean;\n  articleTitle: string;\n  articleSlug: string;\n  hasReflectionRoom?: boolean;\n  moodFeatureEnabled?: boolean;\n  onToggleMoodFeature?: (enabled: boolean) => void;\n  mood?: 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic';\n}\n\nconst ArticleContent: React.FC<ArticleContentProps> = ({\n  articleId,\n  articleHtml,\n  isAuthenticated,\n  articleTitle,\n  articleSlug,\n  hasReflectionRoom = false,\n  moodFeatureEnabled,\n  onToggleMoodFeature,\n  mood\n}) => {\n  // Debug re-renders\n  console.log('📝 ArticleContent re-rendered at:', new Date().toLocaleTimeString());\n  \n  return (\n    <ArticleWithHighlights \n      articleId={articleId} \n      initialHtml={articleHtml || undefined}\n      isAuthenticated={isAuthenticated}\n      articleTitle={articleTitle}\n      articleSlug={articleSlug}\n      hasReflectionRoom={hasReflectionRoom}\n      {...(isAuthenticated && {\n        moodFeatureEnabled: moodFeatureEnabled,\n        onToggleMoodFeature: onToggleMoodFeature,\n        mood: mood\n      })}\n    />\n  );\n};\n\n// Use React.memo with deep comparison for props\nexport default React.memo(ArticleContent, (prevProps, nextProps) => {\n  const shouldNotRerender = (\n    prevProps.articleId === nextProps.articleId &&\n    prevProps.articleHtml === nextProps.articleHtml &&\n    prevProps.isAuthenticated === nextProps.isAuthenticated &&\n    prevProps.articleTitle === nextProps.articleTitle &&\n    prevProps.articleSlug === nextProps.articleSlug &&\n    prevProps.hasReflectionRoom === nextProps.hasReflectionRoom &&\n    prevProps.moodFeatureEnabled === nextProps.moodFeatureEnabled &&\n    prevProps.onToggleMoodFeature === nextProps.onToggleMoodFeature &&\n    prevProps.mood === nextProps.mood\n  );\n  \n  if (!shouldNotRerender) {\n    console.log('📝 ArticleContent memo comparison - will re-render because:', {\n      articleId: prevProps.articleId !== nextProps.articleId,\n      articleHtml: prevProps.articleHtml !== nextProps.articleHtml,\n      isAuthenticated: prevProps.isAuthenticated !== nextProps.isAuthenticated,\n      articleTitle: prevProps.articleTitle !== nextProps.articleTitle,\n      articleSlug: prevProps.articleSlug !== nextProps.articleSlug,\n      hasReflectionRoom: prevProps.hasReflectionRoom !== nextProps.hasReflectionRoom,\n      moodFeatureEnabled: prevProps.moodFeatureEnabled !== nextProps.moodFeatureEnabled,\n      onToggleMoodFeature: prevProps.onToggleMoodFeature !== nextProps.onToggleMoodFeature,\n      mood: prevProps.mood !== nextProps.mood\n    });\n  }\n  \n  return shouldNotRerender;\n}); "],"names":[],"mappings":";;;;AAEA;AACA;AAHA;;;;AAiBA,MAAM,iBAAgD,CAAC,EACrD,SAAS,EACT,WAAW,EACX,eAAe,EACf,YAAY,EACZ,WAAW,EACX,oBAAoB,KAAK,EACzB,kBAAkB,EAClB,mBAAmB,EACnB,IAAI,EACL;IACC,mBAAmB;IACnB,QAAQ,GAAG,CAAC,qCAAqC,IAAI,OAAO,kBAAkB;IAE9E,qBACE,6LAAC,8IAAA,CAAA,UAAqB;QACpB,WAAW;QACX,aAAa,eAAe;QAC5B,iBAAiB;QACjB,cAAc;QACd,aAAa;QACb,mBAAmB;QAClB,GAAI,mBAAmB;YACtB,oBAAoB;YACpB,qBAAqB;YACrB,MAAM;QACR,CAAC;;;;;;AAGP;KA7BM;2DAgCS,6JAAA,CAAA,UAAK,CAAC,IAAI,CAAC,gBAAgB,CAAC,WAAW;IACpD,MAAM,oBACJ,UAAU,SAAS,KAAK,UAAU,SAAS,IAC3C,UAAU,WAAW,KAAK,UAAU,WAAW,IAC/C,UAAU,eAAe,KAAK,UAAU,eAAe,IACvD,UAAU,YAAY,KAAK,UAAU,YAAY,IACjD,UAAU,WAAW,KAAK,UAAU,WAAW,IAC/C,UAAU,iBAAiB,KAAK,UAAU,iBAAiB,IAC3D,UAAU,kBAAkB,KAAK,UAAU,kBAAkB,IAC7D,UAAU,mBAAmB,KAAK,UAAU,mBAAmB,IAC/D,UAAU,IAAI,KAAK,UAAU,IAAI;IAGnC,IAAI,CAAC,mBAAmB;QACtB,QAAQ,GAAG,CAAC,+DAA+D;YACzE,WAAW,UAAU,SAAS,KAAK,UAAU,SAAS;YACtD,aAAa,UAAU,WAAW,KAAK,UAAU,WAAW;YAC5D,iBAAiB,UAAU,eAAe,KAAK,UAAU,eAAe;YACxE,cAAc,UAAU,YAAY,KAAK,UAAU,YAAY;YAC/D,aAAa,UAAU,WAAW,KAAK,UAAU,WAAW;YAC5D,mBAAmB,UAAU,iBAAiB,KAAK,UAAU,iBAAiB;YAC9E,oBAAoB,UAAU,kBAAkB,KAAK,UAAU,kBAAkB;YACjF,qBAAqB,UAAU,mBAAmB,KAAK,UAAU,mBAAmB;YACpF,MAAM,UAAU,IAAI,KAAK,UAAU,IAAI;QACzC;IACF;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 8451, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/LikeButton.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\n\ninterface LikeButtonProps {\n  articleId: string;\n  initialLikes?: string[];\n  className?: string;\n  styles?: any;\n}\n\nconst LikeButton: React.FC<LikeButtonProps> = ({ \n  articleId, \n  initialLikes = [], \n  className = '',\n  styles = {}\n}) => {\n  const [likes, setLikes] = useState<string[]>(initialLikes);\n  const [isLiked, setIsLiked] = useState(false);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      if (user) {\n        setIsLiked(likes.includes(user.uid));\n      } else {\n        setIsLiked(false);\n      }\n    });\n    return () => unsubscribe();\n  }, [likes]);\n\n  // Update like status when initialLikes change\n  useEffect(() => {\n    setLikes(initialLikes);\n    if (currentUser) {\n      setIsLiked(initialLikes.includes(currentUser.uid));\n    }\n  }, [initialLikes, currentUser]);\n\n  const handleLikeClick = async (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    console.log('👍 LikeButton clicked - should NOT trigger parent re-render');\n    \n    if (!currentUser) {\n      alert('Please login to like articles');\n      return;\n    }\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    try {\n      if (isLiked) {\n        // Unlike\n        const newLikes = likes.filter(uid => uid !== currentUser.uid);\n        setLikes(newLikes);\n        setIsLiked(false);\n        console.log('👍 Unlike completed - likes:', newLikes.length);\n        \n        // Update Firestore\n        const { doc, updateDoc, arrayRemove } = await import('firebase/firestore');\n        const { db } = await import('@/firebase/clientApp');\n        const articleRef = doc(db, 'articles', articleId);\n        await updateDoc(articleRef, {\n          likes: arrayRemove(currentUser.uid)\n        });\n      } else {\n        // Like\n        const newLikes = [...likes, currentUser.uid];\n        setLikes(newLikes);\n        setIsLiked(true);\n        console.log('👍 Like completed - likes:', newLikes.length);\n        \n        // Update Firestore\n        const { doc, updateDoc, arrayUnion } = await import('firebase/firestore');\n        const { db } = await import('@/firebase/clientApp');\n        const articleRef = doc(db, 'articles', articleId);\n        await updateDoc(articleRef, {\n          likes: arrayUnion(currentUser.uid)\n        });\n      }\n    } catch (error) {\n      console.error('Error updating like status:', error);\n      // Revert on error\n      if (isLiked) {\n        setLikes([...likes, currentUser.uid]);\n        setIsLiked(true);\n      } else {\n        setLikes(likes.filter(uid => uid !== currentUser.uid));\n        setIsLiked(false);\n      }\n    }\n  };\n\n  return (\n    <button \n      className={`${className} ${isLiked ? styles.liked : ''}`}\n      onClick={handleLikeClick}\n      aria-label={isLiked ? 'Unlike article' : 'Like article'}\n      style={{\n        transition: 'all 0.3s ease',\n        transform: isAnimating ? 'scale(1.2)' : 'scale(1)',\n      }}\n    >\n      <svg \n        xmlns=\"http://www.w3.org/2000/svg\" \n        viewBox=\"0 0 24 24\" \n        fill={isLiked ? \"currentColor\" : \"none\"} \n        stroke=\"currentColor\" \n        strokeWidth=\"2\" \n        className={styles.likeIcon}\n        style={{\n          transition: 'all 0.3s ease',\n          filter: isAnimating ? 'drop-shadow(0 0 8px currentColor)' : 'none',\n        }}\n      >\n        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n      </svg>\n      <span>{likes.length > 0 ? likes.length : ''}</span>\n    </button>\n  );\n};\n\nexport default React.memo(LikeButton); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8618, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ExternalLikeButton.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { ExternalArticleService } from '@/services/externalArticleService';\n\ninterface ExternalLikeButtonProps {\n  externalId: string;\n  source: 'guardian' | 'newsapi';\n  title: string;\n  url: string;\n  initialLikes?: string[];\n  className?: string;\n  styles?: any;\n}\n\nconst ExternalLikeButton: React.FC<ExternalLikeButtonProps> = ({ \n  externalId,\n  source,\n  title,\n  url,\n  initialLikes = [], \n  className = '',\n  styles = {}\n}) => {\n  const [likes, setLikes] = useState<string[]>(initialLikes);\n  const [isLiked, setIsLiked] = useState(false);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [isAnimating, setIsAnimating] = useState(false);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      if (user) {\n        setIsLiked(likes.includes(user.uid));\n      } else {\n        setIsLiked(false);\n      }\n    });\n    return () => unsubscribe();\n  }, [likes]);\n\n  // Update like status when initialLikes change\n  useEffect(() => {\n    setLikes(initialLikes);\n    if (currentUser) {\n      setIsLiked(initialLikes.includes(currentUser.uid));\n    }\n  }, [initialLikes, currentUser]);\n\n  // Load current social data\n  useEffect(() => {\n    const loadSocialData = async () => {\n      try {\n        const socialData = await ExternalArticleService.getSocialData(externalId, source);\n        if (socialData) {\n          setLikes(socialData.likes || []);\n          if (currentUser) {\n            setIsLiked((socialData.likes || []).includes(currentUser.uid));\n          }\n        }\n      } catch (error) {\n        console.error('Error loading social data:', error);\n      }\n    };\n\n    loadSocialData();\n  }, [externalId, source, currentUser]);\n\n  const handleLikeClick = async (e: React.MouseEvent) => {\n    e.preventDefault();\n    e.stopPropagation();\n    \n    if (!currentUser) {\n      alert('Please login to like articles');\n      return;\n    }\n\n    if (isLoading) return;\n\n    // Optimistic update with animation\n    setIsAnimating(true);\n    setIsLoading(true);\n    setTimeout(() => setIsAnimating(false), 300);\n\n    try {\n      const result = await ExternalArticleService.toggleLike(\n        externalId, \n        source, \n        currentUser.uid, \n        title, \n        url\n      );\n      \n      // Update local state with server response\n      setIsLiked(result.isLiked);\n      if (result.isLiked) {\n        setLikes(prev => [...prev.filter(uid => uid !== currentUser.uid), currentUser.uid]);\n      } else {\n        setLikes(prev => prev.filter(uid => uid !== currentUser.uid));\n      }\n      \n      console.log(`${source} article ${result.isLiked ? 'liked' : 'unliked'} - total: ${result.totalLikes}`);\n    } catch (error) {\n      console.error('Error updating like status:', error);\n      // Revert optimistic update on error\n      setIsLiked(prev => !prev);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <button \n      className={`${className} ${isLiked ? styles.liked : ''}`}\n      onClick={handleLikeClick}\n      disabled={isLoading}\n      aria-label={isLiked ? 'Unlike article' : 'Like article'}\n      style={{\n        transition: 'all 0.3s ease',\n        transform: isAnimating ? 'scale(1.2)' : 'scale(1)',\n        opacity: isLoading ? 0.6 : 1\n      }}\n    >\n      <svg \n        xmlns=\"http://www.w3.org/2000/svg\" \n        viewBox=\"0 0 24 24\" \n        fill={isLiked ? \"currentColor\" : \"none\"} \n        stroke=\"currentColor\" \n        strokeWidth=\"2\" \n        className={styles.likeIcon}\n        style={{\n          transition: 'all 0.3s ease',\n          filter: isAnimating ? 'drop-shadow(0 0 8px currentColor)' : 'none',\n        }}\n      >\n        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n      </svg>\n      <span>{likes.length > 0 ? likes.length : ''}</span>\n    </button>\n  );\n};\n\nexport default React.memo(ExternalLikeButton); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 8791, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/presenceService.ts"],"sourcesContent":["import {\n    doc,\n    collection,\n    onSnapshot,\n    setDoc,\n    deleteDoc,\n    serverTimestamp,\n    query,\n    where,\n    orderBy,\n    limit,\n    Timestamp,\n    getDocs\n} from 'firebase/firestore';\nimport { db, auth } from '../firebase/clientApp';\nimport { getUserProfile, UserProfile } from './userService';\n\nexport interface PresenceUser {\n    uid: string;\n    username: string;\n    firstName: string;\n    lastName: string;\n    lastSeen: Timestamp;\n    articleId: string;\n}\n\nexport interface ActiveUser extends PresenceUser {\n    profile?: UserProfile;\n}\n\nclass PresenceService {\n    private presenceRefs: Map<string, () => void> = new Map();\n    private heartbeatIntervals: Map<string, NodeJS.Timeout> = new Map();\n    private cleanupInterval: NodeJS.Timeout | null = null;\n    private isDestroyed = false;\n\n    constructor() {\n        // Run cleanup every 60 seconds instead of 30 (reduce memory pressure)\n        this.cleanupInterval = setInterval(() => {\n            if (!this.isDestroyed) {\n                this.cleanupStalePresence();\n            }\n        }, 60000); // Increased from 30s to 60s\n    }\n\n    /**\n     * Start tracking user presence for an article\n     */\n    async startPresence(articleId: string): Promise<void> {\n        if (this.isDestroyed) return;\n\n        const user = auth.currentUser;\n        if (!user) {\n            // User not authenticated - silently return\n            return;\n        }\n\n        try {\n            // Get user profile for display info\n            const userProfile = await getUserProfile(user.uid);\n            if (!userProfile) return;\n\n            const presenceRef = doc(db, 'articlePresence', `${articleId}_${user.uid}`);\n\n            // Set initial presence\n            await setDoc(presenceRef, {\n                uid: user.uid,\n                username: userProfile.username,\n                firstName: userProfile.firstName,\n                lastName: userProfile.lastName,\n                lastSeen: serverTimestamp(),\n                articleId: articleId\n            });\n\n            // Set up heartbeat to update presence every 30 seconds instead of 15 (reduce database calls)\n            const heartbeatInterval = setInterval(async () => {\n                // Only update if user is still authenticated and page is visible\n                if (auth.currentUser && !document.hidden && !this.isDestroyed) {\n                    try {\n                        await setDoc(presenceRef, {\n                            uid: user.uid,\n                            username: userProfile.username,\n                            firstName: userProfile.firstName,\n                            lastName: userProfile.lastName,\n                            lastSeen: serverTimestamp(),\n                            articleId: articleId\n                        });\n                    } catch (error) {\n                        // If there's an error, stop the heartbeat\n                        clearInterval(heartbeatInterval);\n                        this.heartbeatIntervals.delete(articleId);\n                    }\n                }\n            }, 30000); // Increased from 15s to 30s\n\n            this.heartbeatIntervals.set(articleId, heartbeatInterval);\n\n            // Set up comprehensive cleanup handlers\n            const cleanup = () => {\n                this.stopPresence(articleId);\n            };\n\n            // Clean up on various events\n            const beforeUnloadHandler = cleanup;\n            const pageHideHandler = cleanup;\n            const visibilityChangeHandler = () => {\n                // If page becomes hidden for more than 60 seconds, clean up\n                if (document.hidden) {\n                    setTimeout(() => {\n                        if (document.hidden && !this.isDestroyed) {\n                            this.stopPresence(articleId);\n                        }\n                    }, 60000); // Increased from 30s to 60s\n                }\n            };\n\n            window.addEventListener('beforeunload', beforeUnloadHandler);\n            window.addEventListener('pagehide', pageHideHandler);\n            document.addEventListener('visibilitychange', visibilityChangeHandler);\n\n            // Clean up when user logs out\n            const authCleanup = auth.onAuthStateChanged((user) => {\n                if (!user && !this.isDestroyed) {\n                    this.stopPresence(articleId);\n                }\n            });\n\n            this.presenceRefs.set(articleId, () => {\n                window.removeEventListener('beforeunload', beforeUnloadHandler);\n                window.removeEventListener('pagehide', pageHideHandler);\n                document.removeEventListener('visibilitychange', visibilityChangeHandler);\n                authCleanup();\n            });\n\n        } catch (error) {\n            // Error starting presence - fail silently in production\n        }\n    }\n\n    /**\n     * Stop tracking user presence for an article\n     */\n    async stopPresence(articleId: string): Promise<void> {\n        const user = auth.currentUser;\n        if (!user) return; // Silent return for unauthenticated users\n\n        try {\n            // Clear heartbeat interval\n            const interval = this.heartbeatIntervals.get(articleId);\n            if (interval) {\n                clearInterval(interval);\n                this.heartbeatIntervals.delete(articleId);\n            }\n\n            // Remove presence document\n            const presenceRef = doc(db, 'articlePresence', `${articleId}_${user.uid}`);\n            await deleteDoc(presenceRef);\n\n            // Clean up event listeners\n            const cleanup = this.presenceRefs.get(articleId);\n            if (cleanup) {\n                window.removeEventListener('beforeunload', cleanup);\n                this.presenceRefs.delete(articleId);\n            }\n\n        } catch (error) {\n            // Error stopping presence - fail silently in production\n        }\n    }\n\n    /**\n     * Subscribe to active users for an article\n     */\n    subscribeToActiveUsers(\n        articleId: string,\n        callback: (users: ActiveUser[]) => void\n    ): () => void {\n        // Query for users active in the last 45 seconds (more strict)\n        const cutoffTime = new Date(Date.now() - 45 * 1000); // 45 seconds ago\n\n        const presenceQuery = query(\n            collection(db, 'articlePresence'),\n            where('articleId', '==', articleId),\n            where('lastSeen', '>', Timestamp.fromDate(cutoffTime)),\n            orderBy('lastSeen', 'desc'),\n            limit(10) // Get up to 10 users, we'll show max 5\n        );\n\n        const unsubscribe = onSnapshot(presenceQuery, async (snapshot) => {\n            try {\n                const users: ActiveUser[] = [];\n\n                for (const docSnapshot of snapshot.docs) {\n                    const data = docSnapshot.data() as PresenceUser;\n\n                    // Skip current user\n                    if (auth.currentUser && data.uid === auth.currentUser.uid) {\n                        continue;\n                    }\n\n                    // Get full user profile for avatar/display\n                    try {\n                        const profile = await getUserProfile(data.uid);\n                        users.push({\n                            ...data,\n                            profile: profile || undefined\n                        });\n                    } catch (error) {\n                        // Error fetching user profile - add user without full profile as fallback\n                        users.push({\n                            ...data,\n                            profile: undefined\n                        });\n                    }\n                }\n\n                callback(users);\n            } catch (error) {\n                // Error processing presence updates - return empty array\n                callback([]);\n            }\n        }, (error) => {\n            // Error in presence subscription - return empty array\n            callback([]);\n        });\n\n        return unsubscribe;\n    }\n\n    /**\n     * Clean up stale presence data that hasn't been updated recently\n     */\n    private async cleanupStalePresence(): Promise<void> {\n        try {\n            // Clean up presence data older than 1 minute\n            const staleTime = new Date(Date.now() - 60 * 1000);\n\n            const staleQuery = query(\n                collection(db, 'articlePresence'),\n                where('lastSeen', '<', Timestamp.fromDate(staleTime))\n            );\n\n            const staleSnapshot = await getDocs(staleQuery);\n\n            // Delete stale presence documents\n            const deletePromises = staleSnapshot.docs.map((docSnapshot) =>\n                deleteDoc(docSnapshot.ref)\n            );\n\n            if (deletePromises.length > 0) {\n                await Promise.all(deletePromises);\n                // Cleanup completed silently - consider using a proper logging service for monitoring\n            }\n        } catch (error) {\n            // Error cleaning up stale presence - fail silently\n        }\n    }\n\n    /**\n     * Clean up all presence tracking\n     */\n    cleanup(): void {\n        // Clear cleanup interval\n        if (this.cleanupInterval) {\n            clearInterval(this.cleanupInterval);\n            this.cleanupInterval = null;\n        }\n\n        // Clear all heartbeat intervals\n        this.heartbeatIntervals.forEach((interval) => {\n            clearInterval(interval);\n        });\n        this.heartbeatIntervals.clear();\n\n        // Remove all event listeners\n        this.presenceRefs.forEach((cleanup) => {\n            cleanup();\n        });\n        this.presenceRefs.clear();\n\n        this.isDestroyed = true;\n    }\n}\n\n// Export singleton instance\nexport const presenceService = new PresenceService();\n\n// Clean up service when the module is unloaded\nif (typeof window !== 'undefined') {\n    window.addEventListener('beforeunload', () => {\n        presenceService.cleanup();\n    });\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9014, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/ActiveReaders.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"activeReadersContainer\": \"ActiveReaders-module__b0ZgyG__activeReadersContainer\",\n  \"avatar\": \"ActiveReaders-module__b0ZgyG__avatar\",\n  \"avatarAppear\": \"ActiveReaders-module__b0ZgyG__avatarAppear\",\n  \"avatarStack\": \"ActiveReaders-module__b0ZgyG__avatarStack\",\n  \"pulse\": \"ActiveReaders-module__b0ZgyG__pulse\",\n  \"readingIndicator\": \"ActiveReaders-module__b0ZgyG__readingIndicator\",\n  \"slideIn\": \"ActiveReaders-module__b0ZgyG__slideIn\",\n  \"tooltip\": \"ActiveReaders-module__b0ZgyG__tooltip\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 9030, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ActiveReaders.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { presenceService, ActiveUser } from '../services/presenceService';\nimport styles from './ActiveReaders.module.css';\n\ninterface ActiveReadersProps {\n    articleId: string;\n}\n\nconst ActiveReaders: React.FC<ActiveReadersProps> = ({ articleId }) => {\n    const [activeUsers, setActiveUsers] = useState<ActiveUser[]>([]);\n    const [isVisible, setIsVisible] = useState(false);\n    const [isAuthenticated, setIsAuthenticated] = useState(false);\n\n    // Check authentication status\n    useEffect(() => {\n        const unsubscribe = auth.onAuthStateChanged((user) => {\n            setIsAuthenticated(!!user);\n        });\n\n        return () => unsubscribe();\n    }, []);\n\n    useEffect(() => {\n        if (!articleId || !isAuthenticated) return;\n\n        // Start presence tracking for current user\n        presenceService.startPresence(articleId);\n\n        // Subscribe to active users\n        const unsubscribe = presenceService.subscribeToActiveUsers(articleId, (users) => {\n            // Limit to first 5 users\n            const limitedUsers = users.slice(0, 5);\n            setActiveUsers(limitedUsers);\n            setIsVisible(limitedUsers.length > 0);\n        });\n\n        // Cleanup on unmount\n        return () => {\n            unsubscribe();\n            presenceService.stopPresence(articleId);\n        };\n    }, [articleId, isAuthenticated]);\n\n    // Don't show anything if user is not authenticated\n    if (!isAuthenticated) {\n        return null;\n    }\n\n    // Only show if there are active users\n    if (!isVisible || activeUsers.length === 0) {\n        return null;\n    }\n\n\n\n    return (\n        <div className={styles.activeReadersContainer}>\n            <div className={styles.avatarStack}>\n                {activeUsers.map((user, index) => (\n                    <div\n                        key={user.uid}\n                        className={styles.avatar}\n                        style={{\n                            backgroundColor: getColorForUser(index),\n                            zIndex: 5 - index, // Reverse z-index so first user is on top\n                            left: `${index * 20}px`, // Overlap by 20px\n                        }}\n                        title={getDisplayName(user)}\n                    >\n                        {getInitials(user)}\n                    </div>\n                ))}\n                {activeUsers.length > 0 && (\n                    <div \n                        className={styles.readingIndicator}\n                        style={{\n                            left: `${(activeUsers.length - 1) * 20 + 24}px`, // Position after last avatar\n                        }}\n                    >\n                        <div className={styles.pulse}></div>\n                    </div>\n                )}\n            </div>\n            <div className={styles.tooltip}>\n                {activeUsers.length === 1 ? (\n                    <span>{getDisplayName(activeUsers[0])} is reading this</span>\n                ) : (\n                    <span>{activeUsers.length} people are reading this</span>\n                )}\n            </div>\n        </div>\n    );\n};\n\n// Helper functions moved outside component to avoid re-creating them\nconst getInitials = (user: ActiveUser): string => {\n    if (user.profile?.firstName && user.profile?.lastName) {\n        return `${user.profile.firstName[0]}${user.profile.lastName[0]}`.toUpperCase();\n    }\n    if (user.firstName && user.lastName) {\n        return `${user.firstName[0]}${user.lastName[0]}`.toUpperCase();\n    }\n    if (user.username) {\n        return user.username.slice(0, 2).toUpperCase();\n    }\n    return '?';\n};\n\nconst getDisplayName = (user: ActiveUser): string => {\n    if (user.profile?.firstName && user.profile?.lastName) {\n        return `${user.profile.firstName} ${user.profile.lastName}`;\n    }\n    if (user.firstName && user.lastName) {\n        return `${user.firstName} ${user.lastName}`;\n    }\n    return user.username || 'Anonymous';\n};\n\nconst getColorForUser = (index: number): string => {\n    const colors = [\n        '#FF6B6B', // Red\n        '#4ECDC4', // Teal\n        '#45B7D1', // Blue\n        '#96CEB4', // Green\n        '#FECA57', // Yellow\n        '#FF9FF3', // Pink\n        '#A8E6CF', // Light Green\n        '#FFD93D', // Bright Yellow\n    ];\n    return colors[index % colors.length];\n};\n\nexport default ActiveReaders; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9221, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticlePage.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleActions\": \"ArticlePage-module__RPh7Qa__articleActions\",\n  \"articleContent\": \"ArticlePage-module__RPh7Qa__articleContent\",\n  \"articleDetails\": \"ArticlePage-module__RPh7Qa__articleDetails\",\n  \"articleHeader\": \"ArticlePage-module__RPh7Qa__articleHeader\",\n  \"articleHeaderWithReaders\": \"ArticlePage-module__RPh7Qa__articleHeaderWithReaders\",\n  \"articleMeta\": \"ArticlePage-module__RPh7Qa__articleMeta\",\n  \"articlePageContainer\": \"ArticlePage-module__RPh7Qa__articlePageContainer\",\n  \"articleTitle\": \"ArticlePage-module__RPh7Qa__articleTitle\",\n  \"authButtons\": \"ArticlePage-module__RPh7Qa__authButtons\",\n  \"authorAvatar\": \"ArticlePage-module__RPh7Qa__authorAvatar\",\n  \"authorDetails\": \"ArticlePage-module__RPh7Qa__authorDetails\",\n  \"authorInfo\": \"ArticlePage-module__RPh7Qa__authorInfo\",\n  \"authorName\": \"ArticlePage-module__RPh7Qa__authorName\",\n  \"authorNameLink\": \"ArticlePage-module__RPh7Qa__authorNameLink\",\n  \"backLink\": \"ArticlePage-module__RPh7Qa__backLink\",\n  \"cancelButton\": \"ArticlePage-module__RPh7Qa__cancelButton\",\n  \"commentsContainer\": \"ArticlePage-module__RPh7Qa__commentsContainer\",\n  \"dropdownItem\": \"ArticlePage-module__RPh7Qa__dropdownItem\",\n  \"editButton\": \"ArticlePage-module__RPh7Qa__editButton\",\n  \"editingHeader\": \"ArticlePage-module__RPh7Qa__editingHeader\",\n  \"errorContainer\": \"ArticlePage-module__RPh7Qa__errorContainer\",\n  \"errorMessage\": \"ArticlePage-module__RPh7Qa__errorMessage\",\n  \"headerActions\": \"ArticlePage-module__RPh7Qa__headerActions\",\n  \"headerContainer\": \"ArticlePage-module__RPh7Qa__headerContainer\",\n  \"headerLogo\": \"ArticlePage-module__RPh7Qa__headerLogo\",\n  \"likeButton\": \"ArticlePage-module__RPh7Qa__likeButton\",\n  \"likeIcon\": \"ArticlePage-module__RPh7Qa__likeIcon\",\n  \"liked\": \"ArticlePage-module__RPh7Qa__liked\",\n  \"loadingContainer\": \"ArticlePage-module__RPh7Qa__loadingContainer\",\n  \"loadingIndicator\": \"ArticlePage-module__RPh7Qa__loadingIndicator\",\n  \"loginButton\": \"ArticlePage-module__RPh7Qa__loginButton\",\n  \"logoLink\": \"ArticlePage-module__RPh7Qa__logoLink\",\n  \"moodControls\": \"ArticlePage-module__RPh7Qa__moodControls\",\n  \"moodToggleButton\": \"ArticlePage-module__RPh7Qa__moodToggleButton\",\n  \"pageContainer\": \"ArticlePage-module__RPh7Qa__pageContainer\",\n  \"pageHeader\": \"ArticlePage-module__RPh7Qa__pageHeader\",\n  \"profileCircle\": \"ArticlePage-module__RPh7Qa__profileCircle\",\n  \"profileDropdown\": \"ArticlePage-module__RPh7Qa__profileDropdown\",\n  \"profileMenu\": \"ArticlePage-module__RPh7Qa__profileMenu\",\n  \"readersSection\": \"ArticlePage-module__RPh7Qa__readersSection\",\n  \"relatedTag\": \"ArticlePage-module__RPh7Qa__relatedTag\",\n  \"relatedTagsHeading\": \"ArticlePage-module__RPh7Qa__relatedTagsHeading\",\n  \"relatedTagsList\": \"ArticlePage-module__RPh7Qa__relatedTagsList\",\n  \"relatedTagsSection\": \"ArticlePage-module__RPh7Qa__relatedTagsSection\",\n  \"shareButton\": \"ArticlePage-module__RPh7Qa__shareButton\",\n  \"signupButton\": \"ArticlePage-module__RPh7Qa__signupButton\",\n  \"spin\": \"ArticlePage-module__RPh7Qa__spin\",\n  \"tag\": \"ArticlePage-module__RPh7Qa__tag\",\n  \"tagContainer\": \"ArticlePage-module__RPh7Qa__tagContainer\",\n  \"titleSection\": \"ArticlePage-module__RPh7Qa__titleSection\",\n  \"writeButton\": \"ArticlePage-module__RPh7Qa__writeButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 9280, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleLayout.tsx"],"sourcesContent":["'use client'\n\nimport React from 'react';\nimport ArticleContent from './ArticleContent';\nimport LikeButton from './LikeButton';\nimport ExternalLikeButton from './ExternalLikeButton';\nimport ActiveReaders from './ActiveReaders';\nimport styles from '@/styles/ArticlePage.module.css';\n\ninterface ArticleLayoutProps {\n  // Article data (stable)\n  articleId: string;\n  articleHtml: string | null;\n  article: {\n    title: string;\n    authorName: string;\n    createdAt: string;\n    readTime: number;\n    tags?: string[];\n    authorId?: string;\n    hasReflectionRoom?: boolean;\n  } | null;\n  initialLikes: string[];\n  \n  // User data (semi-stable)\n  currentUser: any;\n  isAuthenticated: boolean;\n  \n  // Callbacks (should be stable with useCallback)\n  onEditClick: () => void;\n  \n  // Other props\n  articleTitle: string;\n  articleSlug: string;\n  \n  // Mood feature props\n  moodFeatureEnabled?: boolean;\n  onToggleMoodFeature?: (enabled: boolean) => void;\n  mood?: 'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic';\n  \n  // External article props (for Guardian/NewsAPI)\n  isExternal?: boolean;\n  externalSource?: 'guardian' | 'newsapi';\n  externalId?: string;\n  externalUrl?: string;\n}\n\nconst ArticleLayout: React.FC<ArticleLayoutProps> = ({\n  articleId,\n  articleHtml,\n  article,\n  initialLikes,\n  currentUser,\n  isAuthenticated,\n  onEditClick,\n  articleTitle,\n  articleSlug,\n  moodFeatureEnabled,\n  onToggleMoodFeature,\n  mood,\n  isExternal = false,\n  externalSource,\n  externalId,\n  externalUrl\n}) => {\n  console.log('🏗️ ArticleLayout re-rendered at:', new Date().toLocaleTimeString());\n\n  return (\n    <div className={styles.pageContainer}>\n      {/* Article header */}\n      {article && (\n        <header className={styles.articleHeader}>\n          <div className={styles.articleHeaderWithReaders}>\n            <div className={styles.titleSection}>\n              <h1 className={styles.articleTitle} style={{ margin: 0 }}>{article.title}</h1>\n            </div>\n            <div className={styles.readersSection}>\n              <ActiveReaders articleId={articleId} />\n            </div>\n          </div>\n          \n          <div className={styles.articleMeta}>\n            <div className={styles.authorInfo}>\n              <div className={styles.authorAvatar}>{article.authorName.charAt(0)}</div>\n              <div className={styles.authorDetails}>\n                <div className={styles.authorName}>{article.authorName}</div>\n                <div className={styles.articleDetails}>\n                  {article.createdAt} · {article.readTime} min read\n                </div>\n              </div>\n            </div>\n            \n            <div className={styles.articleActions}>\n              {isExternal && externalSource && externalId ? (\n                <ExternalLikeButton\n                  externalId={externalId}\n                  source={externalSource}\n                  title={article.title}\n                  url={externalUrl || ''}\n                  initialLikes={initialLikes}\n                  className={styles.likeButton}\n                  styles={styles}\n                />\n              ) : (\n                <LikeButton\n                  articleId={articleId}\n                  initialLikes={initialLikes}\n                  className={styles.likeButton}\n                  styles={styles}\n                />\n              )}\n            \n              {currentUser && article.authorId === currentUser.uid && (\n                <button \n                  className={styles.editButton}\n                  onClick={onEditClick}\n                >\n                  Edit\n                </button>\n              )}\n            </div>\n          </div>\n          \n          {article.tags && article.tags.length > 0 && (\n            <div className={styles.tagContainer}>\n              {article.tags.map((tag, index) => (\n                <span key={index} className={styles.tag}>{tag}</span>\n              ))}\n            </div>\n          )}\n        </header>\n      )}\n      \n      {/* Article content with highlights */}\n      <ArticleContent \n        articleId={articleId} \n        articleHtml={articleHtml}\n        isAuthenticated={isAuthenticated}\n        articleTitle={articleTitle}\n        articleSlug={articleSlug}\n        hasReflectionRoom={article?.hasReflectionRoom || false}\n        moodFeatureEnabled={moodFeatureEnabled}\n        onToggleMoodFeature={onToggleMoodFeature}\n        mood={mood}\n      />\n    </div>\n  );\n};\n\n// Aggressive memoization - only re-render if core content changes\nexport default React.memo(ArticleLayout, (prevProps, nextProps) => {\n  const shouldNotRerender = (\n    // Core article data (including articleId for ActiveReaders)\n    prevProps.articleId === nextProps.articleId &&\n    prevProps.articleHtml === nextProps.articleHtml &&\n    prevProps.article?.title === nextProps.article?.title &&\n    prevProps.article?.authorName === nextProps.article?.authorName &&\n    prevProps.article?.createdAt === nextProps.article?.createdAt &&\n    prevProps.article?.readTime === nextProps.article?.readTime &&\n    prevProps.article?.authorId === nextProps.article?.authorId &&\n    prevProps.article?.hasReflectionRoom === nextProps.article?.hasReflectionRoom &&\n    \n    // User state\n    prevProps.isAuthenticated === nextProps.isAuthenticated &&\n    prevProps.currentUser?.uid === nextProps.currentUser?.uid &&\n    \n    // Stable props\n    prevProps.articleTitle === nextProps.articleTitle &&\n    prevProps.articleSlug === nextProps.articleSlug &&\n    \n    // Mood feature props\n    prevProps.moodFeatureEnabled === nextProps.moodFeatureEnabled &&\n    prevProps.mood === nextProps.mood &&\n    \n    // External article props\n    prevProps.isExternal === nextProps.isExternal &&\n    prevProps.externalSource === nextProps.externalSource &&\n    prevProps.externalId === nextProps.externalId &&\n    prevProps.externalUrl === nextProps.externalUrl &&\n    \n    // Callbacks (should be stable)\n    prevProps.onEditClick === nextProps.onEditClick &&\n    prevProps.onToggleMoodFeature === nextProps.onToggleMoodFeature\n  );\n  \n  if (!shouldNotRerender) {\n    console.log('🏗️ ArticleLayout memo - will re-render because something changed');\n  }\n  \n  return shouldNotRerender;\n}); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 9511, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/comment.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"cancelButton\": \"comment-module__H_rXLG__cancelButton\",\n  \"comment\": \"comment-module__H_rXLG__comment\",\n  \"commentActions\": \"comment-module__H_rXLG__commentActions\",\n  \"commentAuthor\": \"comment-module__H_rXLG__commentAuthor\",\n  \"commentAvatar\": \"comment-module__H_rXLG__commentAvatar\",\n  \"commentFooter\": \"comment-module__H_rXLG__commentFooter\",\n  \"commentForm\": \"comment-module__H_rXLG__commentForm\",\n  \"commentHeader\": \"comment-module__H_rXLG__commentHeader\",\n  \"commentInput\": \"comment-module__H_rXLG__commentInput\",\n  \"commentInputContainer\": \"comment-module__H_rXLG__commentInputContainer\",\n  \"commentLoading\": \"comment-module__H_rXLG__commentLoading\",\n  \"commentMeta\": \"comment-module__H_rXLG__commentMeta\",\n  \"commentText\": \"comment-module__H_rXLG__commentText\",\n  \"commentTime\": \"comment-module__H_rXLG__commentTime\",\n  \"commentsList\": \"comment-module__H_rXLG__commentsList\",\n  \"commentsSection\": \"comment-module__H_rXLG__commentsSection\",\n  \"commentsTitle\": \"comment-module__H_rXLG__commentsTitle\",\n  \"dropdownMenu\": \"comment-module__H_rXLG__dropdownMenu\",\n  \"editActions\": \"comment-module__H_rXLG__editActions\",\n  \"editForm\": \"comment-module__H_rXLG__editForm\",\n  \"editInput\": \"comment-module__H_rXLG__editInput\",\n  \"likeButton\": \"comment-module__H_rXLG__likeButton\",\n  \"liked\": \"comment-module__H_rXLG__liked\",\n  \"loadingDot\": \"comment-module__H_rXLG__loadingDot\",\n  \"loadingDots\": \"comment-module__H_rXLG__loadingDots\",\n  \"loginButton\": \"comment-module__H_rXLG__loginButton\",\n  \"loginPromptContainer\": \"comment-module__H_rXLG__loginPromptContainer\",\n  \"menuButton\": \"comment-module__H_rXLG__menuButton\",\n  \"menuItem\": \"comment-module__H_rXLG__menuItem\",\n  \"noComments\": \"comment-module__H_rXLG__noComments\",\n  \"pulse\": \"comment-module__H_rXLG__pulse\",\n  \"repliesContainer\": \"comment-module__H_rXLG__repliesContainer\",\n  \"reply\": \"comment-module__H_rXLG__reply\",\n  \"replyActions\": \"comment-module__H_rXLG__replyActions\",\n  \"replyButton\": \"comment-module__H_rXLG__replyButton\",\n  \"replyForm\": \"comment-module__H_rXLG__replyForm\",\n  \"replyInput\": \"comment-module__H_rXLG__replyInput\",\n  \"replyInputContainer\": \"comment-module__H_rXLG__replyInputContainer\",\n  \"saveButton\": \"comment-module__H_rXLG__saveButton\",\n  \"shimmer\": \"comment-module__H_rXLG__shimmer\",\n  \"slideDown\": \"comment-module__H_rXLG__slideDown\",\n  \"submitButton\": \"comment-module__H_rXLG__submitButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 9561, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/avatarUtils.ts"],"sourcesContent":["import React from 'react';\n\nexport const getUserAvatar = (name: string, userId?: string, isSmall: boolean = false) => {\n    const initial = name?.charAt(0)?.toUpperCase() || 'A';\n    const colors = ['#4f46e5', '#0ea5e9', '#10b981', '#f59e0b', '#ef4444', '#8b5cf6', '#06b6d4', '#84cc16'];\n    const colorIndex = userId ? Math.abs(userId.charCodeAt(0) % colors.length) : 0;\n    const bgColor = colors[colorIndex];\n\n    return React.createElement('div', {\n        style: {\n            backgroundColor: bgColor,\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            color: 'white',\n            fontWeight: 'bold',\n            fontSize: isSmall ? '0.8rem' : '1rem',\n            width: isSmall ? '32px' : '40px',\n            height: isSmall ? '32px' : '40px',\n            borderRadius: '50%',\n            flexShrink: 0\n        }\n    }, initial);\n};\n\n/**\n * Get initials from first and last name\n */\nexport const getInitials = (firstName: string, lastName: string): string => {\n    const firstInitial = firstName?.charAt(0)?.toUpperCase() || '';\n    const lastInitial = lastName?.charAt(0)?.toUpperCase() || '';\n    return firstInitial + lastInitial || 'U';\n}; "],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,CAAC,MAAc,QAAiB,UAAmB,KAAK;IACjF,MAAM,UAAU,MAAM,OAAO,IAAI,iBAAiB;IAClD,MAAM,SAAS;QAAC;QAAW;QAAW;QAAW;QAAW;QAAW;QAAW;QAAW;KAAU;IACvG,MAAM,aAAa,SAAS,KAAK,GAAG,CAAC,OAAO,UAAU,CAAC,KAAK,OAAO,MAAM,IAAI;IAC7E,MAAM,UAAU,MAAM,CAAC,WAAW;IAElC,qBAAO,6JAAA,CAAA,UAAK,CAAC,aAAa,CAAC,OAAO;QAC9B,OAAO;YACH,iBAAiB;YACjB,SAAS;YACT,YAAY;YACZ,gBAAgB;YAChB,OAAO;YACP,YAAY;YACZ,UAAU,UAAU,WAAW;YAC/B,OAAO,UAAU,SAAS;YAC1B,QAAQ,UAAU,SAAS;YAC3B,cAAc;YACd,YAAY;QAChB;IACJ,GAAG;AACP;AAKO,MAAM,cAAc,CAAC,WAAmB;IAC3C,MAAM,eAAe,WAAW,OAAO,IAAI,iBAAiB;IAC5D,MAAM,cAAc,UAAU,OAAO,IAAI,iBAAiB;IAC1D,OAAO,eAAe,eAAe;AACzC","debugId":null}},
    {"offset": {"line": 9611, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/CommentSection.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useCallback, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { doc, collection, addDoc, query, orderBy, onSnapshot, updateDoc, deleteDoc, where, getDocs } from 'firebase/firestore';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { auth, db as firestore } from '@/firebase/clientApp';\nimport styles from '@/styles/comment.module.css';\nimport { HeartIcon, ReplyIcon, DotsVerticalIcon, TrashIcon, EditIcon } from './icons/CustomIcons';\nimport { getUserAvatar } from '@/utils/avatarUtils';\nimport { getMoodFromText } from '@/utils/getMoodFromText';\nimport { moodThemes } from '@/utils/moodThemes';\n\ninterface Comment {\n  id: string;\n  text: string;\n  authorId: string;\n  authorName: string;\n  authorEmail: string;\n  createdAt: any;\n  likes: string[];\n  mood?: string;\n  replies?: Comment[];\n  parentId?: string;\n}\n\ninterface CommentSectionProps {\n  articleId: string;\n  className?: string;\n}\n\nconst CommentSection: React.FC<CommentSectionProps> = ({ articleId, className = '' }) => {\n  const router = useRouter();\n  \n  // State management\n  const [comments, setComments] = useState<Comment[]>([]);\n  const [newComment, setNewComment] = useState('');\n  const [currentUser, setCurrentUser] = useState<any>(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [replyText, setReplyText] = useState('');\n  const [editingComment, setEditingComment] = useState<string | null>(null);\n  const [editText, setEditText] = useState('');\n  const [expandedMenus, setExpandedMenus] = useState<Set<string>>(new Set());\n  const [focusState, setFocusState] = useState(false);\n  const [windowWidth, setWindowWidth] = useState(0);\n\n  // Mood feature toggle\n  const moodFeatureEnabled = process.env.NODE_ENV === 'development';\n\n  // Device detection and responsive state\n  const deviceInfo = useMemo(() => {\n    return {\n      isMobile: windowWidth <= 768,\n      isTablet: windowWidth > 768 && windowWidth <= 1024,\n      isSmallPhone: windowWidth <= 480,\n      bottomSafeArea: windowWidth <= 768 ? 120 : 40\n    };\n  }, [windowWidth]);\n\n  // Optimized window resize handler\n  useEffect(() => {\n    const updateWidth = () => setWindowWidth(window.innerWidth);\n    updateWidth();\n\n    let timeoutId: NodeJS.Timeout;\n    const debouncedResize = () => {\n      clearTimeout(timeoutId);\n      timeoutId = setTimeout(updateWidth, 100);\n    };\n\n    window.addEventListener('resize', debouncedResize);\n    return () => {\n      window.removeEventListener('resize', debouncedResize);\n      clearTimeout(timeoutId);\n    };\n  }, []);\n\n  // Authentication state management\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setCurrentUser(user);\n      setIsAuthenticated(!!user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Real-time comments subscription\n  useEffect(() => {\n    if (!articleId) return;\n\n    const commentsRef = collection(firestore, 'articles', articleId, 'comments');\n    const q = query(commentsRef, orderBy('createdAt', 'desc'));\n\n    const unsubscribe = onSnapshot(q, (snapshot) => {\n      const fetchedComments: Comment[] = [];\n      snapshot.forEach((doc) => {\n        const data = doc.data();\n        fetchedComments.push({\n          id: doc.id,\n          ...data,\n        } as Comment);\n      });\n      \n      // Organize comments with replies\n      const organizedComments = organizeCommentsWithReplies(fetchedComments);\n      setComments(organizedComments);\n    });\n\n    return () => unsubscribe();\n  }, [articleId]);\n\n  // Organize comments into threads\n  const organizeCommentsWithReplies = useCallback((allComments: Comment[]): Comment[] => {\n    const topLevelComments = allComments.filter(comment => !comment.parentId);\n    const replies = allComments.filter(comment => comment.parentId);\n\n    return topLevelComments.map(comment => ({\n      ...comment,\n      replies: replies.filter(reply => reply.parentId === comment.id)\n        .sort((a, b) => a.createdAt?.toDate() - b.createdAt?.toDate())\n    }));\n  }, []);\n\n  // Get mood for styling\n  const mood = useMemo(() => {\n    if (!moodFeatureEnabled) return 'calm';\n    return getMoodFromText(newComment || replyText || editText);\n  }, [moodFeatureEnabled, newComment, replyText, editText]);\n\n  // Optimized comment submission\n  const handleCommentSubmit = useCallback(async (e: React.FormEvent) => {\n    e.preventDefault();\n    \n    if (!newComment.trim() || !currentUser || isSubmitting) return;\n\n    setIsSubmitting(true);\n    try {\n      const commentsRef = collection(firestore, 'articles', articleId, 'comments');\n      await addDoc(commentsRef, {\n        text: newComment.trim(),\n        authorId: currentUser.uid,\n        authorName: currentUser.displayName || 'Anonymous',\n        authorEmail: currentUser.email || '',\n        createdAt: new Date(),\n        likes: [],\n        mood: moodFeatureEnabled ? mood : undefined,\n      });\n\n      setNewComment('');\n      setFocusState(false);\n    } catch (error) {\n      console.error('Error adding comment:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [newComment, currentUser, isSubmitting, articleId, mood, moodFeatureEnabled]);\n\n  // Reply submission\n  const handleReplySubmit = useCallback(async (parentId: string) => {\n    if (!replyText.trim() || !currentUser || isSubmitting) return;\n\n    setIsSubmitting(true);\n    try {\n      const commentsRef = collection(firestore, 'articles', articleId, 'comments');\n      await addDoc(commentsRef, {\n        text: replyText.trim(),\n        authorId: currentUser.uid,\n        authorName: currentUser.displayName || 'Anonymous',\n        authorEmail: currentUser.email || '',\n        createdAt: new Date(),\n        likes: [],\n        parentId,\n        mood: moodFeatureEnabled ? getMoodFromText(replyText) : undefined,\n      });\n\n      setReplyText('');\n      setReplyingTo(null);\n    } catch (error) {\n      console.error('Error adding reply:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [replyText, currentUser, isSubmitting, articleId, moodFeatureEnabled]);\n\n  // Like/unlike functionality\n  const handleLike = useCallback(async (commentId: string, currentLikes: string[]) => {\n    if (!currentUser) return;\n\n    try {\n      const commentRef = doc(firestore, 'articles', articleId, 'comments', commentId);\n      const userLiked = currentLikes.includes(currentUser.uid);\n      \n      const updatedLikes = userLiked\n        ? currentLikes.filter(uid => uid !== currentUser.uid)\n        : [...currentLikes, currentUser.uid];\n\n      await updateDoc(commentRef, { likes: updatedLikes });\n    } catch (error) {\n      console.error('Error updating like:', error);\n    }\n  }, [currentUser, articleId]);\n\n  // Comment editing\n  const handleEditSubmit = useCallback(async (commentId: string) => {\n    if (!editText.trim() || !currentUser || isSubmitting) return;\n\n    setIsSubmitting(true);\n    try {\n      const commentRef = doc(firestore, 'articles', articleId, 'comments', commentId);\n      await updateDoc(commentRef, {\n        text: editText.trim(),\n        mood: moodFeatureEnabled ? getMoodFromText(editText) : undefined,\n        editedAt: new Date()\n      });\n\n      setEditingComment(null);\n      setEditText('');\n    } catch (error) {\n      console.error('Error editing comment:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [editText, currentUser, isSubmitting, articleId, moodFeatureEnabled]);\n\n  // Comment deletion\n  const handleDelete = useCallback(async (commentId: string) => {\n    if (!currentUser || isSubmitting) return;\n\n    if (!confirm('Are you sure you want to delete this comment?')) return;\n\n    setIsSubmitting(true);\n    try {\n      // Delete the comment\n      const commentRef = doc(firestore, 'articles', articleId, 'comments', commentId);\n      await deleteDoc(commentRef);\n\n      // Delete all replies to this comment\n      const repliesQuery = query(\n        collection(firestore, 'articles', articleId, 'comments'),\n        where('parentId', '==', commentId)\n      );\n      const repliesSnapshot = await getDocs(repliesQuery);\n      \n      const deletePromises = repliesSnapshot.docs.map(replyDoc => \n        deleteDoc(doc(firestore, 'articles', articleId, 'comments', replyDoc.id))\n      );\n      \n      await Promise.all(deletePromises);\n      \n      setExpandedMenus(prev => {\n        const newSet = new Set(prev);\n        newSet.delete(commentId);\n        return newSet;\n      });\n    } catch (error) {\n      console.error('Error deleting comment:', error);\n    } finally {\n      setIsSubmitting(false);\n    }\n  }, [currentUser, isSubmitting, articleId]);\n\n  // Format timestamp\n  const formatTimestamp = useCallback((timestamp: any) => {\n    if (!timestamp) return 'Just now';\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    const now = new Date();\n    const diffInMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60));\n    \n    if (diffInMinutes < 1) return 'Just now';\n    if (diffInMinutes < 60) return `${diffInMinutes}m ago`;\n    if (diffInMinutes < 1440) return `${Math.floor(diffInMinutes / 60)}h ago`;\n    return `${Math.floor(diffInMinutes / 1440)}d ago`;\n  }, []);\n\n  // Memoized container styles\n  const containerStyles = useMemo(() => ({\n    marginBottom: deviceInfo.isMobile ? \n      `max(${deviceInfo.bottomSafeArea + 40}px, calc(${deviceInfo.bottomSafeArea}px + env(safe-area-inset-bottom)))` :\n      '2rem',\n    paddingBottom: deviceInfo.isMobile ? '20px' : '0'\n  }), [deviceInfo]);\n\n  // Render individual comment\n  const renderComment = useCallback((comment: Comment, isReply = false) => (\n    <div key={comment.id} className={`${styles.comment} ${isReply ? styles.reply : ''}`}>\n      <div className={styles.commentHeader}>\n        <div className={styles.commentAvatar}>\n          {getUserAvatar(comment.authorName, comment.authorId)}\n        </div>\n        <div className={styles.commentMeta}>\n          <span className={styles.commentAuthor}>{comment.authorName}</span>\n          <span className={styles.commentTime}>{formatTimestamp(comment.createdAt)}</span>\n        </div>\n        {currentUser?.uid === comment.authorId && (\n          <div className={styles.commentActions}>\n            <button\n              onClick={() => {\n                const newExpanded = new Set(expandedMenus);\n                if (expandedMenus.has(comment.id)) {\n                  newExpanded.delete(comment.id);\n                } else {\n                  newExpanded.add(comment.id);\n                }\n                setExpandedMenus(newExpanded);\n              }}\n              className={styles.menuButton}\n              aria-label=\"Comment options\"\n            >\n              <DotsVerticalIcon size={16} color=\"#64748b\" />\n            </button>\n            {expandedMenus.has(comment.id) && (\n              <div className={styles.dropdownMenu}>\n                <button\n                  onClick={() => {\n                    setEditingComment(comment.id);\n                    setEditText(comment.text);\n                    setExpandedMenus(new Set());\n                  }}\n                  className={styles.menuItem}\n                >\n                  <EditIcon size={14} color=\"#3b82f6\" />\n                  Edit\n                </button>\n                <button\n                  onClick={() => handleDelete(comment.id)}\n                  className={styles.menuItem}\n                  disabled={isSubmitting}\n                >\n                  <TrashIcon size={14} color=\"#ef4444\" />\n                  Delete\n                </button>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n\n      {editingComment === comment.id ? (\n        <div className={styles.editForm}>\n          <textarea\n            value={editText}\n            onChange={(e) => setEditText(e.target.value)}\n            className={`${styles.editInput} mobile-optimized-input`}\n            data-mobile=\"true\"\n            rows={3}\n            autoFocus\n          />\n          <div className={styles.editActions}>\n            <button\n              onClick={() => {\n                setEditingComment(null);\n                setEditText('');\n              }}\n              className={styles.cancelButton}\n              disabled={isSubmitting}\n            >\n              Cancel\n            </button>\n            <button\n              onClick={() => handleEditSubmit(comment.id)}\n              className={styles.saveButton}\n              disabled={!editText.trim() || isSubmitting}\n            >\n              {isSubmitting ? 'Saving...' : 'Save'}\n            </button>\n          </div>\n        </div>\n      ) : (\n        <>\n          <p className={styles.commentText}>{comment.text}</p>\n          <div className={styles.commentFooter}>\n            <button\n              onClick={() => handleLike(comment.id, comment.likes || [])}\n              className={`${styles.likeButton} ${\n                comment.likes?.includes(currentUser?.uid) ? styles.liked : ''\n              }`}\n              disabled={!isAuthenticated}\n            >\n              <HeartIcon\n                size={14}\n                color={comment.likes?.includes(currentUser?.uid) ? '#ef4444' : '#64748b'}\n              />\n              {comment.likes?.length ? comment.likes.length : ''}\n            </button>\n            {!isReply && (\n              <button\n                onClick={() => setReplyingTo(comment.id)}\n                className={styles.replyButton}\n                disabled={!isAuthenticated}\n              >\n                <ReplyIcon size={14} color=\"#64748b\" />\n                Reply\n              </button>\n            )}\n          </div>\n        </>\n      )}\n\n      {/* Reply form */}\n      {replyingTo === comment.id && (\n        <div className={styles.replyForm}>\n          <div className={styles.replyInputContainer}>\n            <div className={styles.commentAvatar}>\n              {getUserAvatar(currentUser?.displayName || 'User', currentUser?.uid)}\n            </div>\n            <textarea\n              value={replyText}\n              onChange={(e) => setReplyText(e.target.value)}\n              placeholder=\"Write a reply...\"\n              className={`${styles.replyInput} mobile-optimized-input`}\n              data-mobile=\"true\"\n              rows={2}\n              autoFocus\n            />\n          </div>\n          <div className={styles.replyActions}>\n            <button\n              onClick={() => {\n                setReplyingTo(null);\n                setReplyText('');\n              }}\n              className={styles.cancelButton}\n              disabled={isSubmitting}\n            >\n              Cancel\n            </button>\n            <button\n              onClick={() => handleReplySubmit(comment.id)}\n              className={styles.submitButton}\n              disabled={!replyText.trim() || isSubmitting}\n            >\n              {isSubmitting ? 'Replying...' : 'Reply'}\n            </button>\n          </div>\n        </div>\n      )}\n\n      {/* Render replies */}\n      {comment.replies && comment.replies.length > 0 && (\n        <div className={styles.repliesContainer}>\n          {comment.replies.map(reply => renderComment(reply, true))}\n        </div>\n      )}\n    </div>\n  ), [\n    currentUser, expandedMenus, editingComment, editText, replyingTo, replyText,\n    isSubmitting, isAuthenticated, formatTimestamp, handleLike, handleDelete,\n    handleEditSubmit, handleReplySubmit\n  ]);\n\n  return (\n    <div \n      className={`${styles.commentsSection} ${className} comment-section`} \n      style={containerStyles}\n    >\n      <h3 className={styles.commentsTitle}>\n        Comments ({comments.length})\n      </h3>\n\n      {/* Comment Form */}\n      <form className={styles.commentForm} onSubmit={handleCommentSubmit}>\n        {isAuthenticated ? (\n          <div className={styles.commentInputContainer}>\n            <div className={styles.commentAvatar}>\n              {getUserAvatar(currentUser.displayName || currentUser.name, currentUser.uid || currentUser.id)}\n            </div>\n            <textarea\n              className={styles.commentInput}\n              placeholder=\"Share your thoughts...\"\n              value={newComment}\n              onChange={e => setNewComment(e.target.value)}\n              onFocus={() => setFocusState(true)}\n              onBlur={() => setFocusState(false)}\n              rows={4}\n            />\n            <div className={styles.commentActions}>\n              <button\n                type=\"button\"\n                onClick={() => setNewComment('')}\n                className={styles.cancelButton}\n                disabled={isSubmitting}\n              >\n                Cancel\n              </button>\n              <button\n                type=\"submit\"\n                className={styles.submitButton}\n                disabled={!newComment.trim() || isSubmitting}\n              >\n                <span>{isSubmitting ? 'Posting...' : 'Post Comment'}</span>\n              </button>\n            </div>\n          </div>\n        ) : (\n          <div className={styles.loginPromptContainer}>\n            <h4>Join the conversation</h4>\n            <p>Please log in to share your thoughts and engage with the community.</p>\n            <button\n              type=\"button\"\n              onClick={() => router.push('/login')}\n              className={styles.loginButton}\n            >\n              Sign In\n            </button>\n          </div>\n        )}\n      </form>\n\n      {/* Comments List */}\n      <div className={styles.commentsList}>\n        {comments.length === 0 ? (\n          <div className={styles.noComments}>\n            <h4>No comments yet</h4>\n            <p>Be the first to share your thoughts!</p>\n          </div>\n        ) : (\n          comments.map(comment => renderComment(comment))\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport default React.memo(CommentSection); "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 10491, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/newsService.ts"],"sourcesContent":["// NewsData.io interfaces (primary source)\nexport interface NewsDataArticle {\n    title: string;\n    link: string;\n    description: string;\n    content: string;\n    pubDate: string;\n    image_url: string;\n    source_id: string;\n    source_name: string;\n    creator: string[];\n    category: string[];\n    country: string[];\n    language: string;\n}\n\nexport interface NewsDataResponse {\n    status: string;\n    totalResults: number;\n    results: NewsDataArticle[];\n    nextPage?: string;\n}\n\n// Original NewsAPI.org interfaces (for fallback compatibility)\nexport interface NewsArticle {\n    title: string;\n    description: string;\n    content: string;\n    url: string;\n    urlToImage: string;\n    publishedAt: string;\n    source: {\n        name: string;\n    };\n    author: string;\n}\n\nexport interface NewsResponse {\n    status: string;\n    totalResults: number;\n    articles: NewsArticle[];\n}\n\nclass NewsService {\n    private newsDataApiKey: string;\n    private newsApiKey: string;\n    private newsDataBaseUrl = 'https://newsdata.io/api/1/news';\n    private newsApiBaseUrl = 'https://newsapi.org/v2';\n\n    constructor() {\n        // Primary: NewsData.io\n        this.newsDataApiKey = process.env.NEXT_PUBLIC_NEWSDATA_API_KEY || '';\n        // Fallback: NewsAPI.org  \n        this.newsApiKey = process.env.NEXT_PUBLIC_NEWS_API_KEY || '';\n\n        if (!this.newsDataApiKey || this.newsDataApiKey === 'YOUR_API_KEY_HERE') {\n            console.warn('NewsData.io API key not configured. Please set NEXT_PUBLIC_NEWSDATA_API_KEY in your environment variables.');\n        }\n\n        if (!this.newsApiKey || this.newsApiKey === 'YOUR_API_KEY_HERE') {\n            console.warn('NewsAPI.org key not configured. NewsData.io will be used exclusively.');\n        }\n    }\n\n    // Helper method to convert NewsData.io articles to standard format\n    private convertNewsDataToStandard(newsDataArticle: NewsDataArticle): NewsArticle {\n        return {\n            title: newsDataArticle.title,\n            description: newsDataArticle.description || '',\n            content: newsDataArticle.content || newsDataArticle.description || '',\n            url: newsDataArticle.link,\n            urlToImage: newsDataArticle.image_url || '',\n            publishedAt: newsDataArticle.pubDate,\n            source: {\n                name: newsDataArticle.source_name || newsDataArticle.source_id\n            },\n            author: newsDataArticle.creator?.[0] || newsDataArticle.source_name || 'Unknown'\n        };\n    }\n\n    async getTopHeadlines(category: string = 'general', country: string = 'us'): Promise<NewsResponse> {\n        // Try NewsData.io first (primary source)\n        if (this.newsDataApiKey && this.newsDataApiKey !== 'YOUR_API_KEY_HERE') {\n            try {\n                console.log('📰 Fetching from NewsData.io (primary)');\n                return await this.getNewsDataHeadlines(category, country);\n            } catch (error) {\n                console.warn('⚠️ NewsData.io failed, falling back to NewsAPI.org:', error);\n            }\n        }\n\n        // Fallback to NewsAPI.org\n        if (this.newsApiKey && this.newsApiKey !== 'YOUR_API_KEY_HERE') {\n            console.log('📰 Using NewsAPI.org (fallback)');\n            return await this.getNewsApiHeadlines(category, country);\n        }\n\n        throw new Error('No news API keys configured. Please set NEXT_PUBLIC_NEWSDATA_API_KEY or NEXT_PUBLIC_NEWS_API_KEY');\n    }\n\n    async searchArticles(query: string, sortBy: string = 'publishedAt'): Promise<NewsResponse> {\n        // Try NewsData.io first (primary source)\n        if (this.newsDataApiKey && this.newsDataApiKey !== 'YOUR_API_KEY_HERE') {\n            try {\n                console.log('🔍 Searching with NewsData.io (primary)');\n                return await this.searchNewsDataArticles(query);\n            } catch (error) {\n                console.warn('⚠️ NewsData.io search failed, falling back to NewsAPI.org:', error);\n            }\n        }\n\n        // Fallback to NewsAPI.org\n        if (this.newsApiKey && this.newsApiKey !== 'YOUR_API_KEY_HERE') {\n            console.log('🔍 Searching with NewsAPI.org (fallback)');\n            return await this.searchNewsApiArticles(query, sortBy);\n        }\n\n        throw new Error('No news API keys configured. Please set NEXT_PUBLIC_NEWSDATA_API_KEY or NEXT_PUBLIC_NEWS_API_KEY');\n    }\n\n    // NewsData.io implementation\n    private async getNewsDataHeadlines(category: string = 'general', country: string = 'us'): Promise<NewsResponse> {\n        const params = new URLSearchParams({\n            apikey: this.newsDataApiKey,\n            country: country,\n            language: 'en',\n            size: '10'\n        });\n\n        // Map categories to NewsData.io categories\n        const categoryMap: { [key: string]: string } = {\n            'general': 'top',\n            'business': 'business',\n            'technology': 'technology',\n            'science': 'science',\n            'health': 'health',\n            'sports': 'sports',\n            'entertainment': 'entertainment'\n        };\n\n        if (categoryMap[category]) {\n            params.append('category', categoryMap[category]);\n        }\n\n        const url = `${this.newsDataBaseUrl}?${params.toString()}`;\n        const response = await fetch(url);\n\n        if (!response.ok) {\n            throw new Error(`NewsData.io HTTP error! status: ${response.status}`);\n        }\n\n        const data: NewsDataResponse = await response.json();\n\n        // Convert to standard format\n        return {\n            status: data.status,\n            totalResults: data.totalResults,\n            articles: data.results.map(article => this.convertNewsDataToStandard(article))\n        };\n    }\n\n    private async searchNewsDataArticles(query: string): Promise<NewsResponse> {\n        const params = new URLSearchParams({\n            apikey: this.newsDataApiKey,\n            q: query,\n            language: 'en',\n            size: '10'\n        });\n\n        const url = `${this.newsDataBaseUrl}?${params.toString()}`;\n        const response = await fetch(url);\n\n        if (!response.ok) {\n            throw new Error(`NewsData.io search HTTP error! status: ${response.status}`);\n        }\n\n        const data: NewsDataResponse = await response.json();\n\n        // Convert to standard format\n        return {\n            status: data.status,\n            totalResults: data.totalResults,\n            articles: data.results.map(article => this.convertNewsDataToStandard(article))\n        };\n    }\n\n    // NewsAPI.org fallback implementation\n    private async getNewsApiHeadlines(category: string = 'general', country: string = 'us'): Promise<NewsResponse> {\n        const url = `${this.newsApiBaseUrl}/top-headlines?category=${category}&country=${country}&apiKey=${this.newsApiKey}`;\n        const response = await fetch(url);\n\n        if (!response.ok) {\n            throw new Error(`NewsAPI.org HTTP error! status: ${response.status}`);\n        }\n\n        return response.json();\n    }\n\n    private async searchNewsApiArticles(query: string, sortBy: string = 'publishedAt'): Promise<NewsResponse> {\n        const url = `${this.newsApiBaseUrl}/everything?q=${encodeURIComponent(query)}&sortBy=${sortBy}&apiKey=${this.newsApiKey}`;\n        const response = await fetch(url);\n\n        if (!response.ok) {\n            throw new Error(`NewsAPI.org search HTTP error! status: ${response.status}`);\n        }\n\n        return response.json();\n    }\n\n    isConfigured(): boolean {\n        return !!(\n            (this.newsDataApiKey && this.newsDataApiKey !== 'YOUR_API_KEY_HERE') ||\n            (this.newsApiKey && this.newsApiKey !== 'YOUR_API_KEY_HERE')\n        );\n    }\n\n    getConfiguredServices(): string[] {\n        const services = [];\n        if (this.newsDataApiKey && this.newsDataApiKey !== 'YOUR_API_KEY_HERE') {\n            services.push('NewsData.io (Primary)');\n        }\n        if (this.newsApiKey && this.newsApiKey !== 'YOUR_API_KEY_HERE') {\n            services.push('NewsAPI.org (Fallback)');\n        }\n        return services;\n    }\n\n    getCurrentProvider(): string {\n        if (this.newsDataApiKey && this.newsDataApiKey !== 'YOUR_API_KEY_HERE') {\n            return 'NewsData.io';\n        }\n        if (this.newsApiKey && this.newsApiKey !== 'YOUR_API_KEY_HERE') {\n            return 'NewsAPI.org';\n        }\n        return 'None configured';\n    }\n}\n\nexport const newsService = new NewsService(); "],"names":[],"mappings":"AAAA,0CAA0C;;;;AAmDZ;AAR9B,MAAM;IACM,eAAuB;IACvB,WAAmB;IACnB,kBAAkB,iCAAiC;IACnD,iBAAiB,yBAAyB;IAElD,aAAc;QACV,uBAAuB;QACvB,IAAI,CAAC,cAAc,GAAG,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,4BAA4B,IAAI;QAClE,0BAA0B;QAC1B,IAAI,CAAC,UAAU,GAAG,wEAAwC;QAE1D,IAAI,CAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,qBAAqB;YACrE,QAAQ,IAAI,CAAC;QACjB;QAEA,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB;YAC7D,QAAQ,IAAI,CAAC;QACjB;IACJ;IAEA,mEAAmE;IAC3D,0BAA0B,eAAgC,EAAe;QAC7E,OAAO;YACH,OAAO,gBAAgB,KAAK;YAC5B,aAAa,gBAAgB,WAAW,IAAI;YAC5C,SAAS,gBAAgB,OAAO,IAAI,gBAAgB,WAAW,IAAI;YACnE,KAAK,gBAAgB,IAAI;YACzB,YAAY,gBAAgB,SAAS,IAAI;YACzC,aAAa,gBAAgB,OAAO;YACpC,QAAQ;gBACJ,MAAM,gBAAgB,WAAW,IAAI,gBAAgB,SAAS;YAClE;YACA,QAAQ,gBAAgB,OAAO,EAAE,CAAC,EAAE,IAAI,gBAAgB,WAAW,IAAI;QAC3E;IACJ;IAEA,MAAM,gBAAgB,WAAmB,SAAS,EAAE,UAAkB,IAAI,EAAyB;QAC/F,yCAAyC;QACzC,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,qBAAqB;YACpE,IAAI;gBACA,QAAQ,GAAG,CAAC;gBACZ,OAAO,MAAM,IAAI,CAAC,oBAAoB,CAAC,UAAU;YACrD,EAAE,OAAO,OAAO;gBACZ,QAAQ,IAAI,CAAC,uDAAuD;YACxE;QACJ;QAEA,0BAA0B;QAC1B,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB;YAC5D,QAAQ,GAAG,CAAC;YACZ,OAAO,MAAM,IAAI,CAAC,mBAAmB,CAAC,UAAU;QACpD;QAEA,MAAM,IAAI,MAAM;IACpB;IAEA,MAAM,eAAe,KAAa,EAAE,SAAiB,aAAa,EAAyB;QACvF,yCAAyC;QACzC,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,qBAAqB;YACpE,IAAI;gBACA,QAAQ,GAAG,CAAC;gBACZ,OAAO,MAAM,IAAI,CAAC,sBAAsB,CAAC;YAC7C,EAAE,OAAO,OAAO;gBACZ,QAAQ,IAAI,CAAC,8DAA8D;YAC/E;QACJ;QAEA,0BAA0B;QAC1B,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB;YAC5D,QAAQ,GAAG,CAAC;YACZ,OAAO,MAAM,IAAI,CAAC,qBAAqB,CAAC,OAAO;QACnD;QAEA,MAAM,IAAI,MAAM;IACpB;IAEA,6BAA6B;IAC7B,MAAc,qBAAqB,WAAmB,SAAS,EAAE,UAAkB,IAAI,EAAyB;QAC5G,MAAM,SAAS,IAAI,gBAAgB;YAC/B,QAAQ,IAAI,CAAC,cAAc;YAC3B,SAAS;YACT,UAAU;YACV,MAAM;QACV;QAEA,2CAA2C;QAC3C,MAAM,cAAyC;YAC3C,WAAW;YACX,YAAY;YACZ,cAAc;YACd,WAAW;YACX,UAAU;YACV,UAAU;YACV,iBAAiB;QACrB;QAEA,IAAI,WAAW,CAAC,SAAS,EAAE;YACvB,OAAO,MAAM,CAAC,YAAY,WAAW,CAAC,SAAS;QACnD;QAEA,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI;QAC1D,MAAM,WAAW,MAAM,MAAM;QAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,IAAI,MAAM,CAAC,gCAAgC,EAAE,SAAS,MAAM,EAAE;QACxE;QAEA,MAAM,OAAyB,MAAM,SAAS,IAAI;QAElD,6BAA6B;QAC7B,OAAO;YACH,QAAQ,KAAK,MAAM;YACnB,cAAc,KAAK,YAAY;YAC/B,UAAU,KAAK,OAAO,CAAC,GAAG,CAAC,CAAA,UAAW,IAAI,CAAC,yBAAyB,CAAC;QACzE;IACJ;IAEA,MAAc,uBAAuB,KAAa,EAAyB;QACvE,MAAM,SAAS,IAAI,gBAAgB;YAC/B,QAAQ,IAAI,CAAC,cAAc;YAC3B,GAAG;YACH,UAAU;YACV,MAAM;QACV;QAEA,MAAM,MAAM,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,EAAE,OAAO,QAAQ,IAAI;QAC1D,MAAM,WAAW,MAAM,MAAM;QAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,IAAI,MAAM,CAAC,uCAAuC,EAAE,SAAS,MAAM,EAAE;QAC/E;QAEA,MAAM,OAAyB,MAAM,SAAS,IAAI;QAElD,6BAA6B;QAC7B,OAAO;YACH,QAAQ,KAAK,MAAM;YACnB,cAAc,KAAK,YAAY;YAC/B,UAAU,KAAK,OAAO,CAAC,GAAG,CAAC,CAAA,UAAW,IAAI,CAAC,yBAAyB,CAAC;QACzE;IACJ;IAEA,sCAAsC;IACtC,MAAc,oBAAoB,WAAmB,SAAS,EAAE,UAAkB,IAAI,EAAyB;QAC3G,MAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,wBAAwB,EAAE,SAAS,SAAS,EAAE,QAAQ,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE;QACpH,MAAM,WAAW,MAAM,MAAM;QAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,IAAI,MAAM,CAAC,gCAAgC,EAAE,SAAS,MAAM,EAAE;QACxE;QAEA,OAAO,SAAS,IAAI;IACxB;IAEA,MAAc,sBAAsB,KAAa,EAAE,SAAiB,aAAa,EAAyB;QACtG,MAAM,MAAM,GAAG,IAAI,CAAC,cAAc,CAAC,cAAc,EAAE,mBAAmB,OAAO,QAAQ,EAAE,OAAO,QAAQ,EAAE,IAAI,CAAC,UAAU,EAAE;QACzH,MAAM,WAAW,MAAM,MAAM;QAE7B,IAAI,CAAC,SAAS,EAAE,EAAE;YACd,MAAM,IAAI,MAAM,CAAC,uCAAuC,EAAE,SAAS,MAAM,EAAE;QAC/E;QAEA,OAAO,SAAS,IAAI;IACxB;IAEA,eAAwB;QACpB,OAAO,CAAC,CAAC,CACL,AAAC,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,uBAC/C,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,mBAC5C;IACJ;IAEA,wBAAkC;QAC9B,MAAM,WAAW,EAAE;QACnB,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,qBAAqB;YACpE,SAAS,IAAI,CAAC;QAClB;QACA,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB;YAC5D,SAAS,IAAI,CAAC;QAClB;QACA,OAAO;IACX;IAEA,qBAA6B;QACzB,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,KAAK,qBAAqB;YACpE,OAAO;QACX;QACA,IAAI,IAAI,CAAC,UAAU,IAAI,IAAI,CAAC,UAAU,KAAK,qBAAqB;YAC5D,OAAO;QACX;QACA,OAAO;IACX;AACJ;AAEO,MAAM,cAAc,IAAI","debugId":null}},
    {"offset": {"line": 10666, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/app/news/%5BarticleId%5D/page.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { useParams, useRouter } from 'next/navigation';\nimport { auth } from '@/firebase/clientApp';\nimport { ExternalArticleService } from '@/services/externalArticleService';\nimport ArticleLayout from '@/components/ArticleLayout';\nimport CommentSection from '@/components/CommentSection';\nimport { newsService, NewsArticle } from '@/services/newsService';\nimport { getMoodFromText } from '@/utils/getMoodFromText';\nimport { moodThemes } from '@/utils/moodThemes';\nimport '@/styles/guardian-articles.css';\n\nexport default function NewsArticlePage() {\n  const params = useParams();\n  const router = useRouter();\n  const [article, setArticle] = useState<NewsArticle | null>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [currentUser, setCurrentUser] = useState<any>(null);\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [initialLikes, setInitialLikes] = useState<string[]>([]);\n  \n  // Mood feature state\n  const [moodFeatureEnabled, setMoodFeatureEnabled] = useState(true);\n  const [mood, setMood] = useState<'joyful' | 'reflective' | 'sad' | 'angry' | 'peaceful' | 'energetic'>('reflective');\n\n  const articleUrl = decodeURIComponent(params?.articleId as string);\n\n  // Set up authentication listener\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n      setIsAuthenticated(!!user);\n    });\n    \n    return () => unsubscribe();\n  }, []);\n\n  // Load mood feature preference from localStorage (only for authenticated users)\n  useEffect(() => {\n    if (isAuthenticated) {\n      const savedPreference = localStorage.getItem('moodFeatureEnabled');\n      if (savedPreference !== null) {\n        setMoodFeatureEnabled(JSON.parse(savedPreference));\n      } else {\n        setMoodFeatureEnabled(true);\n      }\n    } else {\n      setMoodFeatureEnabled(false);\n    }\n  }, [isAuthenticated]);\n\n    // Fetch the specific article\n  useEffect(() => {\n    const fetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        setError('');\n        \n        console.log('News Article Page - articleUrl:', articleUrl);\n        \n        if (!newsService.isConfigured()) {\n          setError('News API not configured. Please add your NewsAPI.org API key to environment variables.');\n          return;\n        }\n        \n        // Extract search terms from the URL for a more targeted search\n        const urlPath = articleUrl.split('/').pop() || '';\n        const searchTerms = urlPath\n          .replace(/-/g, ' ')\n          .replace(/_/g, ' ')\n          .split(/[^a-zA-Z\\s]/)\n          .filter(term => term.length > 3)\n          .slice(0, 3) // Take first 3 meaningful terms\n          .join(' ');\n        \n        console.log('News Article Page - searchTerms:', searchTerms);\n        \n        // Try multiple search strategies to find the article\n        let foundArticle = null;\n        \n        // Strategy 1: Search with extracted terms\n        if (searchTerms) {\n          try {\n            const searchData = await newsService.searchArticles(searchTerms);\n            if (searchData.status === 'ok') {\n              foundArticle = searchData.articles.find(a => a.url === articleUrl);\n              console.log('News Article Page - search results count:', searchData.articles.length);\n            }\n          } catch (err) {\n            console.log('Search strategy 1 failed:', err);\n          }\n        }\n        \n        // Strategy 2: Try different categories if not found\n        if (!foundArticle) {\n          const categories = ['general', 'business', 'technology', 'sports', 'entertainment', 'health', 'science'];\n          for (const category of categories) {\n            try {\n              const headlinesData = await newsService.getTopHeadlines(category);\n              if (headlinesData.status === 'ok') {\n                foundArticle = headlinesData.articles.find(a => a.url === articleUrl);\n                if (foundArticle) {\n                  console.log('News Article Page - found in category:', category);\n                  break;\n                }\n              }\n            } catch (err) {\n              console.log(`Category ${category} failed:`, err);\n              continue;\n            }\n          }\n        }\n        \n        if (foundArticle) {\n          setArticle(foundArticle);\n        } else {\n          // If we still can't find it, create a fallback article object\n          // This happens because NewsAPI doesn't have a direct \"get by URL\" method\n          console.log('Creating fallback article for:', articleUrl);\n          \n          // Extract article title from URL\n          const urlPath = articleUrl.split('/').pop() || '';\n          const titleFromUrl = urlPath\n            .replace(/-/g, ' ')\n            .replace(/_/g, ' ')\n            .replace(/\\d+/g, '')\n            .split(/[^a-zA-Z\\s]/)\n            .filter(word => word.length > 2)\n            .map(word => word.charAt(0).toUpperCase() + word.slice(1))\n            .join(' ');\n          \n          // Extract source from URL\n          let sourceName = 'News Source';\n          try {\n            const urlDomain = new URL(articleUrl).hostname.replace('www.', '');\n            sourceName = urlDomain.split('.')[0].charAt(0).toUpperCase() + urlDomain.split('.')[0].slice(1);\n          } catch (e) {\n            console.log('Error parsing URL domain:', e);\n          }\n          \n          const fallbackArticle: NewsArticle = {\n            title: titleFromUrl || 'News Article',\n            description: 'This article is no longer available through NewsAPI. Click the link below to read the full article on the original site.',\n            content: 'This article is no longer available through our news feed. Please visit the original source to read the full content.',\n            url: articleUrl,\n            urlToImage: '',\n            publishedAt: new Date().toISOString(),\n            source: { name: sourceName },\n            author: sourceName\n          };\n          \n          setArticle(fallbackArticle);\n        }\n\n        // Fetch likes for this News article from our social system\n        await fetchLikesData(articleUrl);\n        \n      } catch (error) {\n        console.error('Error fetching news article:', error);\n        setError('Failed to load article. Please try again later.');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    if (articleUrl) {\n      fetchArticle();\n    }\n  }, [articleUrl]);\n\n  // Analyze mood when article is loaded (only for authenticated users)\n  useEffect(() => {\n    if (article && isAuthenticated) {\n      // Extract text from article content for sentiment analysis\n      const textContent = article.description + ' ' + (article.content || '');\n      if (textContent.trim()) {\n        const cleanText = textContent.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\n        const detectedMood = getMoodFromText(cleanText);\n        setMood(detectedMood);\n      }\n    }\n  }, [article, isAuthenticated]);\n\n  const handleToggleMoodFeature = (enabled: boolean) => {\n    setMoodFeatureEnabled(enabled);\n    localStorage.setItem('moodFeatureEnabled', JSON.stringify(enabled));\n  };\n\n  const handleBackToList = () => {\n    router.push('/news');\n  };\n\n  // Fetch likes data for the News article from our social system\n  const fetchLikesData = async (newsArticleUrl: string) => {\n    try {\n      const socialData = await ExternalArticleService.getSocialData(newsArticleUrl, 'newsapi');\n      if (socialData) {\n        setInitialLikes(socialData.likes || []);\n      } else {\n        setInitialLikes([]);\n      }\n    } catch (error) {\n      console.error('Error fetching likes data:', error);\n      setInitialLikes([]);\n    }\n  };\n\n  const formatDate = (dateString: string): string => {\n    try {\n      const date = new Date(dateString);\n      const options: Intl.DateTimeFormatOptions = { \n        year: 'numeric', \n        month: 'long', \n        day: 'numeric',\n        timeZone: 'UTC'\n      };\n      return date.toLocaleDateString('en-US', options);\n    } catch (error) {\n      console.error('Error formatting date:', error);\n      return dateString;\n    }\n  };\n\n  // Convert news article to display format\n  const convertToArticleFormat = (article: NewsArticle) => {\n    let articleHtml = '';\n    \n    // Helper function to clean and unescape HTML content\n    const cleanHtmlContent = (text: string): string => {\n      if (!text) return '';\n      \n      // First, decode HTML entities\n      let cleanText = text\n        .replace(/&amp;/g, '&')\n        .replace(/&lt;/g, '<')\n        .replace(/&gt;/g, '>')\n        .replace(/&quot;/g, '\"')\n        .replace(/&#x27;/g, \"'\")\n        .replace(/&#39;/g, \"'\")\n        .replace(/&nbsp;/g, ' ');\n      \n      // Then remove HTML tags but preserve line breaks\n      cleanText = cleanText.replace(/<[^>]*>/g, ' ');\n      \n      // Clean up multiple spaces\n      cleanText = cleanText.replace(/\\s+/g, ' ').trim();\n      \n      return cleanText;\n    };\n\n    // Helper function to safely escape HTML for attributes only\n    const escapeForAttribute = (text: string): string => {\n      if (!text) return '';\n      return text\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#x27;');\n    };\n    \n    // Check if this is a fallback article (no content available)\n    const isFallback = article.content?.includes('no longer available through our news feed') || false;\n    \n    if (article.urlToImage) {\n      const safeImageUrl = escapeForAttribute(article.urlToImage);\n      const safeImageAlt = escapeForAttribute(article.title || 'News article image');\n      articleHtml += `<img src=\"${safeImageUrl}\" alt=\"${safeImageAlt}\" style=\"max-width: 100%; height: auto; margin: 2em auto; display: block; border-radius: 8px;\" />`;\n    }\n    \n    if (article.description) {\n      const cleanDescription = cleanHtmlContent(article.description);\n      articleHtml += `<p><strong>${cleanDescription}</strong></p>`;\n    }\n    \n    if (article.content) {\n      // Clean up the content (NewsAPI sometimes truncates with [+chars])\n      const rawContent = article.content.replace(/\\[\\+\\d+\\s+chars\\]$/, '...');\n      const cleanContent = cleanHtmlContent(rawContent);\n      articleHtml += `<p>${cleanContent}</p>`;\n    }\n    \n        const safeUrl = escapeForAttribute(article.url || '');\n    const safeSourceName = cleanHtmlContent(article.source?.name || 'News Source');\n\n    if (isFallback) {\n      // Make the external link more prominent for fallback articles - using simple background color instead of gradient\n      articleHtml += `\n        <div style=\"background-color: #667eea; color: white; padding: 2em; border-radius: 12px; text-align: center; margin: 2em 0; border: 1px solid #5a67d8;\">\n          <h3 style=\"margin: 0 0 1em 0; color: white;\">Read Full Article</h3>\n          <p style=\"margin: 0 0 1.5em 0; color: white; opacity: 0.9;\">\n            This article is available on the original news site\n          </p>\n          <a href=\"${safeUrl}\" target=\"_blank\" rel=\"noopener noreferrer\" style=\"background: white; color: #667eea; padding: 12px 24px; text-decoration: none; border-radius: 25px; font-weight: bold; display: inline-block; border: 2px solid white;\">\n            Visit ${safeSourceName}\n          </a>\n        </div>`;\n    } else {\n      articleHtml += `<p><em>Read the full article at: <a href=\"${safeUrl}\" target=\"_blank\" rel=\"noopener noreferrer\">${safeSourceName}</a></em></p>`;\n    }\n    \n    return {\n      title: article.title || 'News Article',\n      authorName: article.author || article.source?.name || 'Unknown',\n      createdAt: formatDate(article.publishedAt),\n      readTime: Math.ceil((article.content?.split(' ').length || 200) / 200),\n      tags: [article.source?.name || 'News'],\n      authorId: 'news-api',\n      hasReflectionRoom: false,\n      html: articleHtml\n    };\n  };\n\n  if (isLoading) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading article...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <div className=\"text-red-600 text-lg mb-4\">{error}</div>\n          <button\n            onClick={handleBackToList}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n          >\n            Back to News\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!article) {\n    return (\n      <div className=\"min-h-screen bg-white flex items-center justify-center\">\n        <div className=\"text-center max-w-md mx-auto p-6\">\n          <div className=\"text-gray-600 text-lg mb-4\">Article not found</div>\n          <button\n            onClick={handleBackToList}\n            className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700\"\n          >\n            Back to News\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  const articleData = convertToArticleFormat(article);\n\n  return (\n    <div \n      className=\"guardian-article news-article\"\n      style={{ position: 'relative', backgroundColor: '#ffffff' }}\n    >\n      {/* Atmospheric gradient - controlled by user's gradient widget */}\n      {isAuthenticated && (\n        <div\n          data-mood-element=\"primary-gradient\"\n          style={{\n            position: 'fixed',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            backgroundImage: `linear-gradient(160deg, \n              ${moodThemes[mood].gradientStart}, \n              ${moodThemes[mood].gradientEnd})`,\n            backgroundSize: '150% 150%',\n            animation: 'gradientFlow 25s ease-in-out infinite',\n            zIndex: -10,\n            transition: 'background-image 2s ease-in-out',\n            pointerEvents: 'none',\n            display: typeof window !== 'undefined' && localStorage.getItem('moodFeatureEnabled') === 'false' ? 'none' : ''\n          }}\n        />\n      )}\n\n      <ArticleLayout\n        articleId={`news-${encodeURIComponent(article.url)}`}\n        articleHtml={articleData.html}\n        article={articleData}\n        initialLikes={initialLikes}\n        currentUser={currentUser}\n        isAuthenticated={isAuthenticated}\n        onEditClick={handleBackToList}\n        articleTitle={articleData.title}\n        articleSlug={`news-${encodeURIComponent(article.url)}`}\n        moodFeatureEnabled={moodFeatureEnabled}\n        onToggleMoodFeature={handleToggleMoodFeature}\n        mood={mood}\n        isExternal={true}\n        externalSource=\"newsapi\"\n        externalId={article.url}\n        externalUrl={article.url}\n      />\n      \n      {/* Comments Section */}\n      <div style={{ maxWidth: '800px', margin: '0 auto', padding: '2rem 1rem' }}>\n        <CommentSection \n          articleId={`news-${encodeURIComponent(article.url)}`}\n        />\n      </div>\n    </div>\n  );\n} "],"names":[],"mappings":"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","debugId":null}}]
}