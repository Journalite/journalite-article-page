(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[91],{350:(e,a,n)=>{"use strict";n.d(a,{A:()=>d});var s=n(5155),t=n(2115),i=n(6874),c=n.n(i),r=n(9995),o=n(912),l=n.n(o);let d=()=>{let[e,a]=(0,t.useState)(0),[n,i]=(0,t.useState)([]),[o,d]=(0,t.useState)(!1),m=(0,t.useRef)(null);(0,t.useEffect)(()=>{let e=async()=>{a(await (0,r.Hs)())};e();let n=setInterval(e,6e4);return()=>clearInterval(n)},[]),(0,t.useEffect)(()=>{let e=e=>{m.current&&!m.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,t.useEffect)(()=>{o&&h()},[o]);let h=async()=>{try{let e=await (0,r.Ss)(!1);i(e)}catch(e){console.error("Error fetching notifications:",e)}},u=async e=>{try{!e.read&&e.id&&(await (0,r.bA)(e.id),a(e=>Math.max(e-1,0)),i(a=>a.map(a=>a.id===e.id?{...a,read:!0}:a)))}catch(e){console.error("Error marking notification as read:",e)}},f=e=>{if(!e)return"";let a=e.toDate?e.toDate():new Date(e),n=Math.floor((new Date().getTime()-a.getTime())/6e4);if(n<1)return"Just now";if(n<60)return"".concat(n,"m ago");let s=Math.floor(n/60);if(s<24)return"".concat(s,"h ago");let t=Math.floor(s/24);return t<7?"".concat(t,"d ago"):a.toLocaleDateString()};return(0,s.jsxs)("div",{className:l().notificationContainer,ref:m,children:[(0,s.jsxs)("button",{className:l().bellButton,onClick:()=>{d(!o)},children:[(0,s.jsx)("span",{className:l().bellIcon,children:"\uD83D\uDD14"}),e>0&&(0,s.jsx)("span",{className:l().unreadBadge,children:e})]}),o&&(0,s.jsxs)("div",{className:l().notificationDropdown,children:[(0,s.jsxs)("div",{className:l().notificationHeader,children:[(0,s.jsx)("h3",{children:"Notifications"}),n.length>0&&(0,s.jsx)(c(),{href:"/notifications",className:l().viewAllLink,children:"View All"})]}),(0,s.jsx)("div",{className:l().notificationList,children:0===n.length?(0,s.jsx)("div",{className:l().emptyState,children:"No notifications yet"}):n.slice(0,5).map(e=>(0,s.jsxs)(c(),{href:"/articles?slug=".concat(e.articleSlug),className:"".concat(l().notificationItem," ").concat(e.read?"":l().unread),onClick:()=>u(e),children:[(0,s.jsxs)("div",{className:l().notificationContent,children:[(0,s.jsx)("p",{className:l().notificationMessage,children:e.message}),(0,s.jsx)("span",{className:l().notificationTime,children:f(e.createdAt)})]}),!e.read&&(0,s.jsx)("div",{className:l().unreadDot})]},e.id))}),n.length>5&&(0,s.jsx)("div",{className:l().notificationFooter,children:(0,s.jsx)(c(),{href:"/notifications",className:l().seeMoreLink,children:"See more notifications"})})]})]})}},912:e=>{e.exports={notificationContainer:"NotificationBell_notificationContainer__TFGqP",bellButton:"NotificationBell_bellButton__PKB6r",bellIcon:"NotificationBell_bellIcon__ALAAB",unreadBadge:"NotificationBell_unreadBadge__cOn_b",notificationDropdown:"NotificationBell_notificationDropdown__p8Mv4",notificationHeader:"NotificationBell_notificationHeader__cPSyI",viewAllLink:"NotificationBell_viewAllLink__une1x",notificationList:"NotificationBell_notificationList__SBbvK",notificationItem:"NotificationBell_notificationItem__MW9MC",unread:"NotificationBell_unread__9c4op",notificationContent:"NotificationBell_notificationContent__2upmA",notificationMessage:"NotificationBell_notificationMessage__aqMDB",notificationTime:"NotificationBell_notificationTime__JQ2O9",unreadDot:"NotificationBell_unreadDot__qaEb7",notificationFooter:"NotificationBell_notificationFooter__l28sD",seeMoreLink:"NotificationBell_seeMoreLink__eh2qR",emptyState:"NotificationBell_emptyState___y1V2"}},4744:(e,a,n)=>{"use strict";n.d(a,{OQ:()=>c,VM:()=>o,Vz:()=>r,x5:()=>l});var s=n(5317),t=n(6203),i=n(3201);async function c(e){try{let a=(0,s.P)((0,s.rJ)(i.db,"users"),(0,s._M)("username","==",e.toLowerCase()));return!(await (0,s.GG)(a)).empty}catch(e){throw console.error("Error checking username:",e),e}}async function r(e,a){try{let n=await o(e);if(n){console.log("User profile already exists, updating instead of creating");let c=(0,s.H9)(i.db,"users",e);await (0,s.mZ)(c,{firstName:a.firstName,lastName:a.lastName,username:a.username.toLowerCase(),email:a.email.toLowerCase(),bio:a.bio||n.bio||""}),i.j2.currentUser&&await (0,t.r7)(i.j2.currentUser,{displayName:a.username});return}let r=(0,s.P)((0,s.rJ)(i.db,"users"),(0,s._M)("email","==",a.email.toLowerCase()));if(!(await (0,s.GG)(r)).empty)throw Error("Email is already associated with another account");if(await c(a.username))throw Error("Username is already taken");let l=(0,s.H9)(i.db,"users",e);await (0,s.BN)(l,{uid:e,firstName:a.firstName,lastName:a.lastName,username:a.username.toLowerCase(),email:a.email.toLowerCase(),bio:a.bio||"",createdAt:(0,s.O5)()}),i.j2.currentUser&&await (0,t.r7)(i.j2.currentUser,{displayName:a.username})}catch(e){throw console.error("Error creating user profile:",e),e}}async function o(e){try{let a=(0,s.H9)(i.db,"users",e),n=await (0,s.x7)(a);if(n.exists())return n.data();return null}catch(e){throw console.error("Error fetching user profile:",e),e}}async function l(e){try{if(!e||e.trim().length<2)return[];let a=e.toLowerCase().trim(),n=(0,s.rJ)(i.db,"users");return(await (0,s.GG)(n)).docs.map(e=>e.data()).filter(e=>{let n=e.username.toLowerCase(),s=e.firstName.toLowerCase(),t=e.lastName.toLowerCase(),i="".concat(s," ").concat(t);return n.includes(a)||s.includes(a)||t.includes(a)||i.includes(a)})}catch(e){return console.error("Error searching users:",e),[]}}},9478:(e,a,n)=>{"use strict";n.d(a,{A:()=>h});var s=n(5155),t=n(2115),i=n(6874),c=n.n(i),r=n(8163),o=n.n(r),l=n(4744);let d=()=>{let[e,a]=(0,t.useState)(""),[n,i]=(0,t.useState)([]),[r,d]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),u=(0,t.useRef)(null),f=(0,t.useRef)(null);return(0,t.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&u.current&&!u.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,t.useEffect)(()=>{let a=setTimeout(async()=>{if(e.trim().length>=2){d(!0);try{let a=await (0,l.x5)(e);i(a),h(!0)}catch(e){console.error("Error searching users:",e)}finally{d(!1)}}else i([]),h(!1)},300);return()=>clearTimeout(a)},[e]),(0,s.jsxs)("div",{className:o().searchContainer,children:[(0,s.jsxs)("div",{className:o().searchInputWrapper,children:[(0,s.jsx)("input",{type:"text",ref:u,className:o().searchInput,placeholder:"Search users by name or username...",value:e,onChange:e=>{a(e.target.value)},onFocus:()=>{e.trim().length>=2&&n.length>0&&h(!0)}}),r&&(0,s.jsx)("div",{className:o().searchLoading,children:"Searching..."})]}),m&&n.length>0&&(0,s.jsx)("div",{ref:f,className:o().searchResults,children:n.map(e=>(0,s.jsxs)(c(),{href:"/user/".concat(encodeURIComponent(e.username.toLowerCase())),className:o().searchResultItem,onClick:()=>h(!1),children:[(0,s.jsxs)("div",{className:o().userAvatar,children:[e.firstName.charAt(0),e.lastName.charAt(0)]}),(0,s.jsxs)("div",{className:o().userInfo,children:[(0,s.jsxs)("div",{className:o().userName,children:[e.firstName," ",e.lastName]}),(0,s.jsxs)("div",{className:o().userUsername,children:["@",e.username]})]})]},e.uid))}),m&&e.trim().length>=2&&0===n.length&&(0,s.jsx)("div",{className:o().searchResults,children:(0,s.jsxs)("div",{className:o().noResults,children:['No users found matching "',e,'"']})})]})},m=()=>(0,s.jsx)("div",{className:o().searchBarContainer,children:(0,s.jsx)(d,{})}),h=e=>{let{isAuthenticated:a,handleLogout:n,toggleSidebar:t,isSidebarCollapsed:i}=e;return(0,s.jsxs)("aside",{className:"".concat(o()["left-sidebar"]," ").concat(i?o().collapsed:""),children:[(0,s.jsxs)("div",{className:o()["sidebar-header"],children:[(0,s.jsx)("div",{className:o().logo,children:"Journalite"}),(0,s.jsx)("button",{className:o()["toggle-button"],onClick:t,"aria-label":i?"Expand sidebar":"Collapse sidebar",children:i?"→":"←"})]}),(0,s.jsx)("div",{className:o().sidebarSearch,children:(0,s.jsx)(m,{})}),(0,s.jsx)("nav",{className:o()["vertical-nav"],children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c(),{href:"/",className:"".concat(o()["nav-link"]," ").concat(o()["nav-home"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Home"})]}),(0,s.jsxs)(c(),{href:"/my-thoughts",className:"".concat(o()["nav-link"]," ").concat(o()["nav-thoughts"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"My Thoughts"})]}),(0,s.jsxs)(c(),{href:"/create-article",className:"".concat(o()["nav-link"]," ").concat(o()["nav-create"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Create Article"})]}),(0,s.jsxs)(c(),{href:"/explore",className:"".concat(o()["nav-link"]," ").concat(o()["nav-explore"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Explore"})]}),(0,s.jsxs)(c(),{href:"/my-profile",className:"".concat(o()["nav-link"]," ").concat(o()["nav-profile"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"My Profile"})]}),(0,s.jsxs)(c(),{href:"/settings",className:"".concat(o()["nav-link"]," ").concat(o()["nav-settings"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Settings"})]}),(0,s.jsxs)(c(),{href:"/notifications",className:"".concat(o()["nav-link"]," ").concat(o()["nav-notifications"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Notifications"})]}),(0,s.jsxs)("button",{onClick:n,className:"".concat(o()["nav-link"]," ").concat(o()["nav-logout"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Log out"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c(),{href:"/",className:"".concat(o()["nav-link"]," ").concat(o()["nav-home"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Home"})]}),(0,s.jsxs)(c(),{href:"/login",className:"".concat(o()["nav-link"]," ").concat(o()["nav-login"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Login"})]}),(0,s.jsxs)(c(),{href:"/learn",className:"".concat(o()["nav-link"]," ").concat(o()["nav-learn"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Learn More"})]}),(0,s.jsxs)(c(),{href:"/plans",className:"".concat(o()["nav-link"]," ").concat(o()["nav-plans"]),children:[(0,s.jsx)("span",{className:o()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:o()["nav-text"],children:"Plans"})]})]})})]})}}}]);