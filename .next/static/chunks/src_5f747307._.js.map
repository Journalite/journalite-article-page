{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticlePage.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleActions\": \"ArticlePage-module__RPh7Qa__articleActions\",\n  \"articleDetails\": \"ArticlePage-module__RPh7Qa__articleDetails\",\n  \"articleHeader\": \"ArticlePage-module__RPh7Qa__articleHeader\",\n  \"articleMeta\": \"ArticlePage-module__RPh7Qa__articleMeta\",\n  \"articlePageContainer\": \"ArticlePage-module__RPh7Qa__articlePageContainer\",\n  \"articleTitle\": \"ArticlePage-module__RPh7Qa__articleTitle\",\n  \"authButtons\": \"ArticlePage-module__RPh7Qa__authButtons\",\n  \"authorAvatar\": \"ArticlePage-module__RPh7Qa__authorAvatar\",\n  \"authorDetails\": \"ArticlePage-module__RPh7Qa__authorDetails\",\n  \"authorInfo\": \"ArticlePage-module__RPh7Qa__authorInfo\",\n  \"authorName\": \"ArticlePage-module__RPh7Qa__authorName\",\n  \"authorNameLink\": \"ArticlePage-module__RPh7Qa__authorNameLink\",\n  \"cancelButton\": \"ArticlePage-module__RPh7Qa__cancelButton\",\n  \"commentsContainer\": \"ArticlePage-module__RPh7Qa__commentsContainer\",\n  \"dropdownItem\": \"ArticlePage-module__RPh7Qa__dropdownItem\",\n  \"editButton\": \"ArticlePage-module__RPh7Qa__editButton\",\n  \"editingHeader\": \"ArticlePage-module__RPh7Qa__editingHeader\",\n  \"errorContainer\": \"ArticlePage-module__RPh7Qa__errorContainer\",\n  \"errorMessage\": \"ArticlePage-module__RPh7Qa__errorMessage\",\n  \"headerActions\": \"ArticlePage-module__RPh7Qa__headerActions\",\n  \"headerContainer\": \"ArticlePage-module__RPh7Qa__headerContainer\",\n  \"headerLogo\": \"ArticlePage-module__RPh7Qa__headerLogo\",\n  \"likeButton\": \"ArticlePage-module__RPh7Qa__likeButton\",\n  \"likeIcon\": \"ArticlePage-module__RPh7Qa__likeIcon\",\n  \"liked\": \"ArticlePage-module__RPh7Qa__liked\",\n  \"loadingContainer\": \"ArticlePage-module__RPh7Qa__loadingContainer\",\n  \"loadingIndicator\": \"ArticlePage-module__RPh7Qa__loadingIndicator\",\n  \"loginButton\": \"ArticlePage-module__RPh7Qa__loginButton\",\n  \"logoLink\": \"ArticlePage-module__RPh7Qa__logoLink\",\n  \"pageContainer\": \"ArticlePage-module__RPh7Qa__pageContainer\",\n  \"pageHeader\": \"ArticlePage-module__RPh7Qa__pageHeader\",\n  \"profileCircle\": \"ArticlePage-module__RPh7Qa__profileCircle\",\n  \"profileDropdown\": \"ArticlePage-module__RPh7Qa__profileDropdown\",\n  \"profileMenu\": \"ArticlePage-module__RPh7Qa__profileMenu\",\n  \"relatedTag\": \"ArticlePage-module__RPh7Qa__relatedTag\",\n  \"relatedTagsHeading\": \"ArticlePage-module__RPh7Qa__relatedTagsHeading\",\n  \"relatedTagsList\": \"ArticlePage-module__RPh7Qa__relatedTagsList\",\n  \"relatedTagsSection\": \"ArticlePage-module__RPh7Qa__relatedTagsSection\",\n  \"signupButton\": \"ArticlePage-module__RPh7Qa__signupButton\",\n  \"spin\": \"ArticlePage-module__RPh7Qa__spin\",\n  \"tag\": \"ArticlePage-module__RPh7Qa__tag\",\n  \"tagContainer\": \"ArticlePage-module__RPh7Qa__tagContainer\",\n  \"writeButton\": \"ArticlePage-module__RPh7Qa__writeButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 57, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/clientApp.ts"],"sourcesContent":["// Import the functions you need from the SDKs you need\nimport { initializeApp } from \"firebase/app\";\nimport { getAnalytics } from \"firebase/analytics\";\nimport { getAuth, connectAuthEmulator } from \"firebase/auth\";\nimport { getFirestore } from \"firebase/firestore\";\n// TODO: Add SDKs for Firebase products that you want to use\n// https://firebase.google.com/docs/web/setup#available-libraries\n\n// Firebase configuration from environment variables\nconst firebaseConfig = {\n    apiKey: process.env.NEXT_PUBLIC_FIREBASE_API_KEY,\n    authDomain: process.env.NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN,\n    projectId: process.env.NEXT_PUBLIC_FIREBASE_PROJECT_ID,\n    storageBucket: process.env.NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: process.env.NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID,\n    appId: process.env.NEXT_PUBLIC_FIREBASE_APP_ID,\n    measurementId: process.env.NEXT_PUBLIC_FIREBASE_MEASUREMENT_ID\n};\n///\n\n// Initialize Firebase\nconst app = initializeApp(firebaseConfig);\n\n// Initialize Analytics only in browser environment\nlet analytics;\nif (typeof window !== 'undefined') {\n    try {\n        analytics = getAnalytics(app);\n    } catch (error) {\n        // Analytics initialization skipped in development\n    }\n}\n\n// Initialize Firebase Authentication\nconst auth = getAuth(app);\n\n// Initialize Firestore\nconst db = getFirestore(app);\n\n// Configure custom auth actions URL\nif (typeof window !== 'undefined') {\n    const actionCodeSettings = {\n        url: `${window.location.origin}/reset-password`,\n        handleCodeInApp: true,\n    };\n\n    // We need to update this in the forgot-password component when sending the reset email\n}\n\n// // Connect to Auth Emulator in development\n// if (process.env.NODE_ENV === 'development') {\n//     // connectAuthEmulator(auth, \"http://localhost:9099\", { disableWarnings: true });\n// }\n\n/////\n\nexport { app, analytics, auth, db };"],"names":[],"mappings":"AAAA,uDAAuD;;;;;;;AAU3C;AATZ;AAAA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;;;AACA,4DAA4D;AAC5D,iEAAiE;AAEjE,oDAAoD;AACpD,MAAM,iBAAiB;IACnB,MAAM;IACN,UAAU;IACV,SAAS;IACT,aAAa;IACb,iBAAiB;IACjB,KAAK;IACL,aAAa;AACjB;AACA,GAAG;AAEH,sBAAsB;AACtB,MAAM,MAAM,CAAA,GAAA,uLAAA,CAAA,gBAAa,AAAD,EAAE;AAE1B,mDAAmD;AACnD,IAAI;AACJ,wCAAmC;IAC/B,IAAI;QACA,YAAY,CAAA,GAAA,6KAAA,CAAA,eAAY,AAAD,EAAE;IAC7B,EAAE,OAAO,OAAO;IACZ,kDAAkD;IACtD;AACJ;AAEA,qCAAqC;AACrC,MAAM,OAAO,CAAA,GAAA,6MAAA,CAAA,UAAO,AAAD,EAAE;AAErB,uBAAuB;AACvB,MAAM,KAAK,CAAA,GAAA,sKAAA,CAAA,eAAY,AAAD,EAAE;AAExB,oCAAoC;AACpC,wCAAmC;IAC/B,MAAM,qBAAqB;QACvB,KAAK,GAAG,OAAO,QAAQ,CAAC,MAAM,CAAC,eAAe,CAAC;QAC/C,iBAAiB;IACrB;AAEA,uFAAuF;AAC3F","debugId":null}},
    {"offset": {"line": 123, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/notifications.ts"],"sourcesContent":["import {\n    collection,\n    addDoc,\n    getDocs,\n    getDoc,\n    doc,\n    query,\n    orderBy,\n    Timestamp,\n    where,\n    updateDoc,\n    deleteDoc,\n    limit\n} from 'firebase/firestore';\nimport { db, auth } from './clientApp';\n\n// Notification interface matching Firestore structure\nexport interface Notification {\n    id?: string;\n    userId: string;\n    type: 'comment' | 'reply' | 'like' | 'follow';\n    read: boolean;\n    sourceId: string; // ID of the article/comment\n    sourceType: 'article' | 'comment' | 'user';\n    message: string;\n    fromUser: {\n        id: string;\n        name: string;\n        username?: string; // Add username field for profile links\n    };\n    createdAt: Timestamp;\n    articleSlug?: string; // Optional slug to link directly to the article\n    articleTitle?: string; // Optional article title for context\n}\n\n/**\n * Create a new notification when someone comments on a user's post\n */\nexport async function createCommentNotification(\n    ownerId: string,\n    articleId: string,\n    articleSlug: string,\n    articleTitle: string,\n    commentId: string,\n    commentText: string\n) {\n    try {\n        // Skip if the owner is the commenter (don't notify yourself)\n        const currentUser = auth.currentUser;\n        if (!currentUser || currentUser.uid === ownerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: ownerId, // Who will receive the notification\n            type: 'comment',\n            read: false,\n            sourceId: commentId,\n            sourceType: 'comment',\n            message: `${currentUser.displayName || 'Someone'} commented on your article: \"${commentText.substring(0, 50)}${commentText.length > 50 ? '...' : ''}\"`,\n            fromUser: {\n                id: currentUser.uid,\n                name: currentUser.displayName || 'Anonymous'\n            },\n            createdAt: Timestamp.now(),\n            articleSlug,\n            articleTitle\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating notification:', error);\n        return null;\n    }\n}\n\n/**\n * Create a new notification when someone follows a user\n */\nexport async function createFollowNotification(\n    targetUserId: string,\n    followerName: string,\n    followerId: string,\n    followerUsername: string\n) {\n    try {\n        // Skip if user is following themselves (shouldn't happen due to checks in followUser)\n        if (targetUserId === followerId) {\n            return null;\n        }\n\n        // Create notification object\n        const notification: Omit<Notification, 'id'> = {\n            userId: targetUserId, // Who will receive the notification\n            type: 'follow',\n            read: false,\n            sourceId: followerId,\n            sourceType: 'user',\n            message: `${followerName} (@${followerUsername}) started following you`,\n            fromUser: {\n                id: followerId,\n                name: followerName,\n                username: followerUsername\n            },\n            createdAt: Timestamp.now()\n        };\n\n        // Add to Firestore\n        const docRef = await addDoc(collection(db, 'notifications'), notification);\n\n        return {\n            id: docRef.id,\n            ...notification\n        };\n    } catch (error) {\n        console.error('Error creating follow notification:', error);\n        return null;\n    }\n}\n\n/**\n * Get all notifications for the current user\n */\nexport async function getUserNotifications(unreadOnly = false) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        // Create base query\n        const notificationsRef = collection(db, 'notifications');\n        let q;\n\n        if (unreadOnly) {\n            // Only fetch unread notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                where('read', '==', false),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        } else {\n            // Fetch all notifications\n            q = query(\n                notificationsRef,\n                where('userId', '==', currentUser.uid),\n                orderBy('createdAt', 'desc'),\n                limit(100)\n            );\n        }\n\n        const querySnapshot = await getDocs(q);\n\n        const notifications: Notification[] = [];\n        querySnapshot.forEach((doc) => {\n            notifications.push({\n                id: doc.id,\n                ...doc.data() as Omit<Notification, 'id'>\n            });\n        });\n\n        return notifications;\n    } catch (error) {\n        console.error('Error fetching notifications:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark a notification as read\n */\nexport async function markNotificationAsRead(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Update the read status\n        await updateDoc(notificationRef, {\n            read: true\n        });\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error marking notification as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Mark all notifications as read for the current user\n */\nexport async function markAllNotificationsAsRead() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n\n        // Create an array of promises to update each notification\n        const updatePromises = querySnapshot.docs.map(doc =>\n            updateDoc(doc.ref, { read: true })\n        );\n\n        // Execute all updates in parallel\n        await Promise.all(updatePromises);\n\n        return {\n            success: true,\n            count: querySnapshot.size\n        };\n    } catch (error) {\n        console.error('Error marking all notifications as read:', error);\n        throw error;\n    }\n}\n\n/**\n * Delete a notification\n */\nexport async function deleteNotification(notificationId: string) {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            throw new Error('User not authenticated');\n        }\n\n        const notificationRef = doc(db, 'notifications', notificationId);\n        const notificationSnap = await getDoc(notificationRef);\n\n        if (!notificationSnap.exists()) {\n            throw new Error('Notification not found');\n        }\n\n        const notificationData = notificationSnap.data() as Notification;\n\n        // Check if the notification belongs to the current user\n        if (notificationData.userId !== currentUser.uid) {\n            throw new Error('Unauthorized access to notification');\n        }\n\n        // Delete the notification\n        await deleteDoc(notificationRef);\n\n        return {\n            success: true\n        };\n    } catch (error) {\n        console.error('Error deleting notification:', error);\n        throw error;\n    }\n}\n\n/**\n * Get the count of unread notifications\n */\nexport async function getUnreadNotificationsCount() {\n    try {\n        const currentUser = auth.currentUser;\n        if (!currentUser) {\n            return 0;\n        }\n\n        const notificationsRef = collection(db, 'notifications');\n        const q = query(\n            notificationsRef,\n            where('userId', '==', currentUser.uid),\n            where('read', '==', false)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.size;\n    } catch (error) {\n        console.error('Error counting unread notifications:', error);\n        return 0;\n    }\n} "],"names":[],"mappings":";;;;;;;;;AAAA;AAAA;AAcA;;;AAwBO,eAAe,0BAClB,OAAe,EACf,SAAiB,EACjB,WAAmB,EACnB,YAAoB,EACpB,SAAiB,EACjB,WAAmB;IAEnB,IAAI;QACA,6DAA6D;QAC7D,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,eAAe,YAAY,GAAG,KAAK,SAAS;YAC7C,OAAO;QACX;QAEA,6BAA6B;QAC7B,MAAM,eAAyC;YAC3C,QAAQ;YACR,MAAM;YACN,MAAM;YACN,UAAU;YACV,YAAY;YACZ,SAAS,GAAG,YAAY,WAAW,IAAI,UAAU,6BAA6B,EAAE,YAAY,SAAS,CAAC,GAAG,MAAM,YAAY,MAAM,GAAG,KAAK,QAAQ,GAAG,CAAC,CAAC;YACtJ,UAAU;gBACN,IAAI,YAAY,GAAG;gBACnB,MAAM,YAAY,WAAW,IAAI;YACrC;YACA,WAAW,sKAAA,CAAA,YAAS,CAAC,GAAG;YACxB;YACA;QACJ;QAEA,mBAAmB;QACnB,MAAM,SAAS,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE,kBAAkB;QAE7D,OAAO;YACH,IAAI,OAAO,EAAE;YACb,GAAG,YAAY;QACnB;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,OAAO;IACX;AACJ;AAKO,eAAe,yBAClB,YAAoB,EACpB,YAAoB,EACpB,UAAkB,EAClB,gBAAwB;IAExB,IAAI;QACA,sFAAsF;QACtF,IAAI,iBAAiB,YAAY;YAC7B,OAAO;QACX;QAEA,6BAA6B;QAC7B,MAAM,eAAyC;YAC3C,QAAQ;YACR,MAAM;YACN,MAAM;YACN,UAAU;YACV,YAAY;YACZ,SAAS,GAAG,aAAa,GAAG,EAAE,iBAAiB,uBAAuB,CAAC;YACvE,UAAU;gBACN,IAAI;gBACJ,MAAM;gBACN,UAAU;YACd;YACA,WAAW,sKAAA,CAAA,YAAS,CAAC,GAAG;QAC5B;QAEA,mBAAmB;QACnB,MAAM,SAAS,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE,kBAAkB;QAE7D,OAAO;YACH,IAAI,OAAO,EAAE;YACb,GAAG,YAAY;QACnB;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO;IACX;AACJ;AAKO,eAAe,qBAAqB,aAAa,KAAK;IACzD,IAAI;QACA,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,oBAAoB;QACpB,MAAM,mBAAmB,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE;QACxC,IAAI;QAEJ,IAAI,YAAY;YACZ,kCAAkC;YAClC,IAAI,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EACJ,kBACA,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM,QACpB,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE,aAAa,SACrB,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE;QAEd,OAAO;YACH,0BAA0B;YAC1B,IAAI,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EACJ,kBACA,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE,aAAa,SACrB,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE;QAEd;QAEA,MAAM,gBAAgB,MAAM,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE;QAEpC,MAAM,gBAAgC,EAAE;QACxC,cAAc,OAAO,CAAC,CAAC;YACnB,cAAc,IAAI,CAAC;gBACf,IAAI,IAAI,EAAE;gBACV,GAAG,IAAI,IAAI,EAAE;YACjB;QACJ;QAEA,OAAO;IACX,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,MAAM;IACV;AACJ;AAKO,eAAe,uBAAuB,cAAsB;IAC/D,IAAI;QACA,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,kBAAkB,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE,iBAAiB;QACjD,MAAM,mBAAmB,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE;QAEtC,IAAI,CAAC,iBAAiB,MAAM,IAAI;YAC5B,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,iBAAiB,IAAI;QAE9C,wDAAwD;QACxD,IAAI,iBAAiB,MAAM,KAAK,YAAY,GAAG,EAAE;YAC7C,MAAM,IAAI,MAAM;QACpB;QAEA,yBAAyB;QACzB,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE,iBAAiB;YAC7B,MAAM;QACV;QAEA,OAAO;YACH,SAAS;QACb;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,uCAAuC;QACrD,MAAM;IACV;AACJ;AAKO,eAAe;IAClB,IAAI;QACA,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE;QACxC,MAAM,IAAI,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EACV,kBACA,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM;QAGxB,MAAM,gBAAgB,MAAM,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE;QAEpC,0DAA0D;QAC1D,MAAM,iBAAiB,cAAc,IAAI,CAAC,GAAG,CAAC,CAAA,MAC1C,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE,IAAI,GAAG,EAAE;gBAAE,MAAM;YAAK;QAGpC,kCAAkC;QAClC,MAAM,QAAQ,GAAG,CAAC;QAElB,OAAO;YACH,SAAS;YACT,OAAO,cAAc,IAAI;QAC7B;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,4CAA4C;QAC1D,MAAM;IACV;AACJ;AAKO,eAAe,mBAAmB,cAAsB;IAC3D,IAAI;QACA,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,kBAAkB,CAAA,GAAA,sKAAA,CAAA,MAAG,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE,iBAAiB;QACjD,MAAM,mBAAmB,MAAM,CAAA,GAAA,sKAAA,CAAA,SAAM,AAAD,EAAE;QAEtC,IAAI,CAAC,iBAAiB,MAAM,IAAI;YAC5B,MAAM,IAAI,MAAM;QACpB;QAEA,MAAM,mBAAmB,iBAAiB,IAAI;QAE9C,wDAAwD;QACxD,IAAI,iBAAiB,MAAM,KAAK,YAAY,GAAG,EAAE;YAC7C,MAAM,IAAI,MAAM;QACpB;QAEA,0BAA0B;QAC1B,MAAM,CAAA,GAAA,sKAAA,CAAA,YAAS,AAAD,EAAE;QAEhB,OAAO;YACH,SAAS;QACb;IACJ,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,gCAAgC;QAC9C,MAAM;IACV;AACJ;AAKO,eAAe;IAClB,IAAI;QACA,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,WAAW;QACpC,IAAI,CAAC,aAAa;YACd,OAAO;QACX;QAEA,MAAM,mBAAmB,CAAA,GAAA,sKAAA,CAAA,aAAU,AAAD,EAAE,+HAAA,CAAA,KAAE,EAAE;QACxC,MAAM,IAAI,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EACV,kBACA,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,UAAU,MAAM,YAAY,GAAG,GACrC,CAAA,GAAA,sKAAA,CAAA,QAAK,AAAD,EAAE,QAAQ,MAAM;QAGxB,MAAM,gBAAgB,MAAM,CAAA,GAAA,sKAAA,CAAA,UAAO,AAAD,EAAE;QACpC,OAAO,cAAc,IAAI;IAC7B,EAAE,OAAO,OAAO;QACZ,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO;IACX;AACJ","debugId":null}},
    {"offset": {"line": 334, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/MinimalNotificationBell.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"badge\": \"MinimalNotificationBell-module__DQnHDG__badge\",\n  \"button\": \"MinimalNotificationBell-module__DQnHDG__button\",\n  \"container\": \"MinimalNotificationBell-module__DQnHDG__container\",\n  \"content\": \"MinimalNotificationBell-module__DQnHDG__content\",\n  \"dot\": \"MinimalNotificationBell-module__DQnHDG__dot\",\n  \"dropdown\": \"MinimalNotificationBell-module__DQnHDG__dropdown\",\n  \"empty\": \"MinimalNotificationBell-module__DQnHDG__empty\",\n  \"footer\": \"MinimalNotificationBell-module__DQnHDG__footer\",\n  \"header\": \"MinimalNotificationBell-module__DQnHDG__header\",\n  \"icon\": \"MinimalNotificationBell-module__DQnHDG__icon\",\n  \"item\": \"MinimalNotificationBell-module__DQnHDG__item\",\n  \"list\": \"MinimalNotificationBell-module__DQnHDG__list\",\n  \"message\": \"MinimalNotificationBell-module__DQnHDG__message\",\n  \"seeMore\": \"MinimalNotificationBell-module__DQnHDG__seeMore\",\n  \"time\": \"MinimalNotificationBell-module__DQnHDG__time\",\n  \"unread\": \"MinimalNotificationBell-module__DQnHDG__unread\",\n  \"viewAll\": \"MinimalNotificationBell-module__DQnHDG__viewAll\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 359, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/MinimalNotificationBell.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect, useRef } from 'react'\nimport Link from 'next/link'\nimport { getUnreadNotificationsCount, getUserNotifications, markNotificationAsRead, Notification } from '@/firebase/notifications'\nimport styles from './MinimalNotificationBell.module.css'\n\n/**\n * A minimalistic notification bell component designed for the article page header\n */\nconst MinimalNotificationBell = () => {\n  const [unreadCount, setUnreadCount] = useState<number>(0)\n  const [notifications, setNotifications] = useState<Notification[]>([])\n  const [isOpen, setIsOpen] = useState<boolean>(false)\n  const notificationRef = useRef<HTMLDivElement>(null)\n\n  // Fetch unread count on mount\n  useEffect(() => {\n    const fetchUnreadCount = async () => {\n      const count = await getUnreadNotificationsCount()\n      setUnreadCount(count)\n    }\n\n    fetchUnreadCount()\n    \n    // Refresh every minute\n    const interval = setInterval(fetchUnreadCount, 60000)\n    return () => clearInterval(interval)\n  }, [])\n\n  // Handle clicks outside the dropdown\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (notificationRef.current && !notificationRef.current.contains(event.target as Node)) {\n        setIsOpen(false)\n      }\n    }\n\n    document.addEventListener('mousedown', handleClickOutside)\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside)\n    }\n  }, [])\n\n  // Fetch notifications when dropdown is opened\n  useEffect(() => {\n    if (isOpen) {\n      fetchNotifications()\n    }\n  }, [isOpen])\n\n  const fetchNotifications = async () => {\n    try {\n      const fetchedNotifications = await getUserNotifications(false)\n      setNotifications(fetchedNotifications)\n    } catch (error) {\n      console.error('Error fetching notifications:', error)\n    }\n  }\n\n  const handleToggle = () => {\n    setIsOpen(!isOpen)\n  }\n\n  const handleNotificationClick = async (notification: Notification) => {\n    try {\n      if (!notification.read && notification.id) {\n        await markNotificationAsRead(notification.id)\n        \n        // Update local state\n        setUnreadCount(prev => Math.max(prev - 1, 0))\n        setNotifications(prev => \n          prev.map(n => \n            n.id === notification.id \n              ? { ...n, read: true } \n              : n\n          )\n        )\n      }\n    } catch (error) {\n      console.error('Error marking notification as read:', error)\n    }\n  }\n\n  const formatTime = (timestamp: any) => {\n    if (!timestamp) return ''\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp)\n    const now = new Date()\n    const diffMinutes = Math.floor((now.getTime() - date.getTime()) / (1000 * 60))\n    \n    if (diffMinutes < 1) return 'Just now'\n    if (diffMinutes < 60) return `${diffMinutes}m ago`\n    \n    const diffHours = Math.floor(diffMinutes / 60)\n    if (diffHours < 24) return `${diffHours}h ago`\n    \n    const diffDays = Math.floor(diffHours / 24)\n    if (diffDays < 7) return `${diffDays}d ago`\n    \n    return date.toLocaleDateString()\n  }\n\n  const getNotificationLink = (notification: Notification) => {\n    if (notification.type === 'follow') {\n      if (notification.fromUser?.username) {\n        return `/user/${notification.fromUser.username}`;\n      }\n      return '/notifications';\n    } else if (notification.articleSlug) {\n      return `/articles?slug=${notification.articleSlug}`;\n    } else {\n      return '/notifications';\n    }\n  }\n\n  return (\n    <div className={styles.container} ref={notificationRef}>\n      <button \n        className={styles.button} \n        onClick={handleToggle}\n        aria-label=\"Notifications\"\n      >\n        <svg \n          className={styles.icon} \n          width=\"20\" \n          height=\"20\" \n          viewBox=\"0 0 24 24\" \n          fill=\"none\" \n          stroke=\"currentColor\" \n          strokeWidth=\"2\" \n          strokeLinecap=\"round\" \n          strokeLinejoin=\"round\"\n        >\n          <path d=\"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9\"></path>\n          <path d=\"M13.73 21a2 2 0 0 1-3.46 0\"></path>\n        </svg>\n        \n        {unreadCount > 0 && (\n          <span className={styles.badge}>{unreadCount}</span>\n        )}\n      </button>\n      \n      {isOpen && (\n        <div className={styles.dropdown}>\n          <div className={styles.header}>\n            <h3>Notifications</h3>\n            {notifications.length > 0 && (\n              <Link href=\"/notifications\" className={styles.viewAll}>\n                View All\n              </Link>\n            )}\n          </div>\n          \n          <div className={styles.list}>\n            {notifications.length === 0 ? (\n              <div className={styles.empty}>\n                No notifications yet\n              </div>\n            ) : (\n              notifications.slice(0, 5).map((notification) => (\n                <Link \n                  href={getNotificationLink(notification)} \n                  key={notification.id}\n                  className={`${styles.item} ${!notification.read ? styles.unread : ''}`}\n                  onClick={() => handleNotificationClick(notification)}\n                >\n                  <div className={styles.content}>\n                    <p className={styles.message}>\n                      {notification.message}\n                    </p>\n                    <span className={styles.time}>\n                      {formatTime(notification.createdAt)}\n                    </span>\n                  </div>\n                  {!notification.read && (\n                    <div className={styles.dot}></div>\n                  )}\n                </Link>\n              ))\n            )}\n          </div>\n          \n          {notifications.length > 5 && (\n            <div className={styles.footer}>\n              <Link href=\"/notifications\" className={styles.seeMore}>\n                See more notifications\n              </Link>\n            </div>\n          )}\n        </div>\n      )}\n    </div>\n  )\n}\n\nexport default MinimalNotificationBell "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 660, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/highlightService.ts"],"sourcesContent":["import { db } from '@/firebase/clientApp';\nimport {\n    collection,\n    doc,\n    addDoc,\n    getDocs,\n    query,\n    where,\n    deleteDoc,\n    updateDoc,\n    arrayUnion,\n    arrayRemove,\n    serverTimestamp\n} from 'firebase/firestore';\n\nexport interface Highlight {\n    id: string;\n    articleId: string;\n    userId: string;\n    text: string;\n    prefix: string;\n    suffix: string;\n    createdAt: any; // Firestore timestamp\n    comments?: Comment[];\n}\n\ninterface Comment {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport const saveHighlight = async (\n    articleId: string,\n    userId: string,\n    text: string,\n    prefix: string,\n    suffix: string\n): Promise<string> => {\n    try {\n        const highlightData = {\n            articleId,\n            userId,\n            text,\n            prefix,\n            suffix,\n            createdAt: serverTimestamp(),\n            comments: []\n        };\n\n        const docRef = await addDoc(collection(db, 'highlights'), highlightData);\n        return docRef.id;\n    } catch (error) {\n        console.error('Error saving highlight:', error);\n        throw error;\n    }\n};\n\nexport const getArticleHighlights = async (articleId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('articleId', '==', articleId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting highlights:', error);\n        return [];\n    }\n};\n\nexport const getUserHighlights = async (userId: string): Promise<Highlight[]> => {\n    try {\n        const q = query(\n            collection(db, 'highlights'),\n            where('userId', '==', userId)\n        );\n\n        const querySnapshot = await getDocs(q);\n        return querySnapshot.docs.map(doc => ({\n            id: doc.id,\n            ...doc.data()\n        } as Highlight));\n    } catch (error) {\n        console.error('Error getting user highlights:', error);\n        return [];\n    }\n};\n\nexport const deleteHighlight = async (highlightId: string): Promise<void> => {\n    try {\n        await deleteDoc(doc(db, 'highlights', highlightId));\n    } catch (error) {\n        console.error('Error deleting highlight:', error);\n        throw error;\n    }\n};\n\nexport const addCommentToHighlight = async (\n    highlightId: string,\n    userId: string,\n    content: string\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        const comment = {\n            userId,\n            content,\n            createdAt: new Date().toISOString(),\n        };\n\n        await updateDoc(highlightRef, {\n            comments: arrayUnion(comment)\n        });\n    } catch (error) {\n        console.error('Error adding comment to highlight:', error);\n        throw error;\n    }\n};\n\nexport const removeCommentFromHighlight = async (\n    highlightId: string,\n    comment: Comment\n): Promise<void> => {\n    try {\n        const highlightRef = doc(db, 'highlights', highlightId);\n\n        await updateDoc(highlightRef, {\n            comments: arrayRemove(comment)\n        });\n    } catch (error) {\n        console.error('Error removing comment from highlight:', error);\n        throw error;\n    }\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 761, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/context/HighlightContext.tsx"],"sourcesContent":["import React, { createContext, useState, useEffect, useContext, ReactNode } from 'react';\nimport { auth } from '@/firebase/clientApp';\nimport { User } from 'firebase/auth';\nimport { \n  Highlight, \n  getArticleHighlights, \n  saveHighlight, \n  deleteHighlight \n} from '@/services/highlightService';\n\ninterface HighlightContextType {\n  highlights: Highlight[];\n  loading: boolean;\n  saveHighlight: (text: string, prefix: string, suffix: string, articleId: string) => Promise<string | null>;\n  removeHighlight: (highlightId: string) => Promise<void>;\n  highlightElement: (range: Range) => void;\n}\n\nconst HighlightContext = createContext<HighlightContextType | undefined>(undefined);\n\ninterface HighlightProviderProps {\n  children: ReactNode;\n  articleId: string;\n}\n\nexport const HighlightProvider: React.FC<HighlightProviderProps> = ({ children, articleId }) => {\n  const [highlights, setHighlights] = useState<Highlight[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n\n  // Listen for auth state changes\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setCurrentUser(user);\n    });\n    return () => unsubscribe();\n  }, []);\n\n  // Load highlights for the current article\n  useEffect(() => {\n    const loadHighlights = async () => {\n      if (articleId) {\n        setLoading(true);\n        try {\n          const articleHighlights = await getArticleHighlights(articleId);\n          setHighlights(articleHighlights);\n        } catch (error) {\n          console.error('Error loading highlights:', error);\n        } finally {\n          setLoading(false);\n        }\n      }\n    };\n\n    loadHighlights();\n  }, [articleId]);\n\n  // Save a new highlight\n  const handleSaveHighlight = async (\n    text: string, \n    prefix: string, \n    suffix: string, \n    articleId: string\n  ): Promise<string | null> => {\n    if (!currentUser) {\n      alert('You must be logged in to highlight text');\n      return null;\n    }\n\n    try {\n      const highlightId = await saveHighlight(\n        articleId,\n        currentUser.uid,\n        text,\n        prefix,\n        suffix\n      );\n\n      // Add the new highlight to state\n      const newHighlight: Highlight = {\n        id: highlightId,\n        articleId,\n        userId: currentUser.uid,\n        text,\n        prefix,\n        suffix,\n        createdAt: new Date(),\n      };\n\n      setHighlights(prev => [...prev, newHighlight]);\n      return highlightId;\n    } catch (error) {\n      console.error('Error saving highlight:', error);\n      return null;\n    }\n  };\n\n  // Remove a highlight\n  const handleRemoveHighlight = async (highlightId: string): Promise<void> => {\n    try {\n      await deleteHighlight(highlightId);\n      setHighlights(prev => prev.filter(h => h.id !== highlightId));\n    } catch (error) {\n      console.error('Error removing highlight:', error);\n    }\n  };\n\n  // Apply highlight styling to a DOM element\n  const highlightElement = (range: Range): void => {\n    const highlightMark = document.createElement('mark');\n    highlightMark.className = 'article-highlight';\n    \n    try {\n      range.surroundContents(highlightMark);\n    } catch (error) {\n      console.error('Error highlighting range:', error);\n      // Handle complex selection that spans multiple elements\n      const fragment = range.extractContents();\n      highlightMark.appendChild(fragment);\n      range.insertNode(highlightMark);\n    }\n  };\n\n  const contextValue: HighlightContextType = {\n    highlights,\n    loading,\n    saveHighlight: handleSaveHighlight,\n    removeHighlight: handleRemoveHighlight,\n    highlightElement,\n  };\n\n  return (\n    <HighlightContext.Provider value={contextValue}>\n      {children}\n    </HighlightContext.Provider>\n  );\n};\n\nexport const useHighlights = (): HighlightContextType => {\n  const context = useContext(HighlightContext);\n  if (context === undefined) {\n    throw new Error('useHighlights must be used within a HighlightProvider');\n  }\n  return context;\n}; "],"names":[],"mappings":";;;;;AAAA;AACA;AAEA;;;;;;AAeA,MAAM,iCAAmB,CAAA,GAAA,6JAAA,CAAA,gBAAa,AAAD,EAAoC;AAOlE,MAAM,oBAAsD,CAAC,EAAE,QAAQ,EAAE,SAAS,EAAE;;IACzF,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe,EAAE;IAC5D,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,CAAC,aAAa,eAAe,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAe;IAE5D,gCAAgC;IAChC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;uCAAE;YACR,MAAM,cAAc,+HAAA,CAAA,OAAI,CAAC,kBAAkB;2DAAC,CAAA;oBAC1C,eAAe;gBACjB;;YACA;+CAAO,IAAM;;QACf;sCAAG,EAAE;IAEL,0CAA0C;IAC1C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;uCAAE;YACR,MAAM;8DAAiB;oBACrB,IAAI,WAAW;wBACb,WAAW;wBACX,IAAI;4BACF,MAAM,oBAAoB,MAAM,CAAA,GAAA,sIAAA,CAAA,uBAAoB,AAAD,EAAE;4BACrD,cAAc;wBAChB,EAAE,OAAO,OAAO;4BACd,QAAQ,KAAK,CAAC,6BAA6B;wBAC7C,SAAU;4BACR,WAAW;wBACb;oBACF;gBACF;;YAEA;QACF;sCAAG;QAAC;KAAU;IAEd,uBAAuB;IACvB,MAAM,sBAAsB,OAC1B,MACA,QACA,QACA;QAEA,IAAI,CAAC,aAAa;YAChB,MAAM;YACN,OAAO;QACT;QAEA,IAAI;YACF,MAAM,cAAc,MAAM,CAAA,GAAA,sIAAA,CAAA,gBAAa,AAAD,EACpC,WACA,YAAY,GAAG,EACf,MACA,QACA;YAGF,iCAAiC;YACjC,MAAM,eAA0B;gBAC9B,IAAI;gBACJ;gBACA,QAAQ,YAAY,GAAG;gBACvB;gBACA;gBACA;gBACA,WAAW,IAAI;YACjB;YAEA,cAAc,CAAA,OAAQ;uBAAI;oBAAM;iBAAa;YAC7C,OAAO;QACT,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,2BAA2B;YACzC,OAAO;QACT;IACF;IAEA,qBAAqB;IACrB,MAAM,wBAAwB,OAAO;QACnC,IAAI;YACF,MAAM,CAAA,GAAA,sIAAA,CAAA,kBAAe,AAAD,EAAE;YACtB,cAAc,CAAA,OAAQ,KAAK,MAAM,CAAC,CAAA,IAAK,EAAE,EAAE,KAAK;QAClD,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;QAC7C;IACF;IAEA,2CAA2C;IAC3C,MAAM,mBAAmB,CAAC;QACxB,MAAM,gBAAgB,SAAS,aAAa,CAAC;QAC7C,cAAc,SAAS,GAAG;QAE1B,IAAI;YACF,MAAM,gBAAgB,CAAC;QACzB,EAAE,OAAO,OAAO;YACd,QAAQ,KAAK,CAAC,6BAA6B;YAC3C,wDAAwD;YACxD,MAAM,WAAW,MAAM,eAAe;YACtC,cAAc,WAAW,CAAC;YAC1B,MAAM,UAAU,CAAC;QACnB;IACF;IAEA,MAAM,eAAqC;QACzC;QACA;QACA,eAAe;QACf,iBAAiB;QACjB;IACF;IAEA,qBACE,6LAAC,iBAAiB,QAAQ;QAAC,OAAO;kBAC/B;;;;;;AAGP;GA/Ga;KAAA;AAiHN,MAAM,gBAAgB;;IAC3B,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD,EAAE;IAC3B,IAAI,YAAY,WAAW;QACzB,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT;IANa","debugId":null}},
    {"offset": {"line": 905, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/HighlightToolbar.tsx"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\ninterface HighlightToolbarProps {\n  selection: Selection | null;\n  onHighlight: (selectedText: string, range: Range) => void;\n  onResponse?: (selectedText: string) => void;\n  onShare?: (selectedText: string) => void;\n  onAiAssist?: (selectedText: string) => void;\n}\n\nconst HighlightToolbar: React.FC<HighlightToolbarProps> = ({ \n  selection, \n  onHighlight, \n  onResponse, \n  onShare, \n  onAiAssist \n}) => {\n  const [position, setPosition] = useState({ top: 0, left: 0 });\n  const [isVisible, setIsVisible] = useState(false);\n  const toolbarRef = useRef<HTMLDivElement>(null);\n\n  useEffect(() => {\n    // Don't show toolbar if no selection or empty selection\n    if (!selection || selection.isCollapsed) {\n      setIsVisible(false);\n      return;\n    }\n\n    // Get the selection's bounding rectangle\n    const range = selection.getRangeAt(0);\n    const rect = range.getBoundingClientRect();\n\n    // Position the toolbar above the selection\n    const windowHeight = window.innerHeight;\n    const toolbarHeight = toolbarRef.current?.offsetHeight || 40;\n    \n    // Calculate position (centered above the selection)\n    const top = rect.top - toolbarHeight - 10 + window.scrollY;\n    const left = rect.left + rect.width / 2;\n\n    setPosition({ \n      top: top < 0 ? rect.bottom + 10 + window.scrollY : top, // Handle if too high\n      left \n    });\n    \n    // Show the toolbar\n    setIsVisible(true);\n  }, [selection]);\n\n  // Handle highlighting action\n  const handleHighlight = () => {\n    if (selection && !selection.isCollapsed) {\n      const range = selection.getRangeAt(0);\n      const selectedText = selection.toString();\n      onHighlight(selectedText, range);\n      // Clear selection after highlighting\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle response action\n  const handleResponse = () => {\n    if (selection && !selection.isCollapsed && onResponse) {\n      const selectedText = selection.toString();\n      onResponse(selectedText);\n      // Clear selection after response\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle share action\n  const handleShare = () => {\n    if (selection && !selection.isCollapsed && onShare) {\n      const selectedText = selection.toString();\n      onShare(selectedText);\n      // Clear selection after share\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Handle AI assist action\n  const handleAiAssist = () => {\n    if (selection && !selection.isCollapsed && onAiAssist) {\n      const selectedText = selection.toString();\n      onAiAssist(selectedText);\n      // Clear selection after AI assist\n      window.getSelection()?.removeAllRanges();\n      setIsVisible(false);\n    }\n  };\n\n  // Only render if there's a valid selection and in browser\n  if (!isVisible || typeof window === 'undefined') {\n    return null;\n  }\n\n  // Use portal to render outside of article container\n  return createPortal(\n    <div \n      ref={toolbarRef}\n      className=\"highlight-toolbar\"\n      style={{\n        position: 'absolute',\n        top: `${position.top}px`,\n        left: `${position.left}px`,\n        transform: 'translateX(-50%)',\n        zIndex: 1000,\n      }}\n    >\n      <button onClick={handleHighlight} className=\"highlight-btn highlight-btn-main\">\n        <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n          <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\n          <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\n        </svg>\n        <span>Highlight</span>\n      </button>\n      \n      {onResponse && (\n        <button onClick={handleResponse} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n          </svg>\n          <span>Response</span>\n        </button>\n      )}\n      \n      {onShare && (\n        <button onClick={handleShare} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n            <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n            <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n            <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n            <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n          </svg>\n          <span>Share</span>\n        </button>\n      )}\n      \n      {onAiAssist && (\n        <button onClick={handleAiAssist} className=\"highlight-btn\">\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n            <rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" ry=\"2\"></rect>\n            <line x1=\"8\" y1=\"12\" x2=\"16\" y2=\"12\"></line>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"16\"></line>\n          </svg>\n          <span>Journa AI</span>\n        </button>\n      )}\n    </div>,\n    document.body\n  );\n};\n\nexport default HighlightToolbar; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1261, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleHighlights.tsx"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport HighlightToolbar from './HighlightToolbar';\nimport { useHighlights } from '@/context/HighlightContext';\nimport { Highlight } from '@/services/highlightService';\n\ninterface ArticleHighlightsProps {\n  articleId: string;\n  children: React.ReactNode;\n  onShare?: (text: string) => void; // Optional share handler\n}\n\n// Get context for a selection\nconst getSelectionContext = (selection: Selection): { prefix: string; suffix: string } => {\n  // Default empty result\n  const result = { prefix: '', suffix: '' };\n  \n  if (!selection || selection.rangeCount === 0) return result;\n  \n  const range = selection.getRangeAt(0);\n  const selectedText = range.toString();\n  \n  // Clone the range for getting surrounding content\n  const contextRange = range.cloneRange();\n  \n  // Get parent node of selection\n  const parentNode = range.commonAncestorContainer;\n  const parentContent = parentNode.textContent || '';\n  \n  // Find selection position in parent content\n  const selectionStart = parentContent.indexOf(selectedText);\n  \n  if (selectionStart !== -1) {\n    // Get up to 30 chars of context before and after selection\n    const prefixStart = Math.max(0, selectionStart - 30);\n    const suffixEnd = Math.min(parentContent.length, selectionStart + selectedText.length + 30);\n    \n    result.prefix = parentContent.substring(prefixStart, selectionStart);\n    result.suffix = parentContent.substring(selectionStart + selectedText.length, suffixEnd);\n  }\n  \n  return result;\n};\n\n// Apply highlights to existing content in the DOM\nconst applyHighlightsToContent = (highlights: any[], articleContent: HTMLElement): void => {\n  if (!highlights || !articleContent) return;\n  \n  // First clear existing highlights to prevent duplicates\n  const existingHighlights = articleContent.querySelectorAll('.article-highlight');\n  existingHighlights.forEach(el => {\n    const parent = el.parentNode;\n    if (parent) {\n      // Replace the highlight with its text content\n      const textNode = document.createTextNode(el.textContent || '');\n      parent.replaceChild(textNode, el);\n      // Normalize to merge adjacent text nodes\n      parent.normalize();\n    }\n  });\n  \n  // Then apply all highlights from the database\n  highlights.forEach(highlight => {\n    // Function to find text in the DOM using prefix and suffix as context\n    const findTextInDOM = (text: string, prefix: string, suffix: string): Range | null => {\n      // Create a text finder walker\n      const walker = document.createTreeWalker(\n        articleContent,\n        NodeFilter.SHOW_TEXT,\n        null\n      );\n      \n      // Pattern to search for (prefix + text + suffix)\n      const pattern = (prefix + text + suffix).trim();\n      \n      let node;\n      while (node = walker.nextNode()) {\n        const content = node.textContent || '';\n        const index = content.indexOf(pattern);\n        \n        if (index !== -1) {\n          // Found the text with context, create a range\n          const range = document.createRange();\n          const prefixLength = prefix.trim().length;\n          range.setStart(node, index + prefixLength);\n          range.setEnd(node, index + prefixLength + text.trim().length);\n          return range;\n        }\n      }\n      \n      return null;\n    };\n    \n    // Try to find and highlight the text\n    const range = findTextInDOM(highlight.text, highlight.prefix, highlight.suffix);\n    if (range) {\n      try {\n        // Create highlight mark\n        const mark = document.createElement('mark');\n        mark.className = 'article-highlight';\n        mark.dataset.highlightId = highlight.id;\n        \n        // Apply highlight\n        range.surroundContents(mark);\n      } catch (error) {\n        console.error('Error applying highlight:', error);\n      }\n    }\n  });\n};\n\nconst ArticleHighlights: React.FC<ArticleHighlightsProps> = ({ articleId, children, onShare }) => {\n  const [selection, setSelection] = useState<Selection | null>(null);\n  const { highlights, saveHighlight, removeHighlight, highlightElement } = useHighlights();\n  const [contentRef, setContentRef] = useState<HTMLElement | null>(null);\n  const [showResponseModal, setShowResponseModal] = useState(false);\n  const [selectedTextForResponse, setSelectedTextForResponse] = useState('');\n  const [showAiModal, setShowAiModal] = useState(false);\n  const [selectedTextForAi, setSelectedTextForAi] = useState('');\n  const [activeHighlight, setActiveHighlight] = useState<{ id: string, text: string } | null>(null);\n  const [showUnhighlightToolbar, setShowUnhighlightToolbar] = useState(false);\n  const [isHidingToolbar, setIsHidingToolbar] = useState(false);\n  const [unhighlightPosition, setUnhighlightPosition] = useState({ top: 0, left: 0 });\n  \n  // Function to hide toolbar with animation\n  const hideToolbarWithAnimation = useCallback(() => {\n    setIsHidingToolbar(true);\n    // After animation completes, actually hide the toolbar\n    setTimeout(() => {\n      setShowUnhighlightToolbar(false);\n      setIsHidingToolbar(false);\n    }, 150); // Match this with CSS transition duration\n  }, []);\n  \n  // Handle text selection\n  const handleSelection = useCallback(() => {\n    // If unhighlight toolbar is active, don't process regular selections\n    if (showUnhighlightToolbar) return;\n    \n    const currentSelection = window.getSelection();\n    if (currentSelection && !currentSelection.isCollapsed && currentSelection.toString().trim() !== '') {\n      setSelection(currentSelection);\n    } else {\n      setSelection(null);\n    }\n  }, [showUnhighlightToolbar]);\n  \n  // Handle highlight button click\n  const handleHighlight = useCallback((selectedText: string, range: Range) => {\n    if (selectedText && range) {\n      // Get context for the selection\n      const context = getSelectionContext(window.getSelection()!);\n      \n      // Save highlight to database\n      saveHighlight(\n        selectedText.trim(),\n        context.prefix,\n        context.suffix,\n        articleId\n      );\n      \n      // Apply highlight visually\n      highlightElement(range);\n    }\n  }, [articleId, saveHighlight, highlightElement]);\n  \n  // Handle highlight click to show unhighlight option\n  const handleHighlightClick = useCallback((e: MouseEvent) => {\n    // Check if click is on a highlight\n    const target = e.target as HTMLElement;\n    if (target.classList.contains('article-highlight')) {\n      e.preventDefault();\n      e.stopPropagation();\n      \n      // Get highlight info\n      const highlightId = target.dataset.highlightId;\n      const highlightText = target.textContent || '';\n      \n      if (highlightId) {\n        // Reset hiding state if it was set\n        setIsHidingToolbar(false);\n        \n        // Set active highlight\n        setActiveHighlight({ id: highlightId, text: highlightText });\n        \n        // Position unhighlight toolbar near the highlight\n        const rect = target.getBoundingClientRect();\n        setUnhighlightPosition({\n          top: rect.top - 40 + window.scrollY, // Position above the highlight\n          left: rect.left + rect.width / 2\n        });\n        \n        // Show unhighlight toolbar\n        setShowUnhighlightToolbar(true);\n        \n        // Hide regular selection toolbar if visible\n        setSelection(null);\n      }\n    } else {\n      // If clicking elsewhere, hide unhighlight toolbar with animation\n      if (showUnhighlightToolbar) {\n        hideToolbarWithAnimation();\n        setActiveHighlight(null);\n      }\n    }\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Handle unhighlight action\n  const handleUnhighlight = useCallback(() => {\n    if (activeHighlight && activeHighlight.id) {\n      // Start the hiding animation\n      hideToolbarWithAnimation();\n      \n      // Store the ID before resetting the active highlight\n      const highlightId = activeHighlight.id;\n      \n      // Reset active highlight state\n      setActiveHighlight(null);\n      \n      // Remove highlight from database\n      removeHighlight(highlightId);\n      \n      // Find and remove highlight from DOM\n      if (contentRef) {\n        const highlightEl = contentRef.querySelector(`[data-highlight-id=\"${highlightId}\"]`);\n        if (highlightEl && highlightEl.parentNode) {\n          const textNode = document.createTextNode(highlightEl.textContent || '');\n          highlightEl.parentNode.replaceChild(textNode, highlightEl);\n          highlightEl.parentNode.normalize();\n        }\n      }\n    }\n  }, [activeHighlight, removeHighlight, contentRef, hideToolbarWithAnimation]);\n  \n  // Handle response button click\n  const handleResponse = useCallback((selectedText: string) => {\n    setSelectedTextForResponse(selectedText);\n    setShowResponseModal(true);\n  }, []);\n\n  // Handle share button click\n  const handleShare = useCallback((selectedText: string) => {\n    if (onShare) {\n      onShare(selectedText);\n    } else {\n      // Fallback if no share handler is provided\n      const shareText = `\"${selectedText}\"  via Journalite`;\n      \n      // Try to use native share API if available\n      if (navigator.share) {\n        navigator.share({\n          text: shareText,\n        }).catch(error => {\n          console.error('Error sharing:', error);\n          // Fallback to copying to clipboard\n          navigator.clipboard.writeText(shareText)\n            .then(() => alert('Quote copied to clipboard!'))\n            .catch(err => console.error('Failed to copy:', err));\n        });\n      } else {\n        // Fallback to copying to clipboard\n        navigator.clipboard.writeText(shareText)\n          .then(() => alert('Quote copied to clipboard!'))\n          .catch(err => console.error('Failed to copy:', err));\n      }\n    }\n  }, [onShare]);\n\n  // Handle AI assist button click\n  const handleAiAssist = useCallback((selectedText: string) => {\n    setSelectedTextForAi(selectedText);\n    setShowAiModal(true);\n  }, []);\n  \n  // Set up selection event listener\n  useEffect(() => {\n    document.addEventListener('selectionchange', handleSelection);\n    return () => {\n      document.removeEventListener('selectionchange', handleSelection);\n    };\n  }, [handleSelection]);\n  \n  // Set up click listener for highlights\n  useEffect(() => {\n    if (contentRef) {\n      contentRef.addEventListener('click', handleHighlightClick as EventListener);\n      \n      return () => {\n        contentRef.removeEventListener('click', handleHighlightClick as EventListener);\n      };\n    }\n  }, [contentRef, handleHighlightClick]);\n  \n  // Add click listener to document to hide unhighlight toolbar when clicking outside\n  useEffect(() => {\n    const handleDocumentClick = (e: MouseEvent) => {\n      if (showUnhighlightToolbar) {\n        const target = e.target as HTMLElement;\n        if (!target.closest('.highlight-toolbar') && \n            !target.classList.contains('article-highlight')) {\n          hideToolbarWithAnimation();\n          setActiveHighlight(null);\n        }\n      }\n    };\n    \n    document.addEventListener('click', handleDocumentClick);\n    \n    return () => {\n      document.removeEventListener('click', handleDocumentClick);\n    };\n  }, [showUnhighlightToolbar, hideToolbarWithAnimation]);\n  \n  // Apply highlights from database when they change\n  useEffect(() => {\n    if (contentRef && highlights.length > 0) {\n      applyHighlightsToContent(highlights, contentRef);\n    }\n  }, [highlights, contentRef]);\n  \n  // Get ref to content element\n  const setRef = useCallback((node: HTMLElement | null) => {\n    if (node) {\n      setContentRef(node);\n    }\n  }, []);\n  \n  return (\n    <>\n      {/* Toolbar for highlighting */}\n      <HighlightToolbar \n        selection={selection} \n        onHighlight={handleHighlight} \n        onResponse={handleResponse}\n        onShare={handleShare}\n        onAiAssist={handleAiAssist}\n      />\n      \n      {/* Unhighlight toolbar */}\n      {showUnhighlightToolbar && activeHighlight && (\n        <div \n          className={`highlight-toolbar unhighlight-toolbar ${isHidingToolbar ? 'hiding' : ''}`}\n          style={{\n            position: 'absolute',\n            top: `${unhighlightPosition.top}px`,\n            left: `${unhighlightPosition.left}px`,\n            transform: isHidingToolbar ? 'translateY(-10px) translateX(-50%)' : 'translateX(-50%)',\n            zIndex: 1000,\n          }}\n        >\n          <button onClick={handleUnhighlight} className=\"highlight-btn highlight-btn-danger\">\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 4H8l-7 8 7 8h13a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2z\"></path>\n              <line x1=\"18\" y1=\"9\" x2=\"12\" y2=\"15\"></line>\n              <line x1=\"12\" y1=\"9\" x2=\"18\" y2=\"15\"></line>\n            </svg>\n            <span>Unhighlight</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleShare(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <circle cx=\"18\" cy=\"5\" r=\"3\"></circle>\n              <circle cx=\"6\" cy=\"12\" r=\"3\"></circle>\n              <circle cx=\"18\" cy=\"19\" r=\"3\"></circle>\n              <line x1=\"8.59\" y1=\"13.51\" x2=\"15.42\" y2=\"17.49\"></line>\n              <line x1=\"15.41\" y1=\"6.51\" x2=\"8.59\" y2=\"10.49\"></line>\n            </svg>\n            <span>Share</span>\n          </button>\n          \n          <button \n            onClick={() => {\n              handleResponse(activeHighlight.text);\n              hideToolbarWithAnimation();\n            }} \n            className=\"highlight-btn\"\n          >\n            <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n              <path d=\"M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z\"></path>\n            </svg>\n            <span>Response</span>\n          </button>\n        </div>\n      )}\n      \n      {/* Content with ref for highlight application */}\n      <div ref={setRef} className=\"article-highlight-container\">\n        {children}\n      </div>\n      \n      {/* Response Modal - placeholder for implementation */}\n      {showResponseModal && (\n        <div className=\"highlight-response-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowResponseModal(false)}\n            >\n              \n            </button>\n            <h3>Respond to highlighted text</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForResponse}\"</div>\n            <textarea \n              className=\"highlight-response-input\" \n              placeholder=\"Write your response...\"\n            ></textarea>\n            <button className=\"highlight-response-submit\">Submit</button>\n          </div>\n        </div>\n      )}\n      \n      {/* Journa AI Modal - placeholder for implementation */}\n      {showAiModal && (\n        <div className=\"highlight-ai-modal\">\n          <div className=\"highlight-modal-content\">\n            <button \n              className=\"highlight-modal-close\" \n              onClick={() => setShowAiModal(false)}\n            >\n              \n            </button>\n            <h3>Journa AI</h3>\n            <div className=\"highlight-selected-text\">\"{selectedTextForAi}\"</div>\n            <div className=\"highlight-ai-options\">\n              <button>Explain this</button>\n              <button>Fact check</button>\n              <button>Provide context</button>\n              <button>Summarize</button>\n            </div>\n            <div className=\"highlight-ai-response\">\n              {/* AI response would appear here */}\n              <div className=\"highlight-ai-loading\">Journa AI is thinking...</div>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n};\n\nexport default ArticleHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2009, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleWithHighlights.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"articleContainer\": \"ArticleWithHighlights-module__TI8ibW__articleContainer\",\n  \"articleContent\": \"ArticleWithHighlights-module__TI8ibW__articleContent\",\n  \"errorContainer\": \"ArticleWithHighlights-module__TI8ibW__errorContainer\",\n  \"errorMessage\": \"ArticleWithHighlights-module__TI8ibW__errorMessage\",\n  \"loadingContainer\": \"ArticleWithHighlights-module__TI8ibW__loadingContainer\",\n  \"loadingIndicator\": \"ArticleWithHighlights-module__TI8ibW__loadingIndicator\",\n  \"spin\": \"ArticleWithHighlights-module__TI8ibW__spin\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 2024, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/articleService.ts"],"sourcesContent":["// src/services/articleService.ts\n// // or wherever your interface lives\n\nexport async function getArticle(slug: string): Promise<Article> {\n    // 1. Read your base URL (make sure .env.local has NEXT_PUBLIC_API_BASE_URL)\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL\n        || 'http://127.0.0.1:5001'\n\n    // 2. Construct the correct Flask endpoint\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}`\n\n    // 3. Fetch it\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch article: ${res.status} ${res.statusText}`)\n    }\n\n    // 4. Parse JSON and return\n    return res.json()\n}\n\n// Get article comments\nexport async function getArticleComments(slug: string): Promise<ArticleComment[]> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comments`\n\n    const res = await fetch(url)\n    if (!res.ok) {\n        throw new Error(`Failed to fetch comments: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a new comment\nexport async function postComment(slug: string, userId: string, content: string): Promise<ArticleComment> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Post a reply to a comment\nexport async function postReply(slug: string, commentId: string, userId: string, content: string): Promise<CommentReply> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId, content }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to post reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a comment\nexport async function likeComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Like or unlike a reply\nexport async function likeReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, action: string, likes: string[], count: number }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}/like`\n\n    const res = await fetch(url, {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to like reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a comment\nexport async function deleteComment(slug: string, commentId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete comment: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\n// Delete a reply\nexport async function deleteReply(slug: string, commentId: string, replyId: string, userId: string): Promise<{ success: boolean, message: string }> {\n    const baseUrl = process.env.NEXT_PUBLIC_API_BASE_URL || 'http://127.0.0.1:5001'\n    const url = `${baseUrl}/api/prototype/v1/article/${slug}/comment/${commentId}/reply/${replyId}?userId=${userId}`\n\n    const res = await fetch(url, {\n        method: 'DELETE',\n    })\n\n    if (!res.ok) {\n        throw new Error(`Failed to delete reply: ${res.status} ${res.statusText}`)\n    }\n\n    return res.json()\n}\n\nexport interface Article {\n    _id: string;\n    id?: string;           // optional for your samples\n    slug: string;\n    title: string;\n    content: string | ParagraphContent[];\n    author?: string;\n    authorId: string;\n    publishedDate?: string;\n    tags: string[];\n    likes: number | string[];\n    viewCount?: number;\n    readTime?: number;\n    comments?: ArticleComment[];\n    coverImageUrl?: string;\n    createdAt?: string;\n    updatedAt?: string;\n    reposts?: string[];\n}\n\ninterface ParagraphContent {\n    paragraphId: string;\n    text: string;\n    likes: string[];\n    comments: CommentContent[];\n}\n\ninterface CommentContent {\n    userId: string;\n    content: string;\n    createdAt: string;\n}\n\nexport interface ArticleComment {\n    commentId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    content: string;\n    createdAt: string;\n    likes: string[];\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2160, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/syntaxHighlighter.js"],"sourcesContent":["import Prism from 'prismjs';\n\n// Import language support\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/components/prism-typescript';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-tsx';\nimport 'prismjs/components/prism-css';\nimport 'prismjs/components/prism-scss';\nimport 'prismjs/components/prism-json';\nimport 'prismjs/components/prism-python';\nimport 'prismjs/components/prism-java';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-cpp';\nimport 'prismjs/components/prism-csharp';\nimport 'prismjs/components/prism-php';\nimport 'prismjs/components/prism-ruby';\nimport 'prismjs/components/prism-go';\nimport 'prismjs/components/prism-rust';\nimport 'prismjs/components/prism-sql';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-markdown';\n\n/**\n * Apply syntax highlighting to all code blocks in a container\n * @param {HTMLElement} container - The container element to search for code blocks\n */\nexport function highlightCodeBlocks(container) {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const codeBlocks = container.querySelectorAll('pre code');\n\n    codeBlocks.forEach(codeBlock => {\n        const pre = codeBlock.parentElement;\n\n        // Get language from class name or data attribute\n        let language = 'javascript'; // default\n\n        // Check for language-* class on the code element\n        const classNames = codeBlock.className.split(' ');\n        for (const className of classNames) {\n            if (className.startsWith('language-')) {\n                language = className.replace('language-', '');\n                break;\n            }\n        }\n\n        // Check for data-language on the pre element\n        if (pre.hasAttribute('data-language')) {\n            language = pre.getAttribute('data-language');\n        }\n\n        // Apply syntax highlighting if language is supported\n        if (Prism.languages[language]) {\n            try {\n                const code = codeBlock.textContent || '';\n                const highlightedCode = Prism.highlight(code, Prism.languages[language], language);\n                codeBlock.innerHTML = highlightedCode;\n\n                // Add language indicator\n                pre.setAttribute('data-language', language);\n                pre.style.position = 'relative';\n\n            } catch (error) {\n                console.warn('Syntax highlighting failed for language:', language, error);\n            }\n        }\n    });\n}\n\n/**\n * Auto-detect and highlight code blocks when the DOM is ready\n */\nexport function autoHighlightCodeBlocks() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    const highlightOnLoad = () => {\n        const containers = [\n            document.querySelector('.article-content'),\n            document.querySelector('.paragraph-text'),\n            document.querySelector('.paragraph-block'),\n            document.body\n        ].filter(Boolean);\n\n        containers.forEach(container => {\n            if (container) {\n                highlightCodeBlocks(container);\n            }\n        });\n    };\n\n    if (document.readyState === 'loading') {\n        document.addEventListener('DOMContentLoaded', highlightOnLoad);\n    } else {\n        highlightOnLoad();\n    }\n}\n\n/**\n * Highlight code blocks after dynamic content is loaded\n * Call this after AJAX content updates\n */\nexport function highlightDynamicContent() {\n    if (typeof window === 'undefined') return; // SSR guard\n\n    // Wait a bit for DOM to settle\n    setTimeout(() => {\n        autoHighlightCodeBlocks();\n    }, 100);\n} "],"names":[],"mappings":";;;;;AAAA;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;AAMO,SAAS,oBAAoB,SAAS;IACzC,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,MAAM,aAAa,UAAU,gBAAgB,CAAC;IAE9C,WAAW,OAAO,CAAC,CAAA;QACf,MAAM,MAAM,UAAU,aAAa;QAEnC,iDAAiD;QACjD,IAAI,WAAW,cAAc,UAAU;QAEvC,iDAAiD;QACjD,MAAM,aAAa,UAAU,SAAS,CAAC,KAAK,CAAC;QAC7C,KAAK,MAAM,aAAa,WAAY;YAChC,IAAI,UAAU,UAAU,CAAC,cAAc;gBACnC,WAAW,UAAU,OAAO,CAAC,aAAa;gBAC1C;YACJ;QACJ;QAEA,6CAA6C;QAC7C,IAAI,IAAI,YAAY,CAAC,kBAAkB;YACnC,WAAW,IAAI,YAAY,CAAC;QAChC;QAEA,qDAAqD;QACrD,IAAI,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;YAC3B,IAAI;gBACA,MAAM,OAAO,UAAU,WAAW,IAAI;gBACtC,MAAM,kBAAkB,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,MAAM,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;gBACzE,UAAU,SAAS,GAAG;gBAEtB,yBAAyB;gBACzB,IAAI,YAAY,CAAC,iBAAiB;gBAClC,IAAI,KAAK,CAAC,QAAQ,GAAG;YAEzB,EAAE,OAAO,OAAO;gBACZ,QAAQ,IAAI,CAAC,4CAA4C,UAAU;YACvE;QACJ;IACJ;AACJ;AAKO,SAAS;IACZ,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,MAAM,kBAAkB;QACpB,MAAM,aAAa;YACf,SAAS,aAAa,CAAC;YACvB,SAAS,aAAa,CAAC;YACvB,SAAS,aAAa,CAAC;YACvB,SAAS,IAAI;SAChB,CAAC,MAAM,CAAC;QAET,WAAW,OAAO,CAAC,CAAA;YACf,IAAI,WAAW;gBACX,oBAAoB;YACxB;QACJ;IACJ;IAEA,IAAI,SAAS,UAAU,KAAK,WAAW;QACnC,SAAS,gBAAgB,CAAC,oBAAoB;IAClD,OAAO;QACH;IACJ;AACJ;AAMO,SAAS;IACZ,uCAAmC;;IAAM,EAAE,YAAY;IAEvD,+BAA+B;IAC/B,WAAW;QACP;IACJ,GAAG;AACP","debugId":null}},
    {"offset": {"line": 2285, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ClientSideHighlighter.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react';\n\nconst CLIENT_SIDE_HIGHLIGHTER_SCRIPT = `\n// Simple syntax highlighting without external dependencies\nfunction highlightCode() {\n  const codeBlocks = document.querySelectorAll('pre code');\n  \n  codeBlocks.forEach(codeBlock => {\n    const pre = codeBlock.parentElement;\n    if (!pre) return;\n    \n    // Apply dark theme\n    pre.style.backgroundColor = '#1e1e1e';\n    pre.style.color = '#d4d4d4';\n    pre.style.border = '1px solid #333';\n    pre.style.borderRadius = '8px';\n    pre.style.padding = '16px';\n    pre.style.fontFamily = \"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace\";\n    pre.style.fontSize = '14px';\n    pre.style.lineHeight = '1.6';\n    pre.style.overflowX = 'auto';\n    pre.style.position = 'relative';\n    \n    const code = codeBlock.textContent || '';\n    let highlightedCode = code;\n    \n    // Basic JavaScript/TypeScript highlighting\n    highlightedCode = highlightedCode\n      // Keywords\n      .replace(/\\\\b(const|let|var|function|class|interface|type|enum|import|export|from|as|return|if|else|for|while|switch|case|break|default|try|catch|finally|async|await|new|this|extends|implements|private|public|protected|static|get|set|super|void|yield)\\\\b/g, '<span style=\"color: #569cd6; font-weight: 500;\">$1</span>')\n      \n      // Strings\n      .replace(/(['\"\\`])((?:\\\\\\\\.|(?!\\\\1)[^\\\\\\\\\\\\r\\\\n])*?)\\\\1/g, '<span style=\"color: #ce9178;\">$1$2$1</span>')\n      \n      // Numbers\n      .replace(/\\\\b(\\\\d+(?:\\\\.\\\\d+)?)\\\\b/g, '<span style=\"color: #b5cea8;\">$1</span>')\n      \n      // Comments\n      .replace(/(\\/\\/.*?)$/gm, '<span style=\"color: #6a9955; font-style: italic;\">$1</span>')\n      .replace(/(\\/\\\\*[\\\\s\\\\S]*?\\\\*\\/)/g, '<span style=\"color: #6a9955; font-style: italic;\">$1</span>')\n      \n      // Functions\n      .replace(/([a-zA-Z_$][a-zA-Z0-9_$]*)\\\\s*\\\\(/g, '<span style=\"color: #dcdcaa;\">$1</span>(')\n      \n      // Types/Classes (capitalized words)\n      .replace(/\\\\b([A-Z][a-zA-Z0-9_]*)\\\\b/g, '<span style=\"color: #4ec9b0;\">$1</span>')\n      \n      // Operators\n      .replace(/([=!<>+\\\\-*/%&|^~?:;,.])/g, '<span style=\"color: #d4d4d4;\">$1</span>');\n    \n    codeBlock.innerHTML = highlightedCode;\n    \n    // Add language indicator if available\n    let language = 'code';\n    const classNames = codeBlock.className.split(' ');\n    for (const className of classNames) {\n      if (className.startsWith('language-')) {\n        language = className.replace('language-', '');\n        break;\n      }\n    }\n    \n    if (pre.hasAttribute('data-language')) {\n      language = pre.getAttribute('data-language');\n    }\n    \n    // Add language badge\n    const badge = document.createElement('div');\n    badge.textContent = language.toUpperCase();\n    badge.style.position = 'absolute';\n    badge.style.top = '8px';\n    badge.style.right = '12px';\n    badge.style.background = 'rgba(255, 255, 255, 0.1)';\n    badge.style.color = '#a0a0a0';\n    badge.style.padding = '2px 8px';\n    badge.style.borderRadius = '4px';\n    badge.style.fontSize = '12px';\n    badge.style.fontWeight = '500';\n    badge.style.letterSpacing = '0.5px';\n    pre.appendChild(badge);\n  });\n}\n\n// Run when DOM is loaded\nif (document.readyState === 'loading') {\n  document.addEventListener('DOMContentLoaded', highlightCode);\n} else {\n  highlightCode();\n}\n\n// Also run on dynamic content changes\nconst observer = new MutationObserver(() => {\n  setTimeout(highlightCode, 100);\n});\n\nobserver.observe(document.body, {\n  childList: true,\n  subtree: true\n});\n`;\n\nexport default function ClientSideHighlighter() {\n  useEffect(() => {\n    // Create and inject the script\n    const script = document.createElement('script');\n    script.textContent = CLIENT_SIDE_HIGHLIGHTER_SCRIPT;\n    document.head.appendChild(script);\n\n    return () => {\n      // Cleanup if needed\n      try {\n        document.head.removeChild(script);\n      } catch (e) {\n        // Script might already be removed\n      }\n    };\n  }, []);\n\n  return null; // This component doesn't render anything\n} "],"names":[],"mappings":";;;AAEA;;AAFA;;AAIA,MAAM,iCAAiC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiGxC,CAAC;AAEc,SAAS;;IACtB,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;2CAAE;YACR,+BAA+B;YAC/B,MAAM,SAAS,SAAS,aAAa,CAAC;YACtC,OAAO,WAAW,GAAG;YACrB,SAAS,IAAI,CAAC,WAAW,CAAC;YAE1B;mDAAO;oBACL,oBAAoB;oBACpB,IAAI;wBACF,SAAS,IAAI,CAAC,WAAW,CAAC;oBAC5B,EAAE,OAAO,GAAG;oBACV,kCAAkC;oBACpC;gBACF;;QACF;0CAAG,EAAE;IAEL,OAAO,MAAM,yCAAyC;AACxD;GAlBwB;KAAA","debugId":null}},
    {"offset": {"line": 2425, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleWithHighlights.tsx"],"sourcesContent":["'use client'\n\nimport React, { useEffect, useState, useRef } from 'react';\nimport { HighlightProvider } from '@/context/HighlightContext';\nimport ArticleHighlights from './ArticleHighlights';\nimport styles from '@/styles/ArticleWithHighlights.module.css';\nimport { getArticle } from '@/services/articleService';\nimport { highlightCodeBlocks } from '@/utils/syntaxHighlighter';\nimport ClientSideHighlighter from './ClientSideHighlighter';\n\ninterface ArticleWithHighlightsProps {\n  articleId: string;\n  initialHtml?: string;\n}\n\nconst ArticleWithHighlights: React.FC<ArticleWithHighlightsProps> = ({\n  articleId,\n  initialHtml\n}) => {\n  const [article, setArticle] = useState<{ title: string; body: string } | null>(null);\n  const [isLoading, setIsLoading] = useState(!initialHtml);\n  const [error, setError] = useState('');\n  const [reflectionsEnabled, setReflectionsEnabled] = useState(true);\n  const [showReflectionPanel, setShowReflectionPanel] = useState(false);\n  const [reflectionCount, setReflectionCount] = useState(0);\n  const [currentReflection, setCurrentReflection] = useState('');\n  const [currentPrompt, setCurrentPrompt] = useState('');\n  const [isEditingPrompt, setIsEditingPrompt] = useState(false);\n  const [isSubmitting, setIsSubmitting] = useState(false);\n  const articleContainerRef = useRef<HTMLDivElement>(null);\n\n  // Base reflection prompts\n  const basePrompts = [\n    \"How does this make you feel?\",\n    \"What questions does this raise for you?\",\n    \"How does this connect to your own experiences?\",\n    \"What would you have done differently?\",\n    \"What surprises you most about this?\",\n    \"How might this change your perspective?\",\n    \"What emotions are you experiencing right now?\",\n    \"What does this remind you of?\",\n    \"If you could ask the author one question, what would it be?\",\n    \"How does this challenge your existing beliefs?\"\n  ];\n\n  // Topic-based prompts (without AI)\n  const getTopicBasedPrompts = (content: string) => {\n    const text = content.toLowerCase();\n    const topicPrompts: string[] = [];\n\n    // Technology/Business\n    if (text.includes('technology') || text.includes('innovation') || text.includes('digital') || text.includes('business')) {\n      topicPrompts.push(\"How might this technology impact your daily life?\");\n      topicPrompts.push(\"What are the potential risks and benefits you see?\");\n    }\n\n    // Politics/Government\n    if (text.includes('government') || text.includes('policy') || text.includes('president') || text.includes('election')) {\n      topicPrompts.push(\"How do you think this policy might affect different communities?\");\n      topicPrompts.push(\"What would you propose as an alternative approach?\");\n    }\n\n    // Health/Science\n    if (text.includes('health') || text.includes('medical') || text.includes('research') || text.includes('study')) {\n      topicPrompts.push(\"How reliable do you think this research is?\");\n      topicPrompts.push(\"How might this affect healthcare decisions?\");\n    }\n\n    // Environment/Climate\n    if (text.includes('environment') || text.includes('climate') || text.includes('energy') || text.includes('sustainability')) {\n      topicPrompts.push(\"What actions could you personally take based on this information?\");\n      topicPrompts.push(\"How do you balance environmental concerns with other priorities?\");\n    }\n\n    // Education\n    if (text.includes('education') || text.includes('school') || text.includes('learning') || text.includes('student')) {\n      topicPrompts.push(\"How does this compare to your own educational experience?\");\n      topicPrompts.push(\"What changes would you make to improve this system?\");\n    }\n\n    // Social Issues\n    if (text.includes('social') || text.includes('community') || text.includes('justice') || text.includes('equality')) {\n      topicPrompts.push(\"What role do you think individuals should play in addressing this issue?\");\n      topicPrompts.push(\"How might different communities view this differently?\");\n    }\n\n    return topicPrompts;\n  };\n\n  const getAllAvailablePrompts = () => {\n    const content = getContentToDisplay();\n    const topicPrompts = getTopicBasedPrompts(content);\n    return [...basePrompts, ...topicPrompts];\n  };\n\n  const getDefaultPrompt = () => {\n    const allPrompts = getAllAvailablePrompts();\n    return allPrompts[reflectionCount % allPrompts.length];\n  };\n\n  // Initialize prompt when panel opens\n  useEffect(() => {\n    if (showReflectionPanel && !currentPrompt) {\n      setCurrentPrompt(getDefaultPrompt());\n    }\n  }, [showReflectionPanel, reflectionCount]);\n\n  // Apply syntax highlighting when content loads\n  useEffect(() => {\n    if (articleContainerRef.current && (initialHtml || article)) {\n      // Small delay to ensure DOM is updated\n      setTimeout(() => {\n        if (articleContainerRef.current) {\n          highlightCodeBlocks(articleContainerRef.current);\n        }\n      }, 100);\n    }\n  }, [initialHtml, article]);\n\n  const handleShare = (text: string) => {\n    if (navigator.share) {\n      navigator.share({\n        title: article?.title || 'Shared highlight',\n        text: `\"${text}\" - from article ${articleId}`,\n        url: window.location.href\n      }).catch(error => console.error('Error sharing:', error));\n    } else {\n      const shareText = `\"${text}\" - from article ${articleId} ${window.location.href}`;\n      navigator.clipboard.writeText(shareText)\n        .then(() => alert('Highlight copied to clipboard!'))\n        .catch(error => console.error('Error copying to clipboard:', error));\n    }\n  };\n\n  const handleReflectionSubmit = async () => {\n    if (!currentReflection.trim()) return;\n    \n    setIsSubmitting(true);\n    \n    try {\n      console.log('Starting reflection submission:', {\n        articleId,\n        currentPrompt,\n        currentReflection,\n        reflectionCount\n      });\n      \n      // Import the reflection service\n      const { saveReflectionResponse } = await import('@/services/reflectionService');\n      \n      // Save the reflection with proper metadata\n      await saveReflectionResponse(\n        articleId, // This is the article slug\n        `prompt_${Date.now()}`, // Generate a unique prompt ID\n        currentPrompt,\n        currentReflection,\n        reflectionCount, // Use reflection count as position\n        true // isPrivate\n      );\n      \n      console.log('Reflection saved successfully:', { \n        articleId, \n        prompt: currentPrompt, \n        response: currentReflection, \n        count: reflectionCount + 1 \n      });\n      \n      // Update count and close panel\n      setReflectionCount(prev => prev + 1);\n      setCurrentReflection('');\n      setCurrentPrompt('');\n      setIsEditingPrompt(false);\n      setShowReflectionPanel(false);\n    } catch (error) {\n      console.error('Error saving reflection:', error);\n      alert('Error saving reflection. Please try again.');\n    } finally {\n      setIsSubmitting(false);\n    }\n  };\n\n  const toggleReflectionPanel = () => {\n    if (reflectionsEnabled) {\n      setShowReflectionPanel(!showReflectionPanel);\n      if (!showReflectionPanel) {\n        setCurrentReflection('');\n        setCurrentPrompt(getDefaultPrompt());\n        setIsEditingPrompt(false);\n      }\n    }\n  };\n\n  const handlePromptEdit = () => {\n    setIsEditingPrompt(true);\n  };\n\n  const handlePromptSave = () => {\n    setIsEditingPrompt(false);\n  };\n\n  const getRandomPrompt = () => {\n    const allPrompts = getAllAvailablePrompts();\n    const randomIndex = Math.floor(Math.random() * allPrompts.length);\n    setCurrentPrompt(allPrompts[randomIndex]);\n  };\n\n  // Load the article if needed\n  useEffect(() => {\n    if (initialHtml || article) return;\n\n    const fetchArticle = async () => {\n      try {\n        setIsLoading(true);\n        const articleData = await getArticle(articleId);\n\n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n\n        let content = '';\n        if (typeof articleData.content === 'string') {\n          content = articleData.content;\n        } else {\n          content = articleData.content.map(p => `<p>${p.text}</p>`).join('\\n');\n        }\n\n        const cleanHtml = content\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n\n        setArticle({\n          title: articleData.title,\n          body: cleanHtml\n        });\n\n      } catch (error) {\n        console.error('Error loading article:', error);\n        setError('Failed to load article');\n      } finally {\n        setIsLoading(false);\n      }\n    };\n\n    fetchArticle();\n  }, [articleId, article, initialHtml]);\n\n  // Get the content to display\n  const getContentToDisplay = () => {\n    if (initialHtml) {\n      return initialHtml\n        .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n        .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '');\n    }\n    return article?.body || '';\n  };\n\n  if (isLoading) {\n    return (\n      <div className={styles.loadingContainer}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className={styles.errorContainer}>\n        <p className={styles.errorMessage}>{error}</p>\n      </div>\n    );\n  }\n\n  return (\n    <HighlightProvider articleId={articleId}>\n      <ClientSideHighlighter />\n      <article className={styles.articleContainer}>\n        {/* Reflection Settings */}\n        <div style={{ \n          display: 'flex', \n          justifyContent: 'space-between', \n          alignItems: 'center', \n          gap: '1rem', \n          margin: '1rem 0',\n          padding: '1rem',\n          background: 'linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)',\n          borderRadius: '20px',\n          border: '1px solid rgba(255, 255, 255, 0.5)',\n          boxShadow: '0 8px 32px rgba(0, 0, 0, 0.1)',\n          fontSize: '0.875rem'\n        }}>\n          <div style={{ display: 'flex', alignItems: 'center', gap: '1rem' }}>\n            <span style={{ \n              color: '#475569',\n              fontWeight: '600',\n              background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n              WebkitBackgroundClip: 'text',\n              WebkitTextFillColor: 'transparent',\n              backgroundClip: 'text'\n            }}>\n               Reflections saved: {reflectionCount}\n            </span>\n          </div>\n          \n          <div style={{ display: 'flex', alignItems: 'center', gap: '0.5rem' }}>\n            <span style={{ color: '#64748b', fontWeight: '500' }}>\n              Interactive Reflections\n            </span>\n            <button\n              onClick={() => setReflectionsEnabled(!reflectionsEnabled)}\n              style={{\n                padding: '0.6rem 1.2rem',\n                border: 'none',\n                background: reflectionsEnabled \n                  ? 'linear-gradient(135deg, #3b82f6, #8b5cf6)' \n                  : 'linear-gradient(135deg, #e2e8f0, #cbd5e1)',\n                color: reflectionsEnabled ? 'white' : '#64748b',\n                borderRadius: '25px',\n                fontSize: '0.75rem',\n                fontWeight: '600',\n                cursor: 'pointer',\n                transition: 'all 0.3s ease',\n                boxShadow: reflectionsEnabled \n                  ? '0 4px 15px rgba(59, 130, 246, 0.4)' \n                  : '0 2px 8px rgba(0, 0, 0, 0.1)',\n                transform: 'scale(1)'\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.transform = 'scale(1.05)';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.transform = 'scale(1)';\n              }}\n            >\n              {reflectionsEnabled ? 'ON' : 'OFF'}\n            </button>\n          </div>\n        </div>\n\n        <ArticleHighlights articleId={articleId} onShare={handleShare}>\n          <div className={styles.articleContent}>\n            {/* Original article content with preserved formatting */}\n            <div \n              ref={articleContainerRef}\n              dangerouslySetInnerHTML={{ __html: getContentToDisplay() }}\n            />\n          </div>\n          \n          {/* Elegant Floating Reflection Button */}\n          {reflectionsEnabled && (\n            <button\n              onClick={toggleReflectionPanel}\n              style={{\n                position: 'fixed',\n                bottom: '40px',\n                right: '40px',\n                width: '56px',\n                height: '56px',\n                borderRadius: '50%',\n                background: showReflectionPanel \n                  ? 'linear-gradient(135deg, #1d4ed8, #7c3aed)' \n                  : 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n                border: 'none',\n                boxShadow: showReflectionPanel\n                  ? '0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)'\n                  : '0 6px 20px rgba(59, 130, 246, 0.3)',\n                cursor: 'pointer',\n                zIndex: 1000,\n                transition: 'all 0.3s cubic-bezier(0.4, 0, 0.2, 1)',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                fontSize: '18px',\n                transform: showReflectionPanel ? 'scale(1.05)' : 'scale(1)',\n                backdropFilter: 'blur(10px)',\n              }}\n              onMouseEnter={(e) => {\n                e.currentTarget.style.transform = 'scale(1.1)';\n                e.currentTarget.style.boxShadow = '0 8px 30px rgba(59, 130, 246, 0.5), 0 0 0 3px rgba(59, 130, 246, 0.3)';\n              }}\n              onMouseLeave={(e) => {\n                e.currentTarget.style.transform = showReflectionPanel ? 'scale(1.05)' : 'scale(1)';\n                e.currentTarget.style.boxShadow = showReflectionPanel\n                  ? '0 8px 25px rgba(59, 130, 246, 0.4), 0 0 0 2px rgba(59, 130, 246, 0.2)'\n                  : '0 6px 20px rgba(59, 130, 246, 0.3)';\n              }}\n              title={showReflectionPanel ? \"Close reflection\" : \"Open reflection\"}\n            >\n              {showReflectionPanel ? '' : ''}\n            </button>\n          )}\n\n          {/* Custom Floating Reflection Panel */}\n          {showReflectionPanel && reflectionsEnabled && (\n            <div style={{\n              position: 'fixed',\n              bottom: '110px',\n              right: '40px',\n              width: '380px',\n              maxHeight: '500px',\n              background: 'rgba(255, 255, 255, 0.95)',\n              backdropFilter: 'blur(20px)',\n              borderRadius: '24px',\n              boxShadow: '0 20px 60px rgba(0, 0, 0, 0.15), 0 0 0 1px rgba(255, 255, 255, 0.2)',\n              border: '1px solid rgba(255, 255, 255, 0.3)',\n              zIndex: 999,\n              animation: 'gentleSlideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1)',\n              padding: '24px',\n              overflow: 'hidden'\n            }}>\n              <style>\n                {`\n                  @keyframes gentleSlideUp {\n                    from {\n                      opacity: 0;\n                      transform: translateY(20px) scale(0.98);\n                    }\n                    to {\n                      opacity: 1;\n                      transform: translateY(0) scale(1);\n                    }\n                  }\n                `}\n              </style>\n              \n              {/* Gradient overlay */}\n              <div style={{\n                position: 'absolute',\n                top: 0,\n                left: 0,\n                right: 0,\n                height: '80px',\n                background: 'linear-gradient(135deg, rgba(59, 130, 246, 0.08), rgba(139, 92, 246, 0.08))',\n                borderRadius: '24px 24px 0 0',\n                zIndex: -1\n              }} />\n              \n              {/* Header */}\n              <div style={{\n                marginBottom: '20px',\n                textAlign: 'center'\n              }}>\n                <h3 style={{\n                  margin: '0 0 12px 0',\n                  fontSize: '16px',\n                  fontWeight: '600',\n                  background: 'linear-gradient(135deg, #3b82f6, #8b5cf6)',\n                  WebkitBackgroundClip: 'text',\n                  WebkitTextFillColor: 'transparent',\n                  backgroundClip: 'text'\n                }}>\n                  Time to Reflect \n                </h3>\n                \n                {/* Editable Prompt */}\n                <div style={{ position: 'relative' }}>\n                  {isEditingPrompt ? (\n                    <input\n                      type=\"text\"\n                      value={currentPrompt}\n                      onChange={(e) => setCurrentPrompt(e.target.value)}\n                      onBlur={handlePromptSave}\n                      onKeyDown={(e) => {\n                        if (e.key === 'Enter') handlePromptSave();\n                        if (e.key === 'Escape') {\n                          setCurrentPrompt(getDefaultPrompt());\n                          setIsEditingPrompt(false);\n                        }\n                      }}\n                      autoFocus\n                      style={{\n                        width: '100%',\n                        padding: '8px 12px',\n                        border: '2px solid #3b82f6',\n                        borderRadius: '12px',\n                        background: 'white',\n                        fontSize: '14px',\n                        textAlign: 'center',\n                        outline: 'none'\n                      }}\n                    />\n                  ) : (\n                    <div style={{\n                      display: 'flex',\n                      alignItems: 'center',\n                      justifyContent: 'center',\n                      gap: '8px',\n                      flexWrap: 'wrap'\n                    }}>\n                      <p \n                        onClick={handlePromptEdit}\n                        style={{\n                          margin: 0,\n                          fontSize: '14px',\n                          color: '#64748b',\n                          fontWeight: '500',\n                          cursor: 'pointer',\n                          padding: '4px 8px',\n                          borderRadius: '8px',\n                          transition: 'all 0.2s ease'\n                        }}\n                        onMouseEnter={(e) => {\n                          e.currentTarget.style.background = 'rgba(59, 130, 246, 0.1)';\n                          e.currentTarget.style.color = '#3b82f6';\n                        }}\n                        onMouseLeave={(e) => {\n                          e.currentTarget.style.background = 'transparent';\n                          e.currentTarget.style.color = '#64748b';\n                        }}\n                        title=\"Click to edit question\"\n                      >\n                        {currentPrompt}\n                      </p>\n                      <button\n                        onClick={getRandomPrompt}\n                        style={{\n                          background: 'rgba(59, 130, 246, 0.1)',\n                          border: 'none',\n                          borderRadius: '6px',\n                          padding: '4px 8px',\n                          fontSize: '12px',\n                          color: '#3b82f6',\n                          cursor: 'pointer',\n                          fontWeight: '500'\n                        }}\n                        title=\"Get different question\"\n                      >\n                        \n                      </button>\n                    </div>\n                  )}\n                </div>\n              </div>\n\n              {/* Reflection Input */}\n              <textarea\n                value={currentReflection}\n                onChange={(e) => setCurrentReflection(e.target.value)}\n                placeholder=\"Share your thoughts...\"\n                style={{\n                  width: '100%',\n                  height: '120px',\n                  padding: '16px',\n                  border: '2px solid transparent',\n                  borderRadius: '16px',\n                  background: 'rgba(248, 250, 252, 0.8)',\n                  fontSize: '14px',\n                  fontFamily: 'inherit',\n                  resize: 'none',\n                  outline: 'none',\n                  transition: 'all 0.3s ease',\n                  boxShadow: 'inset 0 2px 8px rgba(0, 0, 0, 0.05)',\n                  marginBottom: '20px'\n                }}\n                onFocus={(e) => {\n                  e.target.style.borderColor = '#3b82f6';\n                  e.target.style.background = 'rgba(255, 255, 255, 0.9)';\n                  e.target.style.boxShadow = 'inset 0 2px 8px rgba(0, 0, 0, 0.05), 0 0 0 3px rgba(59, 130, 246, 0.1)';\n                }}\n                onBlur={(e) => {\n                  e.target.style.borderColor = 'transparent';\n                  e.target.style.background = 'rgba(248, 250, 252, 0.8)';\n                  e.target.style.boxShadow = 'inset 0 2px 8px rgba(0, 0, 0, 0.05)';\n                }}\n              />\n\n              {/* Action Buttons */}\n              <div style={{\n                display: 'flex',\n                gap: '12px',\n                justifyContent: 'flex-end'\n              }}>\n                <button\n                  onClick={() => setShowReflectionPanel(false)}\n                  style={{\n                    padding: '10px 18px',\n                    border: 'none',\n                    borderRadius: '16px',\n                    background: 'rgba(148, 163, 184, 0.2)',\n                    color: '#64748b',\n                    fontSize: '14px',\n                    fontWeight: '600',\n                    cursor: 'pointer',\n                    transition: 'all 0.2s ease'\n                  }}\n                  onMouseEnter={(e) => {\n                    e.currentTarget.style.background = 'rgba(148, 163, 184, 0.3)';\n                  }}\n                  onMouseLeave={(e) => {\n                    e.currentTarget.style.background = 'rgba(148, 163, 184, 0.2)';\n                  }}\n                >\n                  Skip\n                </button>\n                <button\n                  onClick={handleReflectionSubmit}\n                  disabled={!currentReflection.trim() || isSubmitting}\n                  style={{\n                    padding: '10px 20px',\n                    border: 'none',\n                    borderRadius: '16px',\n                    background: currentReflection.trim() \n                      ? 'linear-gradient(135deg, #3b82f6, #8b5cf6)' \n                      : 'rgba(148, 163, 184, 0.3)',\n                    color: 'white',\n                    fontSize: '14px',\n                    fontWeight: '600',\n                    cursor: currentReflection.trim() ? 'pointer' : 'not-allowed',\n                    transition: 'all 0.3s ease',\n                    boxShadow: currentReflection.trim() \n                      ? '0 4px 15px rgba(59, 130, 246, 0.4)' \n                      : 'none',\n                    opacity: isSubmitting ? 0.7 : 1\n                  }}\n                  onMouseEnter={(e) => {\n                    if (currentReflection.trim() && !isSubmitting) {\n                      e.currentTarget.style.transform = 'translateY(-1px)';\n                      e.currentTarget.style.boxShadow = '0 6px 20px rgba(59, 130, 246, 0.5)';\n                    }\n                  }}\n                  onMouseLeave={(e) => {\n                    e.currentTarget.style.transform = 'translateY(0)';\n                    e.currentTarget.style.boxShadow = currentReflection.trim() \n                      ? '0 4px 15px rgba(59, 130, 246, 0.4)' \n                      : 'none';\n                  }}\n                >\n                  {isSubmitting ? 'Saving...' : 'Save Reflection'}\n                </button>\n              </div>\n            </div>\n          )}\n        </ArticleHighlights>\n      </article>\n    </HighlightProvider>\n  );\n};\n\nexport default ArticleWithHighlights; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3196, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/firebase/articles.ts"],"sourcesContent":["import { collection, addDoc, getDocs, getDoc, doc, query, orderBy, Timestamp, where, DocumentData, DocumentSnapshot, deleteDoc, updateDoc, arrayUnion, arrayRemove, limit as firestoreLimit, QueryConstraint } from 'firebase/firestore';\nimport { db, auth } from './clientApp';\nimport { createCommentNotification } from './notifications';\n\n// Article interface matching our Firestore structure\nexport interface Article {\n    id?: string;\n    title: string;\n    body: string;\n    createdAt: Timestamp;\n    updatedAt?: Timestamp;\n    authorId: string;\n    authorName: string;\n    tags?: string[];\n    coverImage?: string | null;\n    slug?: string;\n    status?: 'published' | 'drafts';\n    likes?: string[];\n    excerpt?: string;\n    viewCount?: number;\n    reposts?: string[];\n    comments?: any[];\n}\n\n// Comment interfaces for Firestore\nexport interface ArticleComment {\n    id?: string;\n    commentId?: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n    replies: CommentReply[];\n}\n\nexport interface CommentReply {\n    replyId: string;\n    userId: string;\n    userName: string;\n    content: string;\n    createdAt: Timestamp;\n    likes: string[];\n}\n\n// Get articles from Firestore, ordered by createdAt desc, with optional limit and draft inclusion\nexport async function getArticles(options: { limit?: number; includeDrafts?: boolean } = {}) {\n    const { limit, includeDrafts = false } = options;\n    console.log('getArticles called with limit:', limit);\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints = [];\n\n        if (!includeDrafts) {\n            // If status is explicitly 'published' OR if status field does not exist (older data might not have it)\n            // Firestore doesn't easily support \"OR\" across different fields or \"field not exists\" in combination with other `where` on same field.\n            // A common approach is to ensure all articles have a status.\n            // For now, we'll explicitly query for 'published'. If you need to include articles where 'status' is undefined\n            // as 'published', you might need two separate queries or adjust your data model to always include a 'status'.\n            queryConstraints.push(where('status', '==', 'published'));\n        }\n        // Always order by creation date\n        queryConstraints.push(orderBy('createdAt', 'desc'));\n\n        if (limit && limit > 0) {\n            console.log('Adding limit constraint:', limit);\n            queryConstraints.push(firestoreLimit(limit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n        console.log('Query returned document count:', querySnapshot.size);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            const articleData = docSnapshot.data() as Omit<Article, 'id'>;\n\n            // The query now handles filtering for published status if includeDrafts is false.\n            // If includeDrafts is true, no status filter is applied in the query.\n            articles.push({\n                id: docSnapshot.id,\n                ...articleData\n            });\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles:', error);\n        throw error;\n    }\n}\n\n// Get a single article by ID - DIRECT NO-CACHE VERSION\nexport async function getArticleById(id: string): Promise<Article | null> {\n    try {\n        // Super aggressive cache-busting\n        const timestamp = Date.now();\n        console.log(` DIRECT FETCH: Getting article with ID: ${id} (time: ${timestamp})`);\n\n        // Completely bypass any caching by making a direct Firestore call\n        const docRef = doc(db, 'articles', id);\n\n        // Direct Firestore fetch with no caching\n\n        // Get fresh data directly\n        const docSnap = await getDoc(docRef);\n\n        if (docSnap.exists()) {\n            const articleData = {\n                id: docSnap.id,\n                ...docSnap.data()\n            } as Article;\n\n            console.log(' Article found:', articleData.title);\n            console.log(' Content length:', articleData.body?.length || 0);\n            console.log(' Tags:', articleData.tags?.join(', ') || 'none');\n\n            // Return fresh data\n            return articleData;\n        } else {\n            console.log(' Article not found for ID:', id);\n            return null;\n        }\n    } catch (error) {\n        console.error(' Error getting article:', error);\n        throw error;\n    }\n}\n\n// Get a single article by slug\nexport async function getArticleBySlug(slug: string): Promise<Article | null> {\n    try {\n        console.log(`Getting article by slug: ${slug}, timestamp: ${Date.now()}`);\n\n        // Try multiple attempts to get fresh data\n        let attempts = 0;\n        const maxAttempts = 2;\n\n        while (attempts < maxAttempts) {\n            attempts++;\n            console.log(`Attempt ${attempts} to get article by slug`);\n\n            // Short delay between attempts\n            if (attempts > 1) {\n                await new Promise(resolve => setTimeout(resolve, 500));\n            }\n\n            const articlesRef = collection(db, 'articles');\n            const q = query(articlesRef, where('slug', '==', slug), where('status', '==', 'published'));\n            const querySnapshot = await getDocs(q);\n\n            if (!querySnapshot.empty) {\n                const docSnap = querySnapshot.docs[0];\n                const articleData = {\n                    id: docSnap.id,\n                    ...docSnap.data()\n                } as Article;\n\n                console.log('Article found by slug:', articleData.title, 'Content length:', articleData.body?.length || 0);\n                return articleData;\n            } else if (attempts >= maxAttempts) {\n                console.log('Article not found for slug after multiple attempts:', slug);\n                return null;\n            }\n\n            console.log(`Article not found by slug on attempt ${attempts}, will retry...`);\n        }\n\n        return null;\n    } catch (error) {\n        console.error('Error getting article by slug:', error);\n        throw error;\n    }\n}\n\n// Create a new article\nexport async function createArticle(articleInput: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>> & { title: string; body: string; }) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to create an article');\n        }\n\n        const newArticleData: Omit<Article, 'id'> = {\n            title: articleInput.title,\n            body: articleInput.body,\n            slug: articleInput.slug || articleInput.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, ''),\n            createdAt: Timestamp.now(),\n            authorId: user.uid,\n            authorName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            tags: articleInput.tags || [],\n            status: articleInput.status || 'published',\n            coverImage: articleInput.coverImage || null,\n            likes: [],\n            excerpt: articleInput.excerpt || '',\n            viewCount: 0,\n            reposts: [],\n            comments: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles'), newArticleData);\n        return {\n            id: docRef.id,\n            ...newArticleData\n        } as Article;\n    } catch (error) {\n        console.error('Error creating article:', error);\n        throw error;\n    }\n}\n\n// Update an existing article\nexport async function updateArticle(articleId: string, articleData: Partial<Omit<Article, 'id' | 'createdAt' | 'authorId' | 'authorName'>>) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to edit an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleSnap = await getDoc(articleRef);\n\n        if (!articleSnap.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const existingArticleData = articleSnap.data() as Article;\n        if (existingArticleData.authorId !== user.uid) {\n            throw new Error('You can only edit your own articles');\n        }\n\n        const updateData: Partial<Article> = { ...articleData };\n\n        // Always update slug when title changes to ensure published articles reflect changes\n        if (articleData.title) {\n            updateData.slug = articleData.title\n                .toLowerCase()\n                .replace(/[\\s\\W-]+/g, '-')\n                .replace(/^-+|-+$/g, '');\n            console.log('Updated slug to:', updateData.slug);\n        }\n        updateData.updatedAt = Timestamp.now();\n\n        await updateDoc(articleRef, updateData);\n\n        const updatedArticleSnap = await getDoc(articleRef);\n        return {\n            id: updatedArticleSnap.id,\n            ...updatedArticleSnap.data()\n        } as Article;\n    } catch (error) {\n        console.error('Error updating article:', error);\n        throw error;\n    }\n}\n\n// Comments functions\nexport async function getArticleComments(articleId: string) {\n    try {\n        const commentsRef = collection(db, 'articles', articleId, 'comments');\n        const q = query(commentsRef, orderBy('createdAt', 'desc'));\n        const querySnapshot = await getDocs(q);\n\n        const comments: ArticleComment[] = [];\n        querySnapshot.forEach((doc) => {\n            const commentData = doc.data() as Omit<ArticleComment, 'id' | 'commentId'>;\n            comments.push({\n                id: doc.id,\n                commentId: doc.id,\n                ...commentData,\n                replies: commentData.replies || []\n            });\n        });\n\n        return comments;\n    } catch (error) {\n        console.error('Error getting comments:', error);\n        throw error;\n    }\n}\n\nexport async function addComment(articleId: string, content: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to comment');\n        }\n\n        const newComment: Omit<ArticleComment, 'id' | 'commentId'> = {\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: [],\n            replies: []\n        };\n\n        const docRef = await addDoc(collection(db, 'articles', articleId, 'comments'), newComment);\n\n        const articleInfoForNotification = await getArticleById(articleId);\n        if (articleInfoForNotification && articleInfoForNotification.authorId !== user.uid) {\n            await createCommentNotification(\n                articleInfoForNotification.authorId,\n                articleId,\n                articleInfoForNotification.slug || '',\n                articleInfoForNotification.title || 'Article',\n                docRef.id,\n                content\n            );\n        }\n\n        return {\n            id: docRef.id,\n            commentId: docRef.id,\n            ...newComment\n        } as ArticleComment;\n    } catch (error) {\n        console.error('Error adding comment:', error);\n        throw error;\n    }\n}\n\nexport async function addReply(articleId: string, commentId: string, content: string): Promise<CommentReply> {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to reply');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const newReply: CommentReply = {\n            replyId: Math.random().toString(36).substring(2, 15),\n            userId: user.uid,\n            userName: user.displayName || user.email?.split('@')[0] || 'Anonymous',\n            content,\n            createdAt: Timestamp.now(),\n            likes: []\n        };\n\n        await updateDoc(commentRef, {\n            replies: arrayUnion(newReply)\n        });\n\n        const commentData = commentSnap.data() as ArticleComment;\n        if (commentData.userId !== user.uid) {\n            const articleInfo = await getArticleById(articleId);\n            console.log(`User ${user.uid} replied to comment ${commentId} by ${commentData.userId} on article ${articleInfo?.title}`);\n        }\n\n        return newReply;\n    } catch (error) {\n        console.error('Error adding reply:', error);\n        throw error;\n    }\n}\n\nexport async function likeComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to like a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n        const userId = user.uid;\n\n        const likes = commentData.likes || [];\n        const hasLiked = likes.includes(userId);\n\n        await updateDoc(commentRef, {\n            likes: hasLiked ? arrayRemove(userId) : arrayUnion(userId)\n        });\n\n        const updatedSnap = await getDoc(commentRef);\n        const updatedData = updatedSnap.data() as ArticleComment;\n\n        return {\n            success: true,\n            action: hasLiked ? 'unliked' : 'liked',\n            likes: updatedData.likes,\n            count: updatedData.likes.length\n        };\n    } catch (error) {\n        console.error('Error liking comment:', error);\n        throw error;\n    }\n}\n\nexport async function deleteComment(articleId: string, commentId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete a comment');\n        }\n\n        const commentRef = doc(db, 'articles', articleId, 'comments', commentId);\n        const commentSnap = await getDoc(commentRef);\n\n        if (!commentSnap.exists()) {\n            throw new Error('Comment not found');\n        }\n\n        const commentData = commentSnap.data() as ArticleComment;\n\n        if (commentData.userId !== user.uid) {\n            throw new Error('You can only delete your own comments');\n        }\n\n        await deleteDoc(commentRef);\n\n        return {\n            success: true,\n            message: 'Comment deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting comment:', error);\n        throw error;\n    }\n}\n\n// Delete an article\nexport async function deleteArticle(articleId: string) {\n    try {\n        const user = auth.currentUser;\n        if (!user) {\n            throw new Error('You must be logged in to delete an article');\n        }\n\n        const articleRef = doc(db, 'articles', articleId);\n        const articleDoc = await getDoc(articleRef);\n\n        if (!articleDoc.exists()) {\n            throw new Error('Article not found');\n        }\n\n        const articleData = articleDoc.data() as Article;\n\n        if (articleData.authorId !== user.uid) {\n            throw new Error('You can only delete your own articles');\n        }\n\n        await deleteDoc(articleRef);\n\n        return {\n            success: true,\n            message: 'Article deleted successfully'\n        };\n    } catch (error) {\n        console.error('Error deleting article:', error);\n        throw error;\n    }\n}\n\n// Get articles by tag\nexport async function getArticlesByTag(tag: string, options: { limit?: number } = {}) {\n    const { limit: queryLimit } = options;\n    try {\n        const articlesRef = collection(db, 'articles');\n        const queryConstraints: QueryConstraint[] = [\n            where('tags', 'array-contains', tag),\n            where('status', '==', 'published'),\n            orderBy('createdAt', 'desc')\n        ];\n\n        if (queryLimit && queryLimit > 0) {\n            queryConstraints.push(firestoreLimit(queryLimit));\n        }\n\n        const q = query(articlesRef, ...queryConstraints);\n        const querySnapshot = await getDocs(q);\n\n        const articles: Article[] = [];\n        querySnapshot.forEach((docSnapshot) => {\n            articles.push({\n                id: docSnapshot.id,\n                ...docSnapshot.data()\n            } as Article);\n        });\n\n        return articles;\n    } catch (error) {\n        console.error('Error getting articles by tag:', error);\n        throw error;\n    }\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3587, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/comment.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"commentActions\": \"comment-module__H_rXLG__commentActions\",\n  \"commentAvatar\": \"comment-module__H_rXLG__commentAvatar\",\n  \"commentContent\": \"comment-module__H_rXLG__commentContent\",\n  \"commentDate\": \"comment-module__H_rXLG__commentDate\",\n  \"commentDeleteBtn\": \"comment-module__H_rXLG__commentDeleteBtn\",\n  \"commentError\": \"comment-module__H_rXLG__commentError\",\n  \"commentForm\": \"comment-module__H_rXLG__commentForm\",\n  \"commentHeader\": \"comment-module__H_rXLG__commentHeader\",\n  \"commentInput\": \"comment-module__H_rXLG__commentInput\",\n  \"commentInputContainer\": \"comment-module__H_rXLG__commentInputContainer\",\n  \"commentItem\": \"comment-module__H_rXLG__commentItem\",\n  \"commentLikeBtn\": \"comment-module__H_rXLG__commentLikeBtn\",\n  \"commentLoading\": \"comment-module__H_rXLG__commentLoading\",\n  \"commentSection\": \"comment-module__H_rXLG__commentSection\",\n  \"commentSectionTitle\": \"comment-module__H_rXLG__commentSectionTitle\",\n  \"commentSubmit\": \"comment-module__H_rXLG__commentSubmit\",\n  \"commentUser\": \"comment-module__H_rXLG__commentUser\",\n  \"commentsList\": \"comment-module__H_rXLG__commentsList\",\n  \"inThread\": \"comment-module__H_rXLG__inThread\",\n  \"liked\": \"comment-module__H_rXLG__liked\",\n  \"loadingDot\": \"comment-module__H_rXLG__loadingDot\",\n  \"loadingDots\": \"comment-module__H_rXLG__loadingDots\",\n  \"loginButton\": \"comment-module__H_rXLG__loginButton\",\n  \"loginModal\": \"comment-module__H_rXLG__loginModal\",\n  \"loginModalButton\": \"comment-module__H_rXLG__loginModalButton\",\n  \"loginModalButtons\": \"comment-module__H_rXLG__loginModalButtons\",\n  \"loginModalClose\": \"comment-module__H_rXLG__loginModalClose\",\n  \"loginModalOverlay\": \"comment-module__H_rXLG__loginModalOverlay\",\n  \"loginModalText\": \"comment-module__H_rXLG__loginModalText\",\n  \"loginModalTitle\": \"comment-module__H_rXLG__loginModalTitle\",\n  \"loginPromptContainer\": \"comment-module__H_rXLG__loginPromptContainer\",\n  \"noComments\": \"comment-module__H_rXLG__noComments\",\n  \"open\": \"comment-module__H_rXLG__open\",\n  \"primary\": \"comment-module__H_rXLG__primary\",\n  \"pulse\": \"comment-module__H_rXLG__pulse\",\n  \"repliesToggle\": \"comment-module__H_rXLG__repliesToggle\",\n  \"repliesToggleIcon\": \"comment-module__H_rXLG__repliesToggleIcon\",\n  \"replyAvatar\": \"comment-module__H_rXLG__replyAvatar\",\n  \"replyButtons\": \"comment-module__H_rXLG__replyButtons\",\n  \"replyCancel\": \"comment-module__H_rXLG__replyCancel\",\n  \"replyContent\": \"comment-module__H_rXLG__replyContent\",\n  \"replyDate\": \"comment-module__H_rXLG__replyDate\",\n  \"replyForm\": \"comment-module__H_rXLG__replyForm\",\n  \"replyHeader\": \"comment-module__H_rXLG__replyHeader\",\n  \"replyInput\": \"comment-module__H_rXLG__replyInput\",\n  \"replyItem\": \"comment-module__H_rXLG__replyItem\",\n  \"replySection\": \"comment-module__H_rXLG__replySection\",\n  \"replySubmit\": \"comment-module__H_rXLG__replySubmit\",\n  \"replyToggle\": \"comment-module__H_rXLG__replyToggle\",\n  \"replyUser\": \"comment-module__H_rXLG__replyUser\",\n  \"secondary\": \"comment-module__H_rXLG__secondary\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 3646, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/CommentSection.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport Link from 'next/link';\nimport { auth } from '@/firebase/clientApp';\nimport { onAuthStateChanged } from 'firebase/auth';\nimport { \n  getArticleComments, \n  addComment, \n  addReply,\n  likeComment,\n  deleteComment,\n  getArticleBySlug,\n  ArticleComment as FirestoreComment,\n  CommentReply as FirestoreReply\n} from '@/firebase/articles';\nimport styles from '@/styles/comment.module.css';\n\ninterface CommentSectionProps {\n  articleId: string;\n  slug?: string; // Keep slug as optional for backward compatibility\n  isComplex?: boolean; // New prop for article type\n}\n\nconst CommentSection: React.FC<CommentSectionProps> = ({ slug, articleId: propArticleId, isComplex }) => {\n  const [comments, setComments] = useState<FirestoreComment[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState('');\n  const [newComment, setNewComment] = useState('');\n  const [submitting, setSubmitting] = useState(false);\n  const [focusState, setFocusState] = useState(false);\n  const [replyingTo, setReplyingTo] = useState<string | null>(null);\n  const [replyContent, setReplyContent] = useState('');\n  const [submittingReply, setSubmittingReply] = useState(false);\n  const [expandedReplies, setExpandedReplies] = useState<Record<string, boolean>>({});\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [showLoginPrompt, setShowLoginPrompt] = useState(false);\n  const [articleId, setArticleId] = useState<string | null>(propArticleId || null);\n  \n  // This user object will be updated when authenticated\n  const [currentUser, setCurrentUser] = useState({ id: '', name: 'Reader' });\n\n  useEffect(() => {\n    // Check authentication status\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      const isAuth = !!user;\n      setIsAuthenticated(isAuth);\n      \n      if (isAuth && user) {\n        setCurrentUser({\n          id: user.uid,\n          name: user.displayName || user.email?.split('@')[0] || 'User'\n        });\n      } else {\n        setCurrentUser({ id: '', name: 'Reader' });\n      }\n    });\n    \n    return () => unsubscribe();\n  }, []);\n\n  // First, get the article ID from the slug if not provided directly\n  useEffect(() => {\n    if (propArticleId) {\n      setArticleId(propArticleId);\n      return;\n    }\n    \n    if (!slug) return;\n\n    const fetchArticleId = async () => {\n      try {\n        const article = await getArticleBySlug(slug);\n        if (article && article.id) {\n          setArticleId(article.id);\n        }\n      } catch (err) {\n        console.error('Error fetching article:', err);\n        setError('Unable to load article details.');\n      }\n    };\n\n    fetchArticleId();\n  }, [slug, propArticleId]);\n\n  // Then, fetch comments when we have the articleId\n  useEffect(() => {\n    if (!articleId) return;\n    \n    setLoading(true);\n    const fetchComments = async () => {\n      try {\n        const commentsData = await getArticleComments(articleId);\n        \n        // Add a small delay to show loading animation\n        setTimeout(() => {\n          setComments(commentsData);\n          setLoading(false);\n        }, 800);\n      } catch (err) {\n        console.error('Error fetching comments:', err);\n        setError('Unable to load discussions. Please refresh the page to try again.');\n        setLoading(false);\n      }\n    };\n\n    fetchComments();\n  }, [articleId]);\n\n  const handleCommentSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    if (!newComment.trim() || submitting || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmitting(true);\n      const comment = await addComment(articleId, newComment);\n      setComments(prev => [comment, ...prev]);\n      setNewComment('');\n      setSubmitting(false);\n      setFocusState(false); // Reset focus state after submission\n    } catch (err) {\n      console.error('Error adding comment:', err);\n      setError('Your response could not be posted. Please try again.');\n      setSubmitting(false);\n    }\n  };\n\n  const handleReplySubmit = async (commentId: string) => {\n    if (!replyContent.trim() || submittingReply || !articleId) return;\n    \n    if (!isAuthenticated) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      setSubmittingReply(true);\n      const reply = await addReply(articleId, commentId, replyContent);\n      \n      // Update the local state with the new reply\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { \n                ...comment, \n                replies: [...(comment.replies || []), reply]\n              }\n            : comment\n        )\n      );\n      \n      // Reset reply state\n      setReplyContent('');\n      setReplyingTo(null);\n      setSubmittingReply(false);\n      \n      // Ensure replies for this comment are expanded\n      setExpandedReplies(prev => ({\n        ...prev,\n        [commentId]: true\n      }));\n    } catch (err) {\n      console.error('Error adding reply:', err);\n      setSubmittingReply(false);\n    }\n  };\n\n  const handleLikeComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      setShowLoginPrompt(true);\n      return;\n    }\n    \n    try {\n      const result = await likeComment(articleId, commentId);\n      \n      // Update local state\n      setComments(prev => \n        prev.map(comment => \n          comment.commentId === commentId || comment.id === commentId\n            ? { ...comment, likes: result.likes } \n            : comment\n        )\n      );\n    } catch (err) {\n      console.error('Error liking comment:', err);\n    }\n  };\n\n  const handleDeleteComment = async (commentId: string) => {\n    if (!isAuthenticated || !articleId) {\n      return;\n    }\n    \n    try {\n      await deleteComment(articleId, commentId);\n      \n      // Remove comment from local state\n      setComments(prev => \n        prev.filter(comment => \n          comment.commentId !== commentId && comment.id !== commentId\n        )\n      );\n    } catch (err) {\n      console.error('Error deleting comment:', err);\n    }\n  };\n\n  const toggleReplies = (commentId: string) => {\n    setExpandedReplies(prev => ({\n      ...prev,\n      [commentId]: !prev[commentId]\n    }));\n  };\n\n  // Helper to format dates\n  const formatDate = (timestamp: any) => {\n    if (!timestamp) return 'Unknown date';\n    \n    const date = timestamp.toDate ? timestamp.toDate() : new Date(timestamp);\n    const now = new Date();\n    const diffInSeconds = Math.floor((now.getTime() - date.getTime()) / 1000);\n    \n    // For recent dates, use relative time (which is less prone to hydration issues)\n    if (diffInSeconds < 60) {\n      return 'Just now';\n    } else if (diffInSeconds < 3600) {\n      const minutes = Math.floor(diffInSeconds / 60);\n      return `${minutes} ${minutes === 1 ? 'minute' : 'minutes'} ago`;\n    } else if (diffInSeconds < 86400) {\n      const hours = Math.floor(diffInSeconds / 3600);\n      return `${hours} ${hours === 1 ? 'hour' : 'hours'} ago`;\n    } else if (diffInSeconds < 604800) {\n      const days = Math.floor(diffInSeconds / 86400);\n      return `${days} ${days === 1 ? 'day' : 'days'} ago`;\n    } else {\n      // Use consistent UTC timezone and locale for older dates\n      try {\n        const options: Intl.DateTimeFormatOptions = { \n          year: 'numeric', \n          month: 'short', \n          day: 'numeric',\n          timeZone: 'UTC'\n        };\n        \n        return date.toLocaleDateString('en-US', options);\n      } catch (error) {\n        console.error('Error formatting date:', error);\n        return 'Unknown date';\n      }\n    }\n  };\n\n  // Generate a user avatar with initial\n  const getUserAvatar = (name: string, userId: string, isReply = false) => {\n    const initial = name?.charAt(0).toUpperCase() || 'A';\n    const colors = ['#4f46e5', '#0ea5e9', '#10b981', '#f59e0b', '#ef4444'];\n    const colorIndex = userId ? Math.abs(userId.charCodeAt(0) % colors.length) : 0;\n    const bgColor = colors[colorIndex];\n    \n    return (\n      <div \n        className={isReply ? styles.replyAvatar : styles.commentAvatar} \n        style={{ \n          backgroundColor: bgColor, \n          display: 'flex', \n          alignItems: 'center', \n          justifyContent: 'center',\n          color: 'white',\n          fontWeight: 'bold',\n          fontSize: isReply ? '0.9rem' : '1.2rem'\n        }}\n      >\n        {initial}\n      </div>\n    );\n  };\n\n  return (\n    <section className={styles.commentSection}>\n      <h2 className={styles.commentSectionTitle}>\n        Join the Discussion\n      </h2>\n      \n      {error && (\n        <div className={styles.commentError}>\n          <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\n            <circle cx=\"12\" cy=\"12\" r=\"10\"></circle>\n            <line x1=\"12\" y1=\"8\" x2=\"12\" y2=\"12\"></line>\n            <line x1=\"12\" y1=\"16\" x2=\"12.01\" y2=\"16\"></line>\n          </svg>\n          {error}\n        </div>\n      )}\n      \n      <form className={styles.commentForm} onSubmit={handleCommentSubmit}>\n        <div\n          className={styles.commentInputContainer}\n          style={{ opacity: focusState ? 1 : 0.85 }}\n        >\n          {isAuthenticated ? (\n            <>\n              <div className={styles.commentAvatar}>\n                {getUserAvatar(currentUser.name, currentUser.id)}\n              </div>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Share your thoughts...\"\n                value={newComment}\n                onChange={e => setNewComment(e.target.value)}\n                onFocus={() => setFocusState(true)}\n                onBlur={() => {\n                  if (!newComment.trim()) {\n                    setFocusState(false);\n                  }\n                }}\n              />\n              <button \n                className={styles.commentSubmit}\n                type=\"submit\" \n                disabled={!newComment.trim() || submitting}\n              >\n                {submitting ? 'Posting...' : 'Post'}\n              </button>\n            </>\n          ) : (\n            <div className={styles.loginPromptContainer} onClick={() => setShowLoginPrompt(true)}>\n              <textarea\n                className={styles.commentInput}\n                placeholder=\"Login to join the discussion...\"\n                disabled\n              />\n              <button\n                className={`${styles.commentSubmit} ${styles.loginButton}`}\n                type=\"button\"\n                onClick={() => setShowLoginPrompt(true)}\n              >\n                Login to comment\n              </button>\n            </div>\n          )}\n        </div>\n      </form>\n\n      {/* Login Prompt Modal */}\n      {showLoginPrompt && (\n        <div className={styles.loginModalOverlay} onClick={() => setShowLoginPrompt(false)}>\n          <div className={styles.loginModal} onClick={e => e.stopPropagation()}>\n            <button className={styles.loginModalClose} onClick={() => setShowLoginPrompt(false)}></button>\n            <h3 className={styles.loginModalTitle}>Join the conversation</h3>\n            <p className={styles.loginModalText}>\n              Sign in to Journalite to share your thoughts and join the discussion.\n            </p>\n            <div className={styles.loginModalButtons}>\n              <Link href=\"/login\" className={`${styles.loginModalButton} ${styles.primary}`}>\n                Log In\n              </Link>\n              <Link href=\"/register\" className={`${styles.loginModalButton} ${styles.secondary}`}>\n                Create Account\n              </Link>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {loading ? (\n        <div className={styles.commentLoading}>\n          <p>Loading comments...</p>\n          <div className={styles.loadingDots}>\n            <div className={styles.loadingDot}></div>\n            <div className={styles.loadingDot}></div>\n            <div className={styles.loadingDot}></div>\n          </div>\n        </div>\n      ) : comments.length === 0 ? (\n        <div className={styles.noComments}>\n          Be the first to share your thoughts on this article.\n        </div>\n      ) : (\n        <div className={styles.commentsList}>\n          {comments.map(comment => {\n            const commentId = comment.commentId || comment.id || '';\n            return (\n              <div key={commentId} className={styles.commentItem}>\n                <div className={styles.commentHeader}>\n                  {getUserAvatar(comment.userName, comment.userId)}\n                  <span className={styles.commentUser}>{comment.userName}</span>\n                  <span className={styles.commentDate}>{formatDate(comment.createdAt)}</span>\n                </div>\n                <div className={styles.commentContent}>\n                  {comment.content}\n                </div>\n                <div className={styles.commentActions}>\n                  <button \n                    className={`${styles.commentLikeBtn} ${comment.likes.includes(currentUser.id) ? styles.liked : ''}`}\n                    onClick={() => handleLikeComment(commentId)}\n                    aria-pressed={comment.likes.includes(currentUser.id)}\n                    aria-label={comment.likes.includes(currentUser.id) ? \"Unlike comment\" : \"Like comment\"}\n                  >\n                    {comment.likes.includes(currentUser.id) ? (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill=\"currentColor\" className=\"w-4 h-4\">\n                        <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\"/>\n                      </svg>\n                    ) : (\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z\" />\n                      </svg>\n                    )}\n                    <span>{comment.likes.length > 0 ? comment.likes.length : ''}</span>\n                  </button>\n                  \n                  <button \n                    className={styles.replyToggle}\n                    onClick={() => {\n                      if (isAuthenticated) {\n                        setReplyingTo(replyingTo === commentId ? null : commentId);\n                      } else {\n                        setShowLoginPrompt(true);\n                      }\n                    }}\n                    aria-label=\"Reply to comment\"\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M9 15L3 9m0 0l6-6M3 9h12a6 6 0 010 12h-3\" />\n                    </svg>\n                    <span>Reply</span>\n                  </button>\n                  \n                  {/* Only show delete button for the user's own comments */}\n                  {comment.userId === currentUser.id && (\n                    <button \n                      className={styles.commentDeleteBtn}\n                      onClick={() => handleDeleteComment(commentId)}\n                      aria-label=\"Delete comment\"\n                    >\n                      <svg xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\" stroke-width=\"1.5\" stroke=\"currentColor\" className=\"w-4 h-4\">\n                        <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M14.74 9l-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 01-2.244 2.077H8.084a2.25 2.25 0 01-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 00-3.478-.397m-12.56 0c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 013.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 00-3.32 0c-1.18.037-2.09.996-2.09 2.201v.916m7.5 0a48.667 48.667 0 00-7.5 0\" />\n                      </svg>\n                      <span>Delete</span>\n                    </button>\n                  )}\n                </div>\n                \n                {/* Replies */}\n                {comment.replies && comment.replies.length > 0 && (\n                  <>\n                    <button\n                      className={styles.repliesToggle}\n                      onClick={() => toggleReplies(commentId)}\n                    >\n                      <span className={`${styles.repliesToggleIcon} ${expandedReplies[commentId] ? styles.open : ''}`}>\n                        \n                      </span>\n                      {`${comment.replies.length} ${comment.replies.length === 1 ? 'reply' : 'replies'}`}\n                    </button>\n                    \n                    {expandedReplies[commentId] && (\n                      <div className={styles.replySection}>\n                        {comment.replies.map(reply => (\n                          <div key={reply.replyId} className={styles.replyItem}>\n                            <div className={styles.replyHeader}>\n                              {getUserAvatar(reply.userName, reply.userId, true)}\n                              <span className={styles.replyUser}>{reply.userName}</span>\n                              <span className={styles.replyDate}>{formatDate(reply.createdAt)}</span>\n                            </div>\n                            <div className={styles.replyContent}>\n                              {reply.content}\n                            </div>\n                          </div>\n                        ))}\n                      </div>\n                    )}\n                  </>\n                )}\n                \n                {/* Reply form */}\n                {replyingTo === commentId && (\n                  <div className={`${styles.replyForm} ${comment.replies && comment.replies.length > 0 ? styles.inThread : ''}`}>\n                    <textarea\n                      className={styles.replyInput}\n                      placeholder=\"Write a reply...\"\n                      value={replyContent}\n                      onChange={e => setReplyContent(e.target.value)}\n                    />\n                    <div className={styles.replyButtons}>\n                      <button \n                        className={styles.replyCancel}\n                        onClick={() => {\n                          setReplyingTo(null);\n                          setReplyContent('');\n                        }}\n                      >\n                        Cancel\n                      </button>\n                      <button \n                        className={styles.replySubmit}\n                        disabled={!replyContent.trim() || submittingReply}\n                        onClick={() => handleReplySubmit(commentId)}\n                      >\n                        {submittingReply ? 'Posting...' : 'Post Reply'}\n                      </button>\n                    </div>\n                  </div>\n                )}\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </section>\n  );\n};\n\nexport default CommentSection; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4537, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/schema.js"],"sourcesContent":["import { Schema, DOMParser, DOMSerializer } from 'prosemirror-model';\n\n// Define all nodes manually including list nodes\nconst nodes = {\n    // Document node - the root\n    doc: {\n        content: 'block+'\n    },\n\n    // Text node - inline text content\n    text: {\n        group: 'inline'\n    },\n\n    // Paragraph node - basic block containing inline content\n    paragraph: {\n        content: 'inline*',\n        group: 'block',\n        parseDOM: [{ tag: 'p' }],\n        toDOM() { return ['p', 0] }\n    },\n\n    // Heading node with levels 1-6\n    heading: {\n        attrs: { level: { default: 1 } },\n        content: 'inline*',\n        group: 'block',\n        defining: true,\n        parseDOM: [\n            { tag: 'h1', attrs: { level: 1 } },\n            { tag: 'h2', attrs: { level: 2 } },\n            { tag: 'h3', attrs: { level: 3 } },\n            { tag: 'h4', attrs: { level: 4 } },\n            { tag: 'h5', attrs: { level: 5 } },\n            { tag: 'h6', attrs: { level: 6 } }\n        ],\n        toDOM(node) { return [`h${node.attrs.level}`, 0] }\n    },\n\n    // Hard break node\n    hard_break: {\n        inline: true,\n        group: 'inline',\n        selectable: false,\n        parseDOM: [{ tag: 'br' }],\n        toDOM() { return ['br'] }\n    },\n\n    // Image node with enhanced attributes\n    image: {\n        inline: true,\n        attrs: {\n            src: {},\n            alt: { default: null },\n            title: { default: null },\n            width: { default: null },\n            height: { default: null }\n        },\n        group: 'inline',\n        draggable: true,\n        parseDOM: [\n            {\n                tag: 'img[src]',\n                getAttrs(dom) {\n                    return {\n                        src: dom.getAttribute('src'),\n                        title: dom.getAttribute('title'),\n                        alt: dom.getAttribute('alt'),\n                        width: dom.getAttribute('width'),\n                        height: dom.getAttribute('height')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { src, alt, title, width, height } = node.attrs;\n            const attrs = { src };\n            if (alt != null) attrs.alt = alt;\n            if (title != null) attrs.title = title;\n            if (width != null) attrs.width = width;\n            if (height != null) attrs.height = height;\n            return ['img', attrs];\n        }\n    },\n\n    // Blockquote node\n    blockquote: {\n        content: 'block+',\n        group: 'block',\n        defining: true,\n        parseDOM: [{ tag: 'blockquote' }],\n        toDOM() { return ['blockquote', 0] }\n    },\n\n    // Code block node with language support\n    code_block: {\n        content: 'text*',\n        marks: '',\n        group: 'block',\n        code: true,\n        defining: true,\n        attrs: {\n            language: { default: 'javascript' }\n        },\n        parseDOM: [{\n            tag: 'pre',\n            preserveWhitespace: 'full',\n            getAttrs(node) {\n                // First check for data-language attribute on pre element\n                const dataLanguage = node.getAttribute('data-language');\n                if (dataLanguage) {\n                    return { language: dataLanguage };\n                }\n\n                // Then check for language-* class on code element\n                const codeElement = node.querySelector('code');\n                if (codeElement) {\n                    const className = codeElement.className || '';\n                    const languageMatch = className.match(/language-(\\w+)/);\n                    if (languageMatch) {\n                        return { language: languageMatch[1] };\n                    }\n                }\n\n                // Default to javascript\n                return { language: 'javascript' };\n            },\n            getContent(node, schema) {\n                // Extract plain text content from the code element, \n                // ignoring any HTML syntax highlighting spans\n                const codeElement = node.querySelector('code');\n                if (codeElement) {\n                    const text = codeElement.textContent || codeElement.innerText || '';\n                    return text ? [schema.text(text)] : [];\n                }\n                return [];\n            }\n        }],\n        toDOM(node) {\n            return ['pre', { 'data-language': node.attrs.language },\n                ['code', { class: `language-${node.attrs.language}` }, 0]];\n        }\n    },\n\n    // Horizontal rule\n    horizontal_rule: {\n        group: 'block',\n        parseDOM: [{ tag: 'hr' }],\n        toDOM() { return ['hr'] }\n    },\n\n    // List nodes - manually defined to avoid addListNodes issue\n    bullet_list: {\n        content: 'list_item+',\n        group: 'block',\n        parseDOM: [{ tag: 'ul' }],\n        toDOM() { return ['ul', 0] }\n    },\n\n    ordered_list: {\n        content: 'list_item+',\n        group: 'block',\n        attrs: { order: { default: 1 } },\n        parseDOM: [{\n            tag: 'ol',\n            getAttrs(dom) {\n                return { order: dom.hasAttribute('start') ? +dom.getAttribute('start') : 1 }\n            }\n        }],\n        toDOM(node) {\n            return node.attrs.order == 1 ? ['ol', 0] : ['ol', { start: node.attrs.order }, 0]\n        }\n    },\n\n    list_item: {\n        content: 'paragraph block*',\n        parseDOM: [{ tag: 'li' }],\n        toDOM() { return ['li', 0] },\n        defining: true\n    }\n};\n\n// Define marks\nconst marks = {\n    // Strong mark (bold)\n    strong: {\n        parseDOM: [\n            { tag: 'strong' },\n            { tag: 'b', getAttrs: node => node.style.fontWeight != 'normal' && null },\n            { style: 'font-weight', getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null }\n        ],\n        toDOM() { return ['strong', 0] }\n    },\n\n    // Emphasis mark (italic)\n    em: {\n        parseDOM: [\n            { tag: 'i' }, { tag: 'em' },\n            { style: 'font-style=italic' }\n        ],\n        toDOM() { return ['em', 0] }\n    },\n\n    // Code mark (inline code)\n    code: {\n        parseDOM: [{ tag: 'code' }],\n        toDOM() { return ['code', 0] }\n    },\n\n    // Link mark with enhanced attributes\n    link: {\n        attrs: {\n            href: {},\n            title: { default: null },\n            target: { default: null }\n        },\n        inclusive: false,\n        parseDOM: [\n            {\n                tag: 'a[href]',\n                getAttrs(dom) {\n                    return {\n                        href: dom.getAttribute('href'),\n                        title: dom.getAttribute('title'),\n                        target: dom.getAttribute('target')\n                    };\n                }\n            }\n        ],\n        toDOM(node) {\n            const { href, title, target } = node.attrs;\n            const attrs = { href };\n            if (title != null) attrs.title = title;\n            if (target != null) attrs.target = target;\n            return ['a', attrs, 0];\n        }\n    }\n};\n\n// Create and export the schema\nexport const schema = new Schema({\n    nodes,\n    marks\n});\n\n// Helper function to create an empty document\nexport function createEmptyDocument() {\n    return schema.node('doc', null, [\n        schema.node('paragraph')\n    ]);\n}\n\n// Parse HTML content to ProseMirror document\nexport function parseHTML(html) {\n    if (!html || html.trim() === '') {\n        return createEmptyDocument();\n    }\n\n    const div = document.createElement('div');\n    div.innerHTML = html;\n    return DOMParser.fromSchema(schema).parse(div);\n}\n\n// Serialize ProseMirror document to HTML\nexport function serializeToHTML(doc) {\n    const div = document.createElement('div');\n    div.appendChild(DOMSerializer.fromSchema(schema).serializeFragment(doc.content));\n    return div.innerHTML;\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 4983, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commandHelpers.js"],"sourcesContent":["import { liftListItem } from 'prosemirror-schema-list';\n\n/**\n * If the selection is inside a list, lift it out first,\n * then run the real command (cmd).\n */\nexport const withListLift = (cmd, listItemNode) => {\n    return (state, dispatch, view) => {\n        let lifted = false;\n\n        if (liftListItem(listItemNode)(state, dispatch, view)) {\n            // state has changed, pull the fresh state from the view\n            state = view.state;\n            lifted = true;\n        }\n        const ok = cmd(state, dispatch, view);\n        return lifted || ok;\n    };\n}; "],"names":[],"mappings":";;;AAAA;;AAMO,MAAM,eAAe,CAAC,KAAK;IAC9B,OAAO,CAAC,OAAO,UAAU;QACrB,IAAI,SAAS;QAEb,IAAI,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE,cAAc,OAAO,UAAU,OAAO;YACnD,wDAAwD;YACxD,QAAQ,KAAK,KAAK;YAClB,SAAS;QACb;QACA,MAAM,KAAK,IAAI,OAAO,UAAU;QAChC,OAAO,UAAU;IACrB;AACJ","debugId":null}},
    {"offset": {"line": 5009, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/commands.js"],"sourcesContent":["import { setBlockType, wrapIn, lift } from 'prosemirror-commands';\nimport { liftListItem } from 'prosemirror-schema-list';\nimport { schema } from './schema.js';\nimport { withListLift } from './commandHelpers.js';\n\nconst { heading, paragraph, list_item, blockquote } = schema.nodes;\n\n/**\n * Heading command that works even when text is inside lists\n * Lifts out of lists first, then applies heading level\n */\nexport const headingCmd = (level) =>\n    withListLift(\n        setBlockType(heading, { level }),\n        list_item\n    );\n\n/**\n * Paragraph command that works even when text is inside lists\n * Lifts out of lists first, then applies paragraph format\n */\nexport const paragraphCmd = () =>\n    withListLift(\n        setBlockType(paragraph),\n        list_item\n    );\n\n/**\n * Toggle block-quote on the current selection:\n *    if already quoted   lift out\n *    otherwise           wrap in <blockquote>\n * Works on multiple paragraphs and inside lists.\n */\nexport const toggleBlockquote = (state, dispatch, view) => {\n    // 1. If we're *inside* a blockquote anywhere in the selection, lift it out\n    const { from, to } = state.selection;\n    let inQuote = false;\n    state.doc.nodesBetween(from, to, node => {\n        if (node.type === blockquote) {\n            inQuote = true;\n            return false;              // early exit\n        }\n        return true;\n    });\n\n    if (inQuote) {\n        // also lift once if we're inside a list  blockquote  paragraph\n        if (liftListItem(list_item)(state, dispatch)) return true;\n        return lift(state, dispatch);\n    }\n\n    // 2. Otherwise wrap the selection in a new blockquote\n    //    (lift out of list first so the quote sits at top level)\n    if (liftListItem(list_item)(state, dispatch)) {\n        // state has changed; fetch the fresh state from the view\n        state = view.state;\n    }\n    return wrapIn(blockquote)(state, dispatch, view);\n}; "],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;;;;;AAEA,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,SAAS,EAAE,UAAU,EAAE,GAAG,0HAAA,CAAA,SAAM,CAAC,KAAK;AAM3D,MAAM,aAAa,CAAC,QACvB,CAAA,GAAA,kIAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,2JAAA,CAAA,eAAY,AAAD,EAAE,SAAS;QAAE;IAAM,IAC9B;AAOD,MAAM,eAAe,IACxB,CAAA,GAAA,kIAAA,CAAA,eAAY,AAAD,EACP,CAAA,GAAA,2JAAA,CAAA,eAAY,AAAD,EAAE,YACb;AASD,MAAM,mBAAmB,CAAC,OAAO,UAAU;IAC9C,2EAA2E;IAC3E,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,MAAM,SAAS;IACpC,IAAI,UAAU;IACd,MAAM,GAAG,CAAC,YAAY,CAAC,MAAM,IAAI,CAAA;QAC7B,IAAI,KAAK,IAAI,KAAK,YAAY;YAC1B,UAAU;YACV,OAAO,OAAoB,aAAa;QAC5C;QACA,OAAO;IACX;IAEA,IAAI,SAAS;QACT,iEAAiE;QACjE,IAAI,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW,OAAO;QACrD,OAAO,CAAA,GAAA,2JAAA,CAAA,OAAI,AAAD,EAAE,OAAO;IACvB;IAEA,sDAAsD;IACtD,6DAA6D;IAC7D,IAAI,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,WAAW;QAC1C,yDAAyD;QACzD,QAAQ,KAAK,KAAK;IACtB;IACA,OAAO,CAAA,GAAA,2JAAA,CAAA,SAAM,AAAD,EAAE,YAAY,OAAO,UAAU;AAC/C","debugId":null}},
    {"offset": {"line": 5060, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/exitHeadingPlugin.js"],"sourcesContent":["import { Plugin, PluginKey } from 'prosemirror-state';\nimport { setBlockType } from 'prosemirror-commands';\nimport { schema } from './schema.js';\n\nexport const exitHeadingPlugin = new Plugin({\n    key: new PluginKey('exitHeading'),\n    props: {\n        handleKeyDown(view, event) {\n            if (event.key !== 'Enter' || event.shiftKey) return false;\n\n            const { state, dispatch } = view;\n            const { $from, empty } = state.selection;\n            const { heading, paragraph } = schema.nodes;\n\n            // Only trigger if the cursor is at the *end* of a heading\n            if (\n                empty &&\n                $from.parent.type === heading &&\n                $from.parentOffset === $from.parent.content.size\n            ) {\n                event.preventDefault();           // stop default split behaviour\n                return setBlockType(paragraph)(state, dispatch, view);\n            }\n            return false; // let other handlers run\n        },\n    },\n}); "],"names":[],"mappings":";;;AAAA;AACA;AACA;;;;AAEO,MAAM,oBAAoB,IAAI,wJAAA,CAAA,SAAM,CAAC;IACxC,KAAK,IAAI,wJAAA,CAAA,YAAS,CAAC;IACnB,OAAO;QACH,eAAc,IAAI,EAAE,KAAK;YACrB,IAAI,MAAM,GAAG,KAAK,WAAW,MAAM,QAAQ,EAAE,OAAO;YAEpD,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;YAC5B,MAAM,EAAE,KAAK,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS;YACxC,MAAM,EAAE,OAAO,EAAE,SAAS,EAAE,GAAG,0HAAA,CAAA,SAAM,CAAC,KAAK;YAE3C,0DAA0D;YAC1D,IACI,SACA,MAAM,MAAM,CAAC,IAAI,KAAK,WACtB,MAAM,YAAY,KAAK,MAAM,MAAM,CAAC,OAAO,CAAC,IAAI,EAClD;gBACE,MAAM,cAAc,IAAc,+BAA+B;gBACjE,OAAO,CAAA,GAAA,2JAAA,CAAA,eAAY,AAAD,EAAE,WAAW,OAAO,UAAU;YACpD;YACA,OAAO,OAAO,yBAAyB;QAC3C;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 5095, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/syntaxHighlighting.js"],"sourcesContent":["import { Plugin } from 'prosemirror-state';\nimport { Decoration, DecorationSet } from 'prosemirror-view';\nimport Prism from 'prismjs';\n\n// Import language support\nimport 'prismjs/components/prism-javascript';\nimport 'prismjs/components/prism-typescript';\nimport 'prismjs/components/prism-jsx';\nimport 'prismjs/components/prism-tsx';\nimport 'prismjs/components/prism-css';\nimport 'prismjs/components/prism-scss';\nimport 'prismjs/components/prism-json';\nimport 'prismjs/components/prism-python';\nimport 'prismjs/components/prism-java';\nimport 'prismjs/components/prism-c';\nimport 'prismjs/components/prism-cpp';\nimport 'prismjs/components/prism-csharp';\nimport 'prismjs/components/prism-php';\nimport 'prismjs/components/prism-ruby';\nimport 'prismjs/components/prism-go';\nimport 'prismjs/components/prism-rust';\nimport 'prismjs/components/prism-sql';\nimport 'prismjs/components/prism-bash';\nimport 'prismjs/components/prism-yaml';\nimport 'prismjs/components/prism-markdown';\n\nfunction createCodeBlockDecorations(doc, schema) {\n    const decorations = [];\n\n    doc.descendants((node, pos) => {\n        if (node.type === schema.nodes.code_block) {\n            const language = node.attrs.language || 'javascript';\n            const text = node.textContent;\n\n            if (text && Prism.languages[language]) {\n                try {\n                    // Use Prism to tokenize the code\n                    const tokens = Prism.tokenize(text, Prism.languages[language]);\n\n                    let from = pos + 1; // Start after the opening tag\n                    let offset = 0;\n\n                    function processTokens(tokens) {\n                        tokens.forEach(token => {\n                            if (typeof token === 'string') {\n                                offset += token.length;\n                            } else if (typeof token === 'object' && token.type && token.content) {\n                                let tokenContent = token.content;\n                                let tokenLength = 0;\n\n                                // Handle nested tokens\n                                if (Array.isArray(tokenContent)) {\n                                    // For complex tokens with nested content, flatten to string\n                                    tokenContent = token.content.map(t => typeof t === 'string' ? t : t.content || '').join('');\n                                    tokenLength = tokenContent.length;\n                                } else if (typeof tokenContent === 'string') {\n                                    tokenLength = tokenContent.length;\n                                } else {\n                                    tokenLength = String(tokenContent).length;\n                                }\n\n                                if (tokenLength > 0) {\n                                    const tokenStart = from + offset;\n                                    const tokenEnd = tokenStart + tokenLength;\n\n                                    // Create decoration for this token\n                                    decorations.push(\n                                        Decoration.inline(tokenStart, tokenEnd, {\n                                            class: `token ${token.type}`,\n                                            'data-token-type': token.type\n                                        })\n                                    );\n                                }\n\n                                offset += tokenLength;\n                            }\n                        });\n                    }\n\n                    processTokens(tokens);\n                } catch (error) {\n                    console.warn('Syntax highlighting failed for language:', language, error);\n                }\n            }\n        }\n    });\n\n    return DecorationSet.create(doc, decorations);\n}\n\nexport function syntaxHighlightingPlugin(schema) {\n    return new Plugin({\n        key: 'syntaxHighlighting',\n        state: {\n            init(_, { doc }) {\n                return createCodeBlockDecorations(doc, schema);\n            },\n            apply(transaction, oldState) {\n                if (transaction.docChanged) {\n                    return createCodeBlockDecorations(transaction.doc, schema);\n                }\n                return oldState.map(transaction.mapping, transaction.doc);\n            }\n        },\n        props: {\n            decorations(state) {\n                return this.getState(state);\n            }\n        }\n    });\n} "],"names":[],"mappings":";;;AAAA;AACA;AACA;AAEA,0BAA0B;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;AAEA,SAAS,2BAA2B,GAAG,EAAE,MAAM;IAC3C,MAAM,cAAc,EAAE;IAEtB,IAAI,WAAW,CAAC,CAAC,MAAM;QACnB,IAAI,KAAK,IAAI,KAAK,OAAO,KAAK,CAAC,UAAU,EAAE;YACvC,MAAM,WAAW,KAAK,KAAK,CAAC,QAAQ,IAAI;YACxC,MAAM,OAAO,KAAK,WAAW;YAE7B,IAAI,QAAQ,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS,EAAE;gBACnC,IAAI;oBACA,iCAAiC;oBACjC,MAAM,SAAS,mIAAA,CAAA,UAAK,CAAC,QAAQ,CAAC,MAAM,mIAAA,CAAA,UAAK,CAAC,SAAS,CAAC,SAAS;oBAE7D,IAAI,OAAO,MAAM,GAAG,8BAA8B;oBAClD,IAAI,SAAS;oBAEb,SAAS,cAAc,MAAM;wBACzB,OAAO,OAAO,CAAC,CAAA;4BACX,IAAI,OAAO,UAAU,UAAU;gCAC3B,UAAU,MAAM,MAAM;4BAC1B,OAAO,IAAI,OAAO,UAAU,YAAY,MAAM,IAAI,IAAI,MAAM,OAAO,EAAE;gCACjE,IAAI,eAAe,MAAM,OAAO;gCAChC,IAAI,cAAc;gCAElB,uBAAuB;gCACvB,IAAI,MAAM,OAAO,CAAC,eAAe;oCAC7B,4DAA4D;oCAC5D,eAAe,MAAM,OAAO,CAAC,GAAG,CAAC,CAAA,IAAK,OAAO,MAAM,WAAW,IAAI,EAAE,OAAO,IAAI,IAAI,IAAI,CAAC;oCACxF,cAAc,aAAa,MAAM;gCACrC,OAAO,IAAI,OAAO,iBAAiB,UAAU;oCACzC,cAAc,aAAa,MAAM;gCACrC,OAAO;oCACH,cAAc,OAAO,cAAc,MAAM;gCAC7C;gCAEA,IAAI,cAAc,GAAG;oCACjB,MAAM,aAAa,OAAO;oCAC1B,MAAM,WAAW,aAAa;oCAE9B,mCAAmC;oCACnC,YAAY,IAAI,CACZ,uJAAA,CAAA,aAAU,CAAC,MAAM,CAAC,YAAY,UAAU;wCACpC,OAAO,CAAC,MAAM,EAAE,MAAM,IAAI,EAAE;wCAC5B,mBAAmB,MAAM,IAAI;oCACjC;gCAER;gCAEA,UAAU;4BACd;wBACJ;oBACJ;oBAEA,cAAc;gBAClB,EAAE,OAAO,OAAO;oBACZ,QAAQ,IAAI,CAAC,4CAA4C,UAAU;gBACvE;YACJ;QACJ;IACJ;IAEA,OAAO,uJAAA,CAAA,gBAAa,CAAC,MAAM,CAAC,KAAK;AACrC;AAEO,SAAS,yBAAyB,MAAM;IAC3C,OAAO,IAAI,wJAAA,CAAA,SAAM,CAAC;QACd,KAAK;QACL,OAAO;YACH,MAAK,CAAC,EAAE,EAAE,GAAG,EAAE;gBACX,OAAO,2BAA2B,KAAK;YAC3C;YACA,OAAM,WAAW,EAAE,QAAQ;gBACvB,IAAI,YAAY,UAAU,EAAE;oBACxB,OAAO,2BAA2B,YAAY,GAAG,EAAE;gBACvD;gBACA,OAAO,SAAS,GAAG,CAAC,YAAY,OAAO,EAAE,YAAY,GAAG;YAC5D;QACJ;QACA,OAAO;YACH,aAAY,KAAK;gBACb,OAAO,IAAI,CAAC,QAAQ,CAAC;YACzB;QACJ;IACJ;AACJ","debugId":null}},
    {"offset": {"line": 5226, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/editor/plugins.js"],"sourcesContent":["import { history, undo, redo } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { baseKeymap, toggleMark, setBlockType } from 'prosemirror-commands';\nimport {\n    wrapInList,\n    splitListItem,\n    liftListItem,\n    sinkListItem\n} from 'prosemirror-schema-list';\nimport {\n    inputRules,\n    wrappingInputRule,\n    textblockTypeInputRule,\n    smartQuotes,\n    emDash,\n    ellipsis\n} from 'prosemirror-inputrules';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { schema } from './schema.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from './commands.js';\nimport { exitHeadingPlugin } from './exitHeadingPlugin.js';\nimport { syntaxHighlightingPlugin } from './syntaxHighlighting.js';\n\n// Create input rules for automatic formatting\nfunction buildInputRulesPlugin() {\n    const rules = [];\n\n    // 1) Smart text rules - only ellipsis to avoid conflicts\n    rules.push(ellipsis);\n\n    // 2) Bullet list: typing \"- \" at start of line\n    const bulletRule = wrappingInputRule(\n        /^([-+*])\\s$/,\n        schema.nodes.bullet_list,\n        match => null,\n        (match, node) => ({ tight: true })\n    );\n    rules.push(bulletRule);\n\n    // 3) Ordered list: typing \"1. \" at start of line\n    const orderedRule = wrappingInputRule(\n        /^(\\d+)\\.\\s$/,\n        schema.nodes.ordered_list,\n        match => ({ order: +match[1] }),\n        (match, node) => ({ tight: true })\n    );\n    rules.push(orderedRule);\n\n    // 4) Headings: typing \"#\" to \"######\" followed by space\n    const headingRule = textblockTypeInputRule(\n        /^(#{1,6})\\s$/,\n        schema.nodes.heading,\n        match => ({ level: match[1].length })\n    );\n    rules.push(headingRule);\n\n    // 5) Blockquote: typing \"> \" at start of line\n    const blockquoteRule = wrappingInputRule(\n        /^>\\s$/,\n        schema.nodes.blockquote\n    );\n    rules.push(blockquoteRule);\n\n    // 6) Code block: typing \"```\" or \"```javascript\" at start of line\n    const codeRule = textblockTypeInputRule(\n        /^```([a-zA-Z0-9]*)?$/,\n        schema.nodes.code_block,\n        match => ({ language: match[1] || 'javascript' })\n    );\n    rules.push(codeRule);\n\n    return inputRules({ rules });\n}\n\n// Build keymap with common shortcuts\nfunction buildKeymap() {\n    const keys = {\n        // Text formatting shortcuts\n        'Mod-b': toggleMark(schema.marks.strong),\n        'Mod-i': toggleMark(schema.marks.em),\n\n        // Block type shortcuts - now using selection-aware commands\n        'Mod-0': paragraphCmd(),\n        'Mod-Shift-1': headingCmd(1),\n        'Mod-Shift-2': headingCmd(2),\n        'Mod-Shift-3': headingCmd(3),\n        'Mod-Shift-4': headingCmd(4),\n        'Mod-Shift-5': headingCmd(5),\n        'Mod-Shift-6': headingCmd(6),\n        'Mod->': toggleBlockquote,          // /Ctrl + Shift + .\n        'Shift-Ctrl->': toggleBlockquote,   // Windows/Linux variant\n\n        // List shortcuts\n        'Shift-Ctrl-8': wrapInList(schema.nodes.bullet_list),\n        'Shift-Ctrl-9': wrapInList(schema.nodes.ordered_list),\n\n        // Enhanced list item navigation - only for list items\n        'Enter': (state, dispatch, view) => {\n            const { $from, empty } = state.selection;\n\n            // Handle Enter in list items\n            if ($from.parent.type === schema.nodes.list_item) {\n                return splitListItem(schema.nodes.list_item)(state, dispatch);\n            }\n\n            // For all other cases, return false to let baseKeymap handle it\n            return false;\n        },\n        'Mod-[': liftListItem(schema.nodes.list_item),\n        'Mod-]': sinkListItem(schema.nodes.list_item),\n\n        // Only handle backspace for empty list items\n        'Backspace': (state, dispatch, view) => {\n            const { $from, empty } = state.selection;\n            if (empty && $from.parent.type === schema.nodes.list_item &&\n                $from.parentOffset === 0 && $from.parent.content.size === 0) {\n                return liftListItem(schema.nodes.list_item)(state, dispatch);\n            }\n            return false; // Let baseKeymap handle normal backspace\n        },\n\n        // History\n        'Mod-z': undo,\n        'Mod-y': redo,\n        'Shift-Mod-z': redo,\n        // REMOVED custom 'Space' handler to let input rules and default behavior manage it.\n    };\n\n    return keymap(keys);\n}\n\n// Create and export the complete plugins array\nexport function createPlugins() {\n    const inputRulesPlugin = buildInputRulesPlugin();\n    const historyPlugin = history();\n    const baseKeymapPlugin = keymap(baseKeymap); // Essential for basic editor functionality\n    const customKeymapPlugin = buildKeymap();\n    const dropCursorPlugin = dropCursor();\n    const gapCursorPlugin = gapCursor();\n\n    const allPlugins = [\n        // Input rules MUST come before keymap for auto-formatting to work\n        inputRulesPlugin,\n        historyPlugin,\n        // Base keymap MUST come first to handle basic interactions\n        baseKeymapPlugin,\n        // Exit heading plugin must come before custom keymap\n        exitHeadingPlugin,\n        // Custom keymap comes after base keymap\n        customKeymapPlugin,\n        dropCursorPlugin,\n        gapCursorPlugin,\n        // Syntax highlighting for code blocks\n        syntaxHighlightingPlugin(schema),\n    ];\n\n    return allPlugins;\n}\n\n// Export individual plugins for custom configurations\nexport {\n    buildInputRulesPlugin,\n    buildKeymap\n}; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 5366, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/Editor.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"ProseMirror\": \"Editor-module__x7ssIG__ProseMirror\",\n  \"active\": \"Editor-module__x7ssIG__active\",\n  \"divider\": \"Editor-module__x7ssIG__divider\",\n  \"editor\": \"Editor-module__x7ssIG__editor\",\n  \"editorContainer\": \"Editor-module__x7ssIG__editorContainer\",\n  \"editorContent\": \"Editor-module__x7ssIG__editorContent\",\n  \"formatGroup\": \"Editor-module__x7ssIG__formatGroup\",\n  \"headingIcon\": \"Editor-module__x7ssIG__headingIcon\",\n  \"loading\": \"Editor-module__x7ssIG__loading\",\n  \"loadingSpinner\": \"Editor-module__x7ssIG__loadingSpinner\",\n  \"modernToolbar\": \"Editor-module__x7ssIG__modernToolbar\",\n  \"prosemirrorEditor\": \"Editor-module__x7ssIG__prosemirrorEditor\",\n  \"slideInFromTop\": \"Editor-module__x7ssIG__slideInFromTop\",\n  \"spin\": \"Editor-module__x7ssIG__spin\",\n  \"toolBtn\": \"Editor-module__x7ssIG__toolBtn\",\n  \"toolbarContainer\": \"Editor-module__x7ssIG__toolbarContainer\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 5390, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/Editor.jsx"],"sourcesContent":["'use client'\n\n// Import ProseMirror base styles FIRST\nimport 'prosemirror-view/style/prosemirror.css';\n\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { EditorState, TextSelection } from 'prosemirror-state';\nimport { EditorView } from 'prosemirror-view';\nimport { toggleMark, setBlockType, baseKeymap } from 'prosemirror-commands';\nimport { wrapInList, splitListItem, liftListItem, sinkListItem } from 'prosemirror-schema-list';\nimport { undo, redo, history } from 'prosemirror-history';\nimport { keymap } from 'prosemirror-keymap';\nimport { dropCursor } from 'prosemirror-dropcursor';\nimport { gapCursor } from 'prosemirror-gapcursor';\nimport { schema, createEmptyDocument, parseHTML, serializeToHTML } from '@/editor/schema.js';\nimport { createPlugins } from '@/editor/plugins.js';\nimport { headingCmd, paragraphCmd, toggleBlockquote } from '@/editor/commands.js';\nimport styles from '@/styles/Editor.module.css';\n\n/**\n * ProseMirror-based Rich Text Editor\n * \n * A modern, extensible editor built with ProseMirror\n * \n * Props:\n * - articleId: string - Unique identifier for the article\n * - initialContent?: string - JSON string or HTML initial content\n * - onChange?: function - Callback when content changes (content: string, json: any) => void\n * - placeholder?: string - Placeholder text for empty editor\n * - className?: string - Additional CSS classes\n */\nconst Editor = React.forwardRef(({\n    articleId,\n    initialContent = '',\n    onChange,\n    placeholder = 'Tell your story...',\n    className = ''\n}, ref) => {\n    const editorRef = useRef(null);\n    const viewRef = useRef(null);\n    const onChangeRef = useRef(onChange); // Store onChange in ref to avoid re-renders\n    const [isReady, setIsReady] = useState(false);\n\n    // Update onChange ref when it changes\n    onChangeRef.current = onChange;\n\n    // Method to insert text at cursor position\n    const insertTextAtCursor = useCallback((text) => {\n        if (!viewRef.current) return;\n\n        const { state, dispatch } = viewRef.current;\n        const { selection } = state;\n\n        // Create a text node with the new content\n        const textNode = schema.text(text);\n\n        // Create transaction to insert text at current position\n        const transaction = state.tr.replaceSelectionWith(textNode);\n\n        // Apply the transaction\n        dispatch(transaction);\n\n        // Focus the editor\n        viewRef.current.focus();\n    }, []);\n\n    // Expose method to parent component\n    React.useImperativeHandle(ref, () => ({\n        insertText: insertTextAtCursor,\n        focus: () => viewRef.current?.focus()\n    }), [insertTextAtCursor]);\n\n    // Initialize ProseMirror editor\n    useEffect(() => {\n        // Guard against SSR - ProseMirror needs browser environment\n        if (typeof window === 'undefined') {\n            return;\n        }\n\n        if (!editorRef.current || viewRef.current) {\n            return;\n        }\n\n        try {\n            // SIMPLIFIED document creation - always start with empty doc\n            let initialDoc = createEmptyDocument();\n\n            // Debug: console.log('Created initial document:', initialDoc.toJSON());\n\n            // Add back essential plugins gradually\n            const state = EditorState.create({\n                doc: initialDoc,\n                plugins: [\n                    keymap({\n                        // Custom shortcuts FIRST (higher priority)\n                        'Mod-b': toggleMark(schema.marks.strong),\n                        'Mod-i': toggleMark(schema.marks.em),\n                        'Mod-z': undo,\n                        'Mod-y': redo,\n                        // Auto-formatting shortcuts\n                        'Enter': splitListItem(schema.nodes.list_item),\n                        'Mod-[': liftListItem(schema.nodes.list_item),\n                        'Mod-]': sinkListItem(schema.nodes.list_item),\n                        'Space': (state, dispatch) => {\n                            const { $from } = state.selection;\n\n                            console.log(\" Space handler triggered. beforeCursor:\", $from.parent.textContent.slice(0, $from.parentOffset));\n\n                            if ($from.parent.type === schema.nodes.paragraph) {\n                                const beforeCursor = $from.parent.textContent.slice(0, $from.parentOffset);\n\n                                // Auto-heading: ## + space = H2, ### + space = H3\n                                const headingMatch = beforeCursor.match(/^(#{1,6})$/);\n                                if (headingMatch) {\n                                    const level = headingMatch[1].length;\n                                    const tr = state.tr\n                                        .delete($from.start(), $from.pos)\n                                        .setBlockType($from.start(), $from.start(), schema.nodes.heading, { level });\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-bold: **text** + space = bold\n                                const boldMatch = beforeCursor.match(/\\*\\*([^*]+)\\*\\*$/);\n                                if (boldMatch) {\n                                    const start = $from.pos - boldMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(boldMatch[1] + ' ', start)\n                                        .addMark(start, start + boldMatch[1].length, schema.marks.strong);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-italic: *text* + space = italic\n                                const italicMatch = beforeCursor.match(/(?<!\\*)\\*([^*]+)\\*$/);\n                                if (italicMatch) {\n                                    const start = $from.pos - italicMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(italicMatch[1] + ' ', start)\n                                        .addMark(start, start + italicMatch[1].length, schema.marks.em);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-code: `text` + space = inline code\n                                const codeMatch = beforeCursor.match(/`([^`]+)`$/);\n                                if (codeMatch) {\n                                    const start = $from.pos - codeMatch[0].length;\n                                    const tr = state.tr\n                                        .delete(start, $from.pos)\n                                        .insertText(codeMatch[1] + ' ', start)\n                                        .addMark(start, start + codeMatch[1].length, schema.marks.code);\n                                    dispatch(tr);\n                                    return true;\n                                }\n\n                                // Auto-bullet list: - + space or * + space = bullet list\n                                const bulletMatch = beforeCursor.match(/^[-*]$/);\n                                if (bulletMatch) {\n                                    console.log('Bullet list match:', bulletMatch[0]);\n                                    try {\n                                        // Create a simple list item with empty paragraph\n                                        const listItem = schema.nodes.list_item.create(null,\n                                            schema.nodes.paragraph.create()\n                                        );\n                                        const bulletList = schema.nodes.bullet_list.create(null, listItem);\n\n                                        // Delete exactly the dash/asterisk character\n                                        const dashPos = $from.pos - 1; // Position of the dash\n                                        let tr = state.tr\n                                            .delete(dashPos, $from.pos) // Remove exactly the - or *\n                                            .replaceWith(dashPos, dashPos, bulletList);\n\n                                        // Position cursor inside list item (after the transaction is built)\n                                        tr = tr.setSelection(TextSelection.create(tr.doc, dashPos + 2));\n\n                                        dispatch(tr);\n                                        console.log('Auto bullet list creation: success');\n                                        return true;\n                                    } catch (error) {\n                                        console.log('Auto bullet list creation failed:', error);\n                                    }\n                                }\n\n                                // Auto-ordered list: 1. + space = ordered list\n                                const orderedMatch = beforeCursor.match(/^1\\.$/);\n                                if (orderedMatch) {\n                                    console.log('Ordered list match:', orderedMatch[0]);\n                                    try {\n                                        // Create a simple list item with empty paragraph\n                                        const listItem = schema.nodes.list_item.create(null,\n                                            schema.nodes.paragraph.create()\n                                        );\n                                        const orderedList = schema.nodes.ordered_list.create(null, listItem);\n\n                                        // Delete exactly the \"1.\" characters\n                                        const numberedPos = $from.pos - 2; // Position of the \"1.\"\n                                        let tr = state.tr\n                                            .delete(numberedPos, $from.pos) // Remove exactly the 1.\n                                            .replaceWith(numberedPos, numberedPos, orderedList);\n\n                                        // Position cursor inside list item (after the transaction is built)\n                                        tr = tr.setSelection(TextSelection.create(tr.doc, numberedPos + 2));\n\n                                        dispatch(tr);\n                                        console.log('Auto ordered list creation: success');\n                                        return true;\n                                    } catch (error) {\n                                        console.log('Auto ordered list creation failed:', error);\n                                    }\n                                }\n                            }\n\n                            // Default space behavior\n                            return false;\n                        }\n                    }),\n                    keymap(baseKeymap), // Base keymap AFTER custom\n                    history(), // For undo/redo\n                    dropCursor(),\n                    gapCursor()\n                ]\n            });\n\n            // Add back minimal transaction handling\n            const view = new EditorView(editorRef.current, {\n                state,\n                editable: () => true,\n                dispatchTransaction: (transaction) => {\n                    // Apply transaction normally\n                    const newState = view.state.apply(transaction);\n                    view.updateState(newState);\n\n                    // Call onChange only when content actually changes\n                    if (transaction.docChanged && onChangeRef.current) {\n                        const html = serializeToHTML(newState.doc);\n                        const json = newState.doc.toJSON();\n                        onChangeRef.current(html, json);\n                    }\n                },\n                attributes: {\n                    'data-placeholder': placeholder || 'Tell your story...',\n                },\n            });\n\n            viewRef.current = view;\n            setIsReady(true);\n\n            // Focus the editor after it's ready\n            setTimeout(() => {\n                if (view && !view.isDestroyed) {\n                    view.focus();\n                }\n            }, 100);\n\n        } catch (error) {\n            console.error('Error initializing editor:', error);\n            setIsReady(true);\n        }\n\n        // Cleanup function\n        return () => {\n            if (viewRef.current) {\n                viewRef.current.destroy();\n                viewRef.current = null;\n            }\n        };\n    }, []); // Remove unstable dependencies - handle them differently\n\n    // Toolbar action handlers - properly implemented\n    const toggleBold = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleMark(schema.marks.strong);\n        if (command(state, dispatch)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleItalic = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleMark(schema.marks.em);\n        if (command(state, dispatch)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setHeading = useCallback((level) => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = headingCmd(level);\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setParagraph = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = paragraphCmd();\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setBlockquote = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        const command = toggleBlockquote;\n        if (command(state, dispatch, viewRef.current)) {\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const setCodeBlock = useCallback(() => {\n        if (!viewRef.current) return;\n\n        // Ask user for language\n        const language = prompt('Enter programming language (e.g., javascript, python, css):', 'javascript');\n        if (!language) return;\n\n        const { state, dispatch } = viewRef.current;\n        const { from, to } = state.selection;\n\n        // Create code block with language attribute\n        const codeBlock = schema.nodes.code_block.create({ language: language.toLowerCase() });\n        const transaction = state.tr.replaceRangeWith(from, to, codeBlock);\n\n        if (dispatch) {\n            dispatch(transaction);\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleBulletList = useCallback(() => {\n        if (!viewRef.current) return;\n        console.log('Bullet list button clicked');\n        const { state, dispatch } = viewRef.current;\n        const { $from, $to } = state.selection;\n\n        try {\n            // Try simple list creation approach\n            const listItem = schema.nodes.list_item.create(null,\n                schema.nodes.paragraph.create(null, $from.parent.content)\n            );\n            const bulletList = schema.nodes.bullet_list.create(null, listItem);\n\n            const tr = state.tr.replaceWith($from.start(), $to.end(), bulletList);\n            dispatch(tr);\n            console.log('Manual bullet list creation: success');\n            viewRef.current.focus();\n        } catch (error) {\n            console.log('Manual bullet list creation failed:', error);\n            // Fallback to wrapInList\n            const command = wrapInList(schema.nodes.bullet_list);\n            const result = command(state, dispatch);\n            console.log('wrapInList fallback result:', result);\n            if (result) viewRef.current.focus();\n        }\n    }, []);\n\n    const toggleOrderedList = useCallback(() => {\n        if (!viewRef.current) return;\n        console.log('Ordered list button clicked');\n        const { state, dispatch } = viewRef.current;\n        const { $from, $to } = state.selection;\n\n        try {\n            // Try simple list creation approach\n            const listItem = schema.nodes.list_item.create(null,\n                schema.nodes.paragraph.create(null, $from.parent.content)\n            );\n            const orderedList = schema.nodes.ordered_list.create(null, listItem);\n\n            const tr = state.tr.replaceWith($from.start(), $to.end(), orderedList);\n            dispatch(tr);\n            console.log('Manual ordered list creation: success');\n            viewRef.current.focus();\n        } catch (error) {\n            console.log('Manual ordered list creation failed:', error);\n            // Fallback to wrapInList\n            const command = wrapInList(schema.nodes.ordered_list);\n            const result = command(state, dispatch);\n            console.log('wrapInList fallback result:', result);\n            if (result) viewRef.current.focus();\n        }\n    }, []);\n\n    const insertImage = useCallback(() => {\n        const url = prompt('Enter image URL:');\n        if (url && viewRef.current) {\n            const { state, dispatch } = viewRef.current;\n            const imageNode = schema.nodes.image.create({ src: url, alt: '' });\n            const transaction = state.tr.replaceSelectionWith(imageNode);\n            dispatch(transaction);\n            viewRef.current.focus();\n        }\n    }, []);\n\n    const undoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        undo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    const redoCommand = useCallback(() => {\n        if (!viewRef.current) return;\n        const { state, dispatch } = viewRef.current;\n        redo(state, dispatch);\n        viewRef.current.focus();\n    }, []);\n\n    // Check if a mark or node is active (range-aware for multi-block selections)\n    const isMarkActive = useCallback((markType) => {\n        if (!viewRef.current) return false;\n        const { from, $from, to, empty } = viewRef.current.state.selection;\n        if (empty) {\n            return markType.isInSet(viewRef.current.state.storedMarks || $from.marks());\n        }\n        return viewRef.current.state.doc.rangeHasMark(from, to, markType);\n    }, []);\n\n    const isBlockActive = useCallback((nodeType, attrs = {}) => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let allMatch = true;\n\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.isTextblock && !node.hasMarkup(nodeType, attrs)) {\n                allMatch = false;\n                return false;          // early exit\n            }\n            return true;\n        });\n        return allMatch;\n    }, []);\n\n    const isInBlockquote = useCallback(() => {\n        if (!viewRef.current) return false;\n        const { from, to } = viewRef.current.state.selection;\n        let inQuote = false;\n        viewRef.current.state.doc.nodesBetween(from, to, node => {\n            if (node.type === schema.nodes.blockquote) {\n                inQuote = true;\n                return false;              // early exit\n            }\n            return true;\n        });\n        return inQuote;\n    }, []);\n\n    return (\n        <div className={styles.editor} style={{ maxWidth: '800px', margin: '0 auto', padding: '20px' }}>\n            {/* Modern Toolbar - Always visible for now */}\n            {isReady && (\n                <div className={styles.modernToolbar} style={{ opacity: 1, visibility: 'visible', position: 'relative', top: 'auto', left: 'auto', transform: 'none', marginBottom: '20px' }}>\n                    <div className={styles.toolbarContainer}>\n                        {/* Text formatting */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={`${styles.toolBtn} ${isMarkActive(schema.marks.strong) ? styles.active : ''}`}\n                                onClick={toggleBold}\n                                title=\"Bold (B)\"\n                                aria-label=\"Bold\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M13.5 15.5H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5zM10 6.5h3c.55 0 1 .45 1 1s-.45 1-1 1h-3v-2zm5.6 4.5c.75-.9 1.2-2.05 1.2-3.3 0-2.76-2.24-5-5-5H6.5C5.67 2.7 5 3.37 5 4.2v15.6c0 .83.67 1.5 1.5 1.5h8.5c3.31 0 6-2.69 6-6 0-2.5-1.49-4.65-3.4-5.3z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isMarkActive(schema.marks.em) ? styles.active : ''}`}\n                                onClick={toggleItalic}\n                                title=\"Italic (I)\"\n                                aria-label=\"Italic\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4h-8z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Block types */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 1 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(1)}\n                                title=\"Large Heading (1)\"\n                                aria-label=\"Heading 1\"\n                            >\n                                <span className={styles.headingIcon}>H1</span>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 2 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(2)}\n                                title=\"Medium Heading (2)\"\n                                aria-label=\"Heading 2\"\n                            >\n                                <span className={styles.headingIcon}>H2</span>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.heading, { level: 3 }) ? styles.active : ''}`}\n                                onClick={() => setHeading(3)}\n                                title=\"Small Heading (3)\"\n                                aria-label=\"Heading 3\"\n                            >\n                                <span className={styles.headingIcon}>H3</span>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Lists and special blocks */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={toggleBulletList}\n                                title=\"Bullet List\"\n                                aria-label=\"Bullet list\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={toggleOrderedList}\n                                title=\"Numbered List\"\n                                aria-label=\"Numbered list\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isInBlockquote() ? styles.active : ''}`}\n                                onClick={setBlockquote}\n                                title=\"Quote (>)\"\n                                aria-label=\"Quote\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* Media and special */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={insertImage}\n                                title=\"Add Image\"\n                                aria-label=\"Insert image\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={`${styles.toolBtn} ${isBlockActive(schema.nodes.code_block) ? styles.active : ''}`}\n                                onClick={setCodeBlock}\n                                title=\"Code Block\"\n                                aria-label=\"Code block\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0L19.2 12l-4.6-4.6L16 6l6 6-6 6-1.4-1.4z\" />\n                                </svg>\n                            </button>\n                        </div>\n\n                        <div className={styles.divider}></div>\n\n                        {/* History */}\n                        <div className={styles.formatGroup}>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={undoCommand}\n                                title=\"Undo (Z)\"\n                                aria-label=\"Undo\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z\" />\n                                </svg>\n                            </button>\n                            <button\n                                className={styles.toolBtn}\n                                onClick={redoCommand}\n                                title=\"Redo (Y)\"\n                                aria-label=\"Redo\"\n                            >\n                                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\n                                    <path d=\"M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z\" />\n                                </svg>\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            )}\n\n            {/* Loading state */}\n            {!isReady && (\n                <div className={styles.loading}>\n                    <div className={styles.loadingSpinner}></div>\n                    <span>Loading editor...</span>\n                </div>\n            )}\n\n            {/* Editor content with safe styling */}\n            <div\n                ref={editorRef}\n                className={styles.prosemirrorEditor}\n                aria-label=\"Rich text editor\"\n                style={{\n                    minHeight: '400px',\n                    opacity: isReady ? 1 : 0.3\n                }}\n            />\n        </div>\n    );\n});\n\nEditor.displayName = 'Editor';\n\nexport default Editor; "],"names":[],"mappings":";;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAjBA;;;;;;;;;;;;;;;AAmBA;;;;;;;;;;;CAWC,GACD,MAAM,uBAAS,GAAA,6JAAA,CAAA,UAAK,CAAC,UAAU,SAAC,CAAC,EAC7B,SAAS,EACT,iBAAiB,EAAE,EACnB,QAAQ,EACR,cAAc,oBAAoB,EAClC,YAAY,EAAE,EACjB,EAAE;;IACC,MAAM,YAAY,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE;IACzB,MAAM,UAAU,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE;IACvB,MAAM,cAAc,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAE,WAAW,4CAA4C;IAClF,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEvC,sCAAsC;IACtC,YAAY,OAAO,GAAG;IAEtB,2CAA2C;IAC3C,MAAM,qBAAqB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;kDAAE,CAAC;YACpC,IAAI,CAAC,QAAQ,OAAO,EAAE;YAEtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,EAAE,SAAS,EAAE,GAAG;YAEtB,0CAA0C;YAC1C,MAAM,WAAW,0HAAA,CAAA,SAAM,CAAC,IAAI,CAAC;YAE7B,wDAAwD;YACxD,MAAM,cAAc,MAAM,EAAE,CAAC,oBAAoB,CAAC;YAElD,wBAAwB;YACxB,SAAS;YAET,mBAAmB;YACnB,QAAQ,OAAO,CAAC,KAAK;QACzB;iDAAG,EAAE;IAEL,oCAAoC;IACpC,6JAAA,CAAA,UAAK,CAAC,mBAAmB,CAAC;sCAAK,IAAM,CAAC;gBAClC,YAAY;gBACZ,KAAK;kDAAE,IAAM,QAAQ,OAAO,EAAE;;YAClC,CAAC;qCAAG;QAAC;KAAmB;IAExB,gCAAgC;IAChC,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;4BAAE;YACN,4DAA4D;YAC5D,uCAAmC;;YAEnC;YAEA,IAAI,CAAC,UAAU,OAAO,IAAI,QAAQ,OAAO,EAAE;gBACvC;YACJ;YAEA,IAAI;gBACA,6DAA6D;gBAC7D,IAAI,aAAa,CAAA,GAAA,0HAAA,CAAA,sBAAmB,AAAD;gBAEnC,wEAAwE;gBAExE,uCAAuC;gBACvC,MAAM,QAAQ,wJAAA,CAAA,cAAW,CAAC,MAAM,CAAC;oBAC7B,KAAK;oBACL,SAAS;wBACL,CAAA,GAAA,yJAAA,CAAA,SAAM,AAAD,EAAE;4BACH,2CAA2C;4BAC3C,SAAS,CAAA,GAAA,2JAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,MAAM;4BACvC,SAAS,CAAA,GAAA,2JAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,EAAE;4BACnC,SAAS,0JAAA,CAAA,OAAI;4BACb,SAAS,0JAAA,CAAA,OAAI;4BACb,4BAA4B;4BAC5B,SAAS,CAAA,GAAA,iKAAA,CAAA,gBAAa,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS;4BAC7C,SAAS,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS;4BAC5C,SAAS,CAAA,GAAA,iKAAA,CAAA,eAAY,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS;4BAC5C,OAAO;0DAAE,CAAC,OAAO;oCACb,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS;oCAEjC,QAAQ,GAAG,CAAC,iDAAiD,MAAM,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,MAAM,YAAY;oCAEjH,IAAI,MAAM,MAAM,CAAC,IAAI,KAAK,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,EAAE;wCAC9C,MAAM,eAAe,MAAM,MAAM,CAAC,WAAW,CAAC,KAAK,CAAC,GAAG,MAAM,YAAY;wCAEzE,kDAAkD;wCAClD,MAAM,eAAe,aAAa,KAAK,CAAC;wCACxC,IAAI,cAAc;4CACd,MAAM,QAAQ,YAAY,CAAC,EAAE,CAAC,MAAM;4CACpC,MAAM,KAAK,MAAM,EAAE,CACd,MAAM,CAAC,MAAM,KAAK,IAAI,MAAM,GAAG,EAC/B,YAAY,CAAC,MAAM,KAAK,IAAI,MAAM,KAAK,IAAI,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,OAAO,EAAE;gDAAE;4CAAM;4CAC9E,SAAS;4CACT,OAAO;wCACX;wCAEA,qCAAqC;wCACrC,MAAM,YAAY,aAAa,KAAK,CAAC;wCACrC,IAAI,WAAW;4CACX,MAAM,QAAQ,MAAM,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC,MAAM;4CAC7C,MAAM,KAAK,MAAM,EAAE,CACd,MAAM,CAAC,OAAO,MAAM,GAAG,EACvB,UAAU,CAAC,SAAS,CAAC,EAAE,GAAG,KAAK,OAC/B,OAAO,CAAC,OAAO,QAAQ,SAAS,CAAC,EAAE,CAAC,MAAM,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,MAAM;4CACpE,SAAS;4CACT,OAAO;wCACX;wCAEA,uCAAuC;wCACvC,MAAM,cAAc,aAAa,KAAK,CAAC;wCACvC,IAAI,aAAa;4CACb,MAAM,QAAQ,MAAM,GAAG,GAAG,WAAW,CAAC,EAAE,CAAC,MAAM;4CAC/C,MAAM,KAAK,MAAM,EAAE,CACd,MAAM,CAAC,OAAO,MAAM,GAAG,EACvB,UAAU,CAAC,WAAW,CAAC,EAAE,GAAG,KAAK,OACjC,OAAO,CAAC,OAAO,QAAQ,WAAW,CAAC,EAAE,CAAC,MAAM,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,EAAE;4CAClE,SAAS;4CACT,OAAO;wCACX;wCAEA,0CAA0C;wCAC1C,MAAM,YAAY,aAAa,KAAK,CAAC;wCACrC,IAAI,WAAW;4CACX,MAAM,QAAQ,MAAM,GAAG,GAAG,SAAS,CAAC,EAAE,CAAC,MAAM;4CAC7C,MAAM,KAAK,MAAM,EAAE,CACd,MAAM,CAAC,OAAO,MAAM,GAAG,EACvB,UAAU,CAAC,SAAS,CAAC,EAAE,GAAG,KAAK,OAC/B,OAAO,CAAC,OAAO,QAAQ,SAAS,CAAC,EAAE,CAAC,MAAM,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,IAAI;4CAClE,SAAS;4CACT,OAAO;wCACX;wCAEA,yDAAyD;wCACzD,MAAM,cAAc,aAAa,KAAK,CAAC;wCACvC,IAAI,aAAa;4CACb,QAAQ,GAAG,CAAC,sBAAsB,WAAW,CAAC,EAAE;4CAChD,IAAI;gDACA,iDAAiD;gDACjD,MAAM,WAAW,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAC3C,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM;gDAEjC,MAAM,aAAa,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM;gDAEzD,6CAA6C;gDAC7C,MAAM,UAAU,MAAM,GAAG,GAAG,GAAG,uBAAuB;gDACtD,IAAI,KAAK,MAAM,EAAE,CACZ,MAAM,CAAC,SAAS,MAAM,GAAG,EAAE,4BAA4B;iDACvD,WAAW,CAAC,SAAS,SAAS;gDAEnC,oEAAoE;gDACpE,KAAK,GAAG,YAAY,CAAC,wJAAA,CAAA,gBAAa,CAAC,MAAM,CAAC,GAAG,GAAG,EAAE,UAAU;gDAE5D,SAAS;gDACT,QAAQ,GAAG,CAAC;gDACZ,OAAO;4CACX,EAAE,OAAO,OAAO;gDACZ,QAAQ,GAAG,CAAC,qCAAqC;4CACrD;wCACJ;wCAEA,+CAA+C;wCAC/C,MAAM,eAAe,aAAa,KAAK,CAAC;wCACxC,IAAI,cAAc;4CACd,QAAQ,GAAG,CAAC,uBAAuB,YAAY,CAAC,EAAE;4CAClD,IAAI;gDACA,iDAAiD;gDACjD,MAAM,WAAW,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAC3C,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM;gDAEjC,MAAM,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM;gDAE3D,qCAAqC;gDACrC,MAAM,cAAc,MAAM,GAAG,GAAG,GAAG,uBAAuB;gDAC1D,IAAI,KAAK,MAAM,EAAE,CACZ,MAAM,CAAC,aAAa,MAAM,GAAG,EAAE,wBAAwB;iDACvD,WAAW,CAAC,aAAa,aAAa;gDAE3C,oEAAoE;gDACpE,KAAK,GAAG,YAAY,CAAC,wJAAA,CAAA,gBAAa,CAAC,MAAM,CAAC,GAAG,GAAG,EAAE,cAAc;gDAEhE,SAAS;gDACT,QAAQ,GAAG,CAAC;gDACZ,OAAO;4CACX,EAAE,OAAO,OAAO;gDACZ,QAAQ,GAAG,CAAC,sCAAsC;4CACtD;wCACJ;oCACJ;oCAEA,yBAAyB;oCACzB,OAAO;gCACX;;wBACJ;wBACA,CAAA,GAAA,yJAAA,CAAA,SAAM,AAAD,EAAE,2JAAA,CAAA,aAAU;wBACjB,CAAA,GAAA,0JAAA,CAAA,UAAO,AAAD;wBACN,CAAA,GAAA,6JAAA,CAAA,aAAU,AAAD;wBACT,CAAA,GAAA,4JAAA,CAAA,YAAS,AAAD;qBACX;gBACL;gBAEA,wCAAwC;gBACxC,MAAM,OAAO,IAAI,uJAAA,CAAA,aAAU,CAAC,UAAU,OAAO,EAAE;oBAC3C;oBACA,QAAQ;4CAAE,IAAM;;oBAChB,mBAAmB;4CAAE,CAAC;4BAClB,6BAA6B;4BAC7B,MAAM,WAAW,KAAK,KAAK,CAAC,KAAK,CAAC;4BAClC,KAAK,WAAW,CAAC;4BAEjB,mDAAmD;4BACnD,IAAI,YAAY,UAAU,IAAI,YAAY,OAAO,EAAE;gCAC/C,MAAM,OAAO,CAAA,GAAA,0HAAA,CAAA,kBAAe,AAAD,EAAE,SAAS,GAAG;gCACzC,MAAM,OAAO,SAAS,GAAG,CAAC,MAAM;gCAChC,YAAY,OAAO,CAAC,MAAM;4BAC9B;wBACJ;;oBACA,YAAY;wBACR,oBAAoB,eAAe;oBACvC;gBACJ;gBAEA,QAAQ,OAAO,GAAG;gBAClB,WAAW;gBAEX,oCAAoC;gBACpC;wCAAW;wBACP,IAAI,QAAQ,CAAC,KAAK,WAAW,EAAE;4BAC3B,KAAK,KAAK;wBACd;oBACJ;uCAAG;YAEP,EAAE,OAAO,OAAO;gBACZ,QAAQ,KAAK,CAAC,8BAA8B;gBAC5C,WAAW;YACf;YAEA,mBAAmB;YACnB;oCAAO;oBACH,IAAI,QAAQ,OAAO,EAAE;wBACjB,QAAQ,OAAO,CAAC,OAAO;wBACvB,QAAQ,OAAO,GAAG;oBACtB;gBACJ;;QACJ;2BAAG,EAAE,GAAG,yDAAyD;IAEjE,iDAAiD;IACjD,MAAM,aAAa,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;0CAAE;YAC3B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,UAAU,CAAA,GAAA,2JAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,MAAM;YAC9C,IAAI,QAAQ,OAAO,WAAW;gBAC1B,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;yCAAG,EAAE;IAEL,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;4CAAE;YAC7B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,UAAU,CAAA,GAAA,2JAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,EAAE;YAC1C,IAAI,QAAQ,OAAO,WAAW;gBAC1B,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;2CAAG,EAAE;IAEL,MAAM,aAAa,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;0CAAE,CAAC;YAC5B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,UAAU,CAAA,GAAA,4HAAA,CAAA,aAAU,AAAD,EAAE;YAC3B,IAAI,QAAQ,OAAO,UAAU,QAAQ,OAAO,GAAG;gBAC3C,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;yCAAG,EAAE;IAEL,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;4CAAE;YAC7B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,UAAU,CAAA,GAAA,4HAAA,CAAA,eAAY,AAAD;YAC3B,IAAI,QAAQ,OAAO,UAAU,QAAQ,OAAO,GAAG;gBAC3C,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;2CAAG,EAAE;IAEL,MAAM,gBAAgB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;6CAAE;YAC9B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,UAAU,4HAAA,CAAA,mBAAgB;YAChC,IAAI,QAAQ,OAAO,UAAU,QAAQ,OAAO,GAAG;gBAC3C,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;4CAAG,EAAE;IAEL,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;4CAAE;YAC7B,IAAI,CAAC,QAAQ,OAAO,EAAE;YAEtB,wBAAwB;YACxB,MAAM,WAAW,OAAO,+DAA+D;YACvF,IAAI,CAAC,UAAU;YAEf,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,MAAM,SAAS;YAEpC,4CAA4C;YAC5C,MAAM,YAAY,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC;gBAAE,UAAU,SAAS,WAAW;YAAG;YACpF,MAAM,cAAc,MAAM,EAAE,CAAC,gBAAgB,CAAC,MAAM,IAAI;YAExD,IAAI,UAAU;gBACV,SAAS;gBACT,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;2CAAG,EAAE;IAEL,MAAM,mBAAmB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;gDAAE;YACjC,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,QAAQ,GAAG,CAAC;YACZ,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,MAAM,SAAS;YAEtC,IAAI;gBACA,oCAAoC;gBACpC,MAAM,WAAW,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAC3C,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,MAAM,MAAM,CAAC,OAAO;gBAE5D,MAAM,aAAa,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,WAAW,CAAC,MAAM,CAAC,MAAM;gBAEzD,MAAM,KAAK,MAAM,EAAE,CAAC,WAAW,CAAC,MAAM,KAAK,IAAI,IAAI,GAAG,IAAI;gBAC1D,SAAS;gBACT,QAAQ,GAAG,CAAC;gBACZ,QAAQ,OAAO,CAAC,KAAK;YACzB,EAAE,OAAO,OAAO;gBACZ,QAAQ,GAAG,CAAC,uCAAuC;gBACnD,yBAAyB;gBACzB,MAAM,UAAU,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,WAAW;gBACnD,MAAM,SAAS,QAAQ,OAAO;gBAC9B,QAAQ,GAAG,CAAC,+BAA+B;gBAC3C,IAAI,QAAQ,QAAQ,OAAO,CAAC,KAAK;YACrC;QACJ;+CAAG,EAAE;IAEL,MAAM,oBAAoB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;iDAAE;YAClC,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,QAAQ,GAAG,CAAC;YACZ,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,MAAM,EAAE,KAAK,EAAE,GAAG,EAAE,GAAG,MAAM,SAAS;YAEtC,IAAI;gBACA,oCAAoC;gBACpC,MAAM,WAAW,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAC3C,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,SAAS,CAAC,MAAM,CAAC,MAAM,MAAM,MAAM,CAAC,OAAO;gBAE5D,MAAM,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,MAAM;gBAE3D,MAAM,KAAK,MAAM,EAAE,CAAC,WAAW,CAAC,MAAM,KAAK,IAAI,IAAI,GAAG,IAAI;gBAC1D,SAAS;gBACT,QAAQ,GAAG,CAAC;gBACZ,QAAQ,OAAO,CAAC,KAAK;YACzB,EAAE,OAAO,OAAO;gBACZ,QAAQ,GAAG,CAAC,wCAAwC;gBACpD,yBAAyB;gBACzB,MAAM,UAAU,CAAA,GAAA,iKAAA,CAAA,aAAU,AAAD,EAAE,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,YAAY;gBACpD,MAAM,SAAS,QAAQ,OAAO;gBAC9B,QAAQ,GAAG,CAAC,+BAA+B;gBAC3C,IAAI,QAAQ,QAAQ,OAAO,CAAC,KAAK;YACrC;QACJ;gDAAG,EAAE;IAEL,MAAM,cAAc,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;2CAAE;YAC5B,MAAM,MAAM,OAAO;YACnB,IAAI,OAAO,QAAQ,OAAO,EAAE;gBACxB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;gBAC3C,MAAM,YAAY,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC;oBAAE,KAAK;oBAAK,KAAK;gBAAG;gBAChE,MAAM,cAAc,MAAM,EAAE,CAAC,oBAAoB,CAAC;gBAClD,SAAS;gBACT,QAAQ,OAAO,CAAC,KAAK;YACzB;QACJ;0CAAG,EAAE;IAEL,MAAM,cAAc,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;2CAAE;YAC5B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,CAAA,GAAA,0JAAA,CAAA,OAAI,AAAD,EAAE,OAAO;YACZ,QAAQ,OAAO,CAAC,KAAK;QACzB;0CAAG,EAAE;IAEL,MAAM,cAAc,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;2CAAE;YAC5B,IAAI,CAAC,QAAQ,OAAO,EAAE;YACtB,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG,QAAQ,OAAO;YAC3C,CAAA,GAAA,0JAAA,CAAA,OAAI,AAAD,EAAE,OAAO;YACZ,QAAQ,OAAO,CAAC,KAAK;QACzB;0CAAG,EAAE;IAEL,6EAA6E;IAC7E,MAAM,eAAe,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;4CAAE,CAAC;YAC9B,IAAI,CAAC,QAAQ,OAAO,EAAE,OAAO;YAC7B,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,EAAE,EAAE,KAAK,EAAE,GAAG,QAAQ,OAAO,CAAC,KAAK,CAAC,SAAS;YAClE,IAAI,OAAO;gBACP,OAAO,SAAS,OAAO,CAAC,QAAQ,OAAO,CAAC,KAAK,CAAC,WAAW,IAAI,MAAM,KAAK;YAC5E;YACA,OAAO,QAAQ,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,MAAM,IAAI;QAC5D;2CAAG,EAAE;IAEL,MAAM,gBAAgB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;6CAAE,CAAC,UAAU,QAAQ,CAAC,CAAC;YACnD,IAAI,CAAC,QAAQ,OAAO,EAAE,OAAO;YAC7B,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,QAAQ,OAAO,CAAC,KAAK,CAAC,SAAS;YACpD,IAAI,WAAW;YAEf,QAAQ,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,MAAM;qDAAI,CAAA;oBAC7C,IAAI,KAAK,WAAW,IAAI,CAAC,KAAK,SAAS,CAAC,UAAU,QAAQ;wBACtD,WAAW;wBACX,OAAO,OAAgB,aAAa;oBACxC;oBACA,OAAO;gBACX;;YACA,OAAO;QACX;4CAAG,EAAE;IAEL,MAAM,iBAAiB,CAAA,GAAA,6JAAA,CAAA,cAAW,AAAD;8CAAE;YAC/B,IAAI,CAAC,QAAQ,OAAO,EAAE,OAAO;YAC7B,MAAM,EAAE,IAAI,EAAE,EAAE,EAAE,GAAG,QAAQ,OAAO,CAAC,KAAK,CAAC,SAAS;YACpD,IAAI,UAAU;YACd,QAAQ,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,YAAY,CAAC,MAAM;sDAAI,CAAA;oBAC7C,IAAI,KAAK,IAAI,KAAK,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,UAAU,EAAE;wBACvC,UAAU;wBACV,OAAO,OAAoB,aAAa;oBAC5C;oBACA,OAAO;gBACX;;YACA,OAAO;QACX;6CAAG,EAAE;IAEL,qBACI,6LAAC;QAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,MAAM;QAAE,OAAO;YAAE,UAAU;YAAS,QAAQ;YAAU,SAAS;QAAO;;YAExF,yBACG,6LAAC;gBAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,aAAa;gBAAE,OAAO;oBAAE,SAAS;oBAAG,YAAY;oBAAW,UAAU;oBAAY,KAAK;oBAAQ,MAAM;oBAAQ,WAAW;oBAAQ,cAAc;gBAAO;0BACvK,cAAA,6LAAC;oBAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,gBAAgB;;sCAEnC,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;;8CAC9B,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,aAAa,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,MAAM,IAAI,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACxF,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;8CAGhB,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,aAAa,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,EAAE,IAAI,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACpF,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;sCAKpB,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;;;;;;sCAG9B,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;;8CAC9B,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,OAAO,EAAE;wCAAE,OAAO;oCAAE,KAAK,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACxG,SAAS,IAAM,WAAW;oCAC1B,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAK,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;kDAAE;;;;;;;;;;;8CAEzC,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,OAAO,EAAE;wCAAE,OAAO;oCAAE,KAAK,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACxG,SAAS,IAAM,WAAW;oCAC1B,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAK,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;kDAAE;;;;;;;;;;;8CAEzC,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,OAAO,EAAE;wCAAE,OAAO;oCAAE,KAAK,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACxG,SAAS,IAAM,WAAW;oCAC1B,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAK,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;kDAAE;;;;;;;;;;;;;;;;;sCAI7C,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;;;;;;sCAG9B,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;;8CAC9B,6LAAC;oCACG,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;oCACzB,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;8CAGhB,6LAAC;oCACG,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;oCACzB,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;8CAGhB,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,mBAAmB,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCACvE,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;sCAKpB,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;;;;;;sCAG9B,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;;8CAC9B,6LAAC;oCACG,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;oCACzB,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;8CAGhB,6LAAC;oCACG,WAAW,GAAG,sIAAA,CAAA,UAAM,CAAC,OAAO,CAAC,CAAC,EAAE,cAAc,0HAAA,CAAA,SAAM,CAAC,KAAK,CAAC,UAAU,IAAI,sIAAA,CAAA,UAAM,CAAC,MAAM,GAAG,IAAI;oCAC7F,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;sCAKpB,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;;;;;;sCAG9B,6LAAC;4BAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,WAAW;;8CAC9B,6LAAC;oCACG,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;oCACzB,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;8CAGhB,6LAAC;oCACG,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;oCACzB,SAAS;oCACT,OAAM;oCACN,cAAW;8CAEX,cAAA,6LAAC;wCAAI,OAAM;wCAAK,QAAO;wCAAK,SAAQ;wCAAY,MAAK;kDACjD,cAAA,6LAAC;4CAAK,GAAE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAS/B,CAAC,yBACE,6LAAC;gBAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,OAAO;;kCAC1B,6LAAC;wBAAI,WAAW,sIAAA,CAAA,UAAM,CAAC,cAAc;;;;;;kCACrC,6LAAC;kCAAK;;;;;;;;;;;;0BAKd,6LAAC;gBACG,KAAK;gBACL,WAAW,sIAAA,CAAA,UAAM,CAAC,iBAAiB;gBACnC,cAAW;gBACX,OAAO;oBACH,WAAW;oBACX,SAAS,UAAU,IAAI;gBAC3B;;;;;;;;;;;;AAIhB;;AAEA,OAAO,WAAW,GAAG;uCAEN","debugId":null}},
    {"offset": {"line": 6301, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/services/reflectionService.ts"],"sourcesContent":["import {\n    doc,\n    setDoc,\n    getDoc,\n    query,\n    collection,\n    where,\n    getDocs,\n    orderBy,\n    limit,\n    serverTimestamp,\n    Timestamp,\n    deleteDoc\n} from 'firebase/firestore';\nimport { db, auth } from '../firebase/clientApp';\n\nexport interface ReflectionPrompt {\n    id: string;\n    text: string;\n    type: 'emotion' | 'choice' | 'note' | 'custom';\n    triggerPosition?: 'paragraph' | 'percentage'; // Where to trigger the prompt\n    isDefault: boolean;\n}\n\nexport interface ReflectionResponse {\n    id: string;\n    userId: string;\n    articleId: string;\n    promptId: string;\n    promptText: string;\n    response: string;\n    position: number; // Paragraph index or percentage where prompt appeared\n    createdAt: Timestamp;\n    isPrivate: boolean;\n}\n\nexport interface ReflectionJournalEntry {\n    userId: string;\n    articleId: string;\n    articleTitle: string;\n    articleSlug: string;\n    responses: ReflectionResponse[];\n    createdAt: Timestamp;\n    updatedAt: Timestamp;\n}\n\n// Default reflection prompts\nexport const DEFAULT_REFLECTION_PROMPTS: ReflectionPrompt[] = [\n    {\n        id: 'emotion-1',\n        text: 'How does this make you feel?',\n        type: 'emotion',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'choice-1',\n        text: 'Would you have made the same choice?',\n        type: 'choice',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'note-1',\n        text: 'Write your own note to the author.',\n        type: 'note',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'custom-1',\n        text: 'What questions does this raise for you?',\n        type: 'custom',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    },\n    {\n        id: 'custom-2',\n        text: 'How does this relate to your own experience?',\n        type: 'custom',\n        triggerPosition: 'paragraph',\n        isDefault: true\n    }\n];\n\n// Save reflection response to Firestore and local storage\nexport async function saveReflectionResponse(\n    articleId: string,\n    promptId: string,\n    promptText: string,\n    response: string,\n    position: number,\n    isPrivate: boolean = true\n): Promise<void> {\n    console.log('saveReflectionResponse called with:', {\n        articleId,\n        promptId,\n        promptText,\n        response,\n        position,\n        isPrivate\n    });\n\n    const user = auth.currentUser;\n    console.log('Current user:', user ? user.uid : 'Not authenticated');\n\n    if (!user) {\n        // Save to local storage if user is not authenticated\n        console.log('User not authenticated, saving to local storage');\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n        return;\n    }\n\n    const responseId = `${user.uid}_${articleId}_${promptId}_${Date.now()}`;\n    const reflectionDoc = doc(db, 'reflectionResponses', responseId);\n\n    const reflectionResponse: ReflectionResponse = {\n        id: responseId,\n        userId: user.uid,\n        articleId,\n        promptId,\n        promptText,\n        response,\n        position,\n        createdAt: serverTimestamp() as Timestamp,\n        isPrivate\n    };\n\n    try {\n        console.log('Attempting to save to Firestore with ID:', responseId);\n        await setDoc(reflectionDoc, reflectionResponse);\n        console.log('Successfully saved to Firestore');\n\n        // Also save a backup to local storage\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n    } catch (error) {\n        console.error('Error saving reflection response:', error);\n        // Fallback to local storage\n        saveReflectionToLocalStorage(articleId, promptId, promptText, response, position, isPrivate);\n    }\n}\n\n// Save to local storage for offline functionality\nfunction saveReflectionToLocalStorage(\n    articleId: string,\n    promptId: string,\n    promptText: string,\n    response: string,\n    position: number,\n    isPrivate: boolean\n): void {\n    try {\n        const storageKey = `reflection_${articleId}`;\n        console.log('Saving to local storage with key:', storageKey);\n\n        const existingData = localStorage.getItem(storageKey);\n        const reflections = existingData ? JSON.parse(existingData) : [];\n        console.log('Existing reflections:', reflections.length);\n\n        const newReflection = {\n            id: `local_${Date.now()}`,\n            promptId,\n            promptText,\n            response,\n            position,\n            createdAt: new Date().toISOString(),\n            isPrivate\n        };\n\n        reflections.push(newReflection);\n        localStorage.setItem(storageKey, JSON.stringify(reflections));\n        console.log('Successfully saved to local storage. Total reflections:', reflections.length);\n    } catch (error) {\n        console.error('Error saving reflection to local storage:', error);\n    }\n}\n\n// Get reflection responses for an article\nexport async function getReflectionResponses(articleId: string): Promise<ReflectionResponse[]> {\n    const user = auth.currentUser;\n\n    // Start with local storage data\n    const localReflections = getReflectionsFromLocalStorage(articleId);\n\n    if (!user) {\n        return localReflections;\n    }\n\n    try {\n        const reflectionRef = collection(db, 'reflectionResponses');\n        const q = query(\n            reflectionRef,\n            where('userId', '==', user.uid),\n            where('articleId', '==', articleId),\n            orderBy('createdAt', 'asc')\n        );\n\n        const querySnapshot = await getDocs(q);\n        const firestoreReflections = querySnapshot.docs.map(doc => ({\n            ...doc.data(),\n            createdAt: doc.data().createdAt\n        })) as ReflectionResponse[];\n\n        // Merge local and Firestore data, removing duplicates\n        const allReflections = [...firestoreReflections, ...localReflections];\n        const uniqueReflections = allReflections.filter((reflection, index, self) =>\n            index === self.findIndex(r => r.promptId === reflection.promptId && r.position === reflection.position)\n        );\n\n        return uniqueReflections.sort((a, b) => a.position - b.position);\n    } catch (error) {\n        console.error('Error fetching reflection responses:', error);\n        return localReflections;\n    }\n}\n\n// Get reflections from local storage\nfunction getReflectionsFromLocalStorage(articleId: string): ReflectionResponse[] {\n    try {\n        const storageKey = `reflection_${articleId}`;\n        const data = localStorage.getItem(storageKey);\n        if (!data) return [];\n\n        const reflections = JSON.parse(data);\n        return reflections.map((reflection: any) => ({\n            ...reflection,\n            userId: 'local',\n            articleId,\n            createdAt: new Date(reflection.createdAt) as any\n        }));\n    } catch (error) {\n        console.error('Error reading reflections from local storage:', error);\n        return [];\n    }\n}\n\n// Get a random reflection prompt - optimized for speed\nexport function getRandomReflectionPrompt(): ReflectionPrompt {\n    const randomIndex = Math.floor(Math.random() * DEFAULT_REFLECTION_PROMPTS.length);\n    return DEFAULT_REFLECTION_PROMPTS[randomIndex];\n}\n\n// Get a specific prompt by index for testing (faster than random)\nexport function getPromptByIndex(index: number): ReflectionPrompt {\n    return DEFAULT_REFLECTION_PROMPTS[index % DEFAULT_REFLECTION_PROMPTS.length];\n}\n\n// Create a reflection journal entry\nexport async function createReflectionJournal(\n    articleId: string,\n    articleTitle: string,\n    articleSlug: string,\n    responses: ReflectionResponse[]\n): Promise<void> {\n    const user = auth.currentUser;\n    if (!user) return;\n\n    const journalId = `${user.uid}_${articleId}`;\n    const journalDoc = doc(db, 'reflectionJournals', journalId);\n\n    const journalEntry: ReflectionJournalEntry = {\n        userId: user.uid,\n        articleId,\n        articleTitle,\n        articleSlug,\n        responses,\n        createdAt: serverTimestamp() as Timestamp,\n        updatedAt: serverTimestamp() as Timestamp\n    };\n\n    try {\n        await setDoc(journalDoc, journalEntry);\n    } catch (error) {\n        console.error('Error creating reflection journal:', error);\n    }\n}\n\n// Get user's reflection journals - build from individual responses\nexport async function getUserReflectionJournals(userId?: string): Promise<ReflectionJournalEntry[]> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    // Get all reflection responses and build journal entries from them\n    const journalMap = new Map<string, ReflectionJournalEntry>();\n\n    // Get from Firestore if user is authenticated\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc')\n            );\n\n            const querySnapshot = await getDocs(q);\n            querySnapshot.docs.forEach(doc => {\n                const response = doc.data() as ReflectionResponse;\n                const articleId = response.articleId;\n\n                if (!journalMap.has(articleId)) {\n                    journalMap.set(articleId, {\n                        userId: response.userId,\n                        articleId: articleId,\n                        articleTitle: `Loading...`, // Will be updated with actual title\n                        articleSlug: articleId,\n                        responses: [],\n                        createdAt: response.createdAt,\n                        updatedAt: response.createdAt\n                    });\n                }\n\n                const journal = journalMap.get(articleId)!;\n                journal.responses.push(response);\n                // Update the updated time to the latest response\n                if (response.createdAt > journal.updatedAt) {\n                    journal.updatedAt = response.createdAt;\n                }\n            });\n        } catch (error) {\n            console.error('Error fetching reflection responses from Firestore:', error);\n        }\n    }\n\n    // Also get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n\n        localStorageKeys.forEach(key => {\n            const articleId = key.replace('reflection_', '');\n            const data = localStorage.getItem(key);\n            if (!data) return;\n\n            try {\n                const reflections = JSON.parse(data);\n                if (!Array.isArray(reflections)) return;\n\n                reflections.forEach((reflection: any) => {\n                    const response: ReflectionResponse = {\n                        id: reflection.id || `local_${Date.now()}`,\n                        userId: 'local',\n                        articleId: articleId,\n                        promptId: reflection.promptId,\n                        promptText: reflection.promptText,\n                        response: reflection.response,\n                        position: reflection.position,\n                        createdAt: new Date(reflection.createdAt) as any,\n                        isPrivate: reflection.isPrivate\n                    };\n\n                    if (!journalMap.has(articleId)) {\n                        journalMap.set(articleId, {\n                            userId: 'local',\n                            articleId: articleId,\n                            articleTitle: `Loading...`, // Will be updated with actual title\n                            articleSlug: articleId,\n                            responses: [],\n                            createdAt: response.createdAt,\n                            updatedAt: response.createdAt\n                        });\n                    }\n\n                    const journal = journalMap.get(articleId)!;\n                    // Check if this response already exists (avoid duplicates)\n                    const exists = journal.responses.some(r =>\n                        r.promptId === response.promptId &&\n                        r.position === response.position &&\n                        r.response === response.response\n                    );\n\n                    if (!exists) {\n                        journal.responses.push(response);\n                        if (response.createdAt > journal.updatedAt) {\n                            journal.updatedAt = response.createdAt;\n                        }\n                    }\n                });\n            } catch (error) {\n                console.error('Error parsing local storage reflection data:', error);\n            }\n        });\n    } catch (error) {\n        console.error('Error reading from local storage:', error);\n    }\n\n    // Convert map to array and fetch article titles\n    const journals = Array.from(journalMap.values()).filter(journal => journal.responses.length > 0);\n\n    // Fetch article metadata for each journal using Firebase document ID\n    await Promise.all(journals.map(async (journal) => {\n        try {\n            // Use Firebase getArticleById since the articleId is a Firebase document ID\n            const { getArticleById } = await import('@/firebase/articles');\n            const firebaseArticle = await getArticleById(journal.articleId);\n\n            if (firebaseArticle) {\n                journal.articleTitle = firebaseArticle.title;\n                journal.articleSlug = firebaseArticle.slug || journal.articleId; // Update slug if available\n                console.log(`Successfully fetched title for ${journal.articleId}: ${firebaseArticle.title}`);\n            } else {\n                journal.articleTitle = `Article: ${journal.articleId}`;\n                console.log(`Article not found for ID: ${journal.articleId}`);\n            }\n        } catch (error) {\n            console.error(`Error fetching article for ${journal.articleId}:`, error);\n            journal.articleTitle = `Article: ${journal.articleId}`;\n        }\n    }));\n\n    // Sort by updated time\n    journals.sort((a, b) => {\n        const timeA = a.updatedAt instanceof Date ? a.updatedAt.getTime() : a.updatedAt.toMillis();\n        const timeB = b.updatedAt instanceof Date ? b.updatedAt.getTime() : b.updatedAt.toMillis();\n        return timeB - timeA;\n    });\n\n    return journals;\n}\n\n// Delete a reflection response\nexport async function deleteReflectionResponse(\n    articleId: string,\n    reflectionId: string\n): Promise<boolean> {\n    console.log('Deleting reflection:', { articleId, reflectionId });\n\n    const user = auth.currentUser;\n    let deletedFromFirestore = false;\n    let deletedFromLocal = false;\n\n    // Delete from Firestore if user is authenticated\n    if (user) {\n        try {\n            // Try to find and delete from Firestore\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', user.uid),\n                where('articleId', '==', articleId),\n                where('id', '==', reflectionId)\n            );\n\n            const querySnapshot = await getDocs(q);\n            if (!querySnapshot.empty) {\n                const docToDelete = querySnapshot.docs[0];\n                await deleteDoc(docToDelete.ref);\n                console.log('Successfully deleted from Firestore');\n                deletedFromFirestore = true;\n            }\n        } catch (error) {\n            console.error('Error deleting from Firestore:', error);\n        }\n    }\n\n    // Delete from local storage\n    try {\n        const storageKey = `reflection_${articleId}`;\n        const existingData = localStorage.getItem(storageKey);\n\n        if (existingData) {\n            const reflections = JSON.parse(existingData);\n            const filteredReflections = reflections.filter((r: any) => r.id !== reflectionId);\n\n            if (filteredReflections.length !== reflections.length) {\n                if (filteredReflections.length === 0) {\n                    localStorage.removeItem(storageKey);\n                } else {\n                    localStorage.setItem(storageKey, JSON.stringify(filteredReflections));\n                }\n                console.log('Successfully deleted from local storage');\n                deletedFromLocal = true;\n            }\n        }\n    } catch (error) {\n        console.error('Error deleting from local storage:', error);\n    }\n\n    return deletedFromFirestore || deletedFromLocal;\n}\n\n// Get inspiration from user's reflections with metadata\nexport async function getReflectionInspiration(userId?: string): Promise<Array<{ response: string, articleTitle?: string, promptText?: string }>> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    const inspirations: Array<{ response: string, articleTitle?: string, promptText?: string }> = [];\n    const seenResponses = new Set<string>();\n\n    // Get from Firestore if user is authenticated\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc'),\n                limit(10) // Get recent reflections\n            );\n\n            const querySnapshot = await getDocs(q);\n\n            // Create a map to get article titles\n            const articleTitleMap = new Map<string, string>();\n\n            for (const doc of querySnapshot.docs) {\n                const response = doc.data() as ReflectionResponse;\n                if (response.response && response.response.length > 20) {\n                    const normalizedResponse = response.response.toLowerCase().trim();\n                    if (!seenResponses.has(normalizedResponse)) {\n                        seenResponses.add(normalizedResponse);\n\n                        // Try to get article title if not cached\n                        let articleTitle = articleTitleMap.get(response.articleId);\n                        if (!articleTitle) {\n                            try {\n                                const { getArticleById } = await import('@/firebase/articles');\n                                const article = await getArticleById(response.articleId);\n                                articleTitle = article?.title || 'Unknown Article';\n                                articleTitleMap.set(response.articleId, articleTitle);\n                            } catch (error) {\n                                articleTitle = 'Unknown Article';\n                            }\n                        }\n\n                        inspirations.push({\n                            response: response.response,\n                            articleTitle: articleTitle,\n                            promptText: response.promptText\n                        });\n                    }\n                }\n            }\n        } catch (error) {\n            console.error('Error fetching inspiration from Firestore:', error);\n        }\n    }\n\n    // Also get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n        const localReflections: any[] = [];\n\n        localStorageKeys.forEach(key => {\n            const data = localStorage.getItem(key);\n            if (data) {\n                try {\n                    const reflections = JSON.parse(data);\n                    if (Array.isArray(reflections)) {\n                        localReflections.push(...reflections);\n                    }\n                } catch (error) {\n                    console.error('Error parsing local storage reflection:', error);\n                }\n            }\n        });\n\n        // Sort by creation date and take recent ones\n        localReflections\n            .sort((a, b) => new Date(b.createdAt).getTime() - new Date(a.createdAt).getTime())\n            .slice(0, 10)\n            .forEach(reflection => {\n                if (reflection.response && reflection.response.length > 20) {\n                    const normalizedResponse = reflection.response.toLowerCase().trim();\n                    if (!seenResponses.has(normalizedResponse)) {\n                        seenResponses.add(normalizedResponse);\n                        inspirations.push({\n                            response: reflection.response,\n                            articleTitle: 'Local Article', // We could enhance this later\n                            promptText: reflection.promptText\n                        });\n                    }\n                }\n            });\n    } catch (error) {\n        console.error('Error reading inspiration from local storage:', error);\n    }\n\n    // Shuffle and return up to 5 inspirations\n    const shuffled = inspirations.sort(() => Math.random() - 0.5);\n    return shuffled.slice(0, 5);\n}\n\n// Get reflection themes/topics for inspiration\nexport async function getReflectionThemes(userId?: string): Promise<string[]> {\n    const user = auth.currentUser;\n    const targetUserId = userId || user?.uid;\n\n    const themes = new Set<string>();\n    const prompts: string[] = [];\n\n    // Get prompts from Firestore\n    if (user && targetUserId) {\n        try {\n            const reflectionRef = collection(db, 'reflectionResponses');\n            const q = query(\n                reflectionRef,\n                where('userId', '==', targetUserId),\n                orderBy('createdAt', 'desc'),\n                limit(20)\n            );\n\n            const querySnapshot = await getDocs(q);\n            querySnapshot.docs.forEach(doc => {\n                const response = doc.data() as ReflectionResponse;\n                if (response.promptText) {\n                    prompts.push(response.promptText);\n                }\n            });\n        } catch (error) {\n            console.error('Error fetching themes from Firestore:', error);\n        }\n    }\n\n    // Get from local storage\n    try {\n        const localStorageKeys = Object.keys(localStorage).filter(key => key.startsWith('reflection_'));\n\n        localStorageKeys.forEach(key => {\n            const data = localStorage.getItem(key);\n            if (data) {\n                try {\n                    const reflections = JSON.parse(data);\n                    if (Array.isArray(reflections)) {\n                        reflections.forEach((reflection: any) => {\n                            if (reflection.promptText) {\n                                prompts.push(reflection.promptText);\n                            }\n                        });\n                    }\n                } catch (error) {\n                    console.error('Error parsing local storage for themes:', error);\n                }\n            }\n        });\n    } catch (error) {\n        console.error('Error reading themes from local storage:', error);\n    }\n\n    // Extract themes from prompts\n    prompts.forEach(prompt => {\n        const lowerPrompt = prompt.toLowerCase();\n        if (lowerPrompt.includes('feel')) themes.add('emotions');\n        if (lowerPrompt.includes('choice') || lowerPrompt.includes('decision')) themes.add('decision-making');\n        if (lowerPrompt.includes('experience')) themes.add('personal experience');\n        if (lowerPrompt.includes('question')) themes.add('questioning');\n        if (lowerPrompt.includes('surprise')) themes.add('unexpected insights');\n        if (lowerPrompt.includes('perspective') || lowerPrompt.includes('view')) themes.add('perspectives');\n        if (lowerPrompt.includes('author')) themes.add('dialogue with authors');\n        if (lowerPrompt.includes('relate') || lowerPrompt.includes('connect')) themes.add('connections');\n    });\n\n    return Array.from(themes).slice(0, 6);\n} "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 6803, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/components/InspirationWidget.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"active\": \"InspirationWidget-module__v4iIya__active\",\n  \"closeButton\": \"InspirationWidget-module__v4iIya__closeButton\",\n  \"content\": \"InspirationWidget-module__v4iIya__content\",\n  \"empty\": \"InspirationWidget-module__v4iIya__empty\",\n  \"footer\": \"InspirationWidget-module__v4iIya__footer\",\n  \"header\": \"InspirationWidget-module__v4iIya__header\",\n  \"inspirationButton\": \"InspirationWidget-module__v4iIya__inspirationButton\",\n  \"inspirationItem\": \"InspirationWidget-module__v4iIya__inspirationItem\",\n  \"inspirationWidget\": \"InspirationWidget-module__v4iIya__inspirationWidget\",\n  \"loading\": \"InspirationWidget-module__v4iIya__loading\",\n  \"refreshButton\": \"InspirationWidget-module__v4iIya__refreshButton\",\n  \"spin\": \"InspirationWidget-module__v4iIya__spin\",\n  \"spinner\": \"InspirationWidget-module__v4iIya__spinner\",\n  \"subtitle\": \"InspirationWidget-module__v4iIya__subtitle\",\n  \"tab\": \"InspirationWidget-module__v4iIya__tab\",\n  \"tabs\": \"InspirationWidget-module__v4iIya__tabs\",\n  \"themeItem\": \"InspirationWidget-module__v4iIya__themeItem\",\n  \"themePrompt\": \"InspirationWidget-module__v4iIya__themePrompt\",\n  \"themeTag\": \"InspirationWidget-module__v4iIya__themeTag\",\n  \"useButton\": \"InspirationWidget-module__v4iIya__useButton\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 6831, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/InspirationWidget.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect } from 'react';\nimport { getReflectionInspiration, getReflectionThemes } from '@/services/reflectionService';\nimport styles from './InspirationWidget.module.css';\n\ninterface InspirationWidgetProps {\n    onInsert?: (text: string) => void;\n}\n\nconst InspirationWidget: React.FC<InspirationWidgetProps> = ({ onInsert }) => {\n    const [isOpen, setIsOpen] = useState(false);\n    const [inspirations, setInspirations] = useState<Array<{response: string, articleTitle?: string, promptText?: string}>>([]);\n    const [themes, setThemes] = useState<string[]>([]);\n    const [loading, setLoading] = useState(false);\n    const [activeTab, setActiveTab] = useState<'inspirations' | 'themes'>('inspirations');\n\n    const loadInspirationData = async () => {\n        setLoading(true);\n        try {\n            const [inspirationData, themeData] = await Promise.all([\n                getReflectionInspiration(),\n                getReflectionThemes()\n            ]);\n            setInspirations(inspirationData);\n            setThemes(themeData);\n        } catch (error) {\n            console.error('Error loading inspiration data:', error);\n        } finally {\n            setLoading(false);\n        }\n    };\n\n    const handleToggle = () => {\n        if (!isOpen) {\n            loadInspirationData();\n        }\n        setIsOpen(!isOpen);\n    };\n\n    const handleInsert = (text: string) => {\n        if (onInsert) {\n            onInsert(text);\n        }\n        setIsOpen(false);\n    };\n\n    const generateWritingPrompt = (theme: string) => {\n        const prompts = {\n            'emotions': 'Explore a moment when your emotions surprised you...',\n            'decision-making': 'Write about a decision that changed your perspective...',\n            'personal experience': 'Reflect on an experience that shaped who you are today...',\n            'questioning': 'What questions have been on your mind lately?',\n            'unexpected insights': 'Share something that recently surprised you...',\n            'perspectives': 'How has your viewpoint on something important changed?',\n            'dialogue with authors': 'What would you say to an author whose work moved you?',\n            'connections': 'Write about connections you\\'ve discovered between different ideas...'\n        };\n        return prompts[theme as keyof typeof prompts] || `Write about ${theme}...`;\n    };\n\n    if (!isOpen) {\n        return (\n            <button\n                onClick={handleToggle}\n                className={styles.inspirationButton}\n                title=\"Get inspiration from your reflections\"\n            >\n                 Inspiration\n            </button>\n        );\n    }\n\n    return (\n        <div className={styles.inspirationWidget}>\n            <div className={styles.header}>\n                <h3> Your Reflection Insights</h3>\n                <button \n                    onClick={() => setIsOpen(false)}\n                    className={styles.closeButton}\n                >\n                    \n                </button>\n            </div>\n\n            <div className={styles.tabs}>\n                <button\n                    className={`${styles.tab} ${activeTab === 'inspirations' ? styles.active : ''}`}\n                    onClick={() => setActiveTab('inspirations')}\n                >\n                    Recent Thoughts ({inspirations.length})\n                </button>\n                <button\n                    className={`${styles.tab} ${activeTab === 'themes' ? styles.active : ''}`}\n                    onClick={() => setActiveTab('themes')}\n                >\n                    Writing Themes ({themes.length})\n                </button>\n            </div>\n\n            <div className={styles.content}>\n                {loading ? (\n                    <div className={styles.loading}>\n                        <div className={styles.spinner}></div>\n                        <p>Loading your insights...</p>\n                    </div>\n                ) : activeTab === 'inspirations' ? (\n                    <div className={styles.inspirationsList}>\n                        {inspirations.length === 0 ? (\n                            <div className={styles.empty}>\n                                <p> No reflections yet!</p>\n                                <p>Start reading articles and reflecting to build your inspiration library.</p>\n                            </div>\n                        ) : (\n                            <>\n                                <p className={styles.subtitle}>Your past reflections that might spark new ideas:</p>\n                                {inspirations.map((inspiration, index) => (\n                                    <div key={index} className={styles.inspirationItem}>\n                                        <p>\"{inspiration.response}\"</p>\n                                        {inspiration.articleTitle && (\n                                            <p style={{ fontSize: '12px', color: '#6b7280', marginTop: '4px' }}>\n                                                From: {inspiration.articleTitle}\n                                            </p>\n                                        )}\n                                        <button\n                                            onClick={() => {\n                                                const attribution = inspiration.articleTitle ? ` (inspired by \"${inspiration.articleTitle}\")` : '';\n                                                handleInsert(`\"${inspiration.response}\"${attribution} - This reminds me of...`);\n                                            }}\n                                            className={styles.useButton}\n                                        >\n                                            Use as starting point\n                                        </button>\n                                    </div>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                ) : (\n                    <div className={styles.themesList}>\n                        {themes.length === 0 ? (\n                            <div className={styles.empty}>\n                                <p> No themes identified yet!</p>\n                                <p>Keep reflecting on articles to discover your writing themes.</p>\n                            </div>\n                        ) : (\n                            <>\n                                <p className={styles.subtitle}>Writing prompts based on your reflection patterns:</p>\n                                {themes.map((theme, index) => (\n                                    <div key={index} className={styles.themeItem}>\n                                        <div className={styles.themeTag}>{theme}</div>\n                                        <p className={styles.themePrompt}>{generateWritingPrompt(theme)}</p>\n                                        <button\n                                            onClick={() => handleInsert(generateWritingPrompt(theme))}\n                                            className={styles.useButton}\n                                        >\n                                            Start writing\n                                        </button>\n                                    </div>\n                                ))}\n                            </>\n                        )}\n                    </div>\n                )}\n            </div>\n\n            <div className={styles.footer}>\n                <button\n                    onClick={loadInspirationData}\n                    className={styles.refreshButton}\n                    disabled={loading}\n                >\n                     Refresh insights\n                </button>\n            </div>\n        </div>\n    );\n};\n\nexport default InspirationWidget; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7194, "column": 0}, "map": {"version":3,"sources":["turbopack:///[project]/src/styles/ArticleComposer.module.css [app-client] (css module)"],"sourcesContent":["__turbopack_context__.v({\n  \"actionButton\": \"ArticleComposer-module__UcJHvq__actionButton\",\n  \"actionButtons\": \"ArticleComposer-module__UcJHvq__actionButtons\",\n  \"articleComposer\": \"ArticleComposer-module__UcJHvq__articleComposer\",\n  \"composerContent\": \"ArticleComposer-module__UcJHvq__composerContent\",\n  \"composerHeader\": \"ArticleComposer-module__UcJHvq__composerHeader\",\n  \"composerLoading\": \"ArticleComposer-module__UcJHvq__composerLoading\",\n  \"coverImageInput\": \"ArticleComposer-module__UcJHvq__coverImageInput\",\n  \"coverImagePreview\": \"ArticleComposer-module__UcJHvq__coverImagePreview\",\n  \"editorContainer\": \"ArticleComposer-module__UcJHvq__editorContainer\",\n  \"errorMessage\": \"ArticleComposer-module__UcJHvq__errorMessage\",\n  \"fadeIn\": \"ArticleComposer-module__UcJHvq__fadeIn\",\n  \"imageUrlInput\": \"ArticleComposer-module__UcJHvq__imageUrlInput\",\n  \"loadingIndicator\": \"ArticleComposer-module__UcJHvq__loadingIndicator\",\n  \"logo\": \"ArticleComposer-module__UcJHvq__logo\",\n  \"logoContainer\": \"ArticleComposer-module__UcJHvq__logoContainer\",\n  \"publishButton\": \"ArticleComposer-module__UcJHvq__publishButton\",\n  \"removeTagButton\": \"ArticleComposer-module__UcJHvq__removeTagButton\",\n  \"savedIndicator\": \"ArticleComposer-module__UcJHvq__savedIndicator\",\n  \"spin\": \"ArticleComposer-module__UcJHvq__spin\",\n  \"tag\": \"ArticleComposer-module__UcJHvq__tag\",\n  \"tagContainer\": \"ArticleComposer-module__UcJHvq__tagContainer\",\n  \"tagInput\": \"ArticleComposer-module__UcJHvq__tagInput\",\n  \"titleInput\": \"ArticleComposer-module__UcJHvq__titleInput\",\n});\n"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}},
    {"offset": {"line": 7225, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/components/ArticleComposer.tsx"],"sourcesContent":["'use client'\n\nimport React, { useState, useEffect, useRef, useCallback } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { v4 as uuidv4 } from 'uuid';\nimport { createArticle, updateArticle, getArticleById, Article } from '@/firebase/articles';\nimport { auth } from '@/firebase/clientApp';\nimport Editor from './Editor';\nimport InspirationWidget from './InspirationWidget';\nimport styles from '@/styles/ArticleComposer.module.css';\nimport { User } from 'firebase/auth';\n\ninterface ArticleComposerProps {\n  articleId?: string; // Optional - if provided, edit mode, otherwise create mode\n  onUpdateComplete?: (updatedArticle?: Article | null) => void; // Callback when update is complete\n}\n\nconst ArticleComposer: React.FC<ArticleComposerProps> = ({ articleId, onUpdateComplete }) => {\n  const router = useRouter();\n  const [title, setTitle] = useState('');\n  const [content, setContent] = useState('');\n  const [tags, setTags] = useState<string[]>([]);\n  const [coverImage, setCoverImage] = useState('');\n  const [isPublishing, setIsPublishing] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [isSaved, setIsSaved] = useState(false);\n  const [error, setError] = useState('');\n  const [isLoading, setIsLoading] = useState(!!articleId);\n  const [user, setUser] = useState<User | null>(null);\n  const [currentTag, setCurrentTag] = useState('');\n  \n  const titleRef = useRef<HTMLTextAreaElement>(null);\n  const tagInputRef = useRef<HTMLInputElement>(null);\n  const editorRef = useRef<any>(null);\n  \n  // Auto-resize title textarea as content grows\n  const autoResizeTitle = useCallback(() => {\n    if (titleRef.current) {\n      titleRef.current.style.height = 'auto';\n      titleRef.current.style.height = `${titleRef.current.scrollHeight}px`;\n      // Set focus to title if it's empty when component loads\n      if (!title && titleRef.current) {\n        titleRef.current.focus();\n      }\n    }\n  }, [title]);\n  \n  // Set up authentication listener\n  useEffect(() => {\n    const unsubscribe = auth.onAuthStateChanged(user => {\n      setUser(user);\n      if (!user) {\n        // Redirect to login if not authenticated\n        router.push('/login?redirect=compose');\n      }\n    });\n    \n    return () => unsubscribe();\n  }, [router]);\n  \n  // Load article data if in edit mode\n  useEffect(() => {\n    if (articleId && user) {\n      const fetchArticle = async () => {\n        try {\n          setIsLoading(true);\n          const article = await getArticleById(articleId);\n          \n          if (!article) {\n            setError('Article not found');\n            router.push('/');\n            return;\n          }\n          \n          // Verify article ownership\n          if (article.authorId !== user.uid) {\n            setError('You can only edit your own articles');\n            router.push('/');\n            return;\n          }\n          \n          // Set form data\n          setTitle(article.title);\n          \n          // Process HTML to extract and clean the content\n          const cleanContent = article.body.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n          setContent(cleanContent);\n          \n          setTags(article.tags || []);\n          setCoverImage(article.coverImage || '');\n        } catch (error) {\n          console.error('Error loading article:', error);\n          setError('Failed to load article');\n        } finally {\n          setIsLoading(false);\n        }\n      };\n      \n      fetchArticle();\n    } else if (!articleId) {\n      // Editor will start with empty content - no need for document model\n      setIsLoading(false);\n    }\n  }, [articleId, user, router]);\n  \n  // Auto-resize title when it changes\n  useEffect(() => {\n    autoResizeTitle();\n  }, [title, autoResizeTitle]);\n  \n  // Auto-save draft periodically (every 30 seconds)\n  useEffect(() => {\n    let timer: NodeJS.Timeout;\n    \n    if (user && title.trim() && content.trim() && !isSaving && !isPublishing) {\n      timer = setTimeout(() => {\n        saveArticle('drafts');\n      }, 30000);\n    }\n    \n    return () => {\n      if (timer) clearTimeout(timer);\n    };\n  }, [user, title, content, isSaving, isPublishing]);\n  \n  // Handle title changes\n  const handleTitleChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\n    setTitle(e.target.value);\n  };\n  \n  // Handle editor content changes with debouncing for better performance\n  const handleEditorChange = useCallback((html: string, json: any) => {\n    // Only update if content has actually changed\n    if (html !== content) {\n      setContent(html);\n      \n      // Reset saved status when content changes\n      if (isSaved) {\n        setIsSaved(false);\n      }\n    }\n  }, [content, isSaved]);\n  \n  // Handle tag input\n  const handleTagInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCurrentTag(e.target.value);\n  };\n  \n  // Handle tag input keydown\n  const handleTagInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    if (e.key === 'Enter' || e.key === ',') {\n      e.preventDefault();\n      addTag();\n    }\n  };\n  \n  // Add a tag\n  const addTag = () => {\n    const tag = currentTag.trim().toLowerCase();\n    if (tag && !tags.includes(tag) && tags.length < 5) {\n      setTags([...tags, tag]);\n      setCurrentTag('');\n    }\n  };\n  \n  // Remove a tag\n  const removeTag = (tagToRemove: string) => {\n    setTags(tags.filter(tag => tag !== tagToRemove));\n  };\n  \n  // Handle cover image input\n  const handleCoverImageChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setCoverImage(e.target.value);\n  };\n  \n  // Handle focus moving from title to editor\n  const handleTitleKeyDown = (e: React.KeyboardEvent<HTMLTextAreaElement>) => {\n    // When user presses Enter in the title field, move focus to the editor\n    if (e.key === 'Enter') {\n      e.preventDefault();\n      // Note: The new Editor component will handle its own focus\n      // when the user starts typing in the editor area\n    }\n  };\n  \n  // Save article (draft or published)\n  const saveArticle = async (status: 'drafts' | 'published' = 'drafts') => {\n    if (!user) {\n      setError('You must be logged in to save an article');\n      return;\n    }\n    \n    if (!title.trim()) {\n      setError('Title is required');\n      return;\n    }\n    \n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    try {\n      setIsSaving(true);\n      setError('');\n      \n      // Clean HTML content to avoid any strange formatting\n      const cleanContent = content.replace(/data-[\\w-]+=\"[^\"]*\"/g, '');\n      \n      const articleData = {\n        title: title.trim(),\n        body: cleanContent,\n        tags,\n        coverImage: coverImage.trim(),\n        status\n      };\n      \n      console.log('Saving article data:', articleData);\n      \n      if (articleId) {\n        try {\n          // Update existing article\n          const updatedArticle = await updateArticle(articleId, articleData);\n          console.log('Article updated successfully:', updatedArticle?.title);\n          \n          // Show saved indicator\n          setIsSaved(true);\n          \n          // Wait a moment for Firebase to fully process the update\n          await new Promise(resolve => setTimeout(resolve, 500));\n          \n          // Get the updated article with fresh data\n          const updatedArticleData = await getArticleById(articleId);\n          console.log('Fetched updated article data:', updatedArticleData?.title);\n          \n          // Call the callback if provided, pass the updated article data\n          if (onUpdateComplete) {\n            onUpdateComplete(updatedArticleData);\n          }\n          \n          // THIS IS CRITICAL: Go directly to the article page by ID (not slug) to avoid issues\n          // when title/slug changes\n          setTimeout(() => {\n            console.log('Applying changes immediately and redirecting to article ID page');\n            // Direct navigation to our ID-based view route\n            window.location.href = `/articles/${articleId}/view?updated=true&time=${Date.now()}`;\n            \n            // Add a fallback in case something goes wrong - but use ID-based routing\n            setTimeout(() => {\n              if (window.location.pathname.includes('/edit')) {\n                console.log('Fallback navigation to ID-based article page');\n                window.location.href = `/articles/${articleId}?updated=true&time=${Date.now()}`;\n              }\n            }, 2000);\n          }, 1000);\n        } catch (error) {\n          console.error('Error updating article:', error);\n          setError('Failed to update article. Please try again.');\n          setIsSaved(false);\n        }\n      } else {\n        // Create new article\n        const newArticle = await createArticle(articleData);\n        if (status === 'published') {\n          // Redirect to the new article page\n          router.push(`/articles/${newArticle.id}`);\n        } else {\n          // Redirect to dashboard\n          router.push(`/dashboard`);\n        }\n      }\n      \n    } catch (error) {\n      console.error('Error saving article:', error);\n      setError('Failed to save article. Please try again.');\n    } finally {\n      setIsSaving(false);\n      setIsPublishing(false);\n    }\n  };\n  \n  // Handle publish button click\n  const handlePublish = async () => {\n    if (!content.trim()) {\n      setError('Content is required');\n      return;\n    }\n    \n    setIsPublishing(true);\n    await saveArticle('published');\n  };\n  \n  // Handle save draft button click\n  const handleSaveDraft = async () => {\n    await saveArticle('drafts');\n  };\n\n  // Handle inserting text from inspiration widget\n  const handleInsertInspiration = (text: string) => {\n    // Try to insert using the editor ref first\n    if (editorRef.current && editorRef.current.insertText) {\n      editorRef.current.insertText('\\n\\n' + text + '\\n\\n');\n    } else {\n      // Fallback: append to content with proper spacing\n      setContent(prevContent => {\n        const newContent = prevContent.trim() \n          ? prevContent + '\\n\\n<p>' + text + '</p>' \n          : '<p>' + text + '</p>';\n        return newContent;\n      });\n    }\n    \n    // Focus the editor after insertion\n    setTimeout(() => {\n      if (editorRef.current && editorRef.current.focus) {\n        editorRef.current.focus();\n      }\n    }, 100);\n  };\n  \n  if (isLoading) {\n    return (\n      <div className={styles.composerLoading}>\n        <div className={styles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    );\n  }\n  \n  return (\n    <div className={styles.articleComposer}>\n      {/* Header with actions */}\n      <header className={styles.composerHeader}>\n        <div className={styles.logoContainer}>\n          <div className={styles.logo}>Journalite</div>\n        </div>\n        \n        <div className={styles.actionButtons}>\n          {isSaved && (\n            <span className={styles.savedIndicator}>\n              <svg viewBox=\"0 0 24 24\" width=\"24\" height=\"24\" fill=\"currentColor\">\n                <path d=\"M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z\" />\n              </svg>\n              Saved\n            </span>\n          )}\n          \n          <button\n            className={styles.actionButton}\n            onClick={handleSaveDraft}\n            disabled={isSaving || isPublishing}\n          >\n            Save draft\n          </button>\n          \n          <button\n            className={styles.publishButton}\n            onClick={handlePublish}\n            disabled={isSaving || isPublishing || !title.trim() || !content.trim()}\n          >\n            {articleId ? 'Update' : 'Publish'}\n          </button>\n        </div>\n      </header>\n      \n      {/* Main content area */}\n      <main className={styles.composerContent}>\n        {/* Title input */}\n        <textarea\n          ref={titleRef}\n          className={styles.titleInput}\n          value={title}\n          onChange={handleTitleChange}\n          onKeyDown={handleTitleKeyDown}\n          placeholder=\"Title\"\n          rows={1}\n        />\n        \n        {/* Cover image input */}\n        <div className={styles.coverImageInput}>\n          <input\n            type=\"text\"\n            value={coverImage}\n            onChange={handleCoverImageChange}\n            placeholder=\"Add a cover image (enter image URL)\"\n            className={styles.imageUrlInput}\n          />\n          {coverImage && (\n            <div className={styles.coverImagePreview}>\n              <img src={coverImage} alt=\"Cover preview\" />\n            </div>\n          )}\n        </div>\n        \n        {/* Tag input */}\n        <div className={styles.tagContainer}>\n          {tags.map(tag => (\n            <div key={tag} className={styles.tag}>\n              {tag}\n              <button \n                className={styles.removeTagButton} \n                onClick={() => removeTag(tag)}\n                aria-label={`Remove ${tag} tag`}\n              >\n                &times;\n              </button>\n            </div>\n          ))}\n          \n          {tags.length < 5 && (\n            <input\n              ref={tagInputRef}\n              type=\"text\"\n              value={currentTag}\n              onChange={handleTagInputChange}\n              onKeyDown={handleTagInputKeyDown}\n              onBlur={addTag}\n              placeholder={tags.length === 0 ? \"Add up to 5 tags...\" : \"Add another tag...\"}\n              className={styles.tagInput}\n            />\n          )}\n        </div>\n        \n        {/* Error message */}\n        {error && <div className={styles.errorMessage}>{error}</div>}\n        \n        {/* Article editor */}\n        <div className={styles.editorContainer}>\n          <Editor\n            ref={editorRef}\n            articleId={articleId || uuidv4()}\n            initialContent={content}\n            onChange={handleEditorChange}\n            placeholder=\"Tell your story...\"\n          />\n        </div>\n      </main>\n\n      {/* Inspiration Widget */}\n      <InspirationWidget onInsert={handleInsertInspiration} />\n    </div>\n  );\n};\n\nexport default ArticleComposer; "],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 7816, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/utils/getMoodFromText.ts"],"sourcesContent":["import Sentiment from 'sentiment';\n\nexport function getMoodFromText(text: string): 'joyful' | 'reflective' | 'sad' {\n    const sentiment = new Sentiment();\n    const result = sentiment.analyze(text);\n\n    if (result.score > 3) return 'joyful';\n    if (result.score < -2) return 'sad';\n    return 'reflective';\n} "],"names":[],"mappings":";;;AAAA;;AAEO,SAAS,gBAAgB,IAAY;IACxC,MAAM,YAAY,IAAI,4IAAA,CAAA,UAAS;IAC/B,MAAM,SAAS,UAAU,OAAO,CAAC;IAEjC,IAAI,OAAO,KAAK,GAAG,GAAG,OAAO;IAC7B,IAAI,OAAO,KAAK,GAAG,CAAC,GAAG,OAAO;IAC9B,OAAO;AACX","debugId":null}},
    {"offset": {"line": 7837, "column": 0}, "map": {"version":3,"sources":["file:///Users/sirabdisalam/journalite-article-page/src/app/articles/page.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useEffect } from 'react'\nimport Link from 'next/link'\nimport { useSearchParams, useRouter } from 'next/navigation'\nimport { Suspense } from 'react'\nimport styles from '@/styles/home.module.css'\nimport articleStyles from '@/styles/ArticlePage.module.css'\nimport { auth } from '@/firebase/clientApp'\nimport { onAuthStateChanged, signOut } from 'firebase/auth'\nimport MinimalNotificationBell from '@/components/MinimalNotificationBell'\nimport LeftSidebar from '@/components/LeftSidebar'\nimport ArticleWithHighlights from '@/components/ArticleWithHighlights'\nimport CommentSection from '@/components/CommentSection'\nimport ArticleComposer from '@/components/ArticleComposer'\nimport ReflectionMoodBar from '@/components/ReflectionMoodBar'\n\n// Import Firestore article service\nimport { getArticleBySlug } from '@/firebase/articles'\nimport { getMoodFromText } from '@/utils/getMoodFromText'\n\n// Author mapping from homepage for consistency\nconst authorMapping: { [key: string]: string } = {\n  '84b2f82c-1e93-498a-983e-3b30a8379e63': 'Samuel Green',\n  user_002: 'Alex Martinez',\n  'kristen-lee-id': 'Kristen Lee',\n  'alex-wen-id': 'Alex Wen',\n  'hannah-cole-id': 'Hannah Cole'\n}\n\n// Convert Firestore article to UI format for RenderArticle\n// This adapter should ensure the object passed to RenderArticle has the fields RenderArticle expects.\nconst adaptFirestoreArticle = (firestoreArticle: any): any => { // Using 'any' for return type temporarily due to unknown FirestoreArticle structure\n  const slug = firestoreArticle.slug || (firestoreArticle.title || 'untitled').toLowerCase().replace(/[\\s\\W-]+/g, '-').replace(/^-+|-+$/g, '');\n  const now = new Date().toISOString();\n\n  // Base fields required by RenderArticle's BaseArticleInfo\n  const adapted = {\n    id: firestoreArticle.id || '', // CRITICAL: Ensure 'id' is present\n    _id: firestoreArticle.id || '', // Keep for compatibility if RenderArticle or other parts use it\n    title: firestoreArticle.title || 'Untitled Article',\n    slug: slug,\n    authorId: firestoreArticle.authorId, // Assuming authorId is on FirestoreArticle\n    authorName: firestoreArticle.authorName || 'Unknown Author',\n    coverImageUrl: firestoreArticle.coverImage || null,\n    tags: firestoreArticle.tags || [],\n    likes: firestoreArticle.likes || [],\n    createdAt: firestoreArticle.createdAt ? firestoreArticle.createdAt.toDate().toISOString() : now,\n    updatedAt: firestoreArticle.updatedAt ? firestoreArticle.updatedAt.toDate().toISOString() : now,\n    excerpt: firestoreArticle.excerpt || '',\n\n    // Fields for SimpleArticle vs ComplexArticle differentiation by RenderArticle\n    // RenderArticle will use its type guards (isSimple, isComplex)\n    // We pass both `body` and a potential `content` array if Firestore structure supports it.\n    body: firestoreArticle.body || '', // For SimpleArticle path in RenderArticle\n    content: firestoreArticle.content || undefined, // For ComplexArticle path if 'content' is an array in Firestore\n                                                       // If firestoreArticle.content is not an array, RenderArticle's isComplex will be false.\n    \n    // Other optional fields RenderArticle might use from ComplexArticle type\n    reposts: firestoreArticle.reposts || [],\n    viewCount: firestoreArticle.viewCount || 0,\n  };\n\n  // If firestoreArticle.content is indeed an array of paragraphs, map it.\n  // This specific mapping logic might be too complex for the adapter if FirestoreArticle's content isn't already structured as Paragraph[].\n  // For now, we pass it as is, and RenderArticle's isComplex will determine how to use it or 'body'.\n  // If `firestoreArticle.content` is an array and matches Paragraph structure, it will be used.\n  // Otherwise, RenderArticle's `isSimple` path will likely take over using `adapted.body`.\n\n  return adapted;\n};\n\nfunction Article() {\n  const params = useSearchParams()\n  const router = useRouter()\n  const slug = params?.get('slug')\n  \n  const [article, setArticle] = useState<any>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<string | null>(null)\n  const [tags, setTags] = useState<string[]>([])\n  const [isAuthenticated, setIsAuthenticated] = useState(false)\n  const [isSidebarCollapsed, setIsSidebarCollapsed] = useState(true)\n  const [isProfileMenuOpen, setIsProfileMenuOpen] = useState(false)\n  const [windowWidth, setWindowWidth] = useState(0)\n  const [articleHtml, setArticleHtml] = useState<string | null>(null)\n  const [likes, setLikes] = useState<string[]>([])\n  const [isLiked, setIsLiked] = useState(false)\n  const [currentUser, setCurrentUser] = useState<any>(null)\n  const [isEditing, setIsEditing] = useState(false)\n  \n  // Mood and reflection state\n  const [mood, setMood] = useState<'joyful' | 'reflective' | 'sad'>('reflective')\n  const [reflectionCount, setReflectionCount] = useState<number>(0)\n  const [reflectionsOn, setReflectionsOn] = useState<boolean>(true)\n  \n  // Initialize window width on client side\n  useEffect(() => {\n    setWindowWidth(window.innerWidth)\n    \n    const handleResize = () => {\n      setWindowWidth(window.innerWidth)\n    }\n    \n    window.addEventListener('resize', handleResize)\n    return () => window.removeEventListener('resize', handleResize)\n  }, [])\n  \n  // Check if user is authenticated\n  useEffect(() => {\n    const unsubscribe = onAuthStateChanged(auth, (user) => {\n      setIsAuthenticated(!!user)\n      setCurrentUser(user)\n      \n      // Check if article is liked by current user\n      if (user && article?.likes) {\n        setIsLiked(article.likes.includes(user.uid))\n      }\n    })\n    \n    return () => unsubscribe()\n  }, [article])\n  \n  // Handle clicks outside the profile menu to close it\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      const target = event.target as Node;\n      const profileMenu = document.getElementById('profile-menu');\n      const profileButton = document.getElementById('profile-button');\n      \n      if (profileMenu && !profileMenu.contains(target) && \n          profileButton && !profileButton.contains(target)) {\n        setIsProfileMenuOpen(false);\n      }\n    };\n    \n    document.addEventListener('mousedown', handleClickOutside);\n    return () => {\n      document.removeEventListener('mousedown', handleClickOutside);\n    };\n  }, []);\n  \n  // Fetch article data\n  useEffect(() => {\n    const fetchArticle = async () => {\n      if (!slug) {\n        setError('No article slug provided')\n        setIsLoading(false)\n        return\n      }\n      \n      try {\n        const articleData = await getArticleBySlug(slug)\n        \n        if (!articleData) {\n          setError('Article not found')\n          setIsLoading(false)\n          return\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '')\n          \n        setArticleHtml(cleanHtml)\n        setLikes(articleData.likes || [])\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length\n        const readTimeMinutes = Math.ceil(wordCount / 200)\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date'\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug\n        })\n        \n        setTags(articleData.tags || [])\n        setIsLoading(false)\n      } catch (error) {\n        console.error('Error fetching article:', error)\n        setError('Failed to load article')\n        setIsLoading(false)\n      }\n    }\n    \n    fetchArticle()\n  }, [slug])\n  \n  // Analyze mood when article content is loaded\n  useEffect(() => {\n    if (articleHtml) {\n      // Extract text from HTML for sentiment analysis\n      const textContent = articleHtml.replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim()\n      if (textContent) {\n        const detectedMood = getMoodFromText(textContent)\n        setMood(detectedMood)\n      }\n      \n      // Mock reflection count - in a real app, you'd fetch this from your API/database\n      setReflectionCount(Math.floor(Math.random() * 20)) // Random for demo\n    }\n  }, [articleHtml])\n  \n  const handleSignOut = async () => {\n    try {\n      await signOut(auth)\n      setIsProfileMenuOpen(false)\n    } catch (error) {\n      console.error('Error signing out:', error)\n    }\n  }\n  \n  const toggleSidebar = () => {\n    setIsSidebarCollapsed(!isSidebarCollapsed)\n  }\n\n  const toggleProfileMenu = () => {\n    setIsProfileMenuOpen(!isProfileMenuOpen)\n  }\n  \n  const handleLikeArticle = async () => {\n    console.log(' LIKE BUTTON CLICKED!')\n    console.log('Current user:', currentUser)\n    console.log('Article ID:', article?.id)\n    console.log('Is liked:', isLiked)\n    \n    if (!currentUser) {\n      alert('Please login to like articles')\n      return\n    }\n    \n    if (!article?.id) {\n      console.error(' No article ID found')\n      return\n    }\n    \n    try {\n      // Import Firestore functions at the top of the function for debugging\n      const { doc, updateDoc, arrayUnion, arrayRemove } = await import('firebase/firestore')\n      const { db } = await import('@/firebase/clientApp')\n      \n      console.log(' Updating Firestore...')\n      \n      const articleRef = doc(db, 'articles', article.id)\n      \n      if (isLiked) {\n        console.log(' Removing like...')\n        await updateDoc(articleRef, {\n          likes: arrayRemove(currentUser.uid)\n        })\n        setLikes(likes.filter(uid => uid !== currentUser.uid))\n        setIsLiked(false)\n        console.log(' Like removed successfully')\n      } else {\n        console.log(' Adding like...')\n        await updateDoc(articleRef, {\n          likes: arrayUnion(currentUser.uid)\n        })\n        setLikes([...likes, currentUser.uid])\n        setIsLiked(true)\n        console.log(' Like added successfully')\n      }\n      \n    } catch (error) {\n      console.error(' Error updating like status:', error)\n      // Revert UI changes on error\n      if (isLiked) {\n        setLikes([...likes, currentUser.uid])\n        setIsLiked(true)\n      } else {\n        setLikes(likes.filter(uid => uid !== currentUser.uid))\n        setIsLiked(false)\n      }\n    }\n  }\n  \n  if (isLoading) {\n    return (\n      <div className={articleStyles.loadingContainer}>\n        <div className={articleStyles.loadingIndicator}></div>\n        <p>Loading article...</p>\n      </div>\n    )\n  }\n  \n  if (error) {\n    return (\n      <div className={articleStyles.errorContainer}>\n        <p className={articleStyles.errorMessage}>{error}</p>\n      </div>\n    )\n  }\n  \n  // Handle when editing is complete\n  const handleUpdateComplete = () => {\n    console.log('Article update complete');\n    // Set loading state\n    setIsLoading(true);\n    setIsEditing(false);\n    \n    // Use ID-based routing instead of slug to prevent issues when title changes\n    if (article?.id) {\n      window.location.href = `/articles/${article.id}/view?updated=true&t=${Date.now()}`;\n    } else {\n      // Fallback to current page refresh if no ID available\n      window.location.reload();\n    }\n    \n    // Fallback: Refetch the article to show updated content\n    const refetchArticle = async () => {\n      try {\n        const articleData = await getArticleBySlug(slug || '');\n        \n        if (!articleData) {\n          setError('Article not found');\n          return;\n        }\n        \n        // Clean HTML content\n        const cleanHtml = articleData.body\n          .replace(/<div[^>]*>Content is loaded from HTML<\\/div>/g, '')\n          .replace(/<h1[^>]*>Untitled Article<\\/h1>/g, '')\n          \n        setArticleHtml(cleanHtml);\n        setLikes(articleData.likes || []);\n        \n        // Calculate read time (approx 200 words per minute)\n        const wordCount = articleData.body.split(/\\s+/).length;\n        const readTimeMinutes = Math.ceil(wordCount / 200);\n        \n        // Format date\n        const date = articleData.createdAt \n          ? new Date(articleData.createdAt.seconds * 1000).toLocaleDateString('en-US', {\n              year: 'numeric',\n              month: 'long',\n              day: 'numeric'\n            })\n          : 'Unknown date';\n        \n        setArticle({\n          id: articleData.id,\n          title: articleData.title,\n          authorName: articleData.authorName || 'Anonymous',\n          authorId: articleData.authorId,\n          createdAt: date,\n          readTime: readTimeMinutes,\n          likes: articleData.likes || [],\n          tags: articleData.tags || [],\n          slug: slug || ''\n        });\n        \n        setTags(articleData.tags || []);\n      } catch (error) {\n        console.error('Error refetching article:', error);\n      }\n    };\n    \n    refetchArticle();\n  };\n\n  if (isEditing && article) {\n    return (\n      <div>\n        <div className={articleStyles.editingHeader}>\n          <button onClick={() => setIsEditing(false)} className={articleStyles.cancelButton}>\n             Back to Article\n          </button>\n          <h2>Editing: {article.title}</h2>\n        </div>\n        <ArticleComposer articleId={article.id} onUpdateComplete={handleUpdateComplete} />\n      </div>\n    );\n  }\n  \n  return (\n    <div className={articleStyles.articlePageContainer}>\n      <ReflectionMoodBar\n        mood={mood}\n        reflectionCount={reflectionCount}\n        reflectionsOn={reflectionsOn}\n        onToggleReflections={setReflectionsOn}\n      />\n      \n      {article && (\n        <>\n          <header className={articleStyles.pageHeader} style={{ marginTop: '60px' }}>\n            <div className={articleStyles.headerContainer}>\n              <Link href=\"/\" className={articleStyles.logoLink}>\n                <div className={articleStyles.headerLogo}>Journalite</div>\n              </Link>\n              \n              <div className={articleStyles.headerActions}>\n                {isAuthenticated && <MinimalNotificationBell />}\n                \n                <div className={articleStyles.profileMenu} id=\"profile-menu\">\n                  {isAuthenticated ? (\n                    <>\n                      <div \n                        className={articleStyles.profileCircle} \n                        onClick={toggleProfileMenu}\n                        id=\"profile-button\"\n                      >\n                        {currentUser?.displayName?.charAt(0) || currentUser?.email?.charAt(0) || 'U'}\n                      </div>\n                      \n                      {isProfileMenuOpen && (\n                        <div className={articleStyles.profileDropdown}>\n                          <Link href=\"/\" className={articleStyles.dropdownItem}>Home</Link>\n                          <Link href=\"/my-thoughts\" className={articleStyles.dropdownItem}>My Thoughts</Link>\n                          <Link href=\"/dashboard\" className={articleStyles.dropdownItem}>Dashboard</Link>\n                          <Link href=\"/write\" className={articleStyles.dropdownItem}>Write a story</Link>\n                          <Link href=\"/create-article\" className={articleStyles.dropdownItem}>Create Article</Link>\n                          <Link href=\"/explore\" className={articleStyles.dropdownItem}>Explore</Link>\n                          <Link href=\"/profile\" className={articleStyles.dropdownItem}>Profile</Link>\n                          <Link href=\"/settings\" className={articleStyles.dropdownItem}>Settings</Link>\n                          <button onClick={handleSignOut} className={articleStyles.dropdownItem}>Sign out</button>\n                        </div>\n                      )}\n                    </>\n                  ) : (\n                    <div className={articleStyles.authButtons}>\n                      <Link href=\"/login\" className={articleStyles.loginButton}>\n                        Sign in\n                      </Link>\n                      <Link href=\"/signup\" className={articleStyles.signupButton}>\n                        Get started\n                      </Link>\n                    </div>\n                  )}\n                </div>\n              </div>\n            </div>\n          </header>\n          \n          <div className={articleStyles.pageContainer}>\n            {/* Article header */}\n            <header className={articleStyles.articleHeader}>\n              <h1 className={articleStyles.articleTitle}>{article.title}</h1>\n              \n              <div className={articleStyles.articleMeta}>\n                <div className={articleStyles.authorInfo}>\n                  <div className={articleStyles.authorAvatar}>{article.authorName.charAt(0)}</div>\n                  <div className={articleStyles.authorDetails}>\n                    <Link \n                      href={`/user/${article.authorName.toLowerCase().replace(/\\s+/g, '')}`} \n                      className={articleStyles.authorNameLink}\n                    >\n                      <div className={articleStyles.authorName}>{article.authorName}</div>\n                    </Link>\n                    <div className={articleStyles.articleDetails}>\n                      {article.createdAt}  {article.readTime} min read\n                    </div>\n                  </div>\n                </div>\n                \n                <div className={articleStyles.articleActions}>\n                  <button \n                    className={`${articleStyles.likeButton} ${isLiked ? articleStyles.liked : ''}`}\n                    onClick={handleLikeArticle}\n                    aria-label={isLiked ? 'Unlike article' : 'Like article'}\n                  >\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\" fill={isLiked ? \"currentColor\" : \"none\"} stroke=\"currentColor\" strokeWidth=\"2\" className={articleStyles.likeIcon}>\n                      <path d=\"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z\" />\n                    </svg>\n                    <span>{likes.length > 0 ? likes.length : ''}</span>\n                  </button>\n                  \n                  {isAuthenticated && article.authorId === currentUser?.uid && (\n                    <button \n                      className={articleStyles.editButton}\n                      onClick={() => setIsEditing(true)}\n                    >\n                      Edit\n                    </button>\n                  )}\n                </div>\n              </div>\n              \n              {article.tags && article.tags.length > 0 && (\n                <div className={articleStyles.tagContainer}>\n                  {article.tags.map((tag: string, index: number) => (\n                    <span key={index} className={articleStyles.tag}>{tag}</span>\n                  ))}\n                </div>\n              )}\n            </header>\n            \n            {/* Article content with highlights */}\n            <ArticleWithHighlights \n              articleId={article.id} \n              initialHtml={articleHtml || undefined}\n            />\n            \n            {/* Comments section */}\n            <div className={articleStyles.commentsContainer}>\n              <CommentSection articleId={article.id} />\n            </div>\n            \n            {/* Related tags section */}\n            <aside className={articleStyles.relatedTagsSection}>\n              <h2 className={articleStyles.relatedTagsHeading}>Related Tags</h2>\n              <div className={articleStyles.relatedTagsList}>\n                {tags.map((tag: string) => (\n                  <Link\n                    key={tag}\n                    href={`/tag/${tag.toLowerCase()}`}\n                    className={articleStyles.relatedTag}\n                  >\n                    # {tag}\n                  </Link>\n                ))}\n              </div>\n              \n              <Link href='/write' className={articleStyles.writeButton}>\n                Write\n              </Link>\n            </aside>\n          </div>\n        </>\n      )}\n    </div>\n  )\n}\n\nexport default function ArticlePage () {\n  return (\n    <Suspense fallback={<div>Loading article...</div>}>\n      <Article />\n    </Suspense>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}