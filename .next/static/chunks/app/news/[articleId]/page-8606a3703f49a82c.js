(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[608,4156],{608:(e,t,r)=>{"use strict";r.d(t,{newsService:()=>n});class a{async getTopHeadlines(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"general",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"us";if(!this.apiKey||"YOUR_API_KEY_HERE"===this.apiKey)throw Error("News API key not configured");let r="".concat(this.baseUrl,"/top-headlines?category=").concat(e,"&country=").concat(t,"&apiKey=").concat(this.apiKey),a=await fetch(r);if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return a.json()}async searchArticles(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"publishedAt";if(!this.apiKey||"YOUR_API_KEY_HERE"===this.apiKey)throw Error("News API key not configured");let r="".concat(this.baseUrl,"/everything?q=").concat(encodeURIComponent(e),"&sortBy=").concat(t,"&apiKey=").concat(this.apiKey),a=await fetch(r);if(!a.ok)throw Error("HTTP error! status: ".concat(a.status));return a.json()}isConfigured(){return!!(this.apiKey&&"YOUR_API_KEY_HERE"!==this.apiKey)}constructor(){this.baseUrl="https://newsapi.org/v2",this.apiKey="eee337e6eb7e49f4a013473e136af6fc",this.apiKey&&"YOUR_API_KEY_HERE"!==this.apiKey||console.warn("News API key not configured. Please set NEXT_PUBLIC_NEWS_API_KEY in your environment variables.")}}let n=new a},1549:()=>{},3278:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(5155),n=r(2115),i=r(5695),l=r(3201),o=r(3616),s=r(3804),c=r(6016),d=r(608),u=r(7041),h=r(326);function g(){let e=(0,i.useParams)(),t=(0,i.useRouter)(),[r,g]=(0,n.useState)(null),[p,m]=(0,n.useState)(!0),[f,w]=(0,n.useState)(""),[b,y]=(0,n.useState)(null),[x,v]=(0,n.useState)(!1),[E,N]=(0,n.useState)([]),[k,I]=(0,n.useState)(!0),[A,S]=(0,n.useState)("reflective"),_=decodeURIComponent(null==e?void 0:e.articleId);(0,n.useEffect)(()=>{let e=l.j2.onAuthStateChanged(e=>{y(e),v(!!e)});return()=>e()},[]),(0,n.useEffect)(()=>{if(x){let e=localStorage.getItem("moodFeatureEnabled");null!==e?I(JSON.parse(e)):I(!0)}else I(!1)},[x]),(0,n.useEffect)(()=>{let e=async()=>{try{if(m(!0),w(""),!d.newsService.isConfigured())return void w("News API not configured. Please add your NewsAPI.org API key to environment variables.");let e=(_.split("/").pop()||"").replace(/-/g," ").replace(/_/g," ").split(/[^a-zA-Z\s]/).filter(e=>e.length>3).slice(0,3).join(" "),t=null;if(e)try{let r=await d.newsService.searchArticles(e);"ok"===r.status&&(t=r.articles.find(e=>e.url===_))}catch(e){}if(!t)for(let e of["general","business","technology","sports","entertainment","health","science"])try{let r=await d.newsService.getTopHeadlines(e);if("ok"===r.status&&(t=r.articles.find(e=>e.url===_)))break}catch(e){continue}if(t)g(t);else{let e=(_.split("/").pop()||"").replace(/-/g," ").replace(/_/g," ").replace(/\d+/g,"").split(/[^a-zA-Z\s]/).filter(e=>e.length>2).map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),t="News Source";try{let e=new URL(_).hostname.replace("www.","");t=e.split(".")[0].charAt(0).toUpperCase()+e.split(".")[0].slice(1)}catch(e){}let r={title:e||"News Article",description:"This article is no longer available through NewsAPI. Click the link below to read the full article on the original site.",content:"This article is no longer available through our news feed. Please visit the original source to read the full content.",url:_,urlToImage:"",publishedAt:new Date().toISOString(),source:{name:t},author:t};g(r)}await P(_)}catch(e){console.error("Error fetching news article:",e),w("Failed to load article. Please try again later.")}finally{m(!1)}};_&&e()},[_]),(0,n.useEffect)(()=>{if(r&&x){let e=r.description+" "+(r.content||"");if(e.trim()){let t=e.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();S((0,u.H)(t))}}},[r,x]);let j=()=>{t.push("/news")},P=async e=>{try{let t=await o.r.getSocialData(e,"newsapi");t?N(t.likes||[]):N([])}catch(e){console.error("Error fetching likes data:",e),N([])}},U=e=>{try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}catch(t){return console.error("Error formatting date:",t),e}};if(p)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading article..."})]})});if(f)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,a.jsx)("div",{className:"text-red-600 text-lg mb-4",children:f}),(0,a.jsx)("button",{onClick:j,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to News"})]})});if(!r)return(0,a.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,a.jsx)("div",{className:"text-gray-600 text-lg mb-4",children:"Article not found"}),(0,a.jsx)("button",{onClick:j,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to News"})]})});let C=(e=>{var t,r,a,n,i;let l="",o=e=>e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"):"",s=(null==(t=e.content)?void 0:t.includes("no longer available through our news feed"))||!1;if(e.urlToImage){let t=o(e.urlToImage),r=o(e.title||"News article image");l+='<img src="'.concat(t,'" alt="').concat(r,'" style="max-width: 100%; height: auto; margin: 2em auto; display: block; border-radius: 8px;" />')}if(e.description){let t=o(e.description);l+="<p><strong>".concat(t,"</strong></p>")}if(e.content){let t=o(e.content.replace(/\[\+\d+\s+chars\]$/,"..."));l+="<p>".concat(t,"</p>")}let c=o(e.url||""),d=o((null==(r=e.source)?void 0:r.name)||"News Source");return s?l+='\n        <div style="background-color: #667eea; color: white; padding: 2em; border-radius: 12px; text-align: center; margin: 2em 0; border: 1px solid #5a67d8;">\n          <h3 style="margin: 0 0 1em 0; color: white;">Read Full Article</h3>\n          <p style="margin: 0 0 1.5em 0; color: white; opacity: 0.9;">\n            This article is available on the original news site\n          </p>\n          <a href="'.concat(c,'" target="_blank" rel="noopener noreferrer" style="background: white; color: #667eea; padding: 12px 24px; text-decoration: none; border-radius: 25px; font-weight: bold; display: inline-block; border: 2px solid white;">\n            Visit ').concat(d,"\n          </a>\n        </div>"):l+='<p><em>Read the full article at: <a href="'.concat(c,'" target="_blank" rel="noopener noreferrer">').concat(d,"</a></em></p>"),{title:e.title||"News Article",authorName:e.author||(null==(a=e.source)?void 0:a.name)||"Unknown",createdAt:U(e.publishedAt),readTime:Math.ceil(((null==(n=e.content)?void 0:n.split(" ").length)||200)/200),tags:[(null==(i=e.source)?void 0:i.name)||"News"],authorId:"news-api",hasReflectionRoom:!1,html:l}})(r);return(0,a.jsxs)("div",{className:"guardian-article news-article",style:{position:"relative",backgroundColor:"#ffffff"},children:[x&&(0,a.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(160deg, \n              ".concat(h.Qx[A].gradientStart,", \n              ").concat(h.Qx[A].gradientEnd,")"),backgroundSize:"150% 150%",animation:"gradientFlow 25s ease-in-out infinite",zIndex:-10,transition:"background-image 2s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,a.jsx)(s.A,{articleId:"news-".concat(encodeURIComponent(r.url)),articleHtml:C.html,article:C,initialLikes:E,currentUser:b,isAuthenticated:x,onEditClick:j,articleTitle:C.title,articleSlug:"news-".concat(encodeURIComponent(r.url)),moodFeatureEnabled:k,onToggleMoodFeature:e=>{I(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e))},mood:A,isExternal:!0,externalSource:"newsapi",externalId:r.url,externalUrl:r.url}),(0,a.jsx)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"2rem 1rem"},children:(0,a.jsx)(c.A,{articleId:"news-".concat(encodeURIComponent(r.url))})})]})}r(1549)},4302:(e,t,r)=>{Promise.resolve().then(r.bind(r,3278))}},e=>{var t=t=>e(e.s=t);e.O(0,[5598,2140,8096,4744,4814,1431,3804,7358],()=>t(4302)),_N_E=e.O()}]);