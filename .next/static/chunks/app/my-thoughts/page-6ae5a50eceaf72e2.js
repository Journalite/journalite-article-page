(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3998],{350:(t,e,a)=>{"use strict";a.d(e,{A:()=>d});var i=a(5155),n=a(2115),s=a(6874),r=a.n(s),c=a(9995),o=a(912),l=a.n(o);let d=()=>{let[t,e]=(0,n.useState)(0),[a,s]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{let t=async()=>{e(await (0,c.Hs)())};t();let a=setInterval(t,6e4);return()=>clearInterval(a)},[]),(0,n.useEffect)(()=>{let t=t=>{u.current&&!u.current.contains(t.target)&&d(!1)};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[]),(0,n.useEffect)(()=>{o&&h()},[o]);let h=async()=>{try{let t=await (0,c.Ss)(!1);s(t)}catch(t){console.error("Error fetching notifications:",t)}},m=async t=>{try{!t.read&&t.id&&(await (0,c.bA)(t.id),e(t=>Math.max(t-1,0)),s(e=>e.map(e=>e.id===t.id?{...e,read:!0}:e)))}catch(t){console.error("Error marking notification as read:",t)}},f=t=>{if(!t)return"";let e=t.toDate?t.toDate():new Date(t),a=Math.floor((new Date().getTime()-e.getTime())/6e4);if(a<1)return"Just now";if(a<60)return"".concat(a,"m ago");let i=Math.floor(a/60);if(i<24)return"".concat(i,"h ago");let n=Math.floor(i/24);return n<7?"".concat(n,"d ago"):e.toLocaleDateString()},_=t=>{if("follow"===t.type){var e;return(null==(e=t.fromUser)?void 0:e.username)?"/user/".concat(t.fromUser.username):"/notifications"}return t.articleSlug?"/articles?slug=".concat(t.articleSlug):"/notifications"};return(0,i.jsxs)("div",{className:l().notificationContainer,ref:u,children:[(0,i.jsxs)("button",{className:l().bellButton,onClick:()=>{d(!o)},children:[(0,i.jsx)("span",{className:l().bellIcon,children:"\uD83D\uDD14"}),t>0&&(0,i.jsx)("span",{className:l().unreadBadge,children:t})]}),o&&(0,i.jsxs)("div",{className:l().notificationDropdown,children:[(0,i.jsxs)("div",{className:l().notificationHeader,children:[(0,i.jsx)("h3",{children:"Notifications"}),a.length>0&&(0,i.jsx)(r(),{href:"/notifications",className:l().viewAllLink,children:"View All"})]}),(0,i.jsx)("div",{className:l().notificationList,children:0===a.length?(0,i.jsx)("div",{className:l().emptyState,children:"No notifications yet"}):a.slice(0,5).map(t=>(0,i.jsxs)(r(),{href:_(t),className:"".concat(l().notificationItem," ").concat(t.read?"":l().unread),onClick:()=>m(t),children:[(0,i.jsxs)("div",{className:l().notificationContent,children:[(0,i.jsx)("p",{className:l().notificationMessage,children:t.message}),(0,i.jsx)("span",{className:l().notificationTime,children:f(t.createdAt)})]}),!t.read&&(0,i.jsx)("div",{className:l().unreadDot})]},t.id))}),a.length>5&&(0,i.jsx)("div",{className:l().notificationFooter,children:(0,i.jsx)(r(),{href:"/notifications",className:l().seeMoreLink,children:"See more notifications"})})]})]})}},912:t=>{t.exports={notificationContainer:"NotificationBell_notificationContainer__TFGqP",bellButton:"NotificationBell_bellButton__PKB6r",bellIcon:"NotificationBell_bellIcon__ALAAB",unreadBadge:"NotificationBell_unreadBadge__cOn_b",notificationDropdown:"NotificationBell_notificationDropdown__p8Mv4",notificationHeader:"NotificationBell_notificationHeader__cPSyI",viewAllLink:"NotificationBell_viewAllLink__une1x",notificationList:"NotificationBell_notificationList__SBbvK",notificationItem:"NotificationBell_notificationItem__MW9MC",unread:"NotificationBell_unread__9c4op",notificationContent:"NotificationBell_notificationContent__2upmA",notificationMessage:"NotificationBell_notificationMessage__aqMDB",notificationTime:"NotificationBell_notificationTime__JQ2O9",unreadDot:"NotificationBell_unreadDot__qaEb7",notificationFooter:"NotificationBell_notificationFooter__l28sD",seeMoreLink:"NotificationBell_seeMoreLink__eh2qR",emptyState:"NotificationBell_emptyState___y1V2"}},3201:(t,e,a)=>{"use strict";a.d(e,{db:()=>l,j2:()=>o});var i=a(3915),n=a(6864),s=a(6203),r=a(5317);let c=(0,i.Wp)({apiKey:"AIzaSyCFpybhLt43iKUw6lNahU1n2zjYv0BXmf4",authDomain:"journalitev1.firebaseapp.com",projectId:"journalitev1",storageBucket:"journalitev1.firebasestorage.app",messagingSenderId:"897263211529",appId:"1:897263211529:web:bae4a00910a2236d6d54d8",measurementId:"G-ZYT8PRMT0D"});try{(0,n.P5)(c)}catch(t){}let o=(0,s.xI)(c),l=(0,r.aU)(c);window.location.origin},5695:(t,e,a)=>{"use strict";var i=a(8999);a.o(i,"useRouter")&&a.d(e,{useRouter:function(){return i.useRouter}}),a.o(i,"useSearchParams")&&a.d(e,{useSearchParams:function(){return i.useSearchParams}})},6192:(t,e,a)=>{"use strict";a.r(e),a.d(e,{default:()=>x});var i=a(5155),n=a(2115),s=a(6874),r=a.n(s),c=a(5695),o=a(6203),l=a(5317),d=a(3201),u=a(9210),h=a(8163),m=a.n(h),f=a(6944),_=a.n(f),g=a(350);function x(){let[t,e]=(0,n.useState)(!1),[a,s]=(0,n.useState)(null),[h,f]=(0,n.useState)(!0),[x,N]=(0,n.useState)(!1),[y,j]=(0,n.useState)(0),[p,v]=(0,n.useState)("published"),[b,w]=(0,n.useState)([]),[B,E]=(0,n.useState)(null),[S,C]=(0,n.useState)(!1),M=(0,c.useRouter)();(0,n.useEffect)(()=>{j(window.innerWidth);let t=()=>{j(window.innerWidth)};return window.addEventListener("resize",t),()=>window.removeEventListener("resize",t)},[]),(0,n.useEffect)(()=>{N(y<768)},[y]),(0,n.useEffect)(()=>{let t=(0,o.hg)(d.j2,t=>{let a=!!t;e(a),s(t),a?f(!1):M.push("/login?redirect=/my-thoughts")});return()=>t()},[M]),(0,n.useEffect)(()=>{let e=async()=>{if(a)try{let t;f(!0);let e=(0,l.rJ)(d.db,"articles");t="published"===p?(0,l.P)(e,(0,l._M)("authorId","==",a.uid),(0,l.My)("createdAt","desc")):(0,l.P)(e,(0,l._M)("authorId","==",a.uid),(0,l._M)("status","==","drafts"),(0,l.My)("createdAt","desc"));let i=await (0,l.GG)(t),n=[];i.forEach(t=>{let e=t.data();"published"===p?e.status&&"published"!==e.status||n.push({id:t.id,...e,status:e.status||"published"}):n.push({id:t.id,...e})}),w(n)}catch(t){console.error("Error fetching articles:",t)}finally{f(!1)}};a&&t&&e()},[a,t,p]);let D=async()=>{try{await (0,o.CI)(d.j2),M.push("/")}catch(t){console.error("Error signing out:",t)}},T=t=>{E(t),C(!0)},A=async()=>{if(B)try{await (0,u.a)(B),w(b.filter(t=>t.id!==B)),C(!1),E(null)}catch(t){console.error("Error deleting article:",t)}},k=t=>{let e;return t?(t&&"function"==typeof t.toDate?t.toDate():new Date(t)).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""},L=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:120;if(!t)return"";let a=t.includes("<")&&t.includes(">")?(t=>{let e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""})(t):t;return a.length<=e?a:a.substring(0,e).trim()+"..."};return h?(0,i.jsx)("div",{className:m().container,children:(0,i.jsx)("div",{className:m().loading,children:"Loading..."})}):t?(0,i.jsxs)("div",{className:m()["three-column-layout"],children:[(0,i.jsxs)("aside",{className:"".concat(m()["left-sidebar"]," ").concat(x?m().collapsed:""),children:[(0,i.jsxs)("div",{className:m()["sidebar-header"],children:[(0,i.jsx)("div",{className:m().logo,children:"Journalite"}),(0,i.jsx)("button",{className:m()["toggle-button"],onClick:()=>{N(!x)},"aria-label":x?"Expand sidebar":"Collapse sidebar",children:x?"→":"←"})]}),(0,i.jsxs)("nav",{className:m()["vertical-nav"],children:[(0,i.jsxs)(r(),{href:"/",className:"".concat(m()["nav-link"]," ").concat(m()["nav-home"]),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"Home"})]}),(0,i.jsxs)(r(),{href:"/my-thoughts",className:"".concat(m()["nav-link"]," ").concat(m()["nav-thoughts"]," ").concat(m().active),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"My Thoughts"})]}),(0,i.jsxs)(r(),{href:"/create-article",className:"".concat(m()["nav-link"]," ").concat(m()["nav-create"]),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"Create Article"})]}),(0,i.jsxs)(r(),{href:"/explore",className:"".concat(m()["nav-link"]," ").concat(m()["nav-explore"]),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"Explore"})]}),(0,i.jsxs)(r(),{href:"/my-profile",className:"".concat(m()["nav-link"]," ").concat(m()["nav-profile"]),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"My Profile"})]}),(0,i.jsxs)("button",{onClick:D,className:"".concat(m()["nav-link"]," ").concat(m()["nav-logout"]),children:[(0,i.jsx)("span",{className:m()["nav-icon"],children:"•"}),(0,i.jsx)("span",{className:m()["nav-text"],children:"Log out"})]})]})]}),(0,i.jsxs)("main",{className:m()["center-column"],children:[(0,i.jsxs)("div",{className:_().header,children:[(0,i.jsx)("h1",{className:_().title,children:"My Thoughts"}),(0,i.jsx)("div",{className:_().actions,children:(0,i.jsx)(r(),{href:"/create-article",className:_().createButton,children:"New Article"})})]}),(0,i.jsxs)("div",{className:_().tabs,children:[(0,i.jsx)("button",{className:"".concat(_().tabButton," ").concat("published"===p?_().active:""),onClick:()=>v("published"),children:"Published"}),(0,i.jsx)("button",{className:"".concat(_().tabButton," ").concat("drafts"===p?_().active:""),onClick:()=>v("drafts"),children:"Drafts"})]}),0===b.length?(0,i.jsxs)("div",{className:_().emptyState,children:[(0,i.jsxs)("p",{children:["You don't have any ",p," articles yet."]}),"published"===p?(0,i.jsx)("p",{children:"When you publish your articles, they will appear here."}):(0,i.jsx)("p",{children:"Save your work as drafts to continue later."}),(0,i.jsx)(r(),{href:"/create-article",className:_().emptyStateButton,children:"Create Your First Article"})]}):(0,i.jsx)("div",{className:_().articlesList,children:b.map(t=>{var e;return(0,i.jsxs)("div",{className:_().articleCard,children:[(0,i.jsxs)("div",{className:_().articleContent,children:[(0,i.jsx)("h2",{className:_().articleTitle,children:(0,i.jsx)(r(),{href:"/articles?slug=".concat(t.slug),children:t.title})}),(0,i.jsx)("p",{className:_().articleDate,children:k(t.createdAt)}),(0,i.jsx)("p",{className:_().articleExcerpt,children:L(t.body)}),(0,i.jsx)("div",{className:_().articleTags,children:null==(e=t.tags)?void 0:e.map((t,e)=>(0,i.jsx)("span",{className:_().articleTag,children:t},e))})]}),(0,i.jsxs)("div",{className:_().articleActions,children:[(0,i.jsx)(r(),{href:"/articles?slug=".concat(t.slug),className:_().viewButton,children:"View"}),(0,i.jsx)(r(),{href:"/edit-article?id=".concat(t.id),className:_().editButton,children:"Edit"}),(0,i.jsx)("button",{className:_().deleteButton,onClick:()=>T(t.id||""),children:"Delete"})]})]},t.id)})})]}),(0,i.jsxs)("aside",{className:m()["right-sidebar"],children:[(0,i.jsx)("h2",{className:m()["sidebar-heading"],children:"Your Stats"}),(0,i.jsx)(g.A,{}),(0,i.jsxs)("div",{className:_().statsContainer,children:[(0,i.jsxs)("div",{className:_().statCard,children:[(0,i.jsx)("span",{className:_().statValue,children:b.filter(t=>"published"===t.status).length}),(0,i.jsx)("span",{className:_().statLabel,children:"Published"})]}),(0,i.jsxs)("div",{className:_().statCard,children:[(0,i.jsx)("span",{className:_().statValue,children:b.filter(t=>"drafts"===t.status).length}),(0,i.jsx)("span",{className:_().statLabel,children:"Drafts"})]})]}),(0,i.jsx)(r(),{href:"/create-article",className:m()["write-button"],children:"Write"})]}),S&&(0,i.jsx)("div",{className:_().modalOverlay,children:(0,i.jsxs)("div",{className:_().modal,children:[(0,i.jsx)("h3",{className:_().modalTitle,children:"Confirm Delete"}),(0,i.jsx)("p",{className:_().modalText,children:"Are you sure you want to delete this article? This action cannot be undone."}),(0,i.jsxs)("div",{className:_().modalButtons,children:[(0,i.jsx)("button",{className:_().cancelButton,onClick:()=>{C(!1),E(null)},children:"Cancel"}),(0,i.jsx)("button",{className:_().confirmButton,onClick:A,children:"Delete"})]})]})})]}):(0,i.jsxs)("div",{className:m().container,children:[(0,i.jsx)("p",{children:"Please log in to view your articles."}),(0,i.jsx)(r(),{href:"/login?redirect=/my-thoughts",className:m().loginLink,children:"Login Now"})]})}},6944:t=>{t.exports={header:"my-thoughts_header__T84ea",title:"my-thoughts_title__H24DY",actions:"my-thoughts_actions__GWoto",createButton:"my-thoughts_createButton__bL87g",tabs:"my-thoughts_tabs__MTj07",tabButton:"my-thoughts_tabButton__OZNMA",active:"my-thoughts_active__COw73",emptyState:"my-thoughts_emptyState__2Re4c",emptyStateButton:"my-thoughts_emptyStateButton__q4s1p",articlesList:"my-thoughts_articlesList__jwxYp",articleCard:"my-thoughts_articleCard__rN5RC",articleContent:"my-thoughts_articleContent__hh7o4",articleTitle:"my-thoughts_articleTitle__WTcKB",articleDate:"my-thoughts_articleDate__6MnGt",articleExcerpt:"my-thoughts_articleExcerpt__7bMHG",articleTags:"my-thoughts_articleTags__XkPh2",articleTag:"my-thoughts_articleTag__joHmZ",articleActions:"my-thoughts_articleActions__4Mqfy",viewButton:"my-thoughts_viewButton__UcpED",editButton:"my-thoughts_editButton__cUZCL",deleteButton:"my-thoughts_deleteButton__PdPWh",statsContainer:"my-thoughts_statsContainer__nxG1O",statCard:"my-thoughts_statCard__AR6VO",statValue:"my-thoughts_statValue__SUqDm",statLabel:"my-thoughts_statLabel__3IppR",modalOverlay:"my-thoughts_modalOverlay__Jj6UM",modal:"my-thoughts_modal__ISbR_",modalTitle:"my-thoughts_modalTitle__T_PLg",modalText:"my-thoughts_modalText__fTuAg",modalButtons:"my-thoughts_modalButtons__s9o7F",cancelButton:"my-thoughts_cancelButton__gh4wj",confirmButton:"my-thoughts_confirmButton__Kxpb_"}},7423:(t,e,a)=>{Promise.resolve().then(a.bind(a,6192))},9995:(t,e,a)=>{"use strict";a.d(e,{Hs:()=>u,N9:()=>r,Ss:()=>c,bA:()=>o,fP:()=>d,fZ:()=>s,he:()=>l});var i=a(5317),n=a(3201);async function s(t,e,a,s,r,c){try{let e=n.j2.currentUser;if(!e||e.uid===t)return null;let o={userId:t,type:"comment",read:!1,sourceId:r,sourceType:"comment",message:"".concat(e.displayName||"Someone",' commented on your article: "').concat(c.substring(0,50)).concat(c.length>50?"...":"",'"'),fromUser:{id:e.uid,name:e.displayName||"Anonymous"},createdAt:i.Dc.now(),articleSlug:a,articleTitle:s};return{id:(await (0,i.gS)((0,i.rJ)(n.db,"notifications"),o)).id,...o}}catch(t){return console.error("Error creating notification:",t),null}}async function r(t,e,a,s){try{if(t===a)return null;let r={userId:t,type:"follow",read:!1,sourceId:a,sourceType:"user",message:"".concat(e," (@").concat(s,") started following you"),fromUser:{id:a,name:e,username:s},createdAt:i.Dc.now()};return{id:(await (0,i.gS)((0,i.rJ)(n.db,"notifications"),r)).id,...r}}catch(t){return console.error("Error creating follow notification:",t),null}}async function c(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let e,a=n.j2.currentUser;if(!a)throw Error("User not authenticated");let s=(0,i.rJ)(n.db,"notifications");e=t?(0,i.P)(s,(0,i._M)("userId","==",a.uid),(0,i._M)("read","==",!1),(0,i.My)("createdAt","desc"),(0,i.AB)(100)):(0,i.P)(s,(0,i._M)("userId","==",a.uid),(0,i.My)("createdAt","desc"),(0,i.AB)(100));let r=await (0,i.GG)(e),c=[];return r.forEach(t=>{c.push({id:t.id,...t.data()})}),c}catch(t){throw console.error("Error fetching notifications:",t),t}}async function o(t){try{let e=n.j2.currentUser;if(!e)throw Error("User not authenticated");let a=(0,i.H9)(n.db,"notifications",t),s=await (0,i.x7)(a);if(!s.exists())throw Error("Notification not found");if(s.data().userId!==e.uid)throw Error("Unauthorized access to notification");return await (0,i.mZ)(a,{read:!0}),{success:!0}}catch(t){throw console.error("Error marking notification as read:",t),t}}async function l(){try{let t=n.j2.currentUser;if(!t)throw Error("User not authenticated");let e=(0,i.rJ)(n.db,"notifications"),a=(0,i.P)(e,(0,i._M)("userId","==",t.uid),(0,i._M)("read","==",!1)),s=await (0,i.GG)(a),r=s.docs.map(t=>(0,i.mZ)(t.ref,{read:!0}));return await Promise.all(r),{success:!0,count:s.size}}catch(t){throw console.error("Error marking all notifications as read:",t),t}}async function d(t){try{let e=n.j2.currentUser;if(!e)throw Error("User not authenticated");let a=(0,i.H9)(n.db,"notifications",t),s=await (0,i.x7)(a);if(!s.exists())throw Error("Notification not found");if(s.data().userId!==e.uid)throw Error("Unauthorized access to notification");return await (0,i.kd)(a),{success:!0}}catch(t){throw console.error("Error deleting notification:",t),t}}async function u(){try{let t=n.j2.currentUser;if(!t)return 0;let e=(0,i.rJ)(n.db,"notifications"),a=(0,i.P)(e,(0,i._M)("userId","==",t.uid),(0,i._M)("read","==",!1));return(await (0,i.GG)(a)).size}catch(t){return console.error("Error counting unread notifications:",t),0}}}},t=>{var e=e=>t(t.s=e);t.O(0,[7522,2992,7158,7117,6874,4692,8441,1684,7358],()=>e(7423)),_N_E=t.O()}]);