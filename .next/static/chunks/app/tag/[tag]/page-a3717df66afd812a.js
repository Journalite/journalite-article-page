(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6296],{177:(e,t,r)=>{"use strict";r.d(t,{default:()=>p});var a=r(5155),i=r(2115),n=r(6874),s=r.n(n),o=r(8163),c=r.n(o),l=r(3201),d=r(6203),u=r(350),h=r(6201),g=r(9210);let m=e=>({_id:e.id||"",title:e.title,slug:e.slug||"",authorId:e.authorId,authorName:e.authorName||"Unknown Author",coverImageUrl:e.coverImage,tags:e.tags,content:[{paragraphId:"p1",text:e.body,likes:[],comments:[]}],likes:[],reposts:[],comments:[],createdAt:e.createdAt.toDate().toISOString(),updatedAt:e.createdAt.toDate().toISOString()}),f=e=>e.authorName||"Unknown Author",w=e=>{let t=Math.ceil((e?e.split(/\s+/).length:0)/200);return t<1?1:t},j=e=>{let t=e.content&&e.content.length>0?e.content[0].text:e.excerpt||"",r=t.includes("<")&&t.includes(">")?(e=>{let t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""})(t):t;return r.length>150?r.substring(0,150)+"...":r};function p(e){let{tag:t}=e,[r,n]=(0,i.useState)([]),[o,p]=(0,i.useState)(!0),[x,b]=(0,i.useState)(null),[N,y]=(0,i.useState)(!1),[v,E]=(0,i.useState)(!1),[D,I]=(0,i.useState)(0);(0,i.useEffect)(()=>{let e=(0,d.onAuthStateChanged)(l.j2,e=>{y(!!e)});return()=>e()},[]),(0,i.useEffect)(()=>{I(window.innerWidth);let e=()=>{I(window.innerWidth),window.innerWidth<768&&E(!0)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),(0,i.useEffect)(()=>{(async()=>{if(!t){b("No tag specified"),p(!1);return}try{let e=await (0,g.zE)(t);if(0===e.length){n([]),p(!1);return}let r=e.map(m);n(r),p(!1)}catch(e){console.error("Error fetching articles by tag:",e),b("Failed to load articles"),p(!1)}})()},[t]);let k=async()=>{try{await (0,d.signOut)(l.j2)}catch(e){console.error("Error signing out:",e)}},A=()=>{E(!v)},U=t?t.charAt(0).toUpperCase()+t.slice(1):"";return(0,a.jsxs)("div",{className:c()["three-column-layout"],children:[D<768&&!v&&(0,a.jsx)("div",{className:"".concat(c()["menu-overlay"]," ").concat(c().active),onClick:A}),(0,a.jsx)(h.A,{isAuthenticated:N,handleLogout:k,toggleSidebar:A,isSidebarCollapsed:v}),D<768&&(0,a.jsx)("button",{className:c()["toggle-button"],onClick:A,"aria-label":v?"Expand sidebar":"Collapse sidebar",children:v?"☰":"✕"}),(0,a.jsxs)("main",{className:c()["center-column"],children:[(0,a.jsx)("div",{className:c()["tag-header"],children:(0,a.jsxs)("h1",{children:["Articles tagged with ",(0,a.jsxs)("span",{className:c().highlight,children:["#",U]})]})}),o?(0,a.jsx)("div",{className:c().loading,children:"Loading articles..."}):x?(0,a.jsxs)("div",{className:c().loading,children:["Error: ",x]}):0===r.length?(0,a.jsxs)("div",{className:c()["no-results"],children:[(0,a.jsx)("p",{children:"No articles found with this tag."}),(0,a.jsx)(s(),{href:"/",className:c()["back-link"],children:"Back to home"})]}):(0,a.jsx)("div",{className:c()["article-grid"],children:r.map((e,t)=>(0,a.jsxs)("article",{className:c()["article-card"],children:[(0,a.jsx)("h3",{className:c()["article-title"],children:e.title}),(0,a.jsxs)("div",{className:c()["article-meta"],children:["by ",f(e)," • ",w(e.content[0].text)," min read"]}),(0,a.jsx)("p",{className:c()["article-excerpt"],children:j(e)}),e.tags&&e.tags.length>0&&(0,a.jsx)("div",{className:c()["article-tags"],children:e.tags.map((t,r)=>(0,a.jsxs)(s(),{href:"/tag/".concat(t.toLowerCase()),className:c().tag,children:["#",t]},"".concat(e.slug,"-tag-").concat(r)))}),(0,a.jsxs)("div",{className:c()["reaction-bar"],children:[(0,a.jsx)("button",{className:c()["reaction-button"],children:"❤️ Echo"}),(0,a.jsx)("button",{className:c()["reaction-button"],children:"\uD83D\uDD01 Resonate"}),(0,a.jsx)("button",{className:c()["reaction-button"],children:"\uD83D\uDCAC Comment"}),(0,a.jsx)(s(),{href:"/articles?slug=".concat(encodeURIComponent(e.slug)),className:c()["read-link"],children:"Read →"})]})]},e._id||e.slug||"article-".concat(t)))})]}),(0,a.jsxs)("aside",{className:c()["right-sidebar"],children:[(0,a.jsx)("h2",{className:c()["sidebar-heading"],children:"About this tag"}),N&&(0,a.jsx)(u.A,{}),(0,a.jsx)("div",{className:c()["tag-description"],children:(0,a.jsxs)("p",{children:["Browsing articles tagged with ",(0,a.jsxs)("strong",{children:["#",U]}),". Discover content related to this topic."]})}),(0,a.jsxs)(s(),{href:"/write",className:c()["write-button"],children:["Write about #",U]}),(0,a.jsx)(s(),{href:"/",className:c()["back-link"],children:"Back to Home"})]})]})}},3201:(e,t,r)=>{"use strict";r.d(t,{db:()=>l,j2:()=>c});var a=r(3915),i=r(6864),n=r(6203),s=r(5317);let o=(0,a.Wp)({apiKey:"AIzaSyCFpybhLt43iKUw6lNahU1n2zjYv0BXmf4",authDomain:"journalitev1.firebaseapp.com",projectId:"journalitev1",storageBucket:"journalitev1.firebasestorage.app",messagingSenderId:"897263211529",appId:"1:897263211529:web:bae4a00910a2236d6d54d8",measurementId:"G-ZYT8PRMT0D"});try{(0,i.P5)(o)}catch(e){}let c=(0,n.getAuth)(o),l=(0,s.getFirestore)(o);window.location.origin},4815:(e,t,r)=>{Promise.resolve().then(r.bind(r,177))},9995:(e,t,r)=>{"use strict";r.d(t,{Hs:()=>d,N9:()=>n,Ss:()=>s,bA:()=>o,fP:()=>l,he:()=>c});var a=r(5317),i=r(3201);async function n(e,t,r,n){try{if(e===r)return null;let s={userId:e,type:"follow",read:!1,sourceId:r,sourceType:"user",message:"".concat(t," (@").concat(n,") started following you"),fromUser:{id:r,name:t,username:n},createdAt:a.Timestamp.now()};return{id:(await (0,a.addDoc)((0,a.collection)(i.db,"notifications"),s)).id,...s}}catch(e){return console.error("Error creating follow notification:",e),null}}async function s(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{let t,r=i.j2.currentUser;if(!r)throw Error("User not authenticated");let n=(0,a.collection)(i.db,"notifications");t=e?(0,a.query)(n,(0,a.where)("userId","==",r.uid),(0,a.where)("read","==",!1),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(100)):(0,a.query)(n,(0,a.where)("userId","==",r.uid),(0,a.orderBy)("createdAt","desc"),(0,a.limit)(100));let s=await (0,a.getDocs)(t),o=[];return s.forEach(e=>{o.push({id:e.id,...e.data()})}),o}catch(e){throw console.error("Error fetching notifications:",e),e}}async function o(e){try{let t=i.j2.currentUser;if(!t)throw Error("User not authenticated");let r=(0,a.doc)(i.db,"notifications",e),n=await (0,a.getDoc)(r);if(!n.exists())throw Error("Notification not found");if(n.data().userId!==t.uid)throw Error("Unauthorized access to notification");return await (0,a.updateDoc)(r,{read:!0}),{success:!0}}catch(e){throw console.error("Error marking notification as read:",e),e}}async function c(){try{let e=i.j2.currentUser;if(!e)throw Error("User not authenticated");let t=(0,a.collection)(i.db,"notifications"),r=(0,a.query)(t,(0,a.where)("userId","==",e.uid),(0,a.where)("read","==",!1)),n=await (0,a.getDocs)(r),s=n.docs.map(e=>(0,a.updateDoc)(e.ref,{read:!0}));return await Promise.all(s),{success:!0,count:n.size}}catch(e){throw console.error("Error marking all notifications as read:",e),e}}async function l(e){try{let t=i.j2.currentUser;if(!t)throw Error("User not authenticated");let r=(0,a.doc)(i.db,"notifications",e),n=await (0,a.getDoc)(r);if(!n.exists())throw Error("Notification not found");if(n.data().userId!==t.uid)throw Error("Unauthorized access to notification");return await (0,a.deleteDoc)(r),{success:!0}}catch(e){throw console.error("Error deleting notification:",e),e}}async function d(){try{let e=i.j2.currentUser;if(!e)return 0;let t=(0,a.collection)(i.db,"notifications"),r=(0,a.query)(t,(0,a.where)("userId","==",e.uid),(0,a.where)("read","==",!1));return(await (0,a.getDocs)(r)).size}catch(e){return console.error("Error counting unread notifications:",e),0}}}},e=>{var t=t=>e(e.s=t);e.O(0,[1708,2691,2992,7158,7117,6874,2800,56,8441,1684,7358],()=>t(4815)),_N_E=e.O()}]);