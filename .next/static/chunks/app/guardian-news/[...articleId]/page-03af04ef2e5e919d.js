(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[822,3172],{1549:()=>{},3172:(e,t,a)=>{"use strict";a.d(t,{guardianService:()=>r});class i{async searchArticles(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;if(!this.apiKey||"YOUR_API_KEY_HERE"===this.apiKey)throw Error("Guardian API key not configured");let r=new URLSearchParams({"api-key":this.apiKey,"show-fields":"headline,standfirst,body,main,thumbnail,byline,trailText,bodyText","show-tags":"contributor,keyword","show-elements":"image,video","page-size":i.toString(),page:a.toString(),"order-by":"newest"});e&&r.append("q",e),t&&r.append("section",t);let n="".concat(this.baseUrl,"/search?").concat(r.toString()),o=await fetch(n);if(!o.ok)throw Error("HTTP error! status: ".concat(o.status));return(await o.json()).response}async getArticleById(e){if(!this.apiKey||"YOUR_API_KEY_HERE"===this.apiKey)throw Error("Guardian API key not configured");let t=new URLSearchParams({"api-key":this.apiKey,"show-fields":"headline,standfirst,body,main,thumbnail,byline,trailText,bodyText","show-tags":"contributor,keyword","show-elements":"image,video"}),a="".concat(this.baseUrl,"/").concat(e,"?").concat(t.toString()),i=await fetch(a);if(!i.ok)throw Error("HTTP error! status: ".concat(i.status));return(await i.json()).response.content}async getSections(){if(!this.apiKey||"YOUR_API_KEY_HERE"===this.apiKey)throw Error("Guardian API key not configured");let e="".concat(this.baseUrl,"/sections?api-key=").concat(this.apiKey),t=await fetch(e);if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return(await t.json()).response.results}convertToArticleFormat(e){var t,a,i,r,n,o,s,l;let c="";(null==(t=e.fields)?void 0:t.standfirst)&&(c+='<div class="article-standfirst" style="font-size: 1.2em; color: #666; font-weight: 400; line-height: 1.4; margin: 0 0 2em 0;">\n        <strong>'.concat(e.fields.standfirst,"</strong>\n      </div>"));let d=(null==(a=e.fields)?void 0:a.body)||(null==(i=e.fields)?void 0:i.bodyText)||"";if(d&&(c+=d=(d=(d=(d=(d=d.replace(/<img([^>]*?)>/g,(e,t)=>"<img ".concat(t,' style="max-width: 100%; height: auto; margin: 2em auto; display: block; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" />'))).replace(/<figure([^>]*?)>/g,(e,t)=>"<figure ".concat(t,' style="margin: 2em auto; text-align: center;">'))).replace(/<figcaption([^>]*?)>/g,(e,t)=>"<figcaption ".concat(t,' style="margin-top: 0.5em; font-size: 0.9em; color: #666; font-style: italic; text-align: center;">'))).replace(/<video([^>]*?)>/g,(e,t)=>"<video ".concat(t,' style="max-width: 100%; height: auto; margin: 2em auto; display: block; border-radius: 8px;" controls />'))).replace(/<p>\s*<\/p>/g,"")),!(c.includes("<img")||c.includes("<figure"))&&e.elements&&e.elements.length>0){let t=e.elements.find(e=>"image"===e.type&&e.assets&&e.assets.length>0);if(t){let a=t.assets.find(e=>"image"===e.type);if(a){let t=a.typeData.secureFile||a.file,i=a.typeData.alt||a.typeData.caption||e.webTitle,r=a.typeData.caption||"";c='<figure style="margin: 0 0 2em 0; text-align: center;">\n              <img src="'.concat(t,'" alt="').concat(i,'" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" />\n              ').concat(r?'<figcaption style="margin-top: 0.5em; font-size: 0.9em; color: #666; font-style: italic;">'.concat(r,"</figcaption>"):"","\n            </figure>")+c}}}(null==(r=e.fields)?void 0:r.main)&&!c.includes("<img")&&!c.includes("<figure")&&(c='<figure style="margin: 0 0 2em 0; text-align: center;">\n              <img src="'.concat(e.fields.main,'" alt="').concat(e.webTitle.replace(/"/g,"&quot;"),'" style="max-width: 100%; height: auto; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);" />\n            </figure>')+c),c+='<div class="original-article-link" style="margin-top: 3em; padding: 1.5em; background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: 12px; border-left: 4px solid #0066cc; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">\n      <p style="margin: 0; color: #495057;"><em>\uD83D\uDCF0 <strong>Read the complete article at:</strong> <a href="'.concat(e.webUrl,'" target="_blank" rel="noopener noreferrer" style="color: #0066cc; font-weight: 600; text-decoration: none; border-bottom: 1px solid transparent; transition: border-bottom 0.2s ease;" onmouseover="this.style.borderBottom=\'1px solid #0066cc\'" onmouseout="this.style.borderBottom=\'1px solid transparent\'">The Guardian</a></em></p>\n    </div>');let u=(null==(n=e.fields)?void 0:n.byline)||(null==(o=e.tags.find(e=>"contributor"===e.type))?void 0:o.webTitle)||"The Guardian",g=Math.ceil(((null==(s=e.fields)?void 0:s.body)?e.fields.body.replace(/<[^>]*>/g,"").split(/\s+/).length:300)/200),m=[e.sectionName,e.pillarName,...e.tags.filter(e=>"keyword"===e.type).slice(0,3).map(e=>e.webTitle)].filter(Boolean);return{title:(null==(l=e.fields)?void 0:l.headline)||e.webTitle,authorName:u,createdAt:(e=>{try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}catch(t){return console.error("Error formatting date:",t),e}})(e.webPublicationDate),readTime:g,tags:m,authorId:"guardian-api",hasReflectionRoom:!1,html:c}}isConfigured(){return!!(this.apiKey&&"YOUR_API_KEY_HERE"!==this.apiKey)}constructor(){this.baseUrl="https://content.guardianapis.com",this.apiKey="c928b68e-9227-4e28-a734-63f37cbd301b",this.apiKey&&"YOUR_API_KEY_HERE"!==this.apiKey||console.warn("Guardian API key not configured. Please set NEXT_PUBLIC_GUARDIAN_API_KEY in your environment variables.")}}let r=new i},4313:(e,t,a)=>{Promise.resolve().then(a.bind(a,5408))},5408:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var i=a(5155),r=a(2115),n=a(5695),o=a(3201),s=a(3616),l=a(3804),c=a(6016),d=a(3172),u=a(7041),g=a(326);function m(){let e=(0,n.useParams)(),t=(0,n.useRouter)(),[a,m]=(0,r.useState)(null),[h,f]=(0,r.useState)(!0),[p,y]=(0,r.useState)(""),[b,x]=(0,r.useState)(null),[w,v]=(0,r.useState)(!1),[E,k]=(0,r.useState)([]),[S,I]=(0,r.useState)(!0),[A,T]=(0,r.useState)("reflective"),j=Array.isArray(null==e?void 0:e.articleId)?e.articleId.join("/"):null==e?void 0:e.articleId;(0,r.useEffect)(()=>{let e=o.j2.onAuthStateChanged(e=>{x(e),v(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{if(w){let e=localStorage.getItem("moodFeatureEnabled");null!==e?I(JSON.parse(e)):I(!0)}else I(!1)},[w]),(0,r.useEffect)(()=>{let e=async()=>{try{if(f(!0),y(""),!d.guardianService.isConfigured())return void y("Guardian API not configured. Please add your Guardian API key to environment variables.");let e=await d.guardianService.getArticleById(j);m(e),await N(j)}catch(e){console.error("Error fetching Guardian article:",e),y("Failed to load article. Please try again later.")}finally{f(!1)}};j&&e()},[j]),(0,r.useEffect)(()=>{if(a&&w){var e,t;let i=(null==(e=a.fields)?void 0:e.bodyText)||(null==(t=a.fields)?void 0:t.trailText)||"";if(i){let e=i.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();T((0,u.H)(e))}}},[a,w]);let _=()=>{t.push("/guardian-news")},N=async e=>{try{let t=await s.r.getSocialData(e,"guardian");t?k(t.likes||[]):k([])}catch(e){console.error("Error fetching likes data:",e),k([])}};if(h)return(0,i.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center",children:[(0,i.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,i.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading article..."})]})});if(p)return(0,i.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,i.jsx)("div",{className:"text-red-600 text-lg mb-4",children:p}),(0,i.jsx)("button",{onClick:_,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Guardian News"})]})});if(!a)return(0,i.jsx)("div",{className:"min-h-screen bg-white flex items-center justify-center",children:(0,i.jsxs)("div",{className:"text-center max-w-md mx-auto p-6",children:[(0,i.jsx)("div",{className:"text-gray-600 text-lg mb-4",children:"Article not found"}),(0,i.jsx)("button",{onClick:_,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Guardian News"})]})});let P=d.guardianService.convertToArticleFormat(a);return(0,i.jsxs)("div",{className:"guardian-article",style:{position:"relative",backgroundColor:"#ffffff"},children:[w&&(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(135deg, \n                ".concat(g.Qx[A].gradientStart,"08, \n                ").concat(g.Qx[A].gradientEnd,"12, \n                ").concat(g.Qx[A].gradientStart,"06)"),backgroundSize:"100% 100%",zIndex:-10,transition:"background-image 0.8s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}})}),(0,i.jsx)(l.A,{articleId:"guardian-".concat(encodeURIComponent(a.id)),articleHtml:P.html,article:P,initialLikes:E,currentUser:b,isAuthenticated:w,onEditClick:_,articleTitle:P.title,articleSlug:"guardian-".concat(encodeURIComponent(a.id)),moodFeatureEnabled:S,onToggleMoodFeature:e=>{I(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e))},mood:A,isExternal:!0,externalSource:"guardian",externalId:a.id,externalUrl:a.webUrl}),(0,i.jsx)("div",{style:{maxWidth:"800px",margin:"0 auto",padding:"2rem 1rem"},children:(0,i.jsx)(c.A,{articleId:"guardian-".concat(encodeURIComponent(a.id))})})]})}a(1549)}},e=>{var t=t=>e(e.s=t);e.O(0,[5598,2140,8096,4744,4814,1431,3804,7358],()=>t(4313)),_N_E=e.O()}]);