(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5292],{3934:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var n=a(5155),r=a(6121),i=a(6874),o=a.n(i),s=a(5695),l=a(2115),d=a(8501),c=a.n(d),g=a(3201),m=a(6203),h=a(3487),x=a(8883),u=a(9547),p=a(4362),f=a(6016),v=a(2650),j=a(5405),N=a(3891),b=a(9210),y=a(7041),S=a(326);function I(){var e,t;let a=(0,s.useSearchParams)(),i=null==a?void 0:a.get("slug"),[l,d]=(0,r.J0)(null),[I,w]=(0,r.J0)(!0),[A,k]=(0,r.J0)(null),[E,J]=(0,r.J0)([]),[C,L]=(0,r.J0)(!1),[Q,T]=(0,r.J0)(!0),[F,z]=(0,r.J0)(!1),[R,M]=(0,r.J0)(window.innerWidth),[B,H]=(0,r.J0)(null),[U,D]=(0,r.J0)([]),[W,_]=(0,r.J0)(null),[P,O]=(0,r.J0)(!1),[G,q]=(0,r.J0)("reflective"),[K,V]=(0,r.J0)(!0);(0,r.vJ)(()=>{let e=()=>{M(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.vJ)(()=>{if(C){let e=localStorage.getItem("moodFeatureEnabled");if(console.log("Loading mood feature preference from localStorage for authenticated user:",e),null!==e){let t=JSON.parse(e);console.log("Setting mood feature enabled to:",t),V(t)}else console.log("No saved preference found for authenticated user, using default: true"),V(!0)}else console.log("User not authenticated, disabling mood feature"),V(!1)},[C]),(0,r.vJ)(()=>{let e=(0,m.onAuthStateChanged)(g.j2,e=>{L(!!e),_(e)});return()=>e()},[l]),(0,r.vJ)(()=>{let e=e=>{let t=e.target,a=document.getElementById("profile-menu"),n=document.getElementById("profile-button");a&&!a.contains(t)&&n&&!n.contains(t)&&z(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,r.vJ)(()=>{(async()=>{if(!i){k("No article slug provided"),w(!1);return}try{let e=await (0,b.l6)(i);if(!e){k("Article not found"),w(!1);return}let t=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");H(t),D(e.likes||[]);let a=e.body.split(/\s+/).length,n=Math.ceil(a/200),r=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";d({id:e.id,title:e.title,authorName:e.authorName||"Anonymous",authorId:e.authorId,createdAt:r,readTime:n,likes:e.likes||[],tags:e.tags||[],slug:i,hasReflectionRoom:e.hasReflectionRoom||!1}),J(e.tags||[]),w(!1)}catch(e){console.error("Error fetching article:",e),k("Failed to load article"),w(!1)}})()},[i]),(0,r.vJ)(()=>{if(B&&C){let e=B.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();e&&q((0,y.H)(e))}},[B,C]);let X=async()=>{try{await (0,m.signOut)(g.j2),z(!1)}catch(e){console.error("Error signing out:",e)}};return(console.log("\uD83D\uDD04 Articles page Article component re-rendered at:",new Date().toLocaleTimeString()),I)?(0,n.jsxs)("div",{className:c().loadingContainer,children:[(0,n.jsx)("div",{className:c().loadingIndicator}),(0,n.jsx)("p",{children:"Loading article..."})]}):A?(0,n.jsx)("div",{className:c().errorContainer,children:(0,n.jsx)("p",{className:c().errorMessage,children:A})}):P&&l?(0,n.jsx)(v.A,{articleId:l.id,onUpdateComplete:()=>{console.log("Article update complete - refreshing content"),O(!1),(async()=>{try{w(!0),await new Promise(e=>setTimeout(e,500));let e=await (0,b.l6)(i||"");if(!e){k("Article not found"),w(!1);return}let t=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");H(t),D(e.likes||[]);let a=e.body.split(/\s+/).length,n=Math.ceil(a/200),r=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";d({id:e.id,title:e.title,authorName:e.authorName||"Anonymous",authorId:e.authorId,createdAt:r,readTime:n,likes:e.likes||[],tags:e.tags||[],slug:i||"",hasReflectionRoom:e.hasReflectionRoom||!1}),J(e.tags||[]),console.log("Article refreshed successfully - mood feature state preserved")}catch(e){console.error("Error refetching article:",e),k("Failed to refresh article content")}finally{w(!1)}})()},backToArticleAction:()=>O(!1),editingTitle:l.title}):(0,n.jsxs)("div",{className:c().articlePageContainer,style:{position:"relative",backgroundColor:"#ffffff"},children:[C&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(45deg, \n                ".concat(S.Qx[G].gradientStart,"40, \n                ").concat(S.Qx[G].gradientEnd,"60, \n                ").concat(S.Qx[G].gradientStart,"30, \n                ").concat(S.Qx[G].gradientEnd,"50)"),backgroundSize:"400% 400%",animation:"gradientFlow 8s ease-in-out infinite",filter:"contrast(1.1) brightness(1.05) saturate(1.1)",zIndex:0,transition:"background-image 1s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,n.jsx)("div",{"data-mood-element":"grain-texture",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"\n                radial-gradient(circle at 25% 25%, rgba(255,255,255,0.1) 1px, transparent 1px),\n                radial-gradient(circle at 75% 75%, rgba(0,0,0,0.05) 1px, transparent 1px),\n                radial-gradient(circle at 45% 15%, rgba(255,255,255,0.08) 1px, transparent 1px),\n                radial-gradient(circle at 15% 85%, rgba(0,0,0,0.03) 1px, transparent 1px)\n              ",backgroundSize:"4px 4px, 6px 6px, 3px 3px, 5px 5px",animation:"grainMove 20s linear infinite",opacity:.6,mixBlendMode:"soft-light",zIndex:0,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,n.jsx)("div",{"data-mood-element":"secondary-wave",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(ellipse at 30% 50%, \n                ".concat(S.Qx[G].gradientEnd,"25, \n                transparent 70%), \n                radial-gradient(ellipse at 70% 80%, \n                ").concat(S.Qx[G].gradientStart,"30, \n                transparent 70%)"),backgroundSize:"800% 800%",animation:"waveFlow 12s linear infinite reverse",filter:"contrast(1.15) blur(0.5px)",zIndex:0,transition:"background-image 1s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,n.jsx)("div",{"data-mood-element":"floating-orbs",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 20% 20%, \n                ".concat(S.Qx[G].gradientStart,"20, \n                transparent 40%), \n                radial-gradient(circle at 80% 60%, \n                ").concat(S.Qx[G].gradientEnd,"25, \n                transparent 50%),\n                radial-gradient(circle at 40% 90%, \n                ").concat(S.Qx[G].gradientStart,"15, \n                transparent 35%)"),animation:"orbFloat 15s ease-in-out infinite",filter:"contrast(1.2) saturate(0.9)",zIndex:0,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,n.jsx)("div",{"data-mood-element":"fine-grain",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"\n                repeating-conic-gradient(from 0deg at 50% 50%, transparent 0deg, rgba(255,255,255,0.02) 1deg, transparent 2deg),\n                repeating-linear-gradient(90deg, transparent, rgba(0,0,0,0.01) 1px, transparent 2px),\n                repeating-linear-gradient(0deg, transparent, rgba(255,255,255,0.015) 1px, transparent 3px)\n              ",backgroundSize:"2px 2px, 1px 1px, 3px 3px",animation:"fineGrain 25s linear infinite reverse",opacity:.4,mixBlendMode:"overlay",zIndex:0,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}})]}),l&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("header",{className:c().pageHeader,"data-mood-header":"page-header",style:K&&C?{position:"relative",zIndex:1e4,background:"linear-gradient(135deg, \n                  rgba(255, 255, 255, 0.15) 0%, \n                  ".concat(S.Qx[G].gradientStart,"12 40%, \n                  ").concat(S.Qx[G].gradientEnd,"08 100%)"),backdropFilter:"blur(24px) saturate(180%)",borderBottom:"1px solid ".concat(S.Qx[G].gradientStart,"25"),boxShadow:"\n                  0 2px 8px -2px ".concat(S.Qx[G].gradientStart,"15,\n                  0 8px 32px -8px ").concat(S.Qx[G].gradientStart,"20,\n                  inset 0 1px 0 rgba(255, 255, 255, 0.25),\n                  inset 0 -1px 0 ").concat(S.Qx[G].gradientStart,"10\n                "),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid ".concat(S.Qx[G].gradientStart,"15"),borderTop:"none"}:{position:"relative",zIndex:1e4},children:(0,n.jsxs)("div",{className:c().headerContainer,children:[(0,n.jsx)(o(),{href:"/",className:c().logoLink,children:(0,n.jsx)("div",{className:c().headerLogo,style:K&&C?{color:S.Qx[G].accent,fontWeight:"700",textShadow:"0 0 20px ".concat(S.Qx[G].gradientStart,"30, 0 0 40px ").concat(S.Qx[G].gradientStart,"15"),transition:"all 0.3s ease"}:{fontWeight:"700"},children:"Journalite"})}),(0,n.jsxs)("div",{className:c().headerActions,children:[C&&(0,n.jsx)(h.A,{}),C&&(0,n.jsx)(x.A,{}),(0,n.jsx)("div",{className:c().profileMenu,id:"profile-menu",children:C?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:c().profileCircle,onClick:()=>{z(!F)},id:"profile-button",children:(null==W||null==(e=W.displayName)?void 0:e.charAt(0))||(null==W||null==(t=W.email)?void 0:t.charAt(0))||"U"}),F&&(0,n.jsxs)("div",{className:c().profileDropdown,children:[(0,n.jsx)(o(),{href:"/",className:c().dropdownItem,children:"Home"}),(0,n.jsx)(o(),{href:"/my-thoughts",className:c().dropdownItem,children:"My Thoughts"}),(0,n.jsx)(o(),{href:"/messages",className:c().dropdownItem,children:"Messages"}),(0,n.jsx)(o(),{href:"/create-article",className:c().dropdownItem,children:"Create Article"}),(0,n.jsx)(o(),{href:"/explore",className:c().dropdownItem,children:"Explore"}),(0,n.jsx)(o(),{href:"/my-profile",className:c().dropdownItem,children:"Profile"}),(0,n.jsx)(o(),{href:"/settings",className:c().dropdownItem,children:"Settings"}),(0,n.jsx)("button",{onClick:X,className:c().dropdownItem,children:"Sign out"})]})]}):(0,n.jsxs)("div",{className:c().authButtons,children:[(0,n.jsx)(o(),{href:"/login",className:c().loginButton,children:"Sign in"}),(0,n.jsx)(o(),{href:"/register",className:c().signupButton,children:"Get started"})]})})]})]})}),(0,n.jsxs)("div",{className:c().pageContainer,style:{position:"relative",zIndex:1},children:[(0,n.jsxs)("header",{className:c().articleHeader,children:[(0,n.jsxs)("div",{className:c().articleHeaderWithReaders,children:[(0,n.jsx)("div",{className:c().titleSection,children:(0,n.jsx)("h1",{className:c().articleTitle,style:{margin:0},children:l.title})}),(0,n.jsx)("div",{className:c().readersSection,children:(0,n.jsx)(N.A,{articleId:l.id})})]}),(0,n.jsxs)("div",{className:c().articleMeta,children:[(0,n.jsxs)("div",{className:c().authorInfo,children:[(0,n.jsx)("div",{className:c().authorAvatar,children:l.authorName.charAt(0)}),(0,n.jsxs)("div",{className:c().authorDetails,children:[(0,n.jsx)(o(),{href:"/user/".concat(l.authorName.toLowerCase().replace(/\s+/g,"")),className:c().authorNameLink,children:(0,n.jsx)("div",{className:c().authorName,children:l.authorName})}),(0,n.jsxs)("div",{className:c().articleDetails,children:[l.createdAt," \xb7 ",l.readTime," min read"]})]})]}),(0,n.jsxs)("div",{className:c().articleActions,children:[(0,n.jsx)(j.A,{articleId:l.id,initialLikes:U,className:"".concat(c().likeButton),styles:c()}),C&&l.authorId===(null==W?void 0:W.uid)&&(0,n.jsx)("button",{className:c().editButton,onClick:()=>O(!0),children:"Edit"})]})]}),l.tags&&l.tags.length>0&&(0,n.jsx)("div",{className:c().tagContainer,children:l.tags.map((e,t)=>(0,n.jsx)("span",{className:c().tag,children:e},t))})]}),(0,n.jsx)(u.A,{articleId:l.id,initialHtml:B||void 0,isAuthenticated:C,articleTitle:l.title,articleSlug:l.slug,hasReflectionRoom:l.hasReflectionRoom||!1,authorId:l.authorId}),(0,n.jsx)("div",{className:c().commentsContainer,children:(0,n.jsx)(f.A,{articleId:l.id,...C&&{mood:G,moodFeatureEnabled:K}})}),(0,n.jsxs)("aside",{className:c().relatedTagsSection,children:[(0,n.jsx)("h2",{className:c().relatedTagsHeading,children:"Related Tags"}),(0,n.jsx)("div",{className:c().relatedTagsList,children:E.map(e=>(0,n.jsxs)(o(),{href:"/tag/".concat(e.toLowerCase()),className:c().relatedTag,children:["# ",e]},e))}),(0,n.jsx)(o(),{href:"/write",className:c().writeButton,children:"Write"})]})]})]}),(0,n.jsx)(p.A,{isAuthenticated:C})]})}function w(){return(0,n.jsx)(l.Suspense,{fallback:(0,n.jsx)("div",{children:"Loading article..."}),children:(0,n.jsx)(I,{})})}},6121:(e,t,a)=>{"use strict";a.d(t,{J0:()=>n.useState,vJ:()=>n.useEffect});var n=a(2115)},9251:(e,t,a)=>{Promise.resolve().then(a.bind(a,3934))}},e=>{var t=t=>e(e.s=t);e.O(0,[7267,1708,5786,2992,7158,5004,7117,6874,3593,4366,6713,4744,2800,8883,9122,2650,1431,914,8441,1684,7358],()=>t(9251)),_N_E=e.O()}]);