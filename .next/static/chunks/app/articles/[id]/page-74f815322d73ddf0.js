(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8406],{4114:(e,t,a)=>{"use strict";a.d(t,{default:()=>S});var l=a(5155),i=a(2115),r=a(5695),n=a(6874),o=a.n(n),c=a(3201),d=a(6616);let s=i.memo(e=>{let{articleId:t,articleHtml:a,isAuthenticated:i,articleTitle:r,articleSlug:n,moodFeatureEnabled:o,onToggleMoodFeature:c}=e;return console.log("\uD83D\uDCDD ArticleContent re-rendered at:",new Date().toLocaleTimeString()),(0,l.jsx)(d.A,{articleId:t,initialHtml:a||void 0,isAuthenticated:i,articleTitle:r,articleSlug:n,...i&&{moodFeatureEnabled:o,onToggleMoodFeature:c}})},(e,t)=>{let a=e.articleId===t.articleId&&e.articleHtml===t.articleHtml&&e.isAuthenticated===t.isAuthenticated&&e.articleTitle===t.articleTitle&&e.articleSlug===t.articleSlug&&e.moodFeatureEnabled===t.moodFeatureEnabled&&e.onToggleMoodFeature===t.onToggleMoodFeature;return a||console.log("\uD83D\uDCDD ArticleContent memo comparison - will re-render because:",{articleId:e.articleId!==t.articleId,articleHtml:e.articleHtml!==t.articleHtml,isAuthenticated:e.isAuthenticated!==t.isAuthenticated,articleTitle:e.articleTitle!==t.articleTitle,articleSlug:e.articleSlug!==t.articleSlug,moodFeatureEnabled:e.moodFeatureEnabled!==t.moodFeatureEnabled,onToggleMoodFeature:e.onToggleMoodFeature!==t.onToggleMoodFeature}),a});var u=a(5405),g=a(8501),m=a.n(g);let h=i.memo(e=>{let{articleId:t,articleHtml:a,article:i,initialLikes:r,currentUser:n,isAuthenticated:o,onEditClick:c,articleTitle:d,articleSlug:g}=e;return console.log("\uD83C\uDFD7️ ArticleLayout re-rendered at:",new Date().toLocaleTimeString()),(0,l.jsxs)("div",{className:m().pageContainer,children:[i&&(0,l.jsxs)("header",{className:m().articleHeader,children:[(0,l.jsx)("h1",{className:m().articleTitle,children:i.title}),(0,l.jsxs)("div",{className:m().articleMeta,children:[(0,l.jsxs)("div",{className:m().authorInfo,children:[(0,l.jsx)("div",{className:m().authorAvatar,children:i.authorName.charAt(0)}),(0,l.jsxs)("div",{className:m().authorDetails,children:[(0,l.jsx)("div",{className:m().authorName,children:i.authorName}),(0,l.jsxs)("div",{className:m().articleDetails,children:[i.createdAt," \xb7 ",i.readTime," min read"]})]})]}),(0,l.jsxs)("div",{className:m().articleActions,children:[(0,l.jsx)(u.A,{articleId:t,initialLikes:r,className:m().likeButton,styles:m()}),n&&i.authorId===n.uid&&(0,l.jsx)("button",{className:m().editButton,onClick:c,children:"Edit"})]})]}),i.tags&&i.tags.length>0&&(0,l.jsx)("div",{className:m().tagContainer,children:i.tags.map((e,t)=>(0,l.jsx)("span",{className:m().tag,children:e},t))})]}),(0,l.jsx)(s,{articleId:t,articleHtml:a,isAuthenticated:o,articleTitle:d,articleSlug:g})]})},(e,t)=>{var a,l,i,r,n,o,c,d,s,u,g,m;let h=e.articleId===t.articleId&&e.articleHtml===t.articleHtml&&(null==(a=e.article)?void 0:a.title)===(null==(l=t.article)?void 0:l.title)&&(null==(i=e.article)?void 0:i.authorName)===(null==(r=t.article)?void 0:r.authorName)&&(null==(n=e.article)?void 0:n.createdAt)===(null==(o=t.article)?void 0:o.createdAt)&&(null==(c=e.article)?void 0:c.readTime)===(null==(d=t.article)?void 0:d.readTime)&&(null==(s=e.article)?void 0:s.authorId)===(null==(u=t.article)?void 0:u.authorId)&&e.isAuthenticated===t.isAuthenticated&&(null==(g=e.currentUser)?void 0:g.uid)===(null==(m=t.currentUser)?void 0:m.uid)&&e.articleTitle===t.articleTitle&&e.articleSlug===t.articleSlug&&e.onEditClick===t.onEditClick;return h||console.log("\uD83C\uDFD7️ ArticleLayout memo - will re-render because something changed"),h});var x=a(6016),p=a(3430),v=a(9210),b=a(7041),f=a(326);let S=e=>{let{id:t}=e;(0,r.useRouter)();let[a,n]=(0,i.useState)(!0),[d,s]=(0,i.useState)(""),[u,g]=(0,i.useState)(null),[S,k]=(0,i.useState)(null),[j,w]=(0,i.useState)([]),[A,E]=(0,i.useState)(null),[I,N]=(0,i.useState)(!1),[y,C]=(0,i.useState)(!1),[T,F]=(0,i.useState)("reflective"),[Q,L]=(0,i.useState)(!0);(0,i.useEffect)(()=>{let e=c.j2.onAuthStateChanged(e=>{E(e),C(!!e)});return()=>e()},[]),(0,i.useEffect)(()=>{if(y){let e=localStorage.getItem("moodFeatureEnabled");null!==e?L(JSON.parse(e)):L(!0)}else L(!1)},[y]);let H=async()=>{try{var e;console.log("Fetching article with ID: ".concat(t,", timestamp: ").concat(Date.now())),n(!0),await new Promise(e=>setTimeout(e,300));let a=await (0,v.getArticleById)(t);if(console.log("Article data received:",null==a?void 0:a.title,"Content length:",(null==a||null==(e=a.body)?void 0:e.length)||0),!a)return void s("Article not found");let l=a.body?a.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):"";g(l),w(a.likes||[]);let i=a.body?a.body.split(/\s+/).length:0,r=Math.ceil(i/200),o=a.createdAt?new Date(1e3*a.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";k({title:a.title||"Untitled Article",authorName:a.authorName||"Anonymous",createdAt:o,readTime:r,tags:a.tags||[],authorId:a.authorId})}catch(e){console.error("Error loading article:",e),s("Failed to load article")}finally{n(!1)}};(0,i.useEffect)(()=>{H()},[t]),(0,i.useEffect)(()=>{if(u&&y){let e=u.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();e&&F((0,b.H)(e))}},[u,y]);let M=(0,i.useCallback)(()=>{N(!0)},[]),z=(0,i.useCallback)(()=>{N(!1)},[]);(0,i.useCallback)(e=>{L(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e))},[]);let D=(0,i.useMemo)(()=>(null==S?void 0:S.title)||"Article",[null==S?void 0:S.title]),U=(0,i.useMemo)(()=>(null==S?void 0:S.title)?S.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):t,[null==S?void 0:S.title,t]);return a?(0,l.jsxs)("div",{className:m().loadingContainer,children:[(0,l.jsx)("div",{className:m().loadingIndicator}),(0,l.jsx)("p",{children:"Loading article..."})]}):d?(0,l.jsx)("div",{className:m().errorContainer,children:(0,l.jsx)("p",{className:m().errorMessage,children:d})}):I?(0,l.jsx)(p.A,{articleId:t,onUpdateComplete:e=>{console.log("Article update complete with data:",e),n(!0),g(null),k(null),e?(console.log("Forcing hard reload to see updated content"),window.location.href="/articles/".concat(t,"?reload=").concat(Date.now())):setTimeout(()=>{H()},800)},backToArticleAction:z,editingTitle:null==S?void 0:S.title}):(0,l.jsxs)("div",{className:m().articlePageContainer,style:{position:"relative",backgroundColor:"#ffffff"},children:[y&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(45deg, \n                ".concat(f.Qx[T].gradientStart,"40, \n                ").concat(f.Qx[T].gradientEnd,"60, \n                ").concat(f.Qx[T].gradientStart,"30, \n                ").concat(f.Qx[T].gradientEnd,"50)"),backgroundSize:"400% 400%",animation:"gradientFlow 8s ease-in-out infinite",filter:"contrast(1.1) brightness(1.05) saturate(1.1)",zIndex:0,transition:"background-image 1s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,l.jsx)("div",{"data-mood-element":"secondary-wave",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 20% 80%, ".concat(f.Qx[T].gradientEnd,"25 0%, transparent 50%),\n                radial-gradient(circle at 80% 20%, ").concat(f.Qx[T].gradientStart,"25 0%, transparent 50%),\n                radial-gradient(circle at 40% 40%, ").concat(f.Qx[T].gradientEnd,"15 0%, transparent 50%)"),backgroundSize:"600px 600px, 800px 800px, 400px 400px",animation:"moodFloat 12s ease-in-out infinite alternate",zIndex:1,opacity:.6,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,l.jsx)("div",{"data-mood-element":"floating-orbs",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 25% 25%, ".concat(f.Qx[T].gradientStart,"20 0%, transparent 25%),\n                radial-gradient(circle at 75% 75%, ").concat(f.Qx[T].gradientEnd,"20 0%, transparent 25%),\n                radial-gradient(circle at 50% 10%, ").concat(f.Qx[T].gradientStart,"15 0%, transparent 30%),\n                radial-gradient(circle at 10% 90%, ").concat(f.Qx[T].gradientEnd,"15 0%, transparent 30%)"),backgroundSize:"300px 300px, 500px 500px, 200px 200px, 400px 400px",animation:"orbitalFloat 20s linear infinite",zIndex:2,opacity:.4,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,l.jsx)("div",{"data-mood-element":"grain-texture",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"repeating-linear-gradient(\n                90deg,\n                transparent,\n                transparent 2px,\n                ".concat(f.Qx[T].gradientStart,"02 2px,\n                ").concat(f.Qx[T].gradientStart,"02 4px\n              )"),zIndex:3,opacity:.15,mixBlendMode:"overlay",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}})]}),(0,l.jsx)("header",{className:m().pageHeader,"data-mood-header":"page-header",style:Q&&y?{position:"relative",zIndex:1e4,background:"linear-gradient(135deg, \n            rgba(255, 255, 255, 0.15) 0%, \n            ".concat(f.Qx[T].gradientStart,"12 40%, \n            ").concat(f.Qx[T].gradientEnd,"08 100%)"),backdropFilter:"blur(24px) saturate(180%)",borderBottom:"1px solid ".concat(f.Qx[T].gradientStart,"25"),boxShadow:"\n            0 2px 8px -2px ".concat(f.Qx[T].gradientStart,"15,\n            0 8px 32px -8px ").concat(f.Qx[T].gradientStart,"20,\n            inset 0 1px 0 rgba(255, 255, 255, 0.25),\n            inset 0 -1px 0 ").concat(f.Qx[T].gradientStart,"10\n          "),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid ".concat(f.Qx[T].gradientStart,"15"),borderTop:"none"}:{position:"relative",zIndex:1e4,background:"rgba(255, 255, 255, 0.95)"},children:(0,l.jsxs)("div",{className:m().headerContainer,children:[(0,l.jsxs)(o(),{href:"/",className:m().backLink,children:[(0,l.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]}),(0,l.jsx)("div",{className:m().headerLogo,style:Q&&y?{color:f.Qx[T].accent,fontWeight:"700",textShadow:"0 0 20px ".concat(f.Qx[T].gradientStart,"30, 0 0 40px ").concat(f.Qx[T].gradientStart,"15"),transition:"all 0.3s ease"}:{fontWeight:"700"},children:"Journalite"})]})}),(0,l.jsx)(h,{articleId:t,articleHtml:u,article:S,initialLikes:j,currentUser:A,isAuthenticated:y,onEditClick:M,articleTitle:D,articleSlug:U}),(0,l.jsx)("div",{className:m().commentsContainer,children:(0,l.jsx)(x.A,{articleId:t,...y&&{mood:T,moodFeatureEnabled:Q}})})]})}},4734:(e,t,a)=>{Promise.resolve().then(a.bind(a,4114))},5405:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var l=a(5155),i=a(2115),r=a(3201);let n=i.memo(e=>{let{articleId:t,initialLikes:n=[],className:o="",styles:c={}}=e,[d,s]=(0,i.useState)(n),[u,g]=(0,i.useState)(!1),[m,h]=(0,i.useState)(null),[x,p]=(0,i.useState)(!1);(0,i.useEffect)(()=>{let e=r.j2.onAuthStateChanged(e=>{h(e),e?g(d.includes(e.uid)):g(!1)});return()=>e()},[d]),(0,i.useEffect)(()=>{s(n),m&&g(n.includes(m.uid))},[n,m]);let v=async e=>{if(e.preventDefault(),e.stopPropagation(),console.log("\uD83D\uDC4D LikeButton clicked - should NOT trigger parent re-render"),!m)return void alert("Please login to like articles");p(!0),setTimeout(()=>p(!1),300);try{if(u){let e=d.filter(e=>e!==m.uid);s(e),g(!1),console.log("\uD83D\uDC4D Unlike completed - likes:",e.length);let{doc:l,updateDoc:i,arrayRemove:r}=await Promise.resolve().then(a.bind(a,5317)),{db:n}=await Promise.resolve().then(a.bind(a,3201)),o=l(n,"articles",t);await i(o,{likes:r(m.uid)})}else{let e=[...d,m.uid];s(e),g(!0),console.log("\uD83D\uDC4D Like completed - likes:",e.length);let{doc:l,updateDoc:i,arrayUnion:r}=await Promise.resolve().then(a.bind(a,5317)),{db:n}=await Promise.resolve().then(a.bind(a,3201)),o=l(n,"articles",t);await i(o,{likes:r(m.uid)})}}catch(e){console.error("Error updating like status:",e),u?(s([...d,m.uid]),g(!0)):(s(d.filter(e=>e!==m.uid)),g(!1))}};return(0,l.jsxs)("button",{className:"".concat(o," ").concat(u?c.liked:""),onClick:v,"aria-label":u?"Unlike article":"Like article",style:{transition:"all 0.3s ease",transform:x?"scale(1.2)":"scale(1)"},children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:u?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:c.likeIcon,style:{transition:"all 0.3s ease",filter:x?"drop-shadow(0 0 8px currentColor)":"none"},children:(0,l.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,l.jsx)("span",{children:d.length>0?d.length:""})]})})}},e=>{var t=t=>e(e.s=t);e.O(0,[537,8130,1708,2992,7158,5004,7117,6874,8460,7347,464,9122,3430,737,8441,1684,7358],()=>t(4734)),_N_E=e.O()}]);