(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8406],{4114:(e,t,a)=>{"use strict";a.d(t,{default:()=>A});var i=a(5155),l=a(2115),n=a(5695),r=a(6874),o=a.n(r),d=a(3201),c=a(6202);let s=l.memo(e=>{let{articleId:t,articleHtml:a,isAuthenticated:l,articleTitle:n,articleSlug:r,hasReflectionRoom:o=!1,moodFeatureEnabled:d,onToggleMoodFeature:s}=e;return console.log("\uD83D\uDCDD ArticleContent re-rendered at:",new Date().toLocaleTimeString()),(0,i.jsx)(c.A,{articleId:t,initialHtml:a||void 0,isAuthenticated:l,articleTitle:n,articleSlug:r,hasReflectionRoom:o,...l&&{moodFeatureEnabled:d,onToggleMoodFeature:s}})},(e,t)=>{let a=e.articleId===t.articleId&&e.articleHtml===t.articleHtml&&e.isAuthenticated===t.isAuthenticated&&e.articleTitle===t.articleTitle&&e.articleSlug===t.articleSlug&&e.hasReflectionRoom===t.hasReflectionRoom&&e.moodFeatureEnabled===t.moodFeatureEnabled&&e.onToggleMoodFeature===t.onToggleMoodFeature;return a||console.log("\uD83D\uDCDD ArticleContent memo comparison - will re-render because:",{articleId:e.articleId!==t.articleId,articleHtml:e.articleHtml!==t.articleHtml,isAuthenticated:e.isAuthenticated!==t.isAuthenticated,articleTitle:e.articleTitle!==t.articleTitle,articleSlug:e.articleSlug!==t.articleSlug,hasReflectionRoom:e.hasReflectionRoom!==t.hasReflectionRoom,moodFeatureEnabled:e.moodFeatureEnabled!==t.moodFeatureEnabled,onToggleMoodFeature:e.onToggleMoodFeature!==t.onToggleMoodFeature}),a});var u=a(5405),g=a(3891),m=a(8501),h=a.n(m);let x=l.memo(e=>{let{articleId:t,articleHtml:a,article:l,initialLikes:n,currentUser:r,isAuthenticated:o,onEditClick:d,articleTitle:c,articleSlug:m}=e;return console.log("\uD83C\uDFD7️ ArticleLayout re-rendered at:",new Date().toLocaleTimeString()),(0,i.jsxs)("div",{className:h().pageContainer,children:[l&&(0,i.jsxs)("header",{className:h().articleHeader,children:[(0,i.jsxs)("div",{className:h().articleHeaderWithReaders,children:[(0,i.jsx)("div",{className:h().titleSection,children:(0,i.jsx)("h1",{className:h().articleTitle,style:{margin:0},children:l.title})}),(0,i.jsx)("div",{className:h().readersSection,children:(0,i.jsx)(g.A,{articleId:t})})]}),(0,i.jsxs)("div",{className:h().articleMeta,children:[(0,i.jsxs)("div",{className:h().authorInfo,children:[(0,i.jsx)("div",{className:h().authorAvatar,children:l.authorName.charAt(0)}),(0,i.jsxs)("div",{className:h().authorDetails,children:[(0,i.jsx)("div",{className:h().authorName,children:l.authorName}),(0,i.jsxs)("div",{className:h().articleDetails,children:[l.createdAt," \xb7 ",l.readTime," min read"]})]})]}),(0,i.jsxs)("div",{className:h().articleActions,children:[(0,i.jsx)(u.A,{articleId:t,initialLikes:n,className:h().likeButton,styles:h()}),r&&l.authorId===r.uid&&(0,i.jsx)("button",{className:h().editButton,onClick:d,children:"Edit"})]})]}),l.tags&&l.tags.length>0&&(0,i.jsx)("div",{className:h().tagContainer,children:l.tags.map((e,t)=>(0,i.jsx)("span",{className:h().tag,children:e},t))})]}),(0,i.jsx)(s,{articleId:t,articleHtml:a,isAuthenticated:o,articleTitle:c,articleSlug:m,hasReflectionRoom:(null==l?void 0:l.hasReflectionRoom)||!1})]})},(e,t)=>{var a,i,l,n,r,o,d,c,s,u,g,m,h,x;let p=e.articleId===t.articleId&&e.articleHtml===t.articleHtml&&(null==(a=e.article)?void 0:a.title)===(null==(i=t.article)?void 0:i.title)&&(null==(l=e.article)?void 0:l.authorName)===(null==(n=t.article)?void 0:n.authorName)&&(null==(r=e.article)?void 0:r.createdAt)===(null==(o=t.article)?void 0:o.createdAt)&&(null==(d=e.article)?void 0:d.readTime)===(null==(c=t.article)?void 0:c.readTime)&&(null==(s=e.article)?void 0:s.authorId)===(null==(u=t.article)?void 0:u.authorId)&&(null==(g=e.article)?void 0:g.hasReflectionRoom)===(null==(m=t.article)?void 0:m.hasReflectionRoom)&&e.isAuthenticated===t.isAuthenticated&&(null==(h=e.currentUser)?void 0:h.uid)===(null==(x=t.currentUser)?void 0:x.uid)&&e.articleTitle===t.articleTitle&&e.articleSlug===t.articleSlug&&e.onEditClick===t.onEditClick;return p||console.log("\uD83C\uDFD7️ ArticleLayout memo - will re-render because something changed"),p});var p=a(2195),v=a(2650),f=a(9210),b=a(7041),S=a(326),j=a(4362);let A=e=>{let{id:t}=e;(0,n.useRouter)();let[a,r]=(0,l.useState)(!0),[c,s]=(0,l.useState)(""),[u,g]=(0,l.useState)(null),[m,A]=(0,l.useState)(null),[E,I]=(0,l.useState)([]),[N,w]=(0,l.useState)(null),[k,y]=(0,l.useState)(!1),[T,F]=(0,l.useState)(!1),[R,C]=(0,l.useState)(window.innerWidth),[Q,L]=(0,l.useState)("reflective"),[H,M]=(0,l.useState)(!0);(0,l.useEffect)(()=>{let e=d.j2.onAuthStateChanged(e=>{w(e),F(!!e)});return()=>e()},[]),(0,l.useEffect)(()=>{let e=()=>{C(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,l.useEffect)(()=>{if(T){let e=localStorage.getItem("moodFeatureEnabled");null!==e?M(JSON.parse(e)):M(!0)}else M(!1)},[T]);let z=async()=>{try{var e;console.log("Fetching article with ID: ".concat(t,", timestamp: ").concat(Date.now())),r(!0),await new Promise(e=>setTimeout(e,300));let a=await (0,f.getArticleById)(t);if(console.log("Article data received:",null==a?void 0:a.title,"Content length:",(null==a||null==(e=a.body)?void 0:e.length)||0),!a)return void s("Article not found");let i=a.body?a.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):"";g(i),I(a.likes||[]);let l=a.body?a.body.split(/\s+/).length:0,n=Math.ceil(l/200),o=a.createdAt?new Date(1e3*a.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";A({title:a.title||"Untitled Article",authorName:a.authorName||"Anonymous",createdAt:o,readTime:n,tags:a.tags||[],authorId:a.authorId,hasReflectionRoom:a.hasReflectionRoom||!1})}catch(e){console.error("Error loading article:",e),s("Failed to load article")}finally{r(!1)}};(0,l.useEffect)(()=>{z()},[t]),(0,l.useEffect)(()=>{if(u&&T){let e=u.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();e&&L((0,b.H)(e))}},[u,T]);let D=(0,l.useCallback)(()=>{y(!0)},[]),U=(0,l.useCallback)(()=>{y(!1)},[]);(0,l.useCallback)(e=>{M(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e))},[]);let B=(0,l.useMemo)(()=>(null==m?void 0:m.title)||"Article",[null==m?void 0:m.title]),W=(0,l.useMemo)(()=>(null==m?void 0:m.title)?m.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):t,[null==m?void 0:m.title,t]);return a?(0,i.jsxs)("div",{className:h().loadingContainer,children:[(0,i.jsx)("div",{className:h().loadingIndicator}),(0,i.jsx)("p",{children:"Loading article..."})]}):c?(0,i.jsx)("div",{className:h().errorContainer,children:(0,i.jsx)("p",{className:h().errorMessage,children:c})}):k?(0,i.jsx)(v.A,{articleId:t,onUpdateComplete:e=>{console.log("Article update complete with data:",e),r(!0),g(null),A(null),e?(console.log("Forcing hard reload to see updated content"),window.location.href="/articles/".concat(t,"?reload=").concat(Date.now())):setTimeout(()=>{z()},800)},backToArticleAction:U,editingTitle:null==m?void 0:m.title}):(0,i.jsxs)("div",{className:h().articlePageContainer,style:{position:"relative",backgroundColor:"#ffffff"},children:[T&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(45deg, \n                ".concat(S.Qx[Q].gradientStart,"40, \n                ").concat(S.Qx[Q].gradientEnd,"60, \n                ").concat(S.Qx[Q].gradientStart,"30, \n                ").concat(S.Qx[Q].gradientEnd,"50)"),backgroundSize:"400% 400%",animation:"gradientFlow 8s ease-in-out infinite",filter:"contrast(1.1) brightness(1.05) saturate(1.1)",zIndex:0,transition:"background-image 1s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,i.jsx)("div",{"data-mood-element":"secondary-wave",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 20% 80%, ".concat(S.Qx[Q].gradientEnd,"25 0%, transparent 50%),\n                radial-gradient(circle at 80% 20%, ").concat(S.Qx[Q].gradientStart,"25 0%, transparent 50%),\n                radial-gradient(circle at 40% 40%, ").concat(S.Qx[Q].gradientEnd,"15 0%, transparent 50%)"),backgroundSize:"600px 600px, 800px 800px, 400px 400px",animation:"moodFloat 12s ease-in-out infinite alternate",zIndex:1,opacity:.6,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,i.jsx)("div",{"data-mood-element":"floating-orbs",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 25% 25%, ".concat(S.Qx[Q].gradientStart,"20 0%, transparent 25%),\n                radial-gradient(circle at 75% 75%, ").concat(S.Qx[Q].gradientEnd,"20 0%, transparent 25%),\n                radial-gradient(circle at 50% 10%, ").concat(S.Qx[Q].gradientStart,"15 0%, transparent 30%),\n                radial-gradient(circle at 10% 90%, ").concat(S.Qx[Q].gradientEnd,"15 0%, transparent 30%)"),backgroundSize:"300px 300px, 500px 500px, 200px 200px, 400px 400px",animation:"orbitalFloat 20s linear infinite",zIndex:2,opacity:.4,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,i.jsx)("div",{"data-mood-element":"grain-texture",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"repeating-linear-gradient(\n                90deg,\n                transparent,\n                transparent 2px,\n                ".concat(S.Qx[Q].gradientStart,"02 2px,\n                ").concat(S.Qx[Q].gradientStart,"02 4px\n              )"),zIndex:3,opacity:.15,mixBlendMode:"overlay",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}})]}),(0,i.jsx)("header",{className:h().pageHeader,"data-mood-header":"page-header",style:H&&T?{position:"relative",zIndex:1e4,background:"linear-gradient(135deg, \n            rgba(255, 255, 255, 0.15) 0%, \n            ".concat(S.Qx[Q].gradientStart,"12 40%, \n            ").concat(S.Qx[Q].gradientEnd,"08 100%)"),backdropFilter:"blur(24px) saturate(180%)",borderBottom:"1px solid ".concat(S.Qx[Q].gradientStart,"25"),boxShadow:"\n            0 2px 8px -2px ".concat(S.Qx[Q].gradientStart,"15,\n            0 8px 32px -8px ").concat(S.Qx[Q].gradientStart,"20,\n            inset 0 1px 0 rgba(255, 255, 255, 0.25),\n            inset 0 -1px 0 ").concat(S.Qx[Q].gradientStart,"10\n          "),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid ".concat(S.Qx[Q].gradientStart,"15"),borderTop:"none"}:{position:"relative",zIndex:1e4,background:"rgba(255, 255, 255, 0.95)"},children:(0,i.jsxs)("div",{className:h().headerContainer,children:[(0,i.jsxs)(o(),{href:"/",className:h().backLink,children:[(0,i.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]}),(0,i.jsx)("div",{className:h().headerLogo,style:H&&T?{color:S.Qx[Q].accent,fontWeight:"700",textShadow:"0 0 20px ".concat(S.Qx[Q].gradientStart,"30, 0 0 40px ").concat(S.Qx[Q].gradientStart,"15"),transition:"all 0.3s ease"}:{fontWeight:"700"},children:"Journalite"})]})}),(0,i.jsx)(x,{articleId:t,articleHtml:u,article:m,initialLikes:E,currentUser:N,isAuthenticated:T,onEditClick:D,articleTitle:B,articleSlug:W}),(0,i.jsx)("div",{className:h().commentsContainer,children:(0,i.jsx)(p.A,{articleId:t,...T&&{mood:Q,moodFeatureEnabled:H}})}),(0,i.jsx)(j.A,{isAuthenticated:T})]})}},4734:(e,t,a)=>{Promise.resolve().then(a.bind(a,4114))}},e=>{var t=t=>e(e.s=t);e.O(0,[2156,8130,1708,2992,7158,5004,7117,6874,8460,6713,4744,2800,9122,2650,5844,4632,8441,1684,7358],()=>t(4734)),_N_E=e.O()}]);