(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8406],{4734:(e,t,a)=>{Promise.resolve().then(a.bind(a,8120))},8120:(e,t,a)=>{"use strict";a.d(t,{default:()=>x});var l=a(5155),s=a(2115),i=a(5695),n=a(6874),r=a.n(n),c=a(3201),o=a(8059),d=a(6016),h=a(6955),u=a(9210),m=a(8501),g=a.n(m);let x=e=>{let{id:t}=e;(0,i.useRouter)();let[a,n]=(0,s.useState)(!0),[m,x]=(0,s.useState)(""),[j,v]=(0,s.useState)(null),[N,k]=(0,s.useState)(null),[p,w]=(0,s.useState)([]),[f,C]=(0,s.useState)(!1),[A,y]=(0,s.useState)(null),[b,I]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=c.j2.onAuthStateChanged(e=>{y(e)});return()=>e()},[]);let L=async()=>{try{var e;console.log("Fetching article with ID: ".concat(t,", timestamp: ").concat(Date.now())),n(!0),await new Promise(e=>setTimeout(e,300));let a=await (0,u.getArticleById)(t);if(console.log("Article data received:",null==a?void 0:a.title,"Content length:",(null==a||null==(e=a.body)?void 0:e.length)||0),!a)return void x("Article not found");let l=a.body?a.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):"";v(l),w(a.likes||[]);let s=a.body?a.body.split(/\s+/).length:0,i=Math.ceil(s/200),r=a.createdAt?new Date(1e3*a.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";k({title:a.title||"Untitled Article",authorName:a.authorName||"Anonymous",createdAt:r,readTime:i,likes:a.likes||[],tags:a.tags||[],authorId:a.authorId})}catch(e){console.error("Error loading article:",e),x("Failed to load article")}finally{n(!1)}};(0,s.useEffect)(()=>{L()},[t]),(0,s.useEffect)(()=>{(null==N?void 0:N.likes)&&A&&C(N.likes.includes(A.uid))},[N,A]);let S=async()=>{if(!A)return void alert("Please login to like articles");try{f?(w(p.filter(e=>e!==A.uid)),C(!1)):(w([...p,A.uid]),C(!0))}catch(e){console.error("Error updating like status:",e)}};return a?(0,l.jsxs)("div",{className:g().loadingContainer,children:[(0,l.jsx)("div",{className:g().loadingIndicator}),(0,l.jsx)("p",{children:"Loading article..."})]}):m?(0,l.jsx)("div",{className:g().errorContainer,children:(0,l.jsx)("p",{className:g().errorMessage,children:m})}):b?(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:g().editingHeader,children:[(0,l.jsx)("button",{onClick:()=>{I(!1)},className:g().cancelButton,children:"← Back to Article"}),(0,l.jsxs)("h2",{children:["Editing: ",null==N?void 0:N.title]})]}),(0,l.jsx)(h.A,{articleId:t,onUpdateComplete:e=>{console.log("Article update complete with data:",e),n(!0),v(null),k(null),e?(console.log("Forcing hard reload to see updated content"),window.location.href="/articles/".concat(t,"?reload=").concat(Date.now())):setTimeout(()=>{L()},800)}})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("header",{className:g().pageHeader,children:(0,l.jsxs)("div",{className:g().headerContainer,children:[(0,l.jsxs)(r(),{href:"/",className:g().backLink,children:[(0,l.jsx)("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,l.jsx)("path",{d:"M15 18L9 12L15 6",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Home"]}),(0,l.jsx)("div",{className:g().headerLogo,children:"Journalite"})]})}),(0,l.jsxs)("div",{className:g().pageContainer,children:[N&&(0,l.jsxs)("header",{className:g().articleHeader,children:[(0,l.jsx)("h1",{className:g().articleTitle,children:N.title}),(0,l.jsxs)("div",{className:g().articleMeta,children:[(0,l.jsxs)("div",{className:g().authorInfo,children:[(0,l.jsx)("div",{className:g().authorAvatar,children:N.authorName.charAt(0)}),(0,l.jsxs)("div",{className:g().authorDetails,children:[(0,l.jsx)("div",{className:g().authorName,children:N.authorName}),(0,l.jsxs)("div",{className:g().articleDetails,children:[N.createdAt," \xb7 ",N.readTime," min read"]})]})]}),(0,l.jsxs)("div",{className:g().articleActions,children:[(0,l.jsxs)("button",{className:"".concat(g().likeButton," ").concat(f?g().liked:""),onClick:S,"aria-label":f?"Unlike article":"Like article",children:[(0,l.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:f?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:g().likeIcon,children:(0,l.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,l.jsx)("span",{children:p.length>0?p.length:""})]}),A&&N.authorId===A.uid&&(0,l.jsx)("button",{className:g().editButton,onClick:()=>{I(!0)},children:"Edit"})]})]}),N.tags&&N.tags.length>0&&(0,l.jsx)("div",{className:g().tagContainer,children:N.tags.map((e,t)=>(0,l.jsx)("span",{className:g().tag,children:e},t))})]}),(0,l.jsx)(o.A,{articleId:t,initialHtml:j||void 0}),(0,l.jsx)("div",{className:g().commentsContainer,children:(0,l.jsx)(d.A,{articleId:t})})]})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2507,8130,2992,7158,5004,7117,6874,4559,9122,6955,4904,8441,1684,7358],()=>t(4734)),_N_E=e.O()}]);