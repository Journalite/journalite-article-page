(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8406],{4734:(e,t,a)=>{Promise.resolve().then(a.bind(a,8120))},8120:(e,t,a)=>{"use strict";a.d(t,{default:()=>b});var n=a(5155),r=a(2115),i=a(5695),l=a(6874),o=a.n(l),s=a(3201),d=a(6597),c=a(3804),u=a(6016),m=a(2650),g=a(9210),h=a(8501),x=a.n(h),p=a(7041),f=a(326),v=a(4362),S=a(3487),j=a(8883);let b=e=>{var t,a;let{id:l}=e,h=(0,i.useRouter)(),[b,w]=(0,r.useState)(!0),[N,y]=(0,r.useState)(""),[E,I]=(0,r.useState)(null),[A,k]=(0,r.useState)(null),[C,Q]=(0,r.useState)([]),[L,z]=(0,r.useState)(null),[F,T]=(0,r.useState)(!1),[M,U]=(0,r.useState)(!1),[R,_]=(0,r.useState)(window.innerWidth),[B,H]=(0,r.useState)(!1),O=(0,r.useRef)(null),[D,P]=(0,r.useState)("reflective"),[W,J]=(0,r.useState)(!0);(0,r.useEffect)(()=>{let e=s.j2.onAuthStateChanged(e=>{z(e),U(!!e)});return()=>e()},[]),(0,r.useEffect)(()=>{let e=()=>{_(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{if(M){let e=localStorage.getItem("moodFeatureEnabled");null!==e?J(JSON.parse(e)):J(!0)}else J(!1)},[M]);let G=async()=>{try{await (0,d.signOut)(s.j2),H(!1),h.push("/")}catch(e){console.error("Error signing out:",e)}};(0,r.useEffect)(()=>{let e=e=>{O.current&&!O.current.contains(e.target)&&H(!1)};return B&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[B]);let $=async()=>{try{w(!0),await new Promise(e=>setTimeout(e,300));let e=await (0,g.getArticleById)(l);if(!e)return void y("Article not found");let t=e.body?e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,""):"";I(t),Q(e.likes||[]);let a=e.body?e.body.split(/\s+/).length:0,n=Math.ceil(a/200),r=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";k({title:e.title||"Untitled Article",authorName:e.authorName||"Anonymous",createdAt:r,readTime:n,tags:e.tags||[],authorId:e.authorId,hasReflectionRoom:e.hasReflectionRoom||!1})}catch(e){console.error("Error loading article:",e),y("Failed to load article")}finally{w(!1)}};(0,r.useEffect)(()=>{$()},[l]),(0,r.useEffect)(()=>{if(E&&M){let e=E.replace(/<[^>]*>/g," ").replace(/\s+/g," ").trim();e&&P((0,p.H)(e))}},[E,M]);let q=(0,r.useCallback)(()=>{T(!0)},[]),K=(0,r.useCallback)(()=>{T(!1)},[]);(0,r.useCallback)(e=>{J(e),localStorage.setItem("moodFeatureEnabled",JSON.stringify(e))},[]);let V=(0,r.useMemo)(()=>(null==A?void 0:A.title)||"Article",[null==A?void 0:A.title]),X=(0,r.useMemo)(()=>(null==A?void 0:A.title)?A.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""):l,[null==A?void 0:A.title,l]);return b?(0,n.jsxs)("div",{className:x().loadingContainer,children:[(0,n.jsx)("div",{className:x().loadingIndicator}),(0,n.jsx)("p",{children:"Loading article..."})]}):N?(0,n.jsx)("div",{className:x().errorContainer,children:(0,n.jsx)("p",{className:x().errorMessage,children:N})}):F?(0,n.jsx)(m.A,{articleId:l,onUpdateComplete:e=>{w(!0),I(null),k(null),e?window.location.href="/articles/".concat(l,"?reload=").concat(Date.now()):setTimeout(()=>{$()},800)},backToArticleAction:K,editingTitle:null==A?void 0:A.title}):(0,n.jsxs)("div",{className:x().articlePageContainer,style:{position:"relative",backgroundColor:"#ffffff"},children:[M&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{"data-mood-element":"primary-gradient",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"linear-gradient(135deg, \n                ".concat(f.Qx[D].gradientStart,"08, \n                ").concat(f.Qx[D].gradientEnd,"12, \n                ").concat(f.Qx[D].gradientStart,"06)"),backgroundSize:"100% 100%",zIndex:0,transition:"background-image 0.8s ease-in-out",pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}}),(0,n.jsx)("div",{"data-mood-element":"accent-overlay",style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundImage:"radial-gradient(circle at 30% 70%, ".concat(f.Qx[D].gradientEnd,"06 0%, transparent 60%),\n                radial-gradient(circle at 70% 30%, ").concat(f.Qx[D].gradientStart,"06 0%, transparent 60%)"),backgroundSize:"100% 100%",zIndex:1,opacity:.7,pointerEvents:"none",display:"false"===localStorage.getItem("moodFeatureEnabled")?"none":""}})]}),(0,n.jsx)("header",{className:x().pageHeader,"data-mood-header":"page-header",style:W&&M?{position:"relative",zIndex:1e4,background:"linear-gradient(135deg, \n            rgba(255, 255, 255, 0.15) 0%, \n            ".concat(f.Qx[D].gradientStart,"12 40%, \n            ").concat(f.Qx[D].gradientEnd,"08 100%)"),backdropFilter:"blur(24px) saturate(180%)",borderBottom:"1px solid ".concat(f.Qx[D].gradientStart,"25"),boxShadow:"\n            0 2px 8px -2px ".concat(f.Qx[D].gradientStart,"15,\n            0 8px 32px -8px ").concat(f.Qx[D].gradientStart,"20,\n            inset 0 1px 0 rgba(255, 255, 255, 0.25),\n            inset 0 -1px 0 ").concat(f.Qx[D].gradientStart,"10\n          "),transition:"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",border:"1px solid ".concat(f.Qx[D].gradientStart,"15"),borderTop:"none"}:{position:"relative",zIndex:1e4},children:(0,n.jsxs)("div",{className:x().headerContainer,children:[(0,n.jsx)(o(),{href:"/",className:x().logoLink,children:(0,n.jsx)("div",{className:x().headerLogo,style:W&&M?{color:f.Qx[D].accent,fontWeight:"700",textShadow:"0 0 20px ".concat(f.Qx[D].gradientStart,"30, 0 0 40px ").concat(f.Qx[D].gradientStart,"15"),transition:"all 0.3s ease"}:{fontWeight:"700"},children:"Journalite"})}),(0,n.jsxs)("div",{className:x().headerActions,children:[M&&(0,n.jsx)(S.A,{}),M&&(0,n.jsx)(j.A,{}),(0,n.jsx)("div",{className:x().profileMenu,id:"profile-menu",ref:O,children:M?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:x().profileCircle,onClick:()=>{H(!B)},id:"profile-button",children:(null==L||null==(t=L.displayName)?void 0:t.charAt(0))||(null==L||null==(a=L.email)?void 0:a.charAt(0))||"U"}),B&&(0,n.jsxs)("div",{className:x().profileDropdown,children:[(0,n.jsx)(o(),{href:"/",className:x().dropdownItem,children:"Home"}),(0,n.jsx)(o(),{href:"/my-thoughts",className:x().dropdownItem,children:"My Thoughts"}),(0,n.jsx)(o(),{href:"/messages",className:x().dropdownItem,children:"Messages"}),(0,n.jsx)(o(),{href:"/create-article",className:x().dropdownItem,children:"Create Article"}),(0,n.jsx)(o(),{href:"/explore",className:x().dropdownItem,children:"Explore"}),(0,n.jsx)(o(),{href:"/my-profile",className:x().dropdownItem,children:"Profile"}),(0,n.jsx)(o(),{href:"/settings",className:x().dropdownItem,children:"Settings"}),(0,n.jsx)("button",{onClick:G,className:x().dropdownItem,children:"Sign out"})]})]}):(0,n.jsxs)("div",{className:x().authButtons,children:[(0,n.jsx)(o(),{href:"/login",className:x().loginButton,children:"Sign in"}),(0,n.jsx)(o(),{href:"/register",className:x().signupButton,children:"Get started"})]})})]})]})}),(0,n.jsx)(c.A,{articleId:l,articleHtml:E,article:A,initialLikes:C,currentUser:L,isAuthenticated:M,onEditClick:q,articleTitle:V,articleSlug:X}),(0,n.jsx)("div",{className:x().commentsContainer,children:(0,n.jsx)(u.A,{articleId:l,...M&&{mood:D,moodFeatureEnabled:W}})}),(0,n.jsx)(v.A,{isAuthenticated:M})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5598,5786,1708,8096,4744,4814,6677,9122,2650,1431,920,3804,7358],()=>t(4734)),_N_E=e.O()}]);