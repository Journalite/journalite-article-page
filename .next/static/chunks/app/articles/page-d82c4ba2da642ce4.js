(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[292],{3484:()=>{},5377:e=>{e.exports={commentSection:"comment_commentSection__SP_jS",commentSectionTitle:"comment_commentSectionTitle__F_Jxe",commentError:"comment_commentError__A2v6U",commentForm:"comment_commentForm__U8b7X",commentInputContainer:"comment_commentInputContainer__3WsSp",loginPromptContainer:"comment_loginPromptContainer__X4aZr",commentAvatar:"comment_commentAvatar__uav6Q",replyAvatar:"comment_replyAvatar__dIlrw",commentInput:"comment_commentInput__4DHa1",replyInput:"comment_replyInput__8t_ho",commentSubmit:"comment_commentSubmit__UfvUF",replySubmit:"comment_replySubmit__2eCP7",loginButton:"comment_loginButton__4encR",loginModalOverlay:"comment_loginModalOverlay__Pk_AM",loginModal:"comment_loginModal__n984X",loginModalClose:"comment_loginModalClose__v02Rx",loginModalTitle:"comment_loginModalTitle__nZpZB",loginModalText:"comment_loginModalText__XwRn6",loginModalButtons:"comment_loginModalButtons__XdVNl",loginModalButton:"comment_loginModalButton__d8Bnr",primary:"comment_primary__1UIRJ",secondary:"comment_secondary__zc89j",commentLoading:"comment_commentLoading___WYvK",loadingDots:"comment_loadingDots___Lw2B",loadingDot:"comment_loadingDot__skUEk",pulse:"comment_pulse__czQlg",noComments:"comment_noComments__U9FG6",commentsList:"comment_commentsList__ZRMbc",commentItem:"comment_commentItem__Vx48l",commentHeader:"comment_commentHeader__3oOD6",commentUser:"comment_commentUser__QP5pY",commentDate:"comment_commentDate__5zfpn",commentContent:"comment_commentContent__DiE8h",commentActions:"comment_commentActions___Wpzi",commentLikeBtn:"comment_commentLikeBtn__wAYZO",replyToggle:"comment_replyToggle__bCRZg",commentDeleteBtn:"comment_commentDeleteBtn__BnLQc",liked:"comment_liked__2yWZ9",repliesToggle:"comment_repliesToggle__yepDc",repliesToggleIcon:"comment_repliesToggleIcon__EZRkK",open:"comment_open__cpLDc",replySection:"comment_replySection__mAqn4",replyItem:"comment_replyItem__ndhqf",replyHeader:"comment_replyHeader__Y2bUK",replyUser:"comment_replyUser__rw4V8",replyDate:"comment_replyDate__4Jafb",replyContent:"comment_replyContent__uV2jp",replyForm:"comment_replyForm__aYyum",inThread:"comment_inThread__lUoKT",replyButtons:"comment_replyButtons__KRGyv",replyCancel:"comment_replyCancel__od7Vq"}},7560:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>C});var a=n(5155),o=n(2115),r=n(6874),s=n.n(r),l=n(5695),c=n(8163),i=n.n(c),m=n(3201),d=n(6203),u=n(350),h=n(9478),p=n(9210),g=n(792),_=n(6766),x=n(5377),j=n.n(x);let y=e=>{let{slug:t}=e,[n,r]=(0,o.useState)([]),[l,c]=(0,o.useState)(!0),[i,u]=(0,o.useState)(""),[h,g]=(0,o.useState)(""),[_,x]=(0,o.useState)(!1),[y,v]=(0,o.useState)(!1),[N,f]=(0,o.useState)(null),[b,S]=(0,o.useState)(""),[C,I]=(0,o.useState)(!1),[k,w]=(0,o.useState)({}),[A,D]=(0,o.useState)(!1),[E,M]=(0,o.useState)(!1),[T,U]=(0,o.useState)(null),[B,L]=(0,o.useState)({id:"",name:"Reader"});(0,o.useEffect)(()=>{let e=(0,d.hg)(m.j2,e=>{let t=!!e;if(D(t),t&&e){var n;L({id:e.uid,name:e.displayName||(null==(n=e.email)?void 0:n.split("@")[0])||"User"})}else L({id:"",name:"Reader"})});return()=>e()},[]),(0,o.useEffect)(()=>{t&&(async()=>{try{let e=await (0,p.l6)(t);e&&e.id&&U(e.id)}catch(e){console.error("Error fetching article:",e),u("Unable to load article details.")}})()},[t]),(0,o.useEffect)(()=>{T&&(c(!0),(async()=>{try{let e=await (0,p.fz)(T);setTimeout(()=>{r(e),c(!1)},800)}catch(e){console.error("Error fetching comments:",e),u("Unable to load discussions. Please refresh the page to try again."),c(!1)}})())},[T]);let P=async e=>{if(e.preventDefault(),h.trim()&&!_&&T){if(!A)return void M(!0);try{x(!0);let e=await (0,p.BC)(T,h);r(t=>[e,...t]),g(""),x(!1),v(!1)}catch(e){console.error("Error adding comment:",e),u("Your response could not be posted. Please try again."),x(!1)}}},R=async e=>{if(b.trim()&&!C&&T){if(!A)return void M(!0);try{I(!0);let t=await (0,p.Oe)(T,e,b);r(n=>n.map(n=>n.commentId===e||n.id===e?{...n,replies:[...n.replies||[],t]}:n)),S(""),f(null),I(!1),w(t=>({...t,[e]:!0}))}catch(e){console.error("Error adding reply:",e),I(!1)}}},F=async e=>{if(!A||!T)return void M(!0);try{let t=await (0,p.tT)(T,e);r(n=>n.map(n=>n.commentId===e||n.id===e?{...n,likes:t.likes}:n))}catch(e){console.error("Error liking comment:",e)}},O=async e=>{if(A&&T)try{await (0,p.Tu)(T,e),r(t=>t.filter(t=>t.commentId!==e&&t.id!==e))}catch(e){console.error("Error deleting comment:",e)}},W=e=>{w(t=>({...t,[e]:!t[e]}))},Z=e=>{if(!e)return"Unknown date";let t=e.toDate?e.toDate():new Date(e),n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"Just now";if(n<3600){let e=Math.floor(n/60);return"".concat(e," ").concat(1===e?"minute":"minutes"," ago")}if(n<86400){let e=Math.floor(n/3600);return"".concat(e," ").concat(1===e?"hour":"hours"," ago")}if(n<604800){let e=Math.floor(n/86400);return"".concat(e," ").concat(1===e?"day":"days"," ago")}try{return t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",timeZone:"UTC"})}catch(e){return console.error("Error formatting date:",e),"Unknown date"}},z=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=(null==e?void 0:e.charAt(0).toUpperCase())||"A",r=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444"],s=t?Math.abs(t.charCodeAt(0)%r.length):0,l=r[s];return(0,a.jsx)("div",{className:n?j().replyAvatar:j().commentAvatar,style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:n?"0.9rem":"1.2rem"},children:o})};return(0,a.jsxs)("section",{className:j().commentSection,children:[(0,a.jsx)("h2",{className:j().commentSectionTitle,children:"Join the Discussion"}),i&&(0,a.jsxs)("div",{className:j().commentError,children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,a.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,a.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),i]}),(0,a.jsx)("form",{className:j().commentForm,onSubmit:P,children:(0,a.jsx)("div",{className:j().commentInputContainer,style:{opacity:y?1:.85},children:A?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:j().commentAvatar,children:z(B.name,B.id)}),(0,a.jsx)("textarea",{className:j().commentInput,placeholder:"Share your thoughts...",value:h,onChange:e=>g(e.target.value),onFocus:()=>v(!0),onBlur:()=>{h.trim()||v(!1)}}),(0,a.jsx)("button",{className:j().commentSubmit,type:"submit",disabled:!h.trim()||_,children:_?"Posting...":"Post"})]}):(0,a.jsxs)("div",{className:j().loginPromptContainer,onClick:()=>M(!0),children:[(0,a.jsx)("textarea",{className:j().commentInput,placeholder:"Login to join the discussion...",disabled:!0}),(0,a.jsx)("button",{className:"".concat(j().commentSubmit," ").concat(j().loginButton),type:"button",onClick:()=>M(!0),children:"Login to comment"})]})})}),E&&(0,a.jsx)("div",{className:j().loginModalOverlay,onClick:()=>M(!1),children:(0,a.jsxs)("div",{className:j().loginModal,onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("button",{className:j().loginModalClose,onClick:()=>M(!1),children:"\xd7"}),(0,a.jsx)("h3",{className:j().loginModalTitle,children:"Join the conversation"}),(0,a.jsx)("p",{className:j().loginModalText,children:"Sign in to Journalite to share your thoughts and join the discussion."}),(0,a.jsxs)("div",{className:j().loginModalButtons,children:[(0,a.jsx)(s(),{href:"/login",className:"".concat(j().loginModalButton," ").concat(j().primary),children:"Log In"}),(0,a.jsx)(s(),{href:"/register",className:"".concat(j().loginModalButton," ").concat(j().secondary),children:"Create Account"})]})]})}),l?(0,a.jsxs)("div",{className:j().commentLoading,children:[(0,a.jsx)("p",{children:"Loading comments..."}),(0,a.jsxs)("div",{className:j().loadingDots,children:[(0,a.jsx)("div",{className:j().loadingDot}),(0,a.jsx)("div",{className:j().loadingDot}),(0,a.jsx)("div",{className:j().loadingDot})]})]}):0===n.length?(0,a.jsx)("div",{className:j().noComments,children:"Be the first to share your thoughts on this article."}):(0,a.jsx)("div",{className:j().commentsList,children:n.map(e=>{let t=e.commentId||e.id||"";return(0,a.jsxs)("div",{className:j().commentItem,children:[(0,a.jsxs)("div",{className:j().commentHeader,children:[z(e.userName,e.userId),(0,a.jsx)("span",{className:j().commentUser,children:e.userName}),(0,a.jsx)("span",{className:j().commentDate,children:Z(e.createdAt)})]}),(0,a.jsx)("div",{className:j().commentContent,children:e.content}),(0,a.jsxs)("div",{className:j().commentActions,children:[(0,a.jsxs)("button",{className:"".concat(j().commentLikeBtn," ").concat(e.likes.includes(B.id)?j().liked:""),onClick:()=>F(t),children:[(0,a.jsx)("span",{children:"❤"}),(0,a.jsx)("span",{children:e.likes.length||""})]}),(0,a.jsxs)("button",{className:j().replyToggle,onClick:()=>{A?f(N===t?null:t):M(!0)},children:[(0,a.jsx)("span",{children:"↩"}),(0,a.jsx)("span",{children:"Reply"})]}),e.userId===B.id&&(0,a.jsxs)("button",{className:j().commentDeleteBtn,onClick:()=>O(t),children:[(0,a.jsx)("span",{children:"\uD83D\uDDD1"}),(0,a.jsx)("span",{children:"Delete"})]})]}),e.replies&&e.replies.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{className:j().repliesToggle,onClick:()=>W(t),children:[(0,a.jsx)("span",{className:"".concat(j().repliesToggleIcon," ").concat(k[t]?j().open:""),children:"▷"}),"".concat(e.replies.length," ").concat(1===e.replies.length?"reply":"replies")]}),k[t]&&(0,a.jsx)("div",{className:j().replySection,children:e.replies.map(e=>(0,a.jsxs)("div",{className:j().replyItem,children:[(0,a.jsxs)("div",{className:j().replyHeader,children:[z(e.userName,e.userId,!0),(0,a.jsx)("span",{className:j().replyUser,children:e.userName}),(0,a.jsx)("span",{className:j().replyDate,children:Z(e.createdAt)})]}),(0,a.jsx)("div",{className:j().replyContent,children:e.content})]},e.replyId))})]}),N===t&&(0,a.jsxs)("div",{className:"".concat(j().replyForm," ").concat(e.replies&&e.replies.length>0?j().inThread:""),children:[(0,a.jsx)("textarea",{className:j().replyInput,placeholder:"Write a reply...",value:b,onChange:e=>S(e.target.value)}),(0,a.jsxs)("div",{className:j().replyButtons,children:[(0,a.jsx)("button",{className:j().replyCancel,onClick:()=>{f(null),S("")},children:"Cancel"}),(0,a.jsx)("button",{className:j().replySubmit,disabled:!b.trim()||C,onClick:()=>R(t),children:C?"Posting...":"Post Reply"})]})]})]},t)})})]})};n(3484);let v=e=>{try{return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",timeZone:"UTC"})}catch(t){return console.error("Error formatting date:",t),e}},N=e=>encodeURIComponent(e.trim().toLowerCase()),f=e=>{let{article:t}=e,[n,r]=(0,o.useState)({}),l=(0,o.useRef)({});if((0,o.useEffect)(()=>{if(!Array.isArray(t.content))return;let e=new IntersectionObserver(e=>{e.forEach(e=>{let t=e.target.getAttribute("data-paragraph-id");t&&e.isIntersecting&&r(e=>({...e,[t]:!0}))})},{threshold:.3,rootMargin:"-30px 0px"}),n=l.current;return Object.values(n).forEach(t=>{t&&e.observe(t)}),()=>{Object.values(n).forEach(t=>{t&&e.unobserve(t)})}},[t]),!(e=>null!==e&&"object"==typeof e&&"content"in e&&Array.isArray(e.content))(t))return null;let c=t.authorName||"Unknown Author",i=N(c),m=v(t.createdAt);return(0,a.jsx)("article",{className:"article-container",children:(0,a.jsxs)("div",{className:"article-main",children:[(0,a.jsxs)("header",{className:"article-header",children:[(0,a.jsx)("h1",{className:"article-title",children:t.title}),(0,a.jsxs)("div",{className:"article-meta",children:[(0,a.jsx)("div",{className:"author-image-container",children:(0,a.jsx)(_.default,{src:"https://images.unsplash.com/photo-1494790108377-be9c29b29330",alt:"Author",width:40,height:40,className:"author-image"})}),(0,a.jsxs)(s(),{href:"/user/".concat(i),className:"author-link",children:["By ",c]}),(0,a.jsx)("span",{className:"separator",children:"•"}),(0,a.jsx)("span",{className:"date",children:m})]}),(0,a.jsx)("div",{className:"article-tags",children:t.tags.map(e=>(0,a.jsx)("span",{className:"tag",children:e},e))})]}),(0,a.jsx)("section",{className:"article-content",children:t.content.map(e=>(0,a.jsx)("div",{"data-paragraph-id":e.paragraphId,ref:t=>{l.current[e.paragraphId]=t},className:"paragraph-block ".concat(n[e.paragraphId]?"visible":""),children:(0,a.jsx)("div",{className:"paragraph-text",children:(0,a.jsx)(g.oz,{children:e.text})})},e.paragraphId))}),(0,a.jsx)(y,{slug:t.slug})]})})},b=e=>({_id:e.id||"",title:e.title,slug:e.slug||"",authorId:e.authorId,authorName:e.authorName||"Unknown Author",coverImageUrl:e.coverImage,tags:e.tags,status:e.status||"published",content:[{paragraphId:"p1",text:e.body,likes:[],comments:[]}],likes:[],reposts:[],comments:[],createdAt:e.createdAt.toDate().toISOString(),updatedAt:e.createdAt.toDate().toISOString()});function S(){var e;let t=(0,l.useSearchParams)(),n=null==t?void 0:t.get("slug"),[r,c]=(0,o.useState)(null),[g,_]=(0,o.useState)(!0),[x,j]=(0,o.useState)(null),[y,v]=(0,o.useState)([]),[N,S]=(0,o.useState)(!1),[C,I]=(0,o.useState)(!1),[k,w]=(0,o.useState)(window.innerWidth);(0,o.useEffect)(()=>{let e=(0,d.hg)(m.j2,e=>{S(!!e)});return()=>e()},[]),(0,o.useEffect)(()=>{(async()=>{if(!n){j("No article slug provided"),_(!1);return}try{let e=await (0,p.l6)(n);if(!e){j("Article not found"),_(!1);return}let t=b(e);c(t),v(e.tags||[]),_(!1)}catch(e){console.error("Error fetching article:",e),j("Failed to load article"),_(!1)}})()},[n]);let A=async()=>{try{await (0,d.CI)(m.j2)}catch(e){console.error("Error signing out:",e)}},D=()=>{I(!C)};return(0,o.useEffect)(()=>{let e=()=>{w(window.innerWidth),window.innerWidth<768&&I(!0)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),(0,a.jsxs)("div",{className:i()["three-column-layout"],children:[k<768&&!C&&(0,a.jsx)("div",{className:"".concat(i()["menu-overlay"]," ").concat(i().active),onClick:D}),(0,a.jsx)(h.A,{isAuthenticated:N,handleLogout:A,toggleSidebar:D,isSidebarCollapsed:C}),k<768&&(0,a.jsx)("button",{className:i()["toggle-button"],onClick:D,"aria-label":C?"Expand sidebar":"Collapse sidebar",children:C?"☰":"✕"}),(0,a.jsx)("main",{className:i()["center-column"],children:g?(0,a.jsx)("div",{className:i().loading,children:"Loading article..."}):x?(0,a.jsxs)("div",{className:i().loading,children:["Error: ",x]}):r?(0,a.jsx)(f,{article:r}):(0,a.jsx)("div",{className:i().loading,children:"Article not found"})}),(0,a.jsxs)("aside",{className:i()["right-sidebar"],children:[(0,a.jsx)("h2",{className:i()["sidebar-heading"],children:"Related Tags"}),N&&(0,a.jsx)(u.A,{}),(0,a.jsx)("div",{className:i()["tag-list"],children:y.map(e=>(0,a.jsxs)(s(),{href:"/tag/".concat(e.toLowerCase()),className:i()["trending-tag"],children:["# ",e]},e))}),N&&r&&(null==(e=m.j2.currentUser)?void 0:e.uid)===r.authorId&&(0,a.jsx)(s(),{href:"/edit-article?id=".concat(r._id),className:i()["edit-button"],children:"Edit Article"}),(0,a.jsx)(s(),{href:"/write",className:i()["write-button"],children:"Write"})]})]})}function C(){return(0,a.jsx)(o.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading article..."}),children:(0,a.jsx)(S,{})})}},9251:(e,t,n)=>{Promise.resolve().then(n.bind(n,7560))}},e=>{var t=t=>e(e.s=t);e.O(0,[697,709,992,158,874,117,63,529,692,91,441,684,358],()=>t(9251)),_N_E=e.O()}]);