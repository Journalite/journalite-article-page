(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5292],{6462:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>w});var a=i(5155),s=i(2115),n=i(6874),l=i.n(n),r=i(5695),o=i(8501),c=i.n(o),d=i(3201),h=i(6203),m=i(9995),u=i(6559),f=i.n(u);let g=()=>{let[e,t]=(0,s.useState)(0),[i,n]=(0,s.useState)([]),[r,o]=(0,s.useState)(!1),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=async()=>{t(await (0,m.Hs)())};e();let i=setInterval(e,6e4);return()=>clearInterval(i)},[]),(0,s.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{r&&d()},[r]);let d=async()=>{try{let e=await (0,m.Ss)(!1);n(e)}catch(e){console.error("Error fetching notifications:",e)}},h=async e=>{try{!e.read&&e.id&&(await (0,m.bA)(e.id),t(e=>Math.max(e-1,0)),n(t=>t.map(t=>t.id===e.id?{...t,read:!0}:t)))}catch(e){console.error("Error marking notification as read:",e)}},u=e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e),i=Math.floor((new Date().getTime()-t.getTime())/6e4);if(i<1)return"Just now";if(i<60)return"".concat(i,"m ago");let a=Math.floor(i/60);if(a<24)return"".concat(a,"h ago");let s=Math.floor(a/24);return s<7?"".concat(s,"d ago"):t.toLocaleDateString()},g=e=>{if("follow"===e.type){var t;return(null==(t=e.fromUser)?void 0:t.username)?"/user/".concat(e.fromUser.username):"/notifications"}return e.articleSlug?"/articles?slug=".concat(e.articleSlug):"/notifications"};return(0,a.jsxs)("div",{className:f().container,ref:c,children:[(0,a.jsxs)("button",{className:f().button,onClick:()=>{o(!r)},"aria-label":"Notifications",children:[(0,a.jsxs)("svg",{className:f().icon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,a.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,a.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),e>0&&(0,a.jsx)("span",{className:f().badge,children:e})]}),r&&(0,a.jsxs)("div",{className:f().dropdown,children:[(0,a.jsxs)("div",{className:f().header,children:[(0,a.jsx)("h3",{children:"Notifications"}),i.length>0&&(0,a.jsx)(l(),{href:"/notifications",className:f().viewAll,children:"View All"})]}),(0,a.jsx)("div",{className:f().list,children:0===i.length?(0,a.jsx)("div",{className:f().empty,children:"No notifications yet"}):i.slice(0,5).map(e=>(0,a.jsxs)(l(),{href:g(e),className:"".concat(f().item," ").concat(e.read?"":f().unread),onClick:()=>h(e),children:[(0,a.jsxs)("div",{className:f().content,children:[(0,a.jsx)("p",{className:f().message,children:e.message}),(0,a.jsx)("span",{className:f().time,children:u(e.createdAt)})]}),!e.read&&(0,a.jsx)("div",{className:f().dot})]},e.id))}),i.length>5&&(0,a.jsx)("div",{className:f().footer,children:(0,a.jsx)(l(),{href:"/notifications",className:f().seeMore,children:"See more notifications"})})]})]})};var N=i(3074),x=i(6016),j=i(7160),v=i(9210);function p(){var e,t;let i=(0,r.useSearchParams)();(0,r.useRouter)();let n=null==i?void 0:i.get("slug"),[o,m]=(0,s.useState)(null),[u,f]=(0,s.useState)(!0),[p,w]=(0,s.useState)(null),[_,k]=(0,s.useState)([]),[M,A]=(0,s.useState)(!1),[y,S]=(0,s.useState)(!0),[C,B]=(0,s.useState)(!1),[b,E]=(0,s.useState)(0),[I,L]=(0,s.useState)(null),[D,T]=(0,s.useState)([]),[U,H]=(0,s.useState)(!1),[W,P]=(0,s.useState)(null),[J,z]=(0,s.useState)(!1);(0,s.useEffect)(()=>{E(window.innerWidth);let e=()=>{E(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{let e=(0,h.hg)(d.j2,e=>{A(!!e),P(e),e&&(null==o?void 0:o.likes)&&H(o.likes.includes(e.uid))});return()=>e()},[o]),(0,s.useEffect)(()=>{let e=e=>{let t=e.target,i=document.getElementById("profile-menu"),a=document.getElementById("profile-button");i&&!i.contains(t)&&a&&!a.contains(t)&&B(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{(async()=>{if(!n){w("No article slug provided"),f(!1);return}try{let e=await (0,v.l6)(n);if(!e){w("Article not found"),f(!1);return}let t=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");L(t),T(e.likes||[]);let i=e.body.split(/\s+/).length,a=Math.ceil(i/200),s=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";m({id:e.id,title:e.title,authorName:e.authorName||"Anonymous",authorId:e.authorId,createdAt:s,readTime:a,likes:e.likes||[],tags:e.tags||[],slug:n}),k(e.tags||[]),f(!1)}catch(e){console.error("Error fetching article:",e),w("Failed to load article"),f(!1)}})()},[n]);let F=async()=>{try{await (0,h.CI)(d.j2),B(!1)}catch(e){console.error("Error signing out:",e)}},K=async()=>{if(!W)return void alert("Please login to like articles");try{U?(T(D.filter(e=>e!==W.uid)),H(!1)):(T([...D,W.uid]),H(!0))}catch(e){console.error("Error updating like status:",e)}};return u?(0,a.jsxs)("div",{className:c().loadingContainer,children:[(0,a.jsx)("div",{className:c().loadingIndicator}),(0,a.jsx)("p",{children:"Loading article..."})]}):p?(0,a.jsx)("div",{className:c().errorContainer,children:(0,a.jsx)("p",{className:c().errorMessage,children:p})}):J&&o?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:c().editingHeader,children:[(0,a.jsx)("button",{onClick:()=>z(!1),className:c().cancelButton,children:"← Back to Article"}),(0,a.jsxs)("h2",{children:["Editing: ",o.title]})]}),(0,a.jsx)(j.A,{articleId:o.id,onUpdateComplete:()=>{console.log("Article update complete"),f(!0),z(!1),(null==o?void 0:o.id)?window.location.href="/articles/".concat(o.id,"/view?updated=true&t=").concat(Date.now()):window.location.reload(),(async()=>{try{let e=await (0,v.l6)(n||"");if(!e)return void w("Article not found");let t=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");L(t),T(e.likes||[]);let i=e.body.split(/\s+/).length,a=Math.ceil(i/200),s=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";m({id:e.id,title:e.title,authorName:e.authorName||"Anonymous",authorId:e.authorId,createdAt:s,readTime:a,likes:e.likes||[],tags:e.tags||[],slug:n||""}),k(e.tags||[])}catch(e){console.error("Error refetching article:",e)}})()}})]}):(0,a.jsx)("div",{className:c().articlePageContainer,children:o&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("header",{className:c().pageHeader,children:(0,a.jsxs)("div",{className:c().headerContainer,children:[(0,a.jsx)(l(),{href:"/",className:c().logoLink,children:(0,a.jsx)("div",{className:c().headerLogo,children:"Journalite"})}),(0,a.jsxs)("div",{className:c().headerActions,children:[M&&(0,a.jsx)(g,{}),(0,a.jsx)("div",{className:c().profileMenu,id:"profile-menu",children:M?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:c().profileCircle,onClick:()=>{B(!C)},id:"profile-button",children:(null==W||null==(e=W.displayName)?void 0:e.charAt(0))||(null==W||null==(t=W.email)?void 0:t.charAt(0))||"U"}),C&&(0,a.jsxs)("div",{className:c().profileDropdown,children:[(0,a.jsx)(l(),{href:"/",className:c().dropdownItem,children:"Home"}),(0,a.jsx)(l(),{href:"/my-thoughts",className:c().dropdownItem,children:"My Thoughts"}),(0,a.jsx)(l(),{href:"/dashboard",className:c().dropdownItem,children:"Dashboard"}),(0,a.jsx)(l(),{href:"/write",className:c().dropdownItem,children:"Write a story"}),(0,a.jsx)(l(),{href:"/create-article",className:c().dropdownItem,children:"Create Article"}),(0,a.jsx)(l(),{href:"/explore",className:c().dropdownItem,children:"Explore"}),(0,a.jsx)(l(),{href:"/profile",className:c().dropdownItem,children:"Profile"}),(0,a.jsx)(l(),{href:"/settings",className:c().dropdownItem,children:"Settings"}),(0,a.jsx)("button",{onClick:F,className:c().dropdownItem,children:"Sign out"})]})]}):(0,a.jsxs)("div",{className:c().authButtons,children:[(0,a.jsx)(l(),{href:"/login",className:c().loginButton,children:"Sign in"}),(0,a.jsx)(l(),{href:"/signup",className:c().signupButton,children:"Get started"})]})})]})]})}),(0,a.jsxs)("div",{className:c().pageContainer,children:[(0,a.jsxs)("header",{className:c().articleHeader,children:[(0,a.jsx)("h1",{className:c().articleTitle,children:o.title}),(0,a.jsxs)("div",{className:c().articleMeta,children:[(0,a.jsxs)("div",{className:c().authorInfo,children:[(0,a.jsx)("div",{className:c().authorAvatar,children:o.authorName.charAt(0)}),(0,a.jsxs)("div",{className:c().authorDetails,children:[(0,a.jsx)(l(),{href:"/user/".concat(o.authorName.toLowerCase().replace(/\s+/g,"")),className:c().authorNameLink,children:(0,a.jsx)("div",{className:c().authorName,children:o.authorName})}),(0,a.jsxs)("div",{className:c().articleDetails,children:[o.createdAt," \xb7 ",o.readTime," min read"]})]})]}),(0,a.jsxs)("div",{className:c().articleActions,children:[(0,a.jsxs)("button",{className:"".concat(c().likeButton," ").concat(U?c().liked:""),onClick:K,"aria-label":U?"Unlike article":"Like article",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:U?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:c().likeIcon,children:(0,a.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,a.jsx)("span",{children:D.length>0?D.length:""})]}),M&&o.authorId===(null==W?void 0:W.uid)&&(0,a.jsx)("button",{className:c().editButton,onClick:()=>z(!0),children:"Edit"})]})]}),o.tags&&o.tags.length>0&&(0,a.jsx)("div",{className:c().tagContainer,children:o.tags.map((e,t)=>(0,a.jsx)("span",{className:c().tag,children:e},t))})]}),(0,a.jsx)(N.A,{articleId:o.id,initialHtml:I||void 0}),(0,a.jsx)("div",{className:c().commentsContainer,children:(0,a.jsx)(x.A,{articleId:o.id})}),(0,a.jsxs)("aside",{className:c().relatedTagsSection,children:[(0,a.jsx)("h2",{className:c().relatedTagsHeading,children:"Related Tags"}),(0,a.jsx)("div",{className:c().relatedTagsList,children:_.map(e=>(0,a.jsxs)(l(),{href:"/tag/".concat(e.toLowerCase()),className:c().relatedTag,children:["# ",e]},e))}),(0,a.jsx)(l(),{href:"/write",className:c().writeButton,children:"Write"})]})]})]})})}function w(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{children:"Loading article..."}),children:(0,a.jsx)(p,{})})}},6559:e=>{e.exports={container:"MinimalNotificationBell_container__NGUf_",button:"MinimalNotificationBell_button__MAJkt",icon:"MinimalNotificationBell_icon__c6pW9",badge:"MinimalNotificationBell_badge___Di_K",dropdown:"MinimalNotificationBell_dropdown__PJtYq",header:"MinimalNotificationBell_header__zCiQJ",viewAll:"MinimalNotificationBell_viewAll__ZLWoU",list:"MinimalNotificationBell_list__MmsKd",item:"MinimalNotificationBell_item__flonv",unread:"MinimalNotificationBell_unread__278b3",content:"MinimalNotificationBell_content__31WKK",message:"MinimalNotificationBell_message__fnAua",time:"MinimalNotificationBell_time___76Fq",dot:"MinimalNotificationBell_dot__R2YqN",empty:"MinimalNotificationBell_empty__kDVAL",footer:"MinimalNotificationBell_footer__Pslwe",seeMore:"MinimalNotificationBell_seeMore__ggGUA"}},9251:(e,t,i)=>{Promise.resolve().then(i.bind(i,6462))}},e=>{var t=t=>e(e.s=t);e.O(0,[8130,3087,2992,7158,5004,7117,6874,1791,7160,9429,8441,1684,7358],()=>t(9251)),_N_E=e.O()}]);