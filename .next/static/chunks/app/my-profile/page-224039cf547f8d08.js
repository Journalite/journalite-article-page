(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8821],{19:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var a=s(5155),r=s(2115),l=s(5695),n=s(6203),i=s(3201),m=s(4744),u=s(6874),o=s.n(u);function d(){let[e,t]=(0,r.useState)(""),[s,u]=(0,r.useState)(""),[d,c]=(0,r.useState)(""),[f,x]=(0,r.useState)(""),[h,b]=(0,r.useState)(""),[N,g]=(0,r.useState)(!0),[p,j]=(0,r.useState)(!1),[y,v]=(0,r.useState)(""),[w,S]=(0,r.useState)(!1),[k,P]=(0,r.useState)({}),[C,F]=(0,r.useState)({}),[T,U]=(0,r.useState)(null),[E,B]=(0,r.useState)(!1),[_,q]=(0,r.useState)(null),[R,M]=(0,r.useState)(""),[O,z]=(0,r.useState)(0),L=(0,l.useRouter)();(0,r.useEffect)(()=>{let e=(0,n.hg)(i.j2,async e=>{if(e){q(e.uid),M(e.email||"");try{var s,a,r;let l=await (0,m.VM)(e.uid);if(l)t(l.firstName),u(l.lastName),c(l.username),b(l.username),x(l.bio||""),z((null==(s=l.bio)?void 0:s.length)||0),U(!0);else{let s=(e.displayName||"").split(" ");t(s[0]||""),u(s.slice(1).join(" ")||""),c((null==(a=e.email)?void 0:a.split("@")[0])||""),b((null==(r=e.email)?void 0:r.split("@")[0])||"")}}catch(e){console.error("Error fetching user profile:",e),v("Failed to load your profile. Please try refreshing the page.")}finally{g(!1)}}else L.push("/login")});return()=>e()},[L]);let V=e=>{let{name:t,value:s,validity:a}=e.target;if(P({...k,[t]:!0}),F({...C,[t]:""}),a.valueMissing){let e="This field is required";"firstName"===t&&(e="Please enter your first name"),"lastName"===t&&(e="Please enter your last name"),"username"===t&&(e="Please choose a username"),F({...C,[t]:e})}},Y=async e=>{if(e===h)return void U(!0);if(e.length<2)return void U(null);try{B(!0);let t=await (0,m.OQ)(e);U(!t)}catch(e){console.error("Error checking username:",e)}finally{B(!1)}},D=()=>{let t={},a={},r=!0;return a.firstName=!0,e.trim()||(t.firstName="Please enter your first name",r=!1),a.lastName=!0,s.trim()||(t.lastName="Please enter your last name",r=!1),a.username=!0,d.trim()?d.length<2?(t.username="Username must be at least 2 characters",r=!1):d!==h&&!1===T&&(t.username="This username is already taken",r=!1):(t.username="Please choose a username",r=!1),P({...k,...a}),F({...C,...t}),r},H=async t=>{if(t.preventDefault(),D()&&_){j(!0),v(""),S(!1);try{await (0,m.Vz)(_,{firstName:e,lastName:s,username:d,email:R,bio:f}),i.j2.currentUser&&await (0,n.r7)(i.j2.currentUser,{displayName:d}),b(d),S(!0),setTimeout(()=>{S(!1)},3e3)}catch(t){let e="Failed to update your profile";t instanceof Error&&t.message.includes("Username is already taken")&&(e="This username is already taken",F({...C,username:"This username is already taken"})),v(e),console.error(t)}finally{j(!1)}}},Q=e=>{let t="w-full px-5 py-3.5 bg-[#f8f5ec] border border-[#e8e1d1] rounded-md focus:outline-none focus:ring-1 focus:ring-slate-500";return k[e]&&C[e]?"".concat(t," border-red-300 bg-red-50"):"username"===e&&d.length>=2&&!0===T?"".concat(t," border-green-300 bg-green-50"):t};return N?(0,a.jsx)("div",{className:"min-h-screen bg-[#f5efe0] flex items-center justify-center",children:(0,a.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-slate-500 rounded-full border-t-transparent"})}):(0,a.jsx)("div",{className:"min-h-screen bg-[#f5efe0] flex flex-col",children:(0,a.jsx)("div",{className:"py-12 px-6 flex-1 flex flex-col items-center",children:(0,a.jsxs)("div",{className:"w-full max-w-lg mx-auto",children:[(0,a.jsxs)("div",{className:"mb-12 text-center",children:[(0,a.jsx)("h1",{className:"text-4xl md:text-5xl font-serif font-normal text-slate-900",children:"My Profile"}),(0,a.jsx)("p",{className:"mt-2 text-slate-700",children:"Update your personal information"})]}),(0,a.jsxs)("form",{onSubmit:H,className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block mb-2 text-sm font-medium text-slate-700",children:"First Name"}),(0,a.jsx)("input",{id:"firstName",name:"firstName",type:"text",required:!0,value:e,onChange:e=>t(e.target.value),onBlur:V,className:Q("firstName")}),k.firstName&&C.firstName&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:C.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block mb-2 text-sm font-medium text-slate-700",children:"Last Name"}),(0,a.jsx)("input",{id:"lastName",name:"lastName",type:"text",required:!0,value:s,onChange:e=>u(e.target.value),onBlur:V,className:Q("lastName")}),k.lastName&&C.lastName&&(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:C.lastName})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-slate-700",children:"Username"}),E&&(0,a.jsxs)("div",{className:"text-xs text-slate-500 flex items-center",children:[(0,a.jsx)("div",{className:"mr-1 w-3 h-3 border-2 border-slate-500 border-t-transparent rounded-full animate-spin"}),"Checking..."]})]}),(0,a.jsx)("input",{id:"username",name:"username",type:"text",required:!0,value:d,onChange:e=>{let t=e.target.value;if(c(t),t===h)return void U(!0);let s=setTimeout(()=>{t.length>=2?Y(t):U(null)},500);return()=>clearTimeout(s)},onBlur:V,className:Q("username")}),k.username&&C.username?(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:C.username}):d&&d.length>=2&&!0===T?(0,a.jsx)("p",{className:"mt-1 text-sm text-green-600",children:"Username is available"}):d&&d.length>=2&&!1===T?(0,a.jsx)("p",{className:"mt-1 text-sm text-red-500",children:"Username is already taken"}):null]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-slate-700",children:"Bio"}),(0,a.jsxs)("span",{className:"text-xs ".concat(O>=225?"text-amber-600":"text-slate-500"),children:[O,"/",250]})]}),(0,a.jsx)("textarea",{id:"bio",name:"bio",value:f,onChange:e=>{let t=e.target.value;t.length<=250&&(x(t),z(t.length))},onBlur:V,placeholder:"Tell us a little about yourself...",rows:4,maxLength:250,className:"w-full px-5 py-3.5 bg-[#f8f5ec] border border-[#e8e1d1] rounded-md focus:outline-none focus:ring-1 focus:ring-slate-500 resize-none"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"Your bio will be displayed on your public profile and articles"})]}),y&&(0,a.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md text-sm text-red-600",children:y}),w&&(0,a.jsx)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-md text-sm text-green-600",children:"Your profile has been updated successfully!"}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-8",children:[(0,a.jsx)(o(),{href:"/",className:"inline-flex justify-center py-3 px-5 border border-slate-300 rounded-md bg-white text-sm font-medium text-slate-700 hover:bg-slate-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:"Back to Home"}),(0,a.jsx)("button",{type:"submit",disabled:p,className:"inline-flex justify-center py-3 px-5 border border-transparent rounded-md shadow-sm text-sm font-medium text-white \n                  ".concat(p?"bg-slate-400 cursor-not-allowed":"bg-slate-800 hover:bg-slate-700"," \n                  focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500"),children:p?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"mr-2 h-4 w-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):"Save Changes"})]})]})]})})})}},5136:(e,t,s)=>{Promise.resolve().then(s.bind(s,19))},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7158,7117,6874,4744,8441,1684,7358],()=>t(5136)),_N_E=e.O()}]);