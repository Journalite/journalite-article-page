(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3234],{5695:(e,t,a)=>{"use strict";var r=a(8999);a.o(r,"usePathname")&&a.d(t,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},8513:(e,t,a)=>{Promise.resolve().then(a.bind(a,9580))},9580:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>u});var r=a(5155),s=a(2115),n=a(5695),l=a(6203),i=a(3201),o=a(4744),m=a(6874),d=a.n(m);function u(){let[e,t]=(0,s.useState)(""),[a,m]=(0,s.useState)(""),[u,c]=(0,s.useState)(""),[x,h]=(0,s.useState)(""),[f,b]=(0,s.useState)(""),[g,N]=(0,s.useState)(0),[p,j]=(0,s.useState)(!0),[v,y]=(0,s.useState)(!1),[w,S]=(0,s.useState)(""),[k,P]=(0,s.useState)(""),[C,E]=(0,s.useState)({}),[F,U]=(0,s.useState)({}),[B,T]=(0,s.useState)(null),[R,_]=(0,s.useState)(!1),[L,q]=(0,s.useState)(null),[O,V]=(0,s.useState)(""),z=(0,n.useRouter)();(0,s.useEffect)(()=>{let e=(0,l.onAuthStateChanged)(i.j2,async e=>{if(e){q(e.uid),V(e.email||"");try{var a,r;let s=await (0,o.VM)(e.uid);if(s)t(s.firstName||""),m(s.lastName||""),c(s.username||""),h(s.username||""),b(s.bio||""),N((null==(a=s.bio)?void 0:a.length)||0),T(!0);else{let a=(e.displayName||"").split(" ");t(a[0]||""),m(a.slice(1).join(" ")||"");let s=(null==(r=e.email)?void 0:r.split("@")[0])||"";c(s),h(s),s&&await A(s,!0)}}catch(e){console.error("Error fetching user profile:",e),S("Failed to load your profile. Please try refreshing the page.")}finally{j(!1)}}else z.push("/login?redirect=/my-profile/edit")});return()=>e()},[z]);let I=e=>{let{name:a,value:r}=e.target;E({...C,[a]:!0}),U({...F,[a]:""}),S(""),P(""),"firstName"===a&&t(r),"lastName"===a&&m(r),"username"===a&&(c(r),r!==x&&T(null)),"bio"===a&&r.length<=250&&(b(r),N(r.length))},M=async e=>{let{name:t,value:a}=e.target;Y(t,a),"username"===t&&a!==x&&a.length>=2&&await A(a)},Y=(e,t)=>{let a="";return t.trim()||"firstName"!==e&&"lastName"!==e&&"username"!==e||(a="Please enter your ".concat("firstName"===e?"first name":"lastName"===e?"last name":"username",".")),"username"===e&&t.trim().length>0&&t.trim().length<2&&(a="Username must be at least 2 characters."),U(t=>({...t,[e]:a})),!a},A=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length<2)return void T(null);if(e===x&&!t)return void T(!0);_(!0);try{let t=await (0,o.OQ)(e);T(!t)}catch(e){console.error("Error checking username:",e),T(null),U(e=>({...e,username:"Could not verify username. Try again."}))}finally{_(!1)}};(0,s.useEffect)(()=>{if(u===x||u.length<2)return void(u===x?T(!0):T(null));let e=setTimeout(()=>{A(u)},600);return()=>clearTimeout(e)},[u,x]);let D=()=>{let t={},r=!0;return Y("firstName",e)||(r=!1),Y("lastName",a)||(r=!1),Y("username",u)||(r=!1),u.length>=2&&u!==x&&!1===B&&(t.username="This username is already taken.",r=!1),U(e=>({...e,...t})),E({firstName:!0,lastName:!0,username:!0,bio:!0}),r},K=async t=>{if(t.preventDefault(),S(""),P(""),D()&&L){if(u!==x&&!1===B)return void U(e=>({...e,username:"This username is already taken."}));y(!0);try{let t={firstName:e,lastName:a,username:u.toLowerCase(),email:O,bio:f};await (0,o.Vz)(L,t),i.j2.currentUser&&i.j2.currentUser.displayName!==u&&await (0,l.updateProfile)(i.j2.currentUser,{displayName:u}),h(u),P("Profile updated successfully!"),setTimeout(()=>P(""),3e3)}catch(t){console.error("Error updating profile:",t);let e="Failed to update profile. Please try again.";t instanceof Error&&t.message.includes("Username is already taken")&&(e="This username is already taken.",U(t=>({...t,username:e}))),S(e)}finally{y(!1)}}},Q=(e,t,a)=>{let r="w-full px-4 py-3 bg-white border border-stone-300 rounded-lg shadow-sm transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-amber-500 focus:border-amber-500 placeholder-stone-400 text-stone-700";return t?"".concat(r," border-red-400 focus:ring-red-400 bg-red-50 text-red-700 placeholder-red-400"):!0===a&&"username"===e&&u!==x?"".concat(r," border-green-400 focus:ring-green-400 bg-green-50 text-green-700"):"".concat(r," hover:border-stone-400")};return p?(0,r.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex items-center justify-center font-sans",children:[(0,r.jsx)("div",{className:"animate-spin h-10 w-10 border-4 border-amber-500 rounded-full border-t-transparent"}),(0,r.jsx)("p",{className:"ml-3 text-stone-700",children:"Loading profile editor..."})]}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex flex-col items-center justify-start py-12 px-4 sm:px-6 lg:px-8 font-sans",children:(0,r.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,r.jsx)("div",{className:"mb-8 flex justify-start",children:(0,r.jsxs)(d(),{href:"/my-profile",className:"text-amber-700 hover:text-amber-800 font-medium flex items-center",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,r.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Back to Profile"]})}),(0,r.jsxs)("div",{className:"bg-white p-8 sm:p-10 rounded-xl shadow-2xl",children:[(0,r.jsxs)("div",{className:"mb-10 text-center",children:[(0,r.jsx)("h1",{className:"text-3xl sm:text-4xl font-serif font-semibold text-stone-800",children:"Edit Your Profile"}),(0,r.jsx)("p",{className:"mt-3 text-stone-600",children:"Keep your information up to date."})]}),w&&(0,r.jsx)("div",{className:"mb-6 p-3.5 bg-red-100 text-red-700 border border-red-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:w}),k&&(0,r.jsx)("div",{className:"mb-6 p-3.5 bg-green-100 text-green-700 border border-green-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:k}),(0,r.jsxs)("form",{onSubmit:K,noValidate:!0,className:"space-y-8",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"First Name"}),(0,r.jsx)("input",{type:"text",name:"firstName",id:"firstName",value:e,onChange:I,onBlur:M,className:Q("firstName",!!F.firstName),required:!0,"aria-describedby":"firstName-error"}),C.firstName&&F.firstName&&(0,r.jsx)("p",{id:"firstName-error",className:"mt-1.5 text-xs text-red-500",children:F.firstName})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Last Name"}),(0,r.jsx)("input",{type:"text",name:"lastName",id:"lastName",value:a,onChange:I,onBlur:M,className:Q("lastName",!!F.lastName),required:!0,"aria-describedby":"lastName-error"}),C.lastName&&F.lastName&&(0,r.jsx)("p",{id:"lastName-error",className:"mt-1.5 text-xs text-red-500",children:F.lastName})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Username"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("input",{type:"text",name:"username",id:"username",value:u,onChange:I,onBlur:M,className:Q("username",!!F.username,B),required:!0,"aria-describedby":"username-error username-availability"}),R&&(0,r.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,r.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-stone-400 rounded-full border-t-transparent"})})]}),C.username&&F.username&&(0,r.jsx)("p",{id:"username-error",className:"mt-1.5 text-xs text-red-500",children:F.username}),!F.username&&u.length>=2&&u!==x&&(0,r.jsx)("p",{id:"username-availability",className:"mt-1.5 text-xs ".concat(!0===B?"text-green-600":!1===B?"text-red-500":"text-stone-500"),children:R?"Checking...":!0===B?"Username is available":!1===B?"Username is taken":"Enter username to check availability"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Email"}),(0,r.jsx)("input",{type:"email",name:"email",id:"email",value:O,disabled:!0,className:"w-full px-4 py-3 bg-stone-100 border border-stone-300 rounded-lg shadow-sm text-stone-500 cursor-not-allowed"}),(0,r.jsx)("p",{className:"mt-1.5 text-xs text-stone-500",children:"Your email address cannot be changed here."})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Bio"}),(0,r.jsx)("textarea",{name:"bio",id:"bio",rows:4,value:f,onChange:I,onBlur:M,className:Q("bio",!!F.bio),maxLength:250,"aria-describedby":"bio-char-count"}),(0,r.jsxs)("p",{id:"bio-char-count",className:"mt-1.5 text-xs text-stone-500 text-right",children:[g,"/",250," characters"]}),C.bio&&F.bio&&(0,r.jsx)("p",{className:"mt-1.5 text-xs text-red-500",children:F.bio})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end items-center gap-4 pt-4",children:[(0,r.jsx)(d(),{href:"/my-profile",className:"w-full sm:w-auto order-2 sm:order-1 px-6 py-3 text-center text-stone-700 bg-stone-200 hover:bg-stone-300 rounded-lg transition-colors duration-200 ease-in-out font-medium",children:"Cancel"}),(0,r.jsx)("button",{type:"submit",disabled:v||R,className:"w-full sm:w-auto order-1 sm:order-2 px-8 py-3 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center",children:v?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin h-5 w-5 border-2 border-white rounded-full border-t-transparent mr-2.5"}),"Saving..."]}):"Save Changes"})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7158,7117,6874,4744,8441,1684,7358],()=>t(8513)),_N_E=e.O()}]);