(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3234],{6121:(e,r,t)=>{"use strict";t.d(r,{J0:()=>a.useState,vJ:()=>a.useEffect});var a=t(2115)},8513:(e,r,t)=>{Promise.resolve().then(t.bind(t,9580))},9580:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var a=t(5155),s=t(6121),n=t(5695),l=t(6597),i=t(3201),o=t(4744),m=t(6874),d=t.n(m);function c(){let[e,r]=(0,s.J0)(""),[t,m]=(0,s.J0)(""),[c,u]=(0,s.J0)(""),[x,h]=(0,s.J0)(""),[f,b]=(0,s.J0)(""),[g,N]=(0,s.J0)(0),[p,v]=(0,s.J0)(!0),[j,y]=(0,s.J0)(!1),[w,J]=(0,s.J0)(""),[k,C]=(0,s.J0)(""),[E,F]=(0,s.J0)({}),[P,U]=(0,s.J0)({}),[B,T]=(0,s.J0)(null),[_,L]=(0,s.J0)(!1),[S,q]=(0,s.J0)(null),[O,R]=(0,s.J0)(""),V=(0,n.useRouter)();(0,s.vJ)(()=>{let e=(0,l.onAuthStateChanged)(i.j2,async e=>{if(e){q(e.uid),R(e.email||"");try{var t,a;let s=await (0,o.VM)(e.uid);if(s)r(s.firstName||""),m(s.lastName||""),u(s.username||""),h(s.username||""),b(s.bio||""),N((null==(t=s.bio)?void 0:t.length)||0),T(!0);else{let t=(e.displayName||"").split(" ");r(t[0]||""),m(t.slice(1).join(" ")||"");let s=(null==(a=e.email)?void 0:a.split("@")[0])||"";u(s),h(s),s&&await Y(s,!0)}}catch(e){console.error("Error fetching user profile:",e),J("Failed to load your profile. Please try refreshing the page.")}finally{v(!1)}}else V.push("/login?redirect=/my-profile/edit")});return()=>e()},[V]);let z=e=>{let{name:t,value:a}=e.target;F({...E,[t]:!0}),U({...P,[t]:""}),J(""),C(""),"firstName"===t&&r(a),"lastName"===t&&m(a),"username"===t&&(u(a),a!==x&&T(null)),"bio"===t&&a.length<=250&&(b(a),N(a.length))},I=async e=>{let{name:r,value:t}=e.target;M(r,t),"username"===r&&t!==x&&t.length>=2&&await Y(t)},M=(e,r)=>{let t="";return r.trim()||"firstName"!==e&&"lastName"!==e&&"username"!==e||(t="Please enter your ".concat("firstName"===e?"first name":"lastName"===e?"last name":"username",".")),"username"===e&&r.trim().length>0&&r.trim().length<2&&(t="Username must be at least 2 characters."),U(r=>({...r,[e]:t})),!t},Y=async function(e){let r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length<2)return void T(null);if(e===x&&!r)return void T(!0);L(!0);try{let r=await (0,o.OQ)(e);T(!r)}catch(e){console.error("Error checking username:",e),T(null),U(e=>({...e,username:"Could not verify username. Try again."}))}finally{L(!1)}};(0,s.vJ)(()=>{if(c===x||c.length<2)return void(c===x?T(!0):T(null));let e=setTimeout(()=>{Y(c)},600);return()=>clearTimeout(e)},[c,x]);let A=()=>{let r={},a=!0;return M("firstName",e)||(a=!1),M("lastName",t)||(a=!1),M("username",c)||(a=!1),c.length>=2&&c!==x&&!1===B&&(r.username="This username is already taken.",a=!1),U(e=>({...e,...r})),F({firstName:!0,lastName:!0,username:!0,bio:!0}),a},D=async r=>{if(r.preventDefault(),J(""),C(""),A()&&S){if(c!==x&&!1===B)return void U(e=>({...e,username:"This username is already taken."}));y(!0);try{let r={firstName:e,lastName:t,username:c.toLowerCase(),email:O,bio:f};await (0,o.Vz)(S,r),i.j2.currentUser&&i.j2.currentUser.displayName!==c&&await (0,l.updateProfile)(i.j2.currentUser,{displayName:c}),h(c),C("Profile updated successfully!"),setTimeout(()=>C(""),3e3)}catch(r){console.error("Error updating profile:",r);let e="Failed to update profile. Please try again.";r instanceof Error&&r.message.includes("Username is already taken")&&(e="This username is already taken.",U(r=>({...r,username:e}))),J(e)}finally{y(!1)}}},K=(e,r,t)=>{let a="w-full px-4 py-3 bg-white border border-stone-300 rounded-lg shadow-sm transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-amber-500 focus:border-amber-500 placeholder-stone-400 text-stone-700";return r?"".concat(a," border-red-400 focus:ring-red-400 bg-red-50 text-red-700 placeholder-red-400"):!0===t&&"username"===e&&c!==x?"".concat(a," border-green-400 focus:ring-green-400 bg-green-50 text-green-700"):"".concat(a," hover:border-stone-400")};return p?(0,a.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex items-center justify-center font-sans",children:[(0,a.jsx)("div",{className:"animate-spin h-10 w-10 border-4 border-amber-500 rounded-full border-t-transparent"}),(0,a.jsx)("p",{className:"ml-3 text-stone-700",children:"Loading profile editor..."})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex flex-col items-center justify-start py-12 px-4 sm:px-6 lg:px-8 font-sans",children:(0,a.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,a.jsx)("div",{className:"mb-8 flex justify-start",children:(0,a.jsxs)(d(),{href:"/my-profile",className:"text-amber-700 hover:text-amber-800 font-medium flex items-center",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Back to Profile"]})}),(0,a.jsxs)("div",{className:"bg-white p-8 sm:p-10 rounded-xl shadow-2xl",children:[(0,a.jsxs)("div",{className:"mb-10 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl sm:text-4xl font-serif font-semibold text-stone-800",children:"Edit Your Profile"}),(0,a.jsx)("p",{className:"mt-3 text-stone-600",children:"Keep your information up to date."})]}),w&&(0,a.jsx)("div",{className:"mb-6 p-3.5 bg-red-100 text-red-700 border border-red-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:w}),k&&(0,a.jsx)("div",{className:"mb-6 p-3.5 bg-green-100 text-green-700 border border-green-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:k}),(0,a.jsxs)("form",{onSubmit:D,noValidate:!0,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"First Name"}),(0,a.jsx)("input",{type:"text",name:"firstName",id:"firstName",value:e,onChange:z,onBlur:I,className:K("firstName",!!P.firstName),required:!0,"aria-describedby":"firstName-error"}),E.firstName&&P.firstName&&(0,a.jsx)("p",{id:"firstName-error",className:"mt-1.5 text-xs text-red-500",children:P.firstName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Last Name"}),(0,a.jsx)("input",{type:"text",name:"lastName",id:"lastName",value:t,onChange:z,onBlur:I,className:K("lastName",!!P.lastName),required:!0,"aria-describedby":"lastName-error"}),E.lastName&&P.lastName&&(0,a.jsx)("p",{id:"lastName-error",className:"mt-1.5 text-xs text-red-500",children:P.lastName})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Username"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{type:"text",name:"username",id:"username",value:c,onChange:z,onBlur:I,className:K("username",!!P.username,B),required:!0,"aria-describedby":"username-error username-availability"}),_&&(0,a.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,a.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-stone-400 rounded-full border-t-transparent"})})]}),E.username&&P.username&&(0,a.jsx)("p",{id:"username-error",className:"mt-1.5 text-xs text-red-500",children:P.username}),!P.username&&c.length>=2&&c!==x&&(0,a.jsx)("p",{id:"username-availability",className:"mt-1.5 text-xs ".concat(!0===B?"text-green-600":!1===B?"text-red-500":"text-stone-500"),children:_?"Checking...":!0===B?"Username is available":!1===B?"Username is taken":"Enter username to check availability"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Email"}),(0,a.jsx)("input",{type:"email",name:"email",id:"email",value:O,disabled:!0,className:"w-full px-4 py-3 bg-stone-100 border border-stone-300 rounded-lg shadow-sm text-stone-500 cursor-not-allowed"}),(0,a.jsx)("p",{className:"mt-1.5 text-xs text-stone-500",children:"Your email address cannot be changed here."})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Bio"}),(0,a.jsx)("textarea",{name:"bio",id:"bio",rows:4,value:f,onChange:z,onBlur:I,className:K("bio",!!P.bio),maxLength:250,"aria-describedby":"bio-char-count"}),(0,a.jsxs)("p",{id:"bio-char-count",className:"mt-1.5 text-xs text-stone-500 text-right",children:[g,"/",250," characters"]}),E.bio&&P.bio&&(0,a.jsx)("p",{className:"mt-1.5 text-xs text-red-500",children:P.bio})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end items-center gap-4 pt-4",children:[(0,a.jsx)(d(),{href:"/my-profile",className:"w-full sm:w-auto order-2 sm:order-1 px-6 py-3 text-center text-stone-700 bg-stone-200 hover:bg-stone-300 rounded-lg transition-colors duration-200 ease-in-out font-medium",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:j||_,className:"w-full sm:w-auto order-1 sm:order-2 px-8 py-3 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin h-5 w-5 border-2 border-white rounded-full border-t-transparent mr-2.5"}),"Saving..."]}):"Save Changes"})]})]})]})]})})}}},e=>{var r=r=>e(e.s=r);e.O(0,[8096,4744,7358],()=>r(8513)),_N_E=e.O()}]);