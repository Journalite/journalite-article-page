exports.id=488,exports.ids=[488],exports.modules={26734:(e,a,t)=>{"use strict";t.d(a,{A:()=>d});var s=t(60687),n=t(43210),r=t(85814),i=t.n(r),o=t(28163),l=t(55801),c=t.n(l);let d=()=>{let[e,a]=(0,n.useState)(0),[t,r]=(0,n.useState)([]),[l,d]=(0,n.useState)(!1),u=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=async()=>{a(await (0,o.Hs)())};e();let t=setInterval(e,6e4);return()=>clearInterval(t)},[]),(0,n.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,n.useEffect)(()=>{l&&h()},[l]);let h=async()=>{try{let e=await (0,o.Ss)(!1);r(e)}catch(e){console.error("Error fetching notifications:",e)}},m=async e=>{try{!e.read&&e.id&&(await (0,o.bA)(e.id),a(e=>Math.max(e-1,0)),r(a=>a.map(a=>a.id===e.id?{...a,read:!0}:a)))}catch(e){console.error("Error marking notification as read:",e)}},f=e=>{if(!e)return"";let a=e.toDate?e.toDate():new Date(e),t=Math.floor((new Date().getTime()-a.getTime())/6e4);if(t<1)return"Just now";if(t<60)return`${t}m ago`;let s=Math.floor(t/60);if(s<24)return`${s}h ago`;let n=Math.floor(s/24);return n<7?`${n}d ago`:a.toLocaleDateString()},x=e=>"follow"===e.type?e.fromUser?.username?`/user/${e.fromUser.username}`:"/notifications":e.articleSlug?`/articles?slug=${e.articleSlug}`:"/notifications";return(0,s.jsxs)("div",{className:c().notificationContainer,ref:u,children:[(0,s.jsxs)("button",{className:c().bellButton,onClick:()=>{d(!l)},children:[(0,s.jsx)("span",{className:c().bellIcon,children:"\uD83D\uDD14"}),e>0&&(0,s.jsx)("span",{className:c().unreadBadge,children:e})]}),l&&(0,s.jsxs)("div",{className:c().notificationDropdown,children:[(0,s.jsxs)("div",{className:c().notificationHeader,children:[(0,s.jsx)("h3",{children:"Notifications"}),t.length>0&&(0,s.jsx)(i(),{href:"/notifications",className:c().viewAllLink,children:"View All"})]}),(0,s.jsx)("div",{className:c().notificationList,children:0===t.length?(0,s.jsx)("div",{className:c().emptyState,children:"No notifications yet"}):t.slice(0,5).map(e=>(0,s.jsxs)(i(),{href:x(e),className:`${c().notificationItem} ${!e.read?c().unread:""}`,onClick:()=>m(e),children:[(0,s.jsxs)("div",{className:c().notificationContent,children:[(0,s.jsx)("p",{className:c().notificationMessage,children:e.message}),(0,s.jsx)("span",{className:c().notificationTime,children:f(e.createdAt)})]}),!e.read&&(0,s.jsx)("div",{className:c().unreadDot})]},e.id))}),t.length>5&&(0,s.jsx)("div",{className:c().notificationFooter,children:(0,s.jsx)(i(),{href:"/notifications",className:c().seeMoreLink,children:"See more notifications"})})]})]})}},49048:(e,a,t)=>{"use strict";t.d(a,{Ay:()=>d,Ci:()=>v,E$:()=>f,OQ:()=>o,Qt:()=>m,SR:()=>N,VM:()=>c,Vz:()=>l,mH:()=>x,pV:()=>h,x5:()=>u});var s=t(75535),n=t(84245),r=t(43649),i=t(28163);async function o(e){try{let a=(0,s.P)((0,s.rJ)(r.db,"users"),(0,s._M)("username","==",e.toLowerCase()));return!(await (0,s.GG)(a)).empty}catch(e){throw console.error("Error checking username:",e),e}}async function l(e,a){try{let t=await c(e);if(t){console.log("User profile already exists, updating instead of creating");let i=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(i,{firstName:a.firstName,lastName:a.lastName,username:a.username.toLowerCase(),email:a.email.toLowerCase(),bio:a.bio||t.bio||""}),r.j2.currentUser&&await (0,n.r7)(r.j2.currentUser,{displayName:a.username});return}let i=(0,s.P)((0,s.rJ)(r.db,"users"),(0,s._M)("email","==",a.email.toLowerCase()));if(!(await (0,s.GG)(i)).empty)throw Error("Email is already associated with another account");if(await o(a.username))throw Error("Username is already taken");let l=(0,s.H9)(r.db,"users",e);await (0,s.BN)(l,{uid:e,firstName:a.firstName,lastName:a.lastName,username:a.username.toLowerCase(),email:a.email.toLowerCase(),bio:a.bio||"",createdAt:(0,s.O5)()}),r.j2.currentUser&&await (0,n.r7)(r.j2.currentUser,{displayName:a.username})}catch(e){throw console.error("Error creating user profile:",e),e}}async function c(e){try{let a=(0,s.H9)(r.db,"users",e),t=await (0,s.x7)(a);if(t.exists())return t.data();return null}catch(e){throw console.error("Error fetching user profile:",e),e}}async function d(e,a){try{let t=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(t,{interests:a}),console.log(`Interests updated for user ${e}:`,a)}catch(e){throw console.error("Error updating user interests:",e),e}}async function u(e){try{if(!e||e.trim().length<2)return[];let a=e.toLowerCase().trim(),t=(0,s.rJ)(r.db,"users");return(await (0,s.GG)(t)).docs.map(e=>e.data()).filter(e=>{let t=e.username.toLowerCase(),s=e.firstName.toLowerCase(),n=e.lastName.toLowerCase(),r=`${s} ${n}`;return t.includes(a)||s.includes(a)||n.includes(a)||r.includes(a)})}catch(e){return console.error("Error searching users:",e),[]}}async function h(e,a){try{if(e===a)throw Error("You cannot follow yourself");let t=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(t,{following:(0,s.hq)(a),followingCount:(0,s.GV)(1)});let n=(0,s.H9)(r.db,"users",a);await (0,s.mZ)(n,{followers:(0,s.hq)(e),followersCount:(0,s.GV)(1)});let o=await (0,s.x7)(t);if(o.exists()){let t=o.data();await (0,i.N9)(a,`${t.firstName} ${t.lastName}`,e,t.username)}}catch(e){throw console.error("Error following user:",e),e}}async function m(e,a){try{let t=(0,s.H9)(r.db,"users",e);await (0,s.mZ)(t,{following:(0,s.C3)(a),followingCount:(0,s.GV)(-1)});let n=(0,s.H9)(r.db,"users",a);await (0,s.mZ)(n,{followers:(0,s.C3)(e),followersCount:(0,s.GV)(-1)})}catch(e){throw console.error("Error unfollowing user:",e),e}}async function f(e,a){try{let t=(0,s.H9)(r.db,"users",e),n=await (0,s.x7)(t);if(!n.exists())return!1;let i=n.data();return i.following?.includes(a)||!1}catch(e){throw console.error("Error checking follow status:",e),e}}async function x(e,a=50){try{let t=(0,s.H9)(r.db,"users",e),n=await (0,s.x7)(t);if(!n.exists())return[];let i=n.data().following||[];if(0===i.length)return[];let o=[],l=Math.min(i.length,a);for(let e=0;e<l;e++){let a=i[e],t=(0,s.H9)(r.db,"users",a),n=await (0,s.x7)(t);n.exists()&&o.push(n.data())}return o}catch(e){throw console.error("Error getting following list:",e),e}}async function N(e,a=50){try{let t=(0,s.H9)(r.db,"users",e),n=await (0,s.x7)(t);if(!n.exists())return[];let i=n.data().followers||[];if(0===i.length)return[];let o=[],l=Math.min(i.length,a);for(let e=0;e<l;e++){let a=i[e],t=(0,s.H9)(r.db,"users",a),n=await (0,s.x7)(t);n.exists()&&o.push(n.data())}return o}catch(e){throw console.error("Error getting followers list:",e),e}}async function v(e){try{let a=(0,s.H9)(r.db,"users",e);await (0,s.kd)(a),console.log(`User profile for UID ${e} deleted from Firestore.`);let t=r.j2.currentUser;if(t&&t.uid===e)await (0,n.hG)(t),console.log(`User account for UID ${e} deleted from Firebase Authentication.`);else if(t)throw console.error("Current authenticated user does not match UID to be deleted."),Error("Mismatch between authenticated user and account to be deleted.");else throw console.error("No current user authenticated. Cannot delete Firebase Auth user."),Error("Authentication required to delete account.")}catch(e){if(console.error("Error deleting user account:",e),"auth/requires-recent-login"===e.code)throw Error("This operation is sensitive and requires recent authentication. Please sign out and sign back in, then try again.");throw Error("Failed to delete user account. "+e.message)}}},55801:e=>{e.exports={notificationContainer:"NotificationBell_notificationContainer__TFGqP",bellButton:"NotificationBell_bellButton__PKB6r",bellIcon:"NotificationBell_bellIcon__ALAAB",unreadBadge:"NotificationBell_unreadBadge__cOn_b",notificationDropdown:"NotificationBell_notificationDropdown__p8Mv4",notificationHeader:"NotificationBell_notificationHeader__cPSyI",viewAllLink:"NotificationBell_viewAllLink__une1x",notificationList:"NotificationBell_notificationList__SBbvK",notificationItem:"NotificationBell_notificationItem__MW9MC",unread:"NotificationBell_unread__9c4op",notificationContent:"NotificationBell_notificationContent__2upmA",notificationMessage:"NotificationBell_notificationMessage__aqMDB",notificationTime:"NotificationBell_notificationTime__JQ2O9",unreadDot:"NotificationBell_unreadDot__qaEb7",notificationFooter:"NotificationBell_notificationFooter__l28sD",seeMoreLink:"NotificationBell_seeMoreLink__eh2qR",emptyState:"NotificationBell_emptyState___y1V2"}},89275:(e,a,t)=>{"use strict";t.d(a,{A:()=>h});var s=t(60687),n=t(43210),r=t(85814),i=t.n(r),o=t(5062),l=t.n(o),c=t(49048);let d=()=>{let[e,a]=(0,n.useState)(""),[t,r]=(0,n.useState)([]),[o,d]=(0,n.useState)(!1),[u,h]=(0,n.useState)(!1),m=(0,n.useRef)(null),f=(0,n.useRef)(null);return(0,n.useEffect)(()=>{let e=e=>{f.current&&!f.current.contains(e.target)&&m.current&&!m.current.contains(e.target)&&h(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,n.useEffect)(()=>{let a=setTimeout(async()=>{if(e.trim().length>=2){d(!0);try{let a=await (0,c.x5)(e);r(a),h(!0)}catch(e){console.error("Error searching users:",e)}finally{d(!1)}}else r([]),h(!1)},300);return()=>clearTimeout(a)},[e]),(0,s.jsxs)("div",{className:l().searchContainer,children:[(0,s.jsxs)("div",{className:l().searchInputWrapper,children:[(0,s.jsx)("input",{type:"text",ref:m,className:l().searchInput,placeholder:"Search users by name or username...",value:e,onChange:e=>{a(e.target.value)},onFocus:()=>{e.trim().length>=2&&t.length>0&&h(!0)}}),o&&(0,s.jsx)("div",{className:l().searchLoading,children:"Searching..."})]}),u&&t.length>0&&(0,s.jsx)("div",{ref:f,className:l().searchResults,children:t.map(e=>(0,s.jsxs)(i(),{href:`/user/${encodeURIComponent(e.username.toLowerCase())}`,className:l().searchResultItem,onClick:()=>h(!1),children:[(0,s.jsxs)("div",{className:l().userAvatar,children:[e.firstName.charAt(0),e.lastName.charAt(0)]}),(0,s.jsxs)("div",{className:l().userInfo,children:[(0,s.jsxs)("div",{className:l().userName,children:[e.firstName," ",e.lastName]}),(0,s.jsxs)("div",{className:l().userUsername,children:["@",e.username]})]})]},e.uid))}),u&&e.trim().length>=2&&0===t.length&&(0,s.jsx)("div",{className:l().searchResults,children:(0,s.jsxs)("div",{className:l().noResults,children:['No users found matching "',e,'"']})})]})},u=()=>(0,s.jsx)("div",{className:l().searchBarContainer,children:(0,s.jsx)(d,{})}),h=({isAuthenticated:e,handleLogout:a,toggleSidebar:t,isSidebarCollapsed:n})=>(0,s.jsxs)("aside",{className:`${l()["left-sidebar"]} ${n?l().collapsed:""}`,children:[(0,s.jsxs)("div",{className:l()["sidebar-header"],children:[(0,s.jsx)("div",{className:l().logo,children:"Journalite"}),(0,s.jsx)("button",{className:l()["toggle-button"],onClick:t,"aria-label":n?"Expand sidebar":"Collapse sidebar",children:n?"→":"←"})]}),(0,s.jsx)("div",{className:l().sidebarSearch,children:(0,s.jsx)(u,{})}),(0,s.jsx)("nav",{className:l()["vertical-nav"],children:e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{href:"/",className:`${l()["nav-link"]} ${l()["nav-home"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Home"})]}),(0,s.jsxs)(i(),{href:"/my-thoughts",className:`${l()["nav-link"]} ${l()["nav-thoughts"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"My Thoughts"})]}),(0,s.jsxs)(i(),{href:"/create-article",className:`${l()["nav-link"]} ${l()["nav-create"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Create Article"})]}),(0,s.jsxs)(i(),{href:"/explore",className:`${l()["nav-link"]} ${l()["nav-explore"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Explore"})]}),(0,s.jsxs)(i(),{href:"/my-profile",className:`${l()["nav-link"]} ${l()["nav-profile"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"My Profile"})]}),(0,s.jsxs)(i(),{href:"/settings",className:`${l()["nav-link"]} ${l()["nav-settings"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Settings"})]}),(0,s.jsxs)(i(),{href:"/notifications",className:`${l()["nav-link"]} ${l()["nav-notifications"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Notifications"})]}),(0,s.jsxs)(i(),{href:"https://journalite.app/",className:`${l()["nav-link"]} ${l()["nav-learn-more"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Learn More"})]}),(0,s.jsxs)("button",{onClick:a,className:`${l()["nav-link"]} ${l()["nav-logout"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Log out"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(i(),{href:"/",className:`${l()["nav-link"]} ${l()["nav-home"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Home"})]}),(0,s.jsxs)(i(),{href:"/login",className:`${l()["nav-link"]} ${l()["nav-login"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Login"})]}),(0,s.jsxs)(i(),{href:"https://journalite.app/",className:`${l()["nav-link"]} ${l()["nav-learn-more"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Learn More"})]}),(0,s.jsxs)(i(),{href:"/plans",className:`${l()["nav-link"]} ${l()["nav-plans"]}`,children:[(0,s.jsx)("span",{className:l()["nav-icon"],children:"•"}),(0,s.jsx)("span",{className:l()["nav-text"],children:"Plans"})]})]})})]})}};