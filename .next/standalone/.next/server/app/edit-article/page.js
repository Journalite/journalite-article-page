(()=>{var e={};e.id=268,e.ids=[268],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},6576:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/Users/sirabdisalam/journalite-article-page/src/app/edit-article/page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/Users/sirabdisalam/journalite-article-page/src/app/edit-article/page.tsx","default")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},16189:(e,r,t)=>{"use strict";var a=t(65773);t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},18955:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s,viewport:()=>a});let a={width:"device-width",initialScale:1};function s({children:e}){return e}},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37366:e=>{"use strict";e.exports=require("dns")},45177:(e,r,t)=>{Promise.resolve().then(t.bind(t,99473))},55511:e=>{"use strict";e.exports=require("crypto")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},73496:e=>{"use strict";e.exports=require("http2")},74075:e=>{"use strict";e.exports=require("zlib")},77081:e=>{e.exports={articleFormContainer:"ArticleForm_articleFormContainer__Oamhm",articleFormHeader:"ArticleForm_articleFormHeader__lPvz4",articleFormTitle:"ArticleForm_articleFormTitle__GQZ6U",articleFormSubtitle:"ArticleForm_articleFormSubtitle__d0K2B",articleForm:"ArticleForm_articleForm__aPoqs",formGroup:"ArticleForm_formGroup__NG8OF",formLabel:"ArticleForm_formLabel__DP5Fz",optionalLabel:"ArticleForm_optionalLabel__C_B1S",formControl:"ArticleForm_formControl__mBao_",formTextarea:"ArticleForm_formTextarea__ZsknF",formActions:"ArticleForm_formActions__WqypQ",cancelButton:"ArticleForm_cancelButton__OAgVI",submitButton:"ArticleForm_submitButton__o9hsW",errorAlert:"ArticleForm_errorAlert__1DQ3x",errorIcon:"ArticleForm_errorIcon___YV5p",imagePreview:"ArticleForm_imagePreview__92eKB",tagsPreview:"ArticleForm_tagsPreview__48G_v",tag:"ArticleForm_tag__MTDKK",statusDropdown:"ArticleForm_statusDropdown__FfXJV",characterCount:"ArticleForm_characterCount__IqdJb",characterWarning:"ArticleForm_characterWarning__ZKaNu",formHint:"ArticleForm_formHint__h9Deh",loading:"ArticleForm_loading__EUkeX",loadingSpinner:"ArticleForm_loadingSpinner__iaWlv",spin:"ArticleForm_spin__reKcv"}},78151:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=t(65239),s=t(48088),i=t(88170),o=t.n(i),l=t(30893),n={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>l[e]);t.d(r,n);let c={children:["",{children:["edit-article",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,6576)),"/Users/sirabdisalam/journalite-article-page/src/app/edit-article/page.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,18955)),"/Users/sirabdisalam/journalite-article-page/src/app/edit-article/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"/Users/sirabdisalam/journalite-article-page/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["/Users/sirabdisalam/journalite-article-page/src/app/edit-article/page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/edit-article/page",pathname:"/edit-article",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},78335:()=>{},79440:(e,r,t)=>{"use strict";t.d(r,{BC:()=>m,GE:()=>o,N6:()=>c,Oe:()=>h,Tu:()=>g,a:()=>f,fz:()=>u,iZ:()=>d,l6:()=>n,tT:()=>p,zE:()=>l});var a=t(75535),s=t(43649),i=t(28163);async function o(e=!1){try{let r,t=(0,a.rJ)(s.db,"articles");r=(0,a.P)(t,(0,a.My)("createdAt","desc"));let i=await (0,a.GG)(r),o=[];return i.forEach(r=>{let t=r.data();(e||"drafts"!==t.status)&&(e||void 0===t.status||"published"===t.status)&&o.push({id:r.id,...t})}),o}catch(e){throw console.error("Error getting articles:",e),e}}async function l(e){try{let r=(0,a.H9)(s.db,"articles",e),t=await (0,a.x7)(r);if(t.exists())return{id:t.id,...t.data()};throw Error("Article not found")}catch(e){throw console.error("Error getting article:",e),e}}async function n(e){try{let r=(0,a.rJ)(s.db,"articles"),t=(0,a.P)(r,(0,a._M)("slug","==",e)),i=await (0,a.GG)(t);if(i.empty)throw Error("Article not found");let o=i.docs[0];return{id:o.id,...o.data()}}catch(e){throw console.error("Error getting article by slug:",e),e}}async function c(e){try{let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to create an article");let t={title:e.title,body:e.body,slug:e.slug||e.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"),createdAt:a.Dc.now(),authorId:r.uid,authorName:r.displayName||"Anonymous",tags:e.tags||[],status:e.status||"published"};return e.coverImage&&(t.coverImage=e.coverImage),{id:(await (0,a.gS)((0,a.rJ)(s.db,"articles"),t)).id,...t}}catch(e){throw console.error("Error creating article:",e),e}}async function d(e,r){try{let t=s.j2.currentUser;if(!t)throw Error("You must be logged in to edit an article");let i=(0,a.H9)(s.db,"articles",e),o=await (0,a.x7)(i);if(!o.exists())throw Error("Article not found");if(o.data().authorId!==t.uid)throw Error("You can only edit your own articles");let l={};void 0!==r.title&&(l.title=r.title,void 0===r.slug&&(l.slug=r.title.toLowerCase().replace(/[^\w\s]/gi,"").replace(/\s+/g,"-"))),void 0!==r.body&&(l.body=r.body),void 0!==r.tags&&(l.tags=r.tags),void 0!==r.status&&(l.status=r.status),void 0!==r.coverImage&&(l.coverImage=r.coverImage),void 0!==r.slug&&(l.slug=r.slug),await (0,a.mZ)(i,l);let n=await (0,a.x7)(i);return{id:n.id,...n.data()}}catch(e){throw console.error("Error updating article:",e),e}}async function u(e){try{let r=(0,a.rJ)(s.db,"articles",e,"comments"),t=(0,a.P)(r,(0,a.My)("createdAt","desc")),i=await (0,a.GG)(t),o=[];return i.forEach(e=>{let r=e.data();o.push({id:e.id,commentId:e.id,...r,replies:r.replies||[]})}),o}catch(e){throw console.error("Error getting comments:",e),e}}async function m(e,r){try{let t=s.j2.currentUser;if(!t)throw Error("You must be logged in to comment");let o={userId:t.uid,userName:t.displayName||t.email?.split("@")[0]||"Anonymous",content:r,createdAt:a.Dc.now(),likes:[],replies:[]},l=await (0,a.gS)((0,a.rJ)(s.db,"articles",e,"comments"),o),n=(0,a.H9)(s.db,"articles",e),c=await (0,a.x7)(n);if(c.exists()){let t=c.data();await (0,i.fZ)(t.authorId,e,t.slug||"",t.title||"Article",l.id,r)}return{id:l.id,commentId:l.id,...o}}catch(e){throw console.error("Error adding comment:",e),e}}async function h(e,r,t){try{let i=s.j2.currentUser;if(!i)throw Error("You must be logged in to reply");let o=(0,a.H9)(s.db,"articles",e,"comments",r);if(!(await (0,a.x7)(o)).exists())throw Error("Comment not found");let l={replyId:Math.random().toString(36).substring(2,15),userId:i.uid,userName:i.displayName||i.email?.split("@")[0]||"Anonymous",content:t,createdAt:a.Dc.now(),likes:[]};return await (0,a.mZ)(o,{replies:(0,a.hq)(l)}),l}catch(e){throw console.error("Error adding reply:",e),e}}async function p(e,r){try{let t=s.j2.currentUser;if(!t)throw Error("You must be logged in to like a comment");let i=(0,a.H9)(s.db,"articles",e,"comments",r),o=await (0,a.x7)(i);if(!o.exists())throw Error("Comment not found");let l=o.data(),n=t.uid;if((l.likes||[]).includes(n)){await (0,a.mZ)(i,{likes:(0,a.C3)(n)});let e=(await (0,a.x7)(i)).data();return{success:!0,action:"unliked",likes:e.likes,count:e.likes.length}}{await (0,a.mZ)(i,{likes:(0,a.hq)(n)});let e=(await (0,a.x7)(i)).data();return{success:!0,action:"liked",likes:e.likes,count:e.likes.length}}}catch(e){throw console.error("Error liking comment:",e),e}}async function g(e,r){try{let t=s.j2.currentUser;if(!t)throw Error("You must be logged in to delete a comment");let i=(0,a.H9)(s.db,"articles",e,"comments",r),o=await (0,a.x7)(i);if(!o.exists())throw Error("Comment not found");if(o.data().userId!==t.uid)throw Error("You can only delete your own comments");return await (0,a.kd)(i),{success:!0,message:"Comment deleted successfully"}}catch(e){throw console.error("Error deleting comment:",e),e}}async function f(e){try{let r=s.j2.currentUser;if(!r)throw Error("You must be logged in to delete an article");let t=await (0,a.x7)((0,a.H9)(s.db,"articles",e));if(!t.exists())throw Error("Article not found");if(t.data().authorId!==r.uid)throw Error("You can only delete your own articles");return await (0,a.kd)((0,a.H9)(s.db,"articles",e)),{success:!0,message:"Article deleted successfully"}}catch(e){throw console.error("Error deleting article:",e),e}}},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},92377:(e,r,t)=>{Promise.resolve().then(t.bind(t,6576))},94735:e=>{"use strict";e.exports=require("events")},96487:()=>{},99473:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>f});var a=t(60687),s=t(43210),i=t(16189);t(84245);var o=t(43649),l=t(85814),n=t.n(l),c=t(79440),d=t(77081),u=t.n(d);let m=({articleId:e})=>{let[r,t]=(0,s.useState)(""),[l,d]=(0,s.useState)(""),[m,h]=(0,s.useState)(""),[p,g]=(0,s.useState)(""),[f,x]=(0,s.useState)("published"),[v,b]=(0,s.useState)(!1),[y,_]=(0,s.useState)(!0),[w,j]=(0,s.useState)(""),[N,A]=(0,s.useState)(0),[F,E]=(0,s.useState)(""),C=(0,i.useRouter)();(0,s.useEffect)(()=>{A(l.length)},[l]),(0,s.useEffect)(()=>{let r=async()=>{try{_(!0);let r=await (0,c.zE)(e);t(r.title),d(r.body),h(r.tags?.join(", ")||""),g(r.coverImage||""),x(r.status||"published"),E(r.slug||""),A(r.body.length)}catch(e){console.error("Error loading article:",e),j("Failed to load article data")}finally{_(!1)}};e&&r()},[e]);let P=async t=>{if(t.preventDefault(),!r||!l)return void j("Title and content are required");if(!o.j2.currentUser)return void j("You must be logged in to edit an article");try{b(!0),j("");let t=m.split(",").map(e=>e.trim()).filter(e=>""!==e),a={title:r,body:l,tags:t,status:f};""!==p.trim()&&(a.coverImage=p);let s=await (0,c.iZ)(e,a);"published"===f?C.push(`/articles?slug=${s.slug}`):C.push("/my-thoughts")}catch(e){console.error("Error updating article:",e),j("Failed to update article. Please try again.")}finally{b(!1)}},S=["Consider adding more details to make your content more engaging","Re-read your article for clarity before publishing","Use descriptive language to paint a picture for your readers","Update your tags to reach a wider audience"],k=S[Math.floor(Math.random()*S.length)];return y?(0,a.jsx)("div",{className:u().articleFormContainer,children:(0,a.jsxs)("div",{className:u().loading,children:[(0,a.jsx)("div",{className:u().loadingSpinner}),(0,a.jsx)("span",{children:"Loading article data..."})]})}):(0,a.jsxs)("div",{className:u().articleFormContainer,children:[(0,a.jsxs)("div",{className:u().articleFormHeader,children:[(0,a.jsx)("h1",{className:u().articleFormTitle,children:"Edit Your Story"}),(0,a.jsx)("p",{className:u().articleFormSubtitle,children:"Refine your thoughts and make your article shine"})]}),w&&(0,a.jsxs)("div",{className:u().errorAlert,children:[(0,a.jsx)("span",{className:u().errorIcon,children:"⚠️"}),(0,a.jsx)("span",{children:w})]}),(0,a.jsxs)("form",{onSubmit:P,className:u().articleForm,children:[(0,a.jsxs)("div",{className:u().formGroup,children:[(0,a.jsx)("label",{htmlFor:"title",className:u().formLabel,children:"Title"}),(0,a.jsx)("input",{type:"text",id:"title",value:r,onChange:e=>t(e.target.value),required:!0,placeholder:"Enter a captivating title for your article...",className:u().formControl,maxLength:100}),(0,a.jsx)("div",{className:u().formHint,children:"A good title is clear, specific, and engaging"})]}),(0,a.jsxs)("div",{className:u().formGroup,children:[(0,a.jsxs)("label",{htmlFor:"coverImage",className:u().formLabel,children:["Cover Image URL ",(0,a.jsx)("span",{className:u().optionalLabel,children:"optional"})]}),(0,a.jsx)("input",{type:"url",id:"coverImage",value:p,onChange:e=>g(e.target.value),placeholder:"https://example.com/image.jpg",className:u().formControl}),(0,a.jsx)("div",{className:u().formHint,children:"A striking image can increase engagement with your article"}),p&&(0,a.jsx)("div",{className:u().imagePreview,children:(0,a.jsx)("img",{src:p,alt:"Cover preview"})})]}),(0,a.jsxs)("div",{className:u().formGroup,children:[(0,a.jsxs)("label",{htmlFor:"tags",className:u().formLabel,children:["Tags ",(0,a.jsx)("span",{className:u().optionalLabel,children:"comma separated"})]}),(0,a.jsx)("input",{type:"text",id:"tags",value:m,onChange:e=>h(e.target.value),placeholder:"technology, news, science, learning",className:u().formControl}),(0,a.jsx)("div",{className:u().formHint,children:"Tags help readers discover your content"}),m&&(0,a.jsx)("div",{className:u().tagsPreview,children:m.split(",").map((e,r)=>e.trim()&&(0,a.jsx)("span",{className:u().tag,children:e.trim()},r))})]}),(0,a.jsxs)("div",{className:`${u().formGroup} ${u().statusDropdown}`,children:[(0,a.jsx)("label",{htmlFor:"status",className:u().formLabel,children:"Status"}),(0,a.jsxs)("select",{id:"status",value:f,onChange:e=>x(e.target.value),className:u().formControl,children:[(0,a.jsx)("option",{value:"published",children:"Published (visible to everyone)"}),(0,a.jsx)("option",{value:"drafts",children:"Save as Draft (only visible to you)"})]}),(0,a.jsx)("div",{className:u().formHint,children:"published"===f?"Your article will be visible to all users":"Only you can see your draft until you publish it"})]}),(0,a.jsxs)("div",{className:u().formGroup,children:[(0,a.jsx)("label",{htmlFor:"body",className:u().formLabel,children:"Content"}),(0,a.jsx)("textarea",{id:"body",value:l,onChange:e=>d(e.target.value),required:!0,placeholder:"Write your article content here. Provide valuable insights, share your experience, or tell a compelling story...",className:u().formTextarea,rows:15}),(0,a.jsx)("div",{className:u().characterCount,children:(0,a.jsxs)("span",{className:N>3e3?u().characterWarning:"",children:[N," characters"]})}),(0,a.jsx)("div",{className:u().formHint,children:(0,a.jsxs)("span",{children:["✨ Tip: ",k]})})]}),(0,a.jsxs)("div",{className:u().formActions,children:[(0,a.jsx)(n(),{href:"/my-thoughts",className:u().cancelButton,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:u().submitButton,disabled:v,children:v?"Saving...":"Save Changes"})]})]})]})};var h=t(5062),p=t.n(h);function g(){let e=(0,i.useSearchParams)(),r=e?.get("id")||"",[t,o]=(0,s.useState)(!1),[l,n]=(0,s.useState)(!0);return((0,i.useRouter)(),l)?(0,a.jsx)("div",{className:p().container,children:(0,a.jsx)("div",{className:p().loading,children:"Loading..."})}):t?r?(0,a.jsx)(m,{articleId:r}):(0,a.jsx)("div",{className:p().container,children:(0,a.jsx)("div",{className:p().loading,children:"No article ID provided."})}):(0,a.jsx)("div",{className:p().container,children:(0,a.jsx)("div",{className:p().loading,children:"Please log in to edit articles."})})}function f(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:p().container,children:(0,a.jsx)("div",{className:p().loading,children:"Loading..."})}),children:(0,a.jsx)(g,{})})}}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[169,814,948,774],()=>t(78151));module.exports=a})();