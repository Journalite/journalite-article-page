(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3234],{5695:(e,t,r)=>{"use strict";var s=r(8999);r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},8513:(e,t,r)=>{Promise.resolve().then(r.bind(r,9580))},9580:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>u});var s=r(5155),a=r(2115),n=r(5695),l=r(6203),i=r(3201),o=r(4744),m=r(6874),d=r.n(m);function u(){let[e,t]=(0,a.useState)(""),[r,m]=(0,a.useState)(""),[u,c]=(0,a.useState)(""),[x,f]=(0,a.useState)(""),[h,b]=(0,a.useState)(""),[g,N]=(0,a.useState)(0),[p,j]=(0,a.useState)(!0),[v,y]=(0,a.useState)(!1),[w,S]=(0,a.useState)(""),[k,C]=(0,a.useState)(""),[E,P]=(0,a.useState)({}),[F,U]=(0,a.useState)({}),[B,T]=(0,a.useState)(null),[R,_]=(0,a.useState)(!1),[L,q]=(0,a.useState)(null),[O,V]=(0,a.useState)(""),z=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=(0,l.hg)(i.j2,async e=>{if(e){q(e.uid),V(e.email||"");try{var r,s;let a=await (0,o.VM)(e.uid);if(a)t(a.firstName||""),m(a.lastName||""),c(a.username||""),f(a.username||""),b(a.bio||""),N((null==(r=a.bio)?void 0:r.length)||0),T(!0);else{let r=(e.displayName||"").split(" ");t(r[0]||""),m(r.slice(1).join(" ")||"");let a=(null==(s=e.email)?void 0:s.split("@")[0])||"";c(a),f(a),a&&await D(a,!0)}}catch(e){console.error("Error fetching user profile:",e),S("Failed to load your profile. Please try refreshing the page.")}finally{j(!1)}}else z.push("/login?redirect=/my-profile/edit")});return()=>e()},[z]);let I=e=>{let{name:r,value:s}=e.target;P({...E,[r]:!0}),U({...F,[r]:""}),S(""),C(""),"firstName"===r&&t(s),"lastName"===r&&m(s),"username"===r&&(c(s),s!==x&&T(null)),"bio"===r&&s.length<=250&&(b(s),N(s.length))},M=async e=>{let{name:t,value:r}=e.target;Y(t,r),"username"===t&&r!==x&&r.length>=2&&await D(r)},Y=(e,t)=>{let r="";return t.trim()||"firstName"!==e&&"lastName"!==e&&"username"!==e||(r="Please enter your ".concat("firstName"===e?"first name":"lastName"===e?"last name":"username",".")),"username"===e&&t.trim().length>0&&t.trim().length<2&&(r="Username must be at least 2 characters."),U(t=>({...t,[e]:r})),!r},D=async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.length<2)return void T(null);if(e===x&&!t)return void T(!0);_(!0);try{let t=await (0,o.OQ)(e);T(!t)}catch(e){console.error("Error checking username:",e),T(null),U(e=>({...e,username:"Could not verify username. Try again."}))}finally{_(!1)}};(0,a.useEffect)(()=>{if(u===x||u.length<2)return void(u===x?T(!0):T(null));let e=setTimeout(()=>{D(u)},600);return()=>clearTimeout(e)},[u,x]);let K=()=>{let t={},s=!0;return Y("firstName",e)||(s=!1),Y("lastName",r)||(s=!1),Y("username",u)||(s=!1),u.length>=2&&u!==x&&!1===B&&(t.username="This username is already taken.",s=!1),U(e=>({...e,...t})),P({firstName:!0,lastName:!0,username:!0,bio:!0}),s},Q=async t=>{if(t.preventDefault(),S(""),C(""),K()&&L){if(u!==x&&!1===B)return void U(e=>({...e,username:"This username is already taken."}));y(!0);try{let t={firstName:e,lastName:r,username:u.toLowerCase(),email:O,bio:h};await (0,o.Vz)(L,t),i.j2.currentUser&&i.j2.currentUser.displayName!==u&&await (0,l.r7)(i.j2.currentUser,{displayName:u}),f(u),C("Profile updated successfully!"),setTimeout(()=>C(""),3e3)}catch(t){console.error("Error updating profile:",t);let e="Failed to update profile. Please try again.";t instanceof Error&&t.message.includes("Username is already taken")&&(e="This username is already taken.",U(t=>({...t,username:e}))),S(e)}finally{y(!1)}}},A=(e,t,r)=>{let s="w-full px-4 py-3 bg-white border border-stone-300 rounded-lg shadow-sm transition-colors duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-amber-500 focus:border-amber-500 placeholder-stone-400 text-stone-700";return t?"".concat(s," border-red-400 focus:ring-red-400 bg-red-50 text-red-700 placeholder-red-400"):!0===r&&"username"===e&&u!==x?"".concat(s," border-green-400 focus:ring-green-400 bg-green-50 text-green-700"):"".concat(s," hover:border-stone-400")};return p?(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex items-center justify-center font-sans",children:[(0,s.jsx)("div",{className:"animate-spin h-10 w-10 border-4 border-amber-500 rounded-full border-t-transparent"}),(0,s.jsx)("p",{className:"ml-3 text-stone-700",children:"Loading profile editor..."})]}):(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-stone-100 to-amber-100 flex flex-col items-center justify-start py-12 px-4 sm:px-6 lg:px-8 font-sans",children:(0,s.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,s.jsx)("div",{className:"mb-8 flex justify-start",children:(0,s.jsxs)(d(),{href:"/my-profile",className:"text-amber-700 hover:text-amber-800 font-medium flex items-center",children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",viewBox:"0 0 20 20",fill:"currentColor",children:(0,s.jsx)("path",{fillRule:"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Back to Profile"]})}),(0,s.jsxs)("div",{className:"bg-white p-8 sm:p-10 rounded-xl shadow-2xl",children:[(0,s.jsxs)("div",{className:"mb-10 text-center",children:[(0,s.jsx)("h1",{className:"text-3xl sm:text-4xl font-serif font-semibold text-stone-800",children:"Edit Your Profile"}),(0,s.jsx)("p",{className:"mt-3 text-stone-600",children:"Keep your information up to date."})]}),w&&(0,s.jsx)("div",{className:"mb-6 p-3.5 bg-red-100 text-red-700 border border-red-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:w}),k&&(0,s.jsx)("div",{className:"mb-6 p-3.5 bg-green-100 text-green-700 border border-green-200 rounded-lg transition-all duration-300 ease-in-out animate-fadeIn",children:k}),(0,s.jsxs)("form",{onSubmit:Q,noValidate:!0,className:"space-y-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"firstName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"First Name"}),(0,s.jsx)("input",{type:"text",name:"firstName",id:"firstName",value:e,onChange:I,onBlur:M,className:A("firstName",!!F.firstName),required:!0,"aria-describedby":"firstName-error"}),E.firstName&&F.firstName&&(0,s.jsx)("p",{id:"firstName-error",className:"mt-1.5 text-xs text-red-500",children:F.firstName})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"lastName",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Last Name"}),(0,s.jsx)("input",{type:"text",name:"lastName",id:"lastName",value:r,onChange:I,onBlur:M,className:A("lastName",!!F.lastName),required:!0,"aria-describedby":"lastName-error"}),E.lastName&&F.lastName&&(0,s.jsx)("p",{id:"lastName-error",className:"mt-1.5 text-xs text-red-500",children:F.lastName})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Username"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("input",{type:"text",name:"username",id:"username",value:u,onChange:I,onBlur:M,className:A("username",!!F.username,B),required:!0,"aria-describedby":"username-error username-availability"}),R&&(0,s.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,s.jsx)("div",{className:"animate-spin h-4 w-4 border-2 border-stone-400 rounded-full border-t-transparent"})})]}),E.username&&F.username&&(0,s.jsx)("p",{id:"username-error",className:"mt-1.5 text-xs text-red-500",children:F.username}),!F.username&&u.length>=2&&u!==x&&(0,s.jsx)("p",{id:"username-availability",className:"mt-1.5 text-xs ".concat(!0===B?"text-green-600":!1===B?"text-red-500":"text-stone-500"),children:R?"Checking...":!0===B?"Username is available":!1===B?"Username is taken":"Enter username to check availability"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Email"}),(0,s.jsx)("input",{type:"email",name:"email",id:"email",value:O,disabled:!0,className:"w-full px-4 py-3 bg-stone-100 border border-stone-300 rounded-lg shadow-sm text-stone-500 cursor-not-allowed"}),(0,s.jsx)("p",{className:"mt-1.5 text-xs text-stone-500",children:"Your email address cannot be changed here."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"bio",className:"block text-sm font-medium text-stone-600 mb-1.5",children:"Bio"}),(0,s.jsx)("textarea",{name:"bio",id:"bio",rows:4,value:h,onChange:I,onBlur:M,className:A("bio",!!F.bio),maxLength:250,"aria-describedby":"bio-char-count"}),(0,s.jsxs)("p",{id:"bio-char-count",className:"mt-1.5 text-xs text-stone-500 text-right",children:[g,"/",250," characters"]}),E.bio&&F.bio&&(0,s.jsx)("p",{className:"mt-1.5 text-xs text-red-500",children:F.bio})]}),(0,s.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end items-center gap-4 pt-4",children:[(0,s.jsx)(d(),{href:"/my-profile",className:"w-full sm:w-auto order-2 sm:order-1 px-6 py-3 text-center text-stone-700 bg-stone-200 hover:bg-stone-300 rounded-lg transition-colors duration-200 ease-in-out font-medium",children:"Cancel"}),(0,s.jsx)("button",{type:"submit",disabled:v||R,className:"w-full sm:w-auto order-1 sm:order-2 px-8 py-3 bg-amber-600 hover:bg-amber-700 text-white font-semibold rounded-lg shadow-md hover:shadow-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-amber-500 disabled:opacity-60 disabled:cursor-not-allowed flex items-center justify-center",children:v?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"animate-spin h-5 w-5 border-2 border-white rounded-full border-t-transparent mr-2.5"}),"Saving..."]}):"Save Changes"})]})]})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[2992,7158,7117,6874,4744,8441,1684,7358],()=>t(8513)),_N_E=e.O()}]);