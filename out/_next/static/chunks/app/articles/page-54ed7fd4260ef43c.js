(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[292],{3484:()=>{},8060:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>x});var o=a(5155),n=a(2115),r=a(6874),i=a.n(r),c=(a(5695),a(8163)),s=a(8900),l=a(6203);async function m(e){let t="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comments"),a=await fetch(t);if(!a.ok)throw Error("Failed to fetch comments: ".concat(a.status," ").concat(a.statusText));return a.json()}async function d(e,t,a){let o="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment"),n=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t,content:a})});if(!n.ok)throw Error("Failed to post comment: ".concat(n.status," ").concat(n.statusText));return n.json()}async function h(e,t,a,o){let n="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment/").concat(t,"/reply"),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a,content:o})});if(!r.ok)throw Error("Failed to post reply: ".concat(r.status," ").concat(r.statusText));return r.json()}async function _(e,t,a){let o="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment/").concat(t,"/like"),n=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:a})});if(!n.ok)throw Error("Failed to like comment: ".concat(n.status," ").concat(n.statusText));return n.json()}async function u(e,t,a,o){let n="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment/").concat(t,"/reply/").concat(a,"/like"),r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:o})});if(!r.ok)throw Error("Failed to like reply: ".concat(r.status," ").concat(r.statusText));return r.json()}async function p(e,t,a){let o="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment/").concat(t,"?userId=").concat(a),n=await fetch(o,{method:"DELETE"});if(!n.ok)throw Error("Failed to delete comment: ".concat(n.status," ").concat(n.statusText));return n.json()}async function g(e,t,a,o){let n="".concat("http://127.0.0.1:5001","/api/prototype/v1/article/").concat(e,"/comment/").concat(t,"/reply/").concat(a,"?userId=").concat(o),r=await fetch(n,{method:"DELETE"});if(!r.ok)throw Error("Failed to delete reply: ".concat(r.status," ").concat(r.statusText));return r.json()}var f=a(792);let v=e=>{let{slug:t}=e,[a,r]=(0,n.useState)([]),[c,f]=(0,n.useState)(!0),[v,x]=(0,n.useState)(""),[y,j]=(0,n.useState)(""),[b,N]=(0,n.useState)(!1),[k,w]=(0,n.useState)(!1),[I,S]=(0,n.useState)(null),[C,E]=(0,n.useState)(""),[D,P]=(0,n.useState)(!1),[T,L]=(0,n.useState)({}),[F,U]=(0,n.useState)(!1),[A,O]=(0,n.useState)(!1),[B,q]=(0,n.useState)({id:"",name:"Reader"});(0,n.useEffect)(()=>{let e=(0,l.hg)(s.j2,e=>{let t=!!e;if(U(t),t&&e){var a;q({id:e.uid,name:e.displayName||(null==(a=e.email)?void 0:a.split("@")[0])||"User"})}else q({id:"",name:"Reader"})});if(t)return f(!0),m(t).then(e=>{setTimeout(()=>{r(e),f(!1)},800)}).catch(e=>{x("Unable to load discussions. Please refresh the page to try again."),f(!1)}),()=>e()},[t]);let J=async e=>{if(e.preventDefault(),y.trim()&&!b){if(!F)return void O(!0);try{N(!0);let e=await d(t,B.id,y);r(t=>[e,...t]),j(""),N(!1),w(!1)}catch(e){x("Your response could not be posted. Please try again."),N(!1)}}},z=async e=>{if(C.trim()&&!D){if(!F)return void O(!0);try{P(!0);let a=await h(t,e,B.id,C);r(t=>t.map(t=>t.commentId===e?{...t,replies:[...t.replies||[],a]}:t)),E(""),S(null),P(!1),L(t=>({...t,[e]:!0}))}catch(e){P(!1)}}},M=async e=>{if(!F)return void O(!0);try{let a=await _(t,e,B.id);r(t=>t.map(t=>t.commentId===e?{...t,likes:a.likes}:t))}catch(e){}},W=async(e,a)=>{if(!F)return void O(!0);try{let o=await u(t,e,a,B.id);r(t=>t.map(t=>t.commentId===e?{...t,replies:t.replies.map(e=>e.replyId===a?{...e,likes:o.likes}:e)}:t))}catch(e){}},R=async e=>{if(F)try{await p(t,e,B.id),r(t=>t.filter(t=>t.commentId!==e))}catch(e){}},X=async(e,a)=>{if(F)try{await g(t,e,a,B.id),r(t=>t.map(t=>t.commentId===e?{...t,replies:t.replies.filter(e=>e.replyId!==a)}:t))}catch(e){}},K=e=>{L(t=>({...t,[e]:!t[e]}))},Y=e=>{let t=new Date(e),a=new Date().getTime()-t.getTime(),o=Math.floor(a/6e4),n=Math.floor(a/36e5),r=Math.floor(a/864e5);return o<60?"".concat(o," ").concat(1===o?"minute":"minutes"," ago"):n<24?"".concat(n," ").concat(1===n?"hour":"hours"," ago"):r<7?"".concat(r," ").concat(1===r?"day":"days"," ago"):t.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})},Z=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=e.charAt(0).toUpperCase(),n=["#4f46e5","#0ea5e9","#10b981","#f59e0b","#ef4444"],r=e.charCodeAt(0)%n.length,i=n[r];return(0,o.jsx)("div",{className:t?"reply-avatar":"comment-avatar-small",style:{backgroundColor:i,display:"flex",alignItems:"center",justifyContent:"center",color:"white",fontWeight:"bold",fontSize:t?"0.9rem":"1.2rem"},children:a})};return(0,o.jsxs)("section",{className:"comment-section",children:[(0,o.jsx)("h2",{className:"comment-section-title",children:"Join the Discussion"}),v&&(0,o.jsxs)("div",{className:"comment-error",children:[(0,o.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,o.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,o.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,o.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]}),v]}),(0,o.jsx)("form",{className:"comment-form",onSubmit:J,children:(0,o.jsx)("div",{className:"comment-input-container",style:{opacity:k?1:.85},children:F?(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"comment-avatar",children:Z(B.id)}),(0,o.jsx)("textarea",{className:"comment-input",placeholder:"Share your thoughts...",value:y,onChange:e=>j(e.target.value),onFocus:()=>w(!0),onBlur:()=>{y.trim()||w(!1)}}),(0,o.jsx)("button",{className:"comment-submit",type:"submit",disabled:!y.trim()||b,children:b?"Posting...":"Post"})]}):(0,o.jsxs)("div",{className:"login-prompt-container",onClick:()=>O(!0),children:[(0,o.jsx)("textarea",{className:"comment-input",placeholder:"Login to join the discussion...",disabled:!0}),(0,o.jsx)("button",{className:"comment-submit login-button",type:"button",onClick:()=>O(!0),children:"Login to comment"})]})})}),A&&(0,o.jsx)("div",{className:"login-modal-overlay",onClick:()=>O(!1),children:(0,o.jsxs)("div",{className:"login-modal",onClick:e=>e.stopPropagation(),children:[(0,o.jsx)("button",{className:"login-modal-close",onClick:()=>O(!1),children:"\xd7"}),(0,o.jsx)("h3",{className:"login-modal-title",children:"Join the conversation"}),(0,o.jsx)("p",{className:"login-modal-text",children:"Sign in to Journalite to share your thoughts and join the discussion."}),(0,o.jsxs)("div",{className:"login-modal-buttons",children:[(0,o.jsx)(i(),{href:"/login",className:"login-modal-button primary",children:"Log In"}),(0,o.jsx)(i(),{href:"/register",className:"login-modal-button secondary",children:"Create Account"})]})]})}),c?(0,o.jsxs)("div",{className:"comment-loading",children:[(0,o.jsx)("p",{children:"Loading comments..."}),(0,o.jsxs)("div",{className:"loading-dots",children:[(0,o.jsx)("div",{className:"loading-dot"}),(0,o.jsx)("div",{className:"loading-dot"}),(0,o.jsx)("div",{className:"loading-dot"})]})]}):0===a.length?(0,o.jsx)("div",{className:"no-comments",children:"Be the first to share your thoughts on this article."}):(0,o.jsx)("div",{className:"comments-list",children:a.map(e=>(0,o.jsxs)("div",{className:"comment-item",children:[(0,o.jsxs)("div",{className:"comment-header",children:[Z(e.userId),(0,o.jsx)("span",{className:"comment-user",children:e.userId}),(0,o.jsx)("span",{className:"comment-date",children:Y(e.createdAt)})]}),(0,o.jsx)("div",{className:"comment-content",children:e.content}),(0,o.jsxs)("div",{className:"comment-actions",children:[(0,o.jsxs)("button",{className:"comment-like-btn ".concat(e.likes.includes(B.id)?"liked":""),onClick:()=>M(e.commentId),children:[(0,o.jsx)("span",{children:"❤"}),(0,o.jsx)("span",{children:e.likes.length||""})]}),(0,o.jsxs)("button",{className:"reply-toggle",onClick:()=>{F?S(I===e.commentId?null:e.commentId):O(!0)},children:[(0,o.jsx)("span",{children:"↩"}),(0,o.jsx)("span",{children:"Reply"})]}),e.userId===B.id&&(0,o.jsxs)("button",{className:"comment-delete-btn",onClick:()=>R(e.commentId),children:[(0,o.jsx)("span",{children:"\uD83D\uDDD1"}),(0,o.jsx)("span",{children:"Delete"})]})]}),e.replies&&e.replies.length>0&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)("button",{className:"replies-toggle",onClick:()=>K(e.commentId),children:[(0,o.jsx)("span",{className:"replies-toggle-icon ".concat(T[e.commentId]?"open":""),children:"▷"}),"".concat(e.replies.length," ").concat(1===e.replies.length?"reply":"replies")]}),T[e.commentId]&&(0,o.jsx)("div",{className:"reply-section",children:e.replies.map(t=>(0,o.jsxs)("div",{className:"reply-item",children:[(0,o.jsxs)("div",{className:"reply-header",children:[Z(t.userId,!0),(0,o.jsx)("span",{className:"reply-user",children:t.userId}),(0,o.jsx)("span",{className:"reply-date",children:Y(t.createdAt)})]}),(0,o.jsx)("div",{className:"reply-content",children:t.content}),(0,o.jsxs)("div",{className:"reply-actions",children:[(0,o.jsxs)("button",{className:"".concat(t.likes.includes(B.id)?"liked":""),onClick:()=>W(e.commentId,t.replyId),children:["❤ ",t.likes.length||""]}),t.userId===B.id&&(0,o.jsx)("button",{onClick:()=>X(e.commentId,t.replyId),children:"\uD83D\uDDD1 Delete"})]})]},t.replyId))})]}),I===e.commentId&&(0,o.jsxs)("div",{className:"reply-form ".concat(e.replies&&e.replies.length>0?"in-thread":""),children:[(0,o.jsx)("textarea",{className:"reply-input",placeholder:"Write a reply...",value:C,onChange:e=>E(e.target.value)}),(0,o.jsxs)("div",{className:"reply-buttons",children:[(0,o.jsx)("button",{className:"reply-cancel",onClick:()=>{S(null),E("")},children:"Cancel"}),(0,o.jsx)("button",{className:"reply-submit",disabled:!C.trim()||D,onClick:()=>z(e.commentId),children:D?"Posting...":"Post Reply"})]})]})]},e.commentId))})]})};a(3484);function x(){n.Suspense}},8163:e=>{e.exports={"article-page":"home_article-page__CJrzD","three-column-layout":"home_three-column-layout__x41EQ","left-sidebar":"home_left-sidebar__MaSov",collapsed:"home_collapsed__2_VdN","sidebar-header":"home_sidebar-header__4tIx3",logo:"home_logo__fwoF8","toggle-button":"home_toggle-button__sVP2W","vertical-nav":"home_vertical-nav__Cj0En","nav-home":"home_nav-home__X8XEK","nav-icon":"home_nav-icon__yM4nn","nav-thoughts":"home_nav-thoughts__0rfq1","nav-explore":"home_nav-explore__bcQBn","nav-profile":"home_nav-profile__WAAem","nav-settings":"home_nav-settings__0w_SC","nav-logout":"home_nav-logout__MCaXq","nav-login":"home_nav-login__1lQUW","nav-signup":"home_nav-signup__8EtSK","nav-learn":"home_nav-learn__M1FC_","nav-plans":"home_nav-plans__c9i07","nav-link":"home_nav-link__6kEPW","nav-text":"home_nav-text__B7jdN",active:"home_active__S0jaV","sidebar-footer":"home_sidebar-footer__Fj8FR","sidebar-collapse-button":"home_sidebar-collapse-button__W3ZL0","center-column":"home_center-column__eaxY9",expanded:"home_expanded__mJRm4",loading:"home_loading__D6__B","prompt-banner":"home_prompt-banner__xFQFU","prompt-icon":"home_prompt-icon__9eWo_","prompt-text":"home_prompt-text__P3NSJ","prompt-button":"home_prompt-button__z8a6r","featured-card":"home_featured-card__r3SXe","featured-content":"home_featured-content__gbOMz","featured-image":"home_featured-image__3DBbZ","cover-image":"home_cover-image___ZInI","featured-label":"home_featured-label__z2IzP","featured-title":"home_featured-title__qNCn0","featured-meta":"home_featured-meta__Lq6uD","featured-excerpt":"home_featured-excerpt__dhAPX","read-link":"home_read-link___6ZMN","article-grid":"home_article-grid__mC5EI","article-card":"home_article-card__fzb4w","article-title":"home_article-title__toAvL","article-meta":"home_article-meta__9UhXG","article-excerpt":"home_article-excerpt__kuCuZ","article-tags":"home_article-tags__VxN88",tag:"home_tag__LEtq4","reaction-bar":"home_reaction-bar__Y0gsv","reaction-button":"home_reaction-button__KLD0h","reaction-icon":"home_reaction-icon__vhB0y","right-sidebar":"home_right-sidebar__e_5Hr","sidebar-heading":"home_sidebar-heading__lega4","tag-list":"home_tag-list__fgeEi","trending-tag":"home_trending-tag__0awB8","write-button":"home_write-button__Gowtg","quote-card":"home_quote-card__LAcHm","quote-tag":"home_quote-tag__AukSw","article-container":"home_article-container__RCmcS","article-header":"home_article-header__mdTUd","article-content":"home_article-content__HUOVu","article-paragraph":"home_article-paragraph__6t7oy","article-cover-image":"home_article-cover-image__KDspQ",header:"home_header__PUC5f",hero:"home_hero__3iLRs","hero-title":"home_hero-title__tuN3q","hero-subtitle":"home_hero-subtitle__cyiJZ","cta-button":"home_cta-button__X8xB1","main-grid":"home_main-grid__qFsbA","section-title":"home_section-title__wEK3N","article-tag":"home_article-tag__m6NuJ","author-info":"home_author-info__Xw67P","author-avatar":"home_author-avatar__kBH_g","author-name":"home_author-name__vEgN7",topics:"home_topics__lPwTP","topic-tag":"home_topic-tag__LL122","trending-list":"home_trending-list__YinkY",writers:"home_writers__2u4IP","writer-item":"home_writer-item__1jEW3","writer-info":"home_writer-info__OG3R7","writer-avatar":"home_writer-avatar__b69xH","writer-name":"home_writer-name__McEqt","follow-button":"home_follow-button__UX_LS",features:"home_features__Uc1bS","feature-title":"home_feature-title__9pzGT","feature-desc":"home_feature-desc__jOby5",footer:"home_footer__1HL_E","menu-overlay":"home_menu-overlay__S__PE",fadeIn:"home_fadeIn__uLm0f"}},8900:(e,t,a)=>{"use strict";let o,n,r;a.d(t,{j2:()=>n,db:()=>r});var i=a(3915),c=a(6864),s=a(6203),l=a(5317);if((0,i.Dk)().length)o=(0,i.Dk)()[0],n=(0,s.xI)(o),r=(0,l.aU)(o);else{o=(0,i.Wp)({apiKey:"AIzaSyCFpybhLt43iKUw6lNahU1n2zjYv0BXmf4",authDomain:"journalitev1.firebaseapp.com",projectId:"journalitev1",storageBucket:"journalitev1.firebasestorage.app",messagingSenderId:"897263211529",appId:"1:897263211529:web:bae4a00910a2236d6d54d8",measurementId:"G-ZYT8PRMT0D"});try{(0,c.P5)(o)}catch(e){console.log("Analytics initialization error:",e)}n=(0,s.xI)(o),r=(0,l.aU)(o)}},9251:(e,t,a)=>{Promise.resolve().then(a.bind(a,8060))}},e=>{var t=t=>e(e.s=t);e.O(0,[708,709,992,158,117,874,318,441,684,358],()=>t(9251)),_N_E=e.O()}]);