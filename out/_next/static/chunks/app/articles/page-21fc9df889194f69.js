(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5292],{6462:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var i=a(5155),s=a(2115),n=a(6874),l=a.n(n),r=a(5695),o=a(8501),c=a.n(o),d=a(3201),h=a(6203),m=a(9995),u=a(6559),f=a.n(u);let N=()=>{let[e,t]=(0,s.useState)(0),[a,n]=(0,s.useState)([]),[r,o]=(0,s.useState)(!1),c=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=async()=>{t(await (0,m.Hs)())};e();let a=setInterval(e,6e4);return()=>clearInterval(a)},[]),(0,s.useEffect)(()=>{let e=e=>{c.current&&!c.current.contains(e.target)&&o(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{r&&d()},[r]);let d=async()=>{try{let e=await (0,m.Ss)(!1);n(e)}catch(e){console.error("Error fetching notifications:",e)}},h=async e=>{try{!e.read&&e.id&&(await (0,m.bA)(e.id),t(e=>Math.max(e-1,0)),n(t=>t.map(t=>t.id===e.id?{...t,read:!0}:t)))}catch(e){console.error("Error marking notification as read:",e)}},u=e=>{if(!e)return"";let t=e.toDate?e.toDate():new Date(e),a=Math.floor((new Date().getTime()-t.getTime())/6e4);if(a<1)return"Just now";if(a<60)return"".concat(a,"m ago");let i=Math.floor(a/60);if(i<24)return"".concat(i,"h ago");let s=Math.floor(i/24);return s<7?"".concat(s,"d ago"):t.toLocaleDateString()},N=e=>{if("follow"===e.type){var t;return(null==(t=e.fromUser)?void 0:t.username)?"/user/".concat(e.fromUser.username):"/notifications"}return e.articleSlug?"/articles?slug=".concat(e.articleSlug):"/notifications"};return(0,i.jsxs)("div",{className:f().container,ref:c,children:[(0,i.jsxs)("button",{className:f().button,onClick:()=>{o(!r)},"aria-label":"Notifications",children:[(0,i.jsxs)("svg",{className:f().icon,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,i.jsx)("path",{d:"M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"}),(0,i.jsx)("path",{d:"M13.73 21a2 2 0 0 1-3.46 0"})]}),e>0&&(0,i.jsx)("span",{className:f().badge,children:e})]}),r&&(0,i.jsxs)("div",{className:f().dropdown,children:[(0,i.jsxs)("div",{className:f().header,children:[(0,i.jsx)("h3",{children:"Notifications"}),a.length>0&&(0,i.jsx)(l(),{href:"/notifications",className:f().viewAll,children:"View All"})]}),(0,i.jsx)("div",{className:f().list,children:0===a.length?(0,i.jsx)("div",{className:f().empty,children:"No notifications yet"}):a.slice(0,5).map(e=>(0,i.jsxs)(l(),{href:N(e),className:"".concat(f().item," ").concat(e.read?"":f().unread),onClick:()=>h(e),children:[(0,i.jsxs)("div",{className:f().content,children:[(0,i.jsx)("p",{className:f().message,children:e.message}),(0,i.jsx)("span",{className:f().time,children:u(e.createdAt)})]}),!e.read&&(0,i.jsx)("div",{className:f().dot})]},e.id))}),a.length>5&&(0,i.jsx)("div",{className:f().footer,children:(0,i.jsx)(l(),{href:"/notifications",className:f().seeMore,children:"See more notifications"})})]})]})};var g=a(3074),x=a(6016),j=a(9210);function v(){var e,t;let a=(0,r.useSearchParams)(),n=(0,r.useRouter)(),o=null==a?void 0:a.get("slug"),[m,u]=(0,s.useState)(null),[f,v]=(0,s.useState)(!0),[p,_]=(0,s.useState)(null),[w,k]=(0,s.useState)([]),[M,S]=(0,s.useState)(!1),[y,A]=(0,s.useState)(!0),[B,C]=(0,s.useState)(!1),[E,b]=(0,s.useState)(0),[L,I]=(0,s.useState)(null),[D,T]=(0,s.useState)([]),[U,W]=(0,s.useState)(!1),[H,P]=(0,s.useState)(null);(0,s.useEffect)(()=>{b(window.innerWidth);let e=()=>{b(window.innerWidth)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,s.useEffect)(()=>{let e=(0,h.hg)(d.j2,e=>{S(!!e),P(e),e&&(null==m?void 0:m.likes)&&W(m.likes.includes(e.uid))});return()=>e()},[m]),(0,s.useEffect)(()=>{let e=e=>{let t=e.target,a=document.getElementById("profile-menu"),i=document.getElementById("profile-button");a&&!a.contains(t)&&i&&!i.contains(t)&&C(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]),(0,s.useEffect)(()=>{(async()=>{if(!o){_("No article slug provided"),v(!1);return}try{let e=await (0,j.l6)(o);if(!e){_("Article not found"),v(!1);return}let t=e.body.replace(/<div[^>]*>Content is loaded from HTML<\/div>/g,"").replace(/<h1[^>]*>Untitled Article<\/h1>/g,"");I(t),T(e.likes||[]);let a=e.body.split(/\s+/).length,i=Math.ceil(a/200),s=e.createdAt?new Date(1e3*e.createdAt.seconds).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"Unknown date";u({id:e.id,title:e.title,authorName:e.authorName||"Anonymous",authorId:e.authorId,createdAt:s,readTime:i,likes:e.likes||[],tags:e.tags||[],slug:o}),k(e.tags||[]),v(!1)}catch(e){console.error("Error fetching article:",e),_("Failed to load article"),v(!1)}})()},[o]);let J=async()=>{try{await (0,h.CI)(d.j2),C(!1)}catch(e){console.error("Error signing out:",e)}},z=async()=>{if(!H)return void alert("Please login to like articles");try{U?(T(D.filter(e=>e!==H.uid)),W(!1)):(T([...D,H.uid]),W(!0))}catch(e){console.error("Error updating like status:",e)}};return f?(0,i.jsxs)("div",{className:c().loadingContainer,children:[(0,i.jsx)("div",{className:c().loadingIndicator}),(0,i.jsx)("p",{children:"Loading article..."})]}):p?(0,i.jsx)("div",{className:c().errorContainer,children:(0,i.jsx)("p",{className:c().errorMessage,children:p})}):(0,i.jsx)("div",{className:c().articlePageContainer,children:m&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("header",{className:c().pageHeader,children:(0,i.jsxs)("div",{className:c().headerContainer,children:[(0,i.jsx)(l(),{href:"/",className:c().logoLink,children:(0,i.jsx)("div",{className:c().headerLogo,children:"Journalite"})}),(0,i.jsxs)("div",{className:c().headerActions,children:[M&&(0,i.jsx)(N,{}),(0,i.jsx)("div",{className:c().profileMenu,id:"profile-menu",children:M?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{className:c().profileCircle,onClick:()=>{C(!B)},id:"profile-button",children:(null==H||null==(e=H.displayName)?void 0:e.charAt(0))||(null==H||null==(t=H.email)?void 0:t.charAt(0))||"U"}),B&&(0,i.jsxs)("div",{className:c().profileDropdown,children:[(0,i.jsx)(l(),{href:"/",className:c().dropdownItem,children:"Home"}),(0,i.jsx)(l(),{href:"/my-thoughts",className:c().dropdownItem,children:"My Thoughts"}),(0,i.jsx)(l(),{href:"/dashboard",className:c().dropdownItem,children:"Dashboard"}),(0,i.jsx)(l(),{href:"/write",className:c().dropdownItem,children:"Write a story"}),(0,i.jsx)(l(),{href:"/create-article",className:c().dropdownItem,children:"Create Article"}),(0,i.jsx)(l(),{href:"/explore",className:c().dropdownItem,children:"Explore"}),(0,i.jsx)(l(),{href:"/profile",className:c().dropdownItem,children:"Profile"}),(0,i.jsx)(l(),{href:"/settings",className:c().dropdownItem,children:"Settings"}),(0,i.jsx)("button",{onClick:J,className:c().dropdownItem,children:"Sign out"})]})]}):(0,i.jsxs)("div",{className:c().authButtons,children:[(0,i.jsx)(l(),{href:"/login",className:c().loginButton,children:"Sign in"}),(0,i.jsx)(l(),{href:"/signup",className:c().signupButton,children:"Get started"})]})})]})]})}),(0,i.jsxs)("div",{className:c().pageContainer,children:[(0,i.jsxs)("header",{className:c().articleHeader,children:[(0,i.jsx)("h1",{className:c().articleTitle,children:m.title}),(0,i.jsxs)("div",{className:c().articleMeta,children:[(0,i.jsxs)("div",{className:c().authorInfo,children:[(0,i.jsx)("div",{className:c().authorAvatar,children:m.authorName.charAt(0)}),(0,i.jsxs)("div",{className:c().authorDetails,children:[(0,i.jsx)(l(),{href:"/user/".concat(m.authorName.toLowerCase().replace(/\s+/g,"")),className:c().authorNameLink,children:(0,i.jsx)("div",{className:c().authorName,children:m.authorName})}),(0,i.jsxs)("div",{className:c().articleDetails,children:[m.createdAt," \xb7 ",m.readTime," min read"]})]})]}),(0,i.jsxs)("div",{className:c().articleActions,children:[(0,i.jsxs)("button",{className:"".concat(c().likeButton," ").concat(U?c().liked:""),onClick:z,"aria-label":U?"Unlike article":"Like article",children:[(0,i.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:U?"currentColor":"none",stroke:"currentColor",strokeWidth:"2",className:c().likeIcon,children:(0,i.jsx)("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})}),(0,i.jsx)("span",{children:D.length>0?D.length:""})]}),M&&m.authorId===(null==H?void 0:H.uid)&&(0,i.jsx)("button",{className:c().editButton,onClick:()=>n.push("/articles/".concat(m.id,"/edit")),children:"Edit"})]})]}),m.tags&&m.tags.length>0&&(0,i.jsx)("div",{className:c().tagContainer,children:m.tags.map((e,t)=>(0,i.jsx)("span",{className:c().tag,children:e},t))})]}),(0,i.jsx)(g.A,{articleId:m.id,initialHtml:L||void 0}),(0,i.jsx)("div",{className:c().commentsContainer,children:(0,i.jsx)(x.A,{articleId:m.id})}),(0,i.jsxs)("aside",{className:c().relatedTagsSection,children:[(0,i.jsx)("h2",{className:c().relatedTagsHeading,children:"Related Tags"}),(0,i.jsx)("div",{className:c().relatedTagsList,children:w.map(e=>(0,i.jsxs)(l(),{href:"/tag/".concat(e.toLowerCase()),className:c().relatedTag,children:["# ",e]},e))}),(0,i.jsx)(l(),{href:"/write",className:c().writeButton,children:"Write"})]})]})]})})}function p(){return(0,i.jsx)(s.Suspense,{fallback:(0,i.jsx)("div",{children:"Loading article..."}),children:(0,i.jsx)(v,{})})}},6559:e=>{e.exports={container:"MinimalNotificationBell_container__NGUf_",button:"MinimalNotificationBell_button__MAJkt",icon:"MinimalNotificationBell_icon__c6pW9",badge:"MinimalNotificationBell_badge___Di_K",dropdown:"MinimalNotificationBell_dropdown__PJtYq",header:"MinimalNotificationBell_header__zCiQJ",viewAll:"MinimalNotificationBell_viewAll__ZLWoU",list:"MinimalNotificationBell_list__MmsKd",item:"MinimalNotificationBell_item__flonv",unread:"MinimalNotificationBell_unread__278b3",content:"MinimalNotificationBell_content__31WKK",message:"MinimalNotificationBell_message__fnAua",time:"MinimalNotificationBell_time___76Fq",dot:"MinimalNotificationBell_dot__R2YqN",empty:"MinimalNotificationBell_empty__kDVAL",footer:"MinimalNotificationBell_footer__Pslwe",seeMore:"MinimalNotificationBell_seeMore__ggGUA"}},9251:(e,t,a)=>{Promise.resolve().then(a.bind(a,6462))}},e=>{var t=t=>e(e.s=t);e.O(0,[8130,8354,2992,7158,7117,6874,922,9429,8441,1684,7358],()=>t(9251)),_N_E=e.O()}]);